<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PianoPractice Pro</title>
    <link rel="stylesheet" href="css/styles.css">
    <!-- VexFlow from CDN -->
    <script src="https://cdn.jsdelivr.net/npm/vexflow@4.2.2/build/cjs/vexflow.js"></script>
</head>
<body>
    <div class="app-container">
        <!-- Header -->
        <header class="app-header">
            <h1>üéµ InstrumentPractice Pro</h1>
            <div class="header-controls">
                <button id="themeToggle" class="icon-btn" title="Toggle dark/light mode">
                    <span class="theme-icon">üåô</span>
                </button>
                <div class="midi-status" id="midiStatus">
                    <span class="status-dot"></span>
                    <span class="status-text">No MIDI</span>
                </div>
                <div class="microphone-status" id="microphoneStatus">
                    <span class="status-dot"></span>
                    <span class="status-text">No Microphone</span>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Sidebar Navigation -->
            <aside class="sidebar">
                <nav class="module-nav">
                    <button class="nav-btn active" data-module="sightReading">
                        <span class="nav-icon">üëÅÔ∏è</span>
                        <span>Sight Reading</span>
                    </button>
                    <button class="nav-btn" data-module="scales">
                        <span class="nav-icon">üéº</span>
                        <span>Scales Quiz</span>
                    </button>
                    <button class="nav-btn" data-module="keys">
                        <span class="nav-icon">üîë</span>
                        <span>Key Signatures</span>
                    </button>
                    <button class="nav-btn" data-module="chords">
                        <span class="nav-icon">üéµ</span>
                        <span>Chords Quiz</span>
                    </button>
                    <button class="nav-btn" data-module="progress">
                        <span class="nav-icon">üìä</span>
                        <span>Progress</span>
                    </button>
                </nav>

                <!-- Instrument Selector -->
                <div class="instrument-panel">
                    <h3>Instrument</h3>
                    <select id="instrumentSelect" class="instrument-select">
                        <option value="piano">üéπ Piano (MIDI)</option>
                        <option value="violin">üéª Violin (Microphone)</option>
                        <option value="guitar">üé∏ Guitar (Microphone)</option>
                    </select>
                </div>

                <!-- MIDI Device Selector -->
                <div class="midi-panel" id="midiSection">
                    <h3>MIDI Device</h3>
                    <select id="midiDeviceSelect" class="midi-select">
                        <option value="">No device connected</option>
                    </select>
                    <button id="connectMidiBtn" class="btn btn-secondary">Connect MIDI</button>
                    <div class="virtual-keyboard-toggle">
                        <label>
                            <input type="checkbox" id="virtualKeyboardToggle">
                            <span>Virtual Keyboard</span>
                        </label>
                    </div>
                </div>

                <!-- Microphone Input -->
                <div class="microphone-panel" id="microphoneSection" style="display: none;">
                    <h3>Microphone</h3>
                    <select id="audioDeviceSelect" class="audio-select">
                        <option value="">Select microphone...</option>
                    </select>
                    <div id="microphoneControls">
                        <button id="connectMicrophoneBtn" class="btn btn-primary">üé§ Connect Microphone</button>
                    </div>
                    <div class="audio-level-display">
                        <label>Audio Level:</label>
                        <div class="level-bar">
                            <div class="level-fill" id="audioLevelBar"></div>
                        </div>
                    </div>
                    <div class="pitch-display" id="pitchDisplay">
                        <span class="pitch-label">Detected:</span>
                        <span class="pitch-value" id="detectedPitch">-</span>
                        <span class="pitch-cents" id="detectedCents"></span>
                    </div>
                </div>
            </aside>

            <!-- Module Container -->
            <main class="module-container">
                <!-- Sight Reading Module -->
                <div id="sightReadingModule" class="module active">
                    <div class="module-header">
                        <h2>Sight Reading Practice</h2>
                        <div class="module-controls">
                            <label>
                                <span>Clef:</span>
                                <select id="clefSelect">
                                    <option value="treble">Treble</option>
                                    <option value="bass">Bass</option>
                                </select>
                            </label>
                            <label>
                                <span>Range:</span>
                                <select id="rangeSelect">
                                    <option value="c4-c5">C4-C5 (Beginner)</option>
                                    <option value="c4-g5">C4-G5 (Intermediate)</option>
                                    <option value="a3-c6">A3-C6 (Advanced)</option>
                                </select>
                            </label>
                            <label>
                                <input type="checkbox" id="fallingNotesToggle">
                                <span>Falling Notes Mode</span>
                            </label>
                        </div>
                    </div>

                    <!-- Notation Display -->
                    <div class="notation-container">
                        <div id="staffDisplay" class="staff-display"></div>
                        <div id="fallingNotesDisplay" class="falling-notes-display hidden"></div>
                    </div>

                    <!-- Feedback Display -->
                    <div class="feedback-display">
                        <div class="score-display">
                            <div class="score-item">
                                <span class="score-label">Correct:</span>
                                <span class="score-value" id="correctCount">0</span>
                            </div>
                            <div class="score-item">
                                <span class="score-label">Incorrect:</span>
                                <span class="score-value" id="incorrectCount">0</span>
                            </div>
                            <div class="score-item">
                                <span class="score-label">Streak:</span>
                                <span class="score-value" id="streakCount">0</span>
                            </div>
                            <div class="score-item">
                                <span class="score-label">Avg Time:</span>
                                <span class="score-value" id="avgTime">-</span>
                            </div>
                        </div>
                        <div class="feedback-message" id="feedbackMessage">
                            Play the note shown above
                        </div>
                    </div>

                    <!-- Session Controls -->
                    <div class="session-controls">
                        <button id="startSessionBtn" class="btn btn-primary">Start Practice</button>
                        <button id="stopSessionBtn" class="btn btn-secondary hidden">Stop</button>
                        <button id="nextNoteBtn" class="btn btn-secondary">Next Note</button>
                        <button id="playReferenceBtn" class="btn btn-secondary">üîä Play Note</button>
                    </div>
                </div>

                <!-- Scales Module (Placeholder) -->
                <div id="scalesModule" class="module">
                    <div class="module-header">
                        <h2>Scales Quiz</h2>
                    </div>
                    <div class="coming-soon">
                        <p>üéº</p>
                        <p>Coming Soon</p>
                        <p>Practice major and minor scales with MIDI validation</p>
                    </div>
                </div>

                <!-- Keys Module (Placeholder) -->
                <div id="keysModule" class="module">
                    <div class="module-header">
                        <h2>Key Signatures Quiz</h2>
                    </div>
                    <div class="coming-soon">
                        <p>üîë</p>
                        <p>Coming Soon</p>
                        <p>Master key signature recognition and circle of fifths</p>
                    </div>
                </div>

                <!-- Chords Module (Placeholder) -->
                <div id="chordsModule" class="module">
                    <div class="module-header">
                        <h2>Chords Quiz</h2>
                    </div>
                    <div class="coming-soon">
                        <p>üéµ</p>
                        <p>Coming Soon</p>
                        <p>Learn and practice chord recognition and voicings</p>
                    </div>
                </div>

                <!-- Progress Module (Placeholder) -->
                <div id="progressModule" class="module">
                    <div class="module-header">
                        <h2>Practice Progress</h2>
                    </div>
                    <div class="coming-soon">
                        <p>üìä</p>
                        <p>Coming Soon</p>
                        <p>Track your progress with detailed analytics and charts</p>
                    </div>
                </div>
            </main>
        </div>

        <!-- Virtual Keyboard (Hidden by default) -->
        <div id="virtualKeyboard" class="virtual-keyboard hidden">
            <div class="keyboard-container">
                <!-- Will be populated by JavaScript -->
            </div>
        </div>
    </div>

    <!-- JavaScript Bundle (TypeScript compiled) -->
    <script type="module" src="dist/app.js"></script>
</body>
</html>
