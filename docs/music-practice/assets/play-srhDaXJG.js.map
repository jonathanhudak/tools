{"version":3,"file":"play-srhDaXJG.js","sources":["../../../node_modules/.pnpm/lucide-react@0.468.0_react@18.3.1/node_modules/lucide-react/dist/esm/icons/clock.js","../../../node_modules/.pnpm/lucide-react@0.468.0_react@18.3.1/node_modules/lucide-react/dist/esm/icons/flame.js","../../../node_modules/.pnpm/lucide-react@0.468.0_react@18.3.1/node_modules/lucide-react/dist/esm/icons/heart.js","../../../node_modules/.pnpm/lucide-react@0.468.0_react@18.3.1/node_modules/lucide-react/dist/esm/icons/piano.js","../../../node_modules/.pnpm/lucide-react@0.468.0_react@18.3.1/node_modules/lucide-react/dist/esm/icons/skip-forward.js","../../../node_modules/.pnpm/lucide-react@0.468.0_react@18.3.1/node_modules/lucide-react/dist/esm/icons/trending-up.js","../../../node_modules/.pnpm/@tonaljs+pitch@5.0.2/node_modules/@tonaljs/pitch/dist/index.mjs","../../../node_modules/.pnpm/@tonaljs+pitch-interval@6.1.0/node_modules/@tonaljs/pitch-interval/dist/index.mjs","../../../node_modules/.pnpm/@tonaljs+pitch-note@6.1.0/node_modules/@tonaljs/pitch-note/dist/index.mjs","../../../node_modules/.pnpm/@tonaljs+pitch-distance@5.0.5/node_modules/@tonaljs/pitch-distance/dist/index.mjs","../../../node_modules/.pnpm/@tonaljs+collection@4.9.0/node_modules/@tonaljs/collection/dist/index.mjs","../../../node_modules/.pnpm/@tonaljs+pcset@4.10.1/node_modules/@tonaljs/pcset/dist/index.mjs","../../../node_modules/.pnpm/@tonaljs+chord-type@5.1.1/node_modules/@tonaljs/chord-type/dist/index.mjs","../../../node_modules/.pnpm/@tonaljs+interval@5.1.0/node_modules/@tonaljs/interval/dist/index.mjs","../../../node_modules/.pnpm/@tonaljs+scale-type@4.9.1/node_modules/@tonaljs/scale-type/dist/index.mjs","../../../node_modules/.pnpm/@tonaljs+chord@6.1.1/node_modules/@tonaljs/chord/dist/index.mjs","../../../node_modules/.pnpm/@tonaljs+duration-value@4.9.0/node_modules/@tonaljs/duration-value/dist/index.mjs","../../../node_modules/.pnpm/@tonaljs+midi@4.10.2/node_modules/@tonaljs/midi/dist/index.mjs","../../../node_modules/.pnpm/@tonaljs+note@4.12.1/node_modules/@tonaljs/note/dist/index.mjs","../../../node_modules/.pnpm/@tonaljs+mode@4.9.1/node_modules/@tonaljs/mode/dist/index.mjs","../../../node_modules/.pnpm/@tonaljs+scale@4.13.3/node_modules/@tonaljs/scale/dist/index.mjs","../../../apps/music-practice/src/lib/utils/instrument-config.ts","../../../apps/music-practice/src/lib/utils/music-theory.ts","../../../apps/music-practice/src/lib/input/midi-manager.ts","../../../node_modules/.pnpm/fft.js@4.0.4/node_modules/fft.js/lib/fft.js","../../../node_modules/.pnpm/pitchy@4.1.0/node_modules/pitchy/index.js","../../../apps/music-practice/src/lib/utils/pitch-detector.ts","../../../apps/music-practice/src/lib/input/audio-manager.ts","../../../apps/music-practice/src/lib/notation/staff-renderer.ts","../../../apps/music-practice/src/lib/notation/tab-renderer.ts","../../../apps/music-practice/src/lib/utils/storage.ts","../../../apps/music-practice/src/lib/utils/audio-playback.ts","../../../apps/music-practice/src/lib/game/note-range.ts","../../../apps/music-practice/src/lib/game/render-note.ts","../../../apps/music-practice/src/lib/utils/scoring.ts","../../../apps/music-practice/src/hooks/use-game-round.tsx","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/version.js","../../../node_modules/.pnpm/automation-events@7.1.13/node_modules/automation-events/build/es2019/functions/create-extended-exponential-ramp-to-value-automation-event.js","../../../node_modules/.pnpm/automation-events@7.1.13/node_modules/automation-events/build/es2019/functions/create-extended-linear-ramp-to-value-automation-event.js","../../../node_modules/.pnpm/automation-events@7.1.13/node_modules/automation-events/build/es2019/functions/create-set-value-automation-event.js","../../../node_modules/.pnpm/automation-events@7.1.13/node_modules/automation-events/build/es2019/functions/create-set-value-curve-automation-event.js","../../../node_modules/.pnpm/automation-events@7.1.13/node_modules/automation-events/build/es2019/functions/get-target-value-at-time.js","../../../node_modules/.pnpm/automation-events@7.1.13/node_modules/automation-events/build/es2019/guards/exponential-ramp-to-value-automation-event.js","../../../node_modules/.pnpm/automation-events@7.1.13/node_modules/automation-events/build/es2019/guards/linear-ramp-to-value-automation-event.js","../../../node_modules/.pnpm/automation-events@7.1.13/node_modules/automation-events/build/es2019/guards/any-ramp-to-value-automation-event.js","../../../node_modules/.pnpm/automation-events@7.1.13/node_modules/automation-events/build/es2019/guards/set-value-automation-event.js","../../../node_modules/.pnpm/automation-events@7.1.13/node_modules/automation-events/build/es2019/guards/set-value-curve-automation-event.js","../../../node_modules/.pnpm/automation-events@7.1.13/node_modules/automation-events/build/es2019/functions/get-value-of-automation-event-at-index-at-time.js","../../../node_modules/.pnpm/automation-events@7.1.13/node_modules/automation-events/build/es2019/functions/get-end-time-and-value-of-previous-automation-event.js","../../../node_modules/.pnpm/automation-events@7.1.13/node_modules/automation-events/build/es2019/guards/cancel-and-hold-automation-event.js","../../../node_modules/.pnpm/automation-events@7.1.13/node_modules/automation-events/build/es2019/guards/cancel-scheduled-values-automation-event.js","../../../node_modules/.pnpm/automation-events@7.1.13/node_modules/automation-events/build/es2019/functions/get-event-time.js","../../../node_modules/.pnpm/automation-events@7.1.13/node_modules/automation-events/build/es2019/functions/get-exponential-ramp-value-at-time.js","../../../node_modules/.pnpm/automation-events@7.1.13/node_modules/automation-events/build/es2019/functions/get-linear-ramp-value-at-time.js","../../../node_modules/.pnpm/automation-events@7.1.13/node_modules/automation-events/build/es2019/functions/interpolate-value.js","../../../node_modules/.pnpm/automation-events@7.1.13/node_modules/automation-events/build/es2019/functions/get-value-curve-value-at-time.js","../../../node_modules/.pnpm/automation-events@7.1.13/node_modules/automation-events/build/es2019/guards/set-target-automation-event.js","../../../node_modules/.pnpm/automation-events@7.1.13/node_modules/automation-events/build/es2019/classes/automation-event-list.js","../../../node_modules/.pnpm/automation-events@7.1.13/node_modules/automation-events/build/es2019/functions/create-cancel-and-hold-automation-event.js","../../../node_modules/.pnpm/automation-events@7.1.13/node_modules/automation-events/build/es2019/functions/create-cancel-scheduled-values-automation-event.js","../../../node_modules/.pnpm/automation-events@7.1.13/node_modules/automation-events/build/es2019/functions/create-exponential-ramp-to-value-automation-event.js","../../../node_modules/.pnpm/automation-events@7.1.13/node_modules/automation-events/build/es2019/functions/create-linear-ramp-to-value-automation-event.js","../../../node_modules/.pnpm/automation-events@7.1.13/node_modules/automation-events/build/es2019/functions/create-set-target-automation-event.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/abort-error.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/add-active-input-connection-to-audio-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/add-audio-node-connections.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/add-audio-param-connections.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/globals.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/is-constructible.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/split-import-statements.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/add-audio-worklet-module.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/get-value-for-key.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/pick-element-from-set.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/delete-passive-input-connection-to-audio-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/get-event-listeners-of-audio-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/set-internal-state-to-active.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/guards/audio-worklet-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/set-internal-state-to-passive.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/set-internal-state-to-passive-when-necessary.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/add-connection-to-audio-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/add-passive-input-connection-to-audio-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/add-silent-connection.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/add-unrendered-audio-worklet-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/analyser-node-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/is-owned-by-context.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/analyser-node-renderer-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/test-audio-buffer-copy-channel-methods-out-of-bounds-support.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/index-size-error.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/wrap-audio-buffer-get-channel-data-method.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/audio-buffer-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/constants.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/is-active-audio-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/audio-buffer-source-node-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/audio-buffer-source-node-renderer-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/guards/audio-buffer-source-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/guards/biquad-filter-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/guards/constant-source-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/guards/gain-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/guards/oscillator-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/guards/stereo-panner-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/get-audio-node-connections.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/get-audio-param-connections.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/deactivate-active-audio-node-input-connections.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/deactivate-audio-graph.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/is-valid-latency-hint.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/audio-context-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/audio-destination-node-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/audio-destination-node-renderer-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/audio-listener-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/guards/audio-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/guards/audio-node-output-connection.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/insert-element-in-set.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/add-active-input-connection-to-audio-param.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/add-passive-input-connection-to-audio-param.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/guards/native-audio-node-faker.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/connect-native-audio-node-to-native-audio-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/delete-active-input-connection.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/delete-active-input-connection-to-audio-param.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/delete-event-listeners-of-audio-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/delete-passive-input-connection-to-audio-param.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/disconnect-native-audio-node-from-native-audio-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/get-native-audio-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/get-native-audio-param.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/is-part-of-a-cycle.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/is-passive-audio-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/test-audio-node-disconnect-method-support.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/visit-each-audio-node-once.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/guards/native-audio-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/wrap-audio-node-disconnect-method.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/audio-node-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/audio-param-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/audio-param-renderer.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/read-only-map.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/audio-worklet-node-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/copy-from-channel.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/copy-to-channel.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/create-nested-arrays.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/get-audio-worklet-processor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/audio-worklet-node-renderer-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/base-audio-context-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/biquad-filter-node-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/biquad-filter-node-renderer-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/cache-test-result.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/channel-merger-node-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/channel-merger-node-renderer-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/channel-splitter-node-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/channel-splitter-node-renderer-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/connect-audio-param.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/connect-multiple-outputs.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/connected-native-audio-buffer-source-node-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/constant-source-node-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/constant-source-node-renderer-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/convert-number-to-unsigned-long.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/convolver-node-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/convolver-node-renderer-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/create-native-offline-audio-context.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/data-clone-error.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/detach-array-buffer.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/decode-audio-data.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/decrement-cycle-counter.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/delay-node-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/delay-node-renderer-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/delete-active-input-connection-to-audio-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/delete-unrendered-audio-worklet-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/guards/delay-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/detect-cycles.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/disconnect-multiple-outputs.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/dynamics-compressor-node-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/dynamics-compressor-node-renderer-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/encoding-error.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/evaluate-source.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/event-target-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/expose-current-frame-and-current-time.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/fetch-source.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/gain-node-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/gain-node-renderer-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/get-active-audio-worklet-node-inputs.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/get-audio-node-renderer.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/get-audio-node-tail-time.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/get-audio-param-renderer.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/get-backup-offline-audio-context.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/invalid-state-error.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/get-native-context.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/get-or-create-backup-offline-audio-context.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/get-unrendered-audio-worklet-nodes.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/invalid-access-error.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/wrap-iir-filter-node-get-frequency-response-method.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/iir-filter-node-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/filter-buffer.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/iir-filter-node-renderer-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/increment-cycle-counter-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/is-any-audio-context.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/is-any-audio-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/is-any-audio-param.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/is-any-offline-audio-context.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/is-native-audio-context.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/is-native-audio-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/is-native-audio-param.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/is-native-context.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/is-native-offline-audio-context.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/is-secure-context.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/media-element-audio-source-node-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/media-stream-audio-destination-node-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/media-stream-audio-source-node-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/media-stream-track-audio-source-node-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/minimal-base-audio-context-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/test-promise-support.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/monitor-connections.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/assign-native-audio-node-option.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/assign-native-audio-node-options.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/test-analyser-node-get-float-time-domain-data-method-support.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/wrap-analyser-node-get-float-time-domain-data-method.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-analyser-node-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-audio-buffer-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/assign-native-audio-node-audio-param-value.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/wrap-audio-buffer-source-node-start-method-consecutive-calls.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/wrap-audio-scheduled-source-node-start-method-negative-parameters.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/wrap-audio-scheduled-source-node-stop-method-negative-parameters.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-audio-buffer-source-node-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-audio-context-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-audio-destination-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-audio-worklet-node-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/test-clonability-of-audio-worklet-node-options.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-audio-worklet-node-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/compute-buffer-size.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/clone-audio-worklet-node-options.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/create-audio-worklet-processor-promise.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/create-audio-worklet-processor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-audio-worklet-node-faker-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-biquad-filter-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-channel-merger-node-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/wrap-channel-splitter-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-channel-splitter-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-constant-source-node-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/intercept-connections.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-constant-source-node-faker-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-convolver-node-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-delay-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-dynamics-compressor-node-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-gain-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-iir-filter-node-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-iir-filter-node-faker-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-media-element-audio-source-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-media-stream-audio-destination-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-media-stream-audio-source-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-media-stream-track-audio-source-node-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-offline-audio-context-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-oscillator-node-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-panner-node-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-panner-node-faker-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-periodic-wave-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-script-processor-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-stereo-panner-node-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-stereo-panner-node-faker-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-wave-shaper-node-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/native-wave-shaper-node-faker-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/not-supported-error.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/offline-audio-context-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/oscillator-node-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/oscillator-node-renderer-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/panner-node-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/panner-node-renderer-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/periodic-wave-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/render-automation.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/render-inputs-of-audio-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/render-inputs-of-audio-param.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/render-native-offline-audio-context.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/set-active-audio-worklet-node-inputs.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/set-audio-node-tail-time.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/start-rendering.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/stereo-panner-node-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/stereo-panner-node-renderer-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/test-audio-buffer-constructor-support.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/test-audio-worklet-processor-post-message-support.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/test-offline-audio-context-current-time-support.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/unknown-error.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/wave-shaper-node-constructor.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/wave-shaper-node-renderer-factory.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/window.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/wrap-audio-buffer-copy-channel-methods.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/wrap-audio-buffer-copy-channel-methods-out-of-bounds.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/wrap-audio-buffer-source-node-stop-method-nullified-buffer.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/factories/wrap-channel-merger-node.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/get-first-sample.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/is-dc-curve.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/overwrite-accessors.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/sanitize-audio-worklet-node-options.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/sanitize-channel-splitter-options.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/sanitize-periodic-wave-options.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/set-value-at-time-until-possible.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/test-audio-buffer-source-node-start-method-consecutive-calls-support.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/test-audio-buffer-source-node-start-method-offset-clamping-support.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/test-audio-buffer-source-node-stop-method-nullified-buffer-support.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/test-audio-scheduled-source-node-start-method-negative-parameters-support.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/test-audio-scheduled-source-node-stop-method-consecutive-calls-support.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/test-audio-scheduled-source-node-stop-method-negative-parameters-support.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/test-audio-worklet-node-options-clonability.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/wrap-audio-buffer-source-node-start-method-offset-clamping.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/wrap-audio-scheduled-source-node-stop-method-consecutive-calls.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/helpers/wrap-event-listener.js","../../../node_modules/.pnpm/standardized-audio-context@25.3.77/node_modules/standardized-audio-context/build/es2019/module.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/util/TypeCheck.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/util/Debug.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/context/AudioContext.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/clock/Ticker.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/util/AdvancedTypeCheck.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/util/Defaults.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/Tone.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/util/Math.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/util/Timeline.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/context/ContextInitialization.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/util/Emitter.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/context/BaseContext.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/context/Context.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/context/DummyContext.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/util/Interface.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/context/ToneAudioBuffer.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/context/OfflineContext.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/Global.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/type/Conversions.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/type/TimeBase.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/type/Time.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/type/Frequency.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/type/TransportTime.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/context/ToneWithContext.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/util/StateTimeline.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/context/Param.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/context/ToneAudioNode.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/context/Gain.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/source/OneShotSource.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/signal/ToneConstantSource.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/signal/Signal.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/clock/TickParam.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/clock/TickSignal.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/clock/TickSource.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/clock/Clock.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/component/channel/Volume.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/context/Destination.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/context/Listener.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/context/ToneAudioBuffers.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/type/Midi.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/type/Ticks.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/util/Draw.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/util/IntervalTimeline.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/util/TimelineValue.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/signal/SignalOperator.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/signal/WaveShaper.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/signal/Pow.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/clock/TransportEvent.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/clock/TransportRepeatEvent.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/clock/Transport.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/source/Source.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/source/buffer/ToneBufferSource.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/source/oscillator/OscillatorInterface.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/source/oscillator/ToneOscillatorNode.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/source/oscillator/Oscillator.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/signal/AudioToGain.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/signal/Multiply.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/source/oscillator/AMOscillator.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/source/oscillator/FMOscillator.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/source/oscillator/PulseOscillator.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/source/oscillator/FatOscillator.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/source/oscillator/PWMOscillator.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/source/oscillator/OmniOscillator.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/util/Decorator.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/source/buffer/Player.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/component/envelope/Envelope.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/instrument/Instrument.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/instrument/Monophonic.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/component/envelope/AmplitudeEnvelope.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/instrument/Synth.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/instrument/MembraneSynth.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/worklet/WorkletGlobalScope.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/worklet/ToneAudioWorkletProcessor.worklet.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/worklet/SingleIOProcessor.worklet.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/core/worklet/DelayLine.worklet.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/component/filter/FeedbackCombFilter.worklet.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/instrument/PolySynth.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/instrument/Sampler.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/component/channel/Panner.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/effect/BitCrusher.worklet.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/component/channel/Solo.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/component/channel/PanVol.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/component/channel/Channel.js","../../../node_modules/.pnpm/tone@15.1.22/node_modules/tone/build/esm/index.js","../../../apps/music-practice/src/components/virtual-keyboard.tsx","../../../apps/music-practice/src/components/play/radial-timer.tsx","../../../apps/music-practice/src/components/lives-display.tsx","../../../apps/music-practice/src/components/play/score-hud.tsx","../../../packages/audio-components/dist/index.js","../../../apps/music-practice/src/components/play/notation-card.tsx","../../../apps/music-practice/src/components/score-summary.tsx","../../../apps/music-practice/src/components/play/score-summary-modal.tsx","../../../apps/music-practice/src/routes/play.tsx?tsr-split=component"],"sourcesContent":["/**\n * @license lucide-react v0.468.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Clock = createLucideIcon(\"Clock\", [\n  [\"circle\", { cx: \"12\", cy: \"12\", r: \"10\", key: \"1mglay\" }],\n  [\"polyline\", { points: \"12 6 12 12 16 14\", key: \"68esgv\" }]\n]);\n\nexport { Clock as default };\n//# sourceMappingURL=clock.js.map\n","/**\n * @license lucide-react v0.468.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Flame = createLucideIcon(\"Flame\", [\n  [\n    \"path\",\n    {\n      d: \"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z\",\n      key: \"96xj49\"\n    }\n  ]\n]);\n\nexport { Flame as default };\n//# sourceMappingURL=flame.js.map\n","/**\n * @license lucide-react v0.468.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Heart = createLucideIcon(\"Heart\", [\n  [\n    \"path\",\n    {\n      d: \"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z\",\n      key: \"c3ymky\"\n    }\n  ]\n]);\n\nexport { Heart as default };\n//# sourceMappingURL=heart.js.map\n","/**\n * @license lucide-react v0.468.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst Piano = createLucideIcon(\"Piano\", [\n  [\n    \"path\",\n    {\n      d: \"M18.5 8c-1.4 0-2.6-.8-3.2-2A6.87 6.87 0 0 0 2 9v11a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-8.5C22 9.6 20.4 8 18.5 8\",\n      key: \"lag0yf\"\n    }\n  ],\n  [\"path\", { d: \"M2 14h20\", key: \"myj16y\" }],\n  [\"path\", { d: \"M6 14v4\", key: \"9ng0ue\" }],\n  [\"path\", { d: \"M10 14v4\", key: \"1v8uk5\" }],\n  [\"path\", { d: \"M14 14v4\", key: \"1tqops\" }],\n  [\"path\", { d: \"M18 14v4\", key: \"18uqwm\" }]\n]);\n\nexport { Piano as default };\n//# sourceMappingURL=piano.js.map\n","/**\n * @license lucide-react v0.468.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst SkipForward = createLucideIcon(\"SkipForward\", [\n  [\"polygon\", { points: \"5 4 15 12 5 20 5 4\", key: \"16p6eg\" }],\n  [\"line\", { x1: \"19\", x2: \"19\", y1: \"5\", y2: \"19\", key: \"futhcm\" }]\n]);\n\nexport { SkipForward as default };\n//# sourceMappingURL=skip-forward.js.map\n","/**\n * @license lucide-react v0.468.0 - ISC\n *\n * This source code is licensed under the ISC license.\n * See the LICENSE file in the root directory of this source tree.\n */\n\nimport createLucideIcon from '../createLucideIcon.js';\n\nconst TrendingUp = createLucideIcon(\"TrendingUp\", [\n  [\"polyline\", { points: \"22 7 13.5 15.5 8.5 10.5 2 17\", key: \"126l90\" }],\n  [\"polyline\", { points: \"16 7 22 7 22 13\", key: \"kwv8wd\" }]\n]);\n\nexport { TrendingUp as default };\n//# sourceMappingURL=trending-up.js.map\n","// index.ts\nfunction isNamedPitch(src) {\n  return src !== null && typeof src === \"object\" && \"name\" in src && typeof src.name === \"string\" ? true : false;\n}\nvar SIZES = [0, 2, 4, 5, 7, 9, 11];\nvar chroma = ({ step, alt }) => (SIZES[step] + alt + 120) % 12;\nvar height = ({ step, alt, oct, dir = 1 }) => dir * (SIZES[step] + alt + 12 * (oct === void 0 ? -100 : oct));\nvar midi = (pitch2) => {\n  const h = height(pitch2);\n  return pitch2.oct !== void 0 && h >= -12 && h <= 115 ? h + 12 : null;\n};\nfunction isPitch(pitch2) {\n  return pitch2 !== null && typeof pitch2 === \"object\" && \"step\" in pitch2 && typeof pitch2.step === \"number\" && \"alt\" in pitch2 && typeof pitch2.alt === \"number\" && !isNaN(pitch2.step) && !isNaN(pitch2.alt) ? true : false;\n}\nvar FIFTHS = [0, 2, 4, -1, 1, 3, 5];\nvar STEPS_TO_OCTS = FIFTHS.map(\n  (fifths) => Math.floor(fifths * 7 / 12)\n);\nfunction coordinates(pitch2) {\n  const { step, alt, oct, dir = 1 } = pitch2;\n  const f = FIFTHS[step] + 7 * alt;\n  if (oct === void 0) {\n    return [dir * f];\n  }\n  const o = oct - STEPS_TO_OCTS[step] - 4 * alt;\n  return [dir * f, dir * o];\n}\nvar FIFTHS_TO_STEPS = [3, 0, 4, 1, 5, 2, 6];\nfunction pitch(coord) {\n  const [f, o, dir] = coord;\n  const step = FIFTHS_TO_STEPS[unaltered(f)];\n  const alt = Math.floor((f + 1) / 7);\n  if (o === void 0) {\n    return { step, alt, dir };\n  }\n  const oct = o + 4 * alt + STEPS_TO_OCTS[step];\n  return { step, alt, oct, dir };\n}\nfunction unaltered(f) {\n  const i = (f + 1) % 7;\n  return i < 0 ? 7 + i : i;\n}\nexport {\n  chroma,\n  coordinates,\n  height,\n  isNamedPitch,\n  isPitch,\n  midi,\n  pitch\n};\n//# sourceMappingURL=index.mjs.map","// index.ts\nimport {\n  coordinates,\n  isNamedPitch,\n  isPitch,\n  pitch\n} from \"@tonaljs/pitch\";\nvar fillStr = (s, n) => Array(Math.abs(n) + 1).join(s);\nvar NoInterval = Object.freeze({\n  empty: true,\n  name: \"\",\n  num: NaN,\n  q: \"\",\n  type: \"\",\n  step: NaN,\n  alt: NaN,\n  dir: NaN,\n  simple: NaN,\n  semitones: NaN,\n  chroma: NaN,\n  coord: [],\n  oct: NaN\n});\nvar INTERVAL_TONAL_REGEX = \"([-+]?\\\\d+)(d{1,4}|m|M|P|A{1,4})\";\nvar INTERVAL_SHORTHAND_REGEX = \"(AA|A|P|M|m|d|dd)([-+]?\\\\d+)\";\nvar REGEX = new RegExp(\n  \"^\" + INTERVAL_TONAL_REGEX + \"|\" + INTERVAL_SHORTHAND_REGEX + \"$\"\n);\nfunction tokenizeInterval(str) {\n  const m = REGEX.exec(`${str}`);\n  if (m === null) {\n    return [\"\", \"\"];\n  }\n  return m[1] ? [m[1], m[2]] : [m[4], m[3]];\n}\nvar cache = {};\nfunction interval(src) {\n  return typeof src === \"string\" ? cache[src] || (cache[src] = parse(src)) : isPitch(src) ? interval(pitchName(src)) : isNamedPitch(src) ? interval(src.name) : NoInterval;\n}\nvar SIZES = [0, 2, 4, 5, 7, 9, 11];\nvar TYPES = \"PMMPPMM\";\nfunction parse(str) {\n  const tokens = tokenizeInterval(str);\n  if (tokens[0] === \"\") {\n    return NoInterval;\n  }\n  const num = +tokens[0];\n  const q = tokens[1];\n  const step = (Math.abs(num) - 1) % 7;\n  const t = TYPES[step];\n  if (t === \"M\" && q === \"P\") {\n    return NoInterval;\n  }\n  const type = t === \"M\" ? \"majorable\" : \"perfectable\";\n  const name = \"\" + num + q;\n  const dir = num < 0 ? -1 : 1;\n  const simple = num === 8 || num === -8 ? num : dir * (step + 1);\n  const alt = qToAlt(type, q);\n  const oct = Math.floor((Math.abs(num) - 1) / 7);\n  const semitones = dir * (SIZES[step] + alt + 12 * oct);\n  const chroma = (dir * (SIZES[step] + alt) % 12 + 12) % 12;\n  const coord = coordinates({ step, alt, oct, dir });\n  return {\n    empty: false,\n    name,\n    num,\n    q,\n    step,\n    alt,\n    dir,\n    type,\n    simple,\n    semitones,\n    chroma,\n    coord,\n    oct\n  };\n}\nfunction coordToInterval(coord, forceDescending) {\n  const [f, o = 0] = coord;\n  const isDescending = f * 7 + o * 12 < 0;\n  const ivl = forceDescending || isDescending ? [-f, -o, -1] : [f, o, 1];\n  return interval(pitch(ivl));\n}\nfunction qToAlt(type, q) {\n  return q === \"M\" && type === \"majorable\" || q === \"P\" && type === \"perfectable\" ? 0 : q === \"m\" && type === \"majorable\" ? -1 : /^A+$/.test(q) ? q.length : /^d+$/.test(q) ? -1 * (type === \"perfectable\" ? q.length : q.length + 1) : 0;\n}\nfunction pitchName(props) {\n  const { step, alt, oct = 0, dir } = props;\n  if (!dir) {\n    return \"\";\n  }\n  const calcNum = step + 1 + 7 * oct;\n  const num = calcNum === 0 ? step + 1 : calcNum;\n  const d = dir < 0 ? \"-\" : \"\";\n  const type = TYPES[step] === \"M\" ? \"majorable\" : \"perfectable\";\n  const name = d + num + altToQ(type, alt);\n  return name;\n}\nfunction altToQ(type, alt) {\n  if (alt === 0) {\n    return type === \"majorable\" ? \"M\" : \"P\";\n  } else if (alt === -1 && type === \"majorable\") {\n    return \"m\";\n  } else if (alt > 0) {\n    return fillStr(\"A\", alt);\n  } else {\n    return fillStr(\"d\", type === \"perfectable\" ? alt : alt + 1);\n  }\n}\nexport {\n  coordToInterval,\n  interval,\n  tokenizeInterval\n};\n//# sourceMappingURL=index.mjs.map","// index.ts\nimport {\n  coordinates,\n  isNamedPitch,\n  isPitch,\n  pitch\n} from \"@tonaljs/pitch\";\nvar fillStr = (s, n) => Array(Math.abs(n) + 1).join(s);\nvar NoNote = Object.freeze({\n  empty: true,\n  name: \"\",\n  letter: \"\",\n  acc: \"\",\n  pc: \"\",\n  step: NaN,\n  alt: NaN,\n  chroma: NaN,\n  height: NaN,\n  coord: [],\n  midi: null,\n  freq: null\n});\nvar cache = /* @__PURE__ */ new Map();\nvar stepToLetter = (step) => \"CDEFGAB\".charAt(step);\nvar altToAcc = (alt) => alt < 0 ? fillStr(\"b\", -alt) : fillStr(\"#\", alt);\nvar accToAlt = (acc) => acc[0] === \"b\" ? -acc.length : acc.length;\nfunction note(src) {\n  const stringSrc = JSON.stringify(src);\n  const cached = cache.get(stringSrc);\n  if (cached) {\n    return cached;\n  }\n  const value = typeof src === \"string\" ? parse(src) : isPitch(src) ? note(pitchName(src)) : isNamedPitch(src) ? note(src.name) : NoNote;\n  cache.set(stringSrc, value);\n  return value;\n}\nvar REGEX = /^([a-gA-G]?)(#{1,}|b{1,}|x{1,}|)(-?\\d*)\\s*(.*)$/;\nfunction tokenizeNote(str) {\n  const m = REGEX.exec(str);\n  return m ? [m[1].toUpperCase(), m[2].replace(/x/g, \"##\"), m[3], m[4]] : [\"\", \"\", \"\", \"\"];\n}\nfunction coordToNote(noteCoord) {\n  return note(pitch(noteCoord));\n}\nvar mod = (n, m) => (n % m + m) % m;\nvar SEMI = [0, 2, 4, 5, 7, 9, 11];\nfunction parse(noteName) {\n  const tokens = tokenizeNote(noteName);\n  if (tokens[0] === \"\" || tokens[3] !== \"\") {\n    return NoNote;\n  }\n  const letter = tokens[0];\n  const acc = tokens[1];\n  const octStr = tokens[2];\n  const step = (letter.charCodeAt(0) + 3) % 7;\n  const alt = accToAlt(acc);\n  const oct = octStr.length ? +octStr : void 0;\n  const coord = coordinates({ step, alt, oct });\n  const name = letter + acc + octStr;\n  const pc = letter + acc;\n  const chroma = (SEMI[step] + alt + 120) % 12;\n  const height = oct === void 0 ? mod(SEMI[step] + alt, 12) - 12 * 99 : SEMI[step] + alt + 12 * (oct + 1);\n  const midi = height >= 0 && height <= 127 ? height : null;\n  const freq = oct === void 0 ? null : Math.pow(2, (height - 69) / 12) * 440;\n  return {\n    empty: false,\n    acc,\n    alt,\n    chroma,\n    coord,\n    freq,\n    height,\n    letter,\n    midi,\n    name,\n    oct,\n    pc,\n    step\n  };\n}\nfunction pitchName(props) {\n  const { step, alt, oct } = props;\n  const letter = stepToLetter(step);\n  if (!letter) {\n    return \"\";\n  }\n  const pc = letter + altToAcc(alt);\n  return oct || oct === 0 ? pc + oct : pc;\n}\nexport {\n  accToAlt,\n  altToAcc,\n  coordToNote,\n  note,\n  stepToLetter,\n  tokenizeNote\n};\n//# sourceMappingURL=index.mjs.map","// index.ts\nimport {\n  interval as asInterval,\n  coordToInterval\n} from \"@tonaljs/pitch-interval\";\nimport {\n  note as asNote,\n  coordToNote\n} from \"@tonaljs/pitch-note\";\nfunction transpose(noteName, intervalName) {\n  const note = asNote(noteName);\n  const intervalCoord = Array.isArray(intervalName) ? intervalName : asInterval(intervalName).coord;\n  if (note.empty || !intervalCoord || intervalCoord.length < 2) {\n    return \"\";\n  }\n  const noteCoord = note.coord;\n  const tr = noteCoord.length === 1 ? [noteCoord[0] + intervalCoord[0]] : [noteCoord[0] + intervalCoord[0], noteCoord[1] + intervalCoord[1]];\n  return coordToNote(tr).name;\n}\nfunction tonicIntervalsTransposer(intervals, tonic) {\n  const len = intervals.length;\n  return (normalized) => {\n    if (!tonic) return \"\";\n    const index = normalized < 0 ? (len - -normalized % len) % len : normalized % len;\n    const octaves = Math.floor(normalized / len);\n    const root = transpose(tonic, [0, octaves]);\n    return transpose(root, intervals[index]);\n  };\n}\nfunction distance(fromNote, toNote) {\n  const from = asNote(fromNote);\n  const to = asNote(toNote);\n  if (from.empty || to.empty) {\n    return \"\";\n  }\n  const fcoord = from.coord;\n  const tcoord = to.coord;\n  const fifths = tcoord[0] - fcoord[0];\n  const octs = fcoord.length === 2 && tcoord.length === 2 ? tcoord[1] - fcoord[1] : -Math.floor(fifths * 7 / 12);\n  const forceDescending = to.height === from.height && to.midi !== null && from.oct === to.oct && from.step > to.step;\n  return coordToInterval([fifths, octs], forceDescending).name;\n}\nexport {\n  distance,\n  tonicIntervalsTransposer,\n  transpose\n};\n//# sourceMappingURL=index.mjs.map","// index.ts\nfunction ascR(b, n) {\n  const a = [];\n  for (; n--; a[n] = n + b) ;\n  return a;\n}\nfunction descR(b, n) {\n  const a = [];\n  for (; n--; a[n] = b - n) ;\n  return a;\n}\nfunction range(from, to) {\n  return from < to ? ascR(from, to - from + 1) : descR(from, from - to + 1);\n}\nfunction rotate(times, arr) {\n  const len = arr.length;\n  const n = (times % len + len) % len;\n  return arr.slice(n, len).concat(arr.slice(0, n));\n}\nfunction compact(arr) {\n  return arr.filter((n) => n === 0 || n);\n}\nfunction shuffle(arr, rnd = Math.random) {\n  let i;\n  let t;\n  let m = arr.length;\n  while (m) {\n    i = Math.floor(rnd() * m--);\n    t = arr[m];\n    arr[m] = arr[i];\n    arr[i] = t;\n  }\n  return arr;\n}\nfunction permutations(arr) {\n  if (arr.length === 0) {\n    return [[]];\n  }\n  return permutations(arr.slice(1)).reduce((acc, perm) => {\n    return acc.concat(\n      arr.map((e, pos) => {\n        const newPerm = perm.slice();\n        newPerm.splice(pos, 0, arr[0]);\n        return newPerm;\n      })\n    );\n  }, []);\n}\nvar collection_default = {\n  compact,\n  permutations,\n  range,\n  rotate,\n  shuffle\n};\nexport {\n  compact,\n  collection_default as default,\n  permutations,\n  range,\n  rotate,\n  shuffle\n};\n//# sourceMappingURL=index.mjs.map","// index.ts\nimport { compact, range, rotate } from \"@tonaljs/collection\";\nimport { transpose } from \"@tonaljs/pitch-distance\";\nimport { interval } from \"@tonaljs/pitch-interval\";\nimport { note } from \"@tonaljs/pitch-note\";\nvar EmptyPcset = {\n  empty: true,\n  name: \"\",\n  setNum: 0,\n  chroma: \"000000000000\",\n  normalized: \"000000000000\",\n  intervals: []\n};\nvar setNumToChroma = (num2) => Number(num2).toString(2).padStart(12, \"0\");\nvar chromaToNumber = (chroma2) => parseInt(chroma2, 2);\nvar REGEX = /^[01]{12}$/;\nfunction isChroma(set) {\n  return REGEX.test(set);\n}\nvar isPcsetNum = (set) => typeof set === \"number\" && set >= 0 && set <= 4095;\nvar isPcset = (set) => set && isChroma(set.chroma);\nvar cache = { [EmptyPcset.chroma]: EmptyPcset };\nfunction get(src) {\n  const chroma2 = isChroma(src) ? src : isPcsetNum(src) ? setNumToChroma(src) : Array.isArray(src) ? listToChroma(src) : isPcset(src) ? src.chroma : EmptyPcset.chroma;\n  return cache[chroma2] = cache[chroma2] || chromaToPcset(chroma2);\n}\nvar pcset = get;\nvar chroma = (set) => get(set).chroma;\nvar intervals = (set) => get(set).intervals;\nvar num = (set) => get(set).setNum;\nvar IVLS = [\n  \"1P\",\n  \"2m\",\n  \"2M\",\n  \"3m\",\n  \"3M\",\n  \"4P\",\n  \"5d\",\n  \"5P\",\n  \"6m\",\n  \"6M\",\n  \"7m\",\n  \"7M\"\n];\nfunction chromaToIntervals(chroma2) {\n  const intervals2 = [];\n  for (let i = 0; i < 12; i++) {\n    if (chroma2.charAt(i) === \"1\") intervals2.push(IVLS[i]);\n  }\n  return intervals2;\n}\nfunction notes(set) {\n  return get(set).intervals.map((ivl) => transpose(\"C\", ivl));\n}\nfunction chromas() {\n  return range(2048, 4095).map(setNumToChroma);\n}\nfunction modes(set, normalize = true) {\n  const pcs = get(set);\n  const binary = pcs.chroma.split(\"\");\n  return compact(\n    binary.map((_, i) => {\n      const r = rotate(i, binary);\n      return normalize && r[0] === \"0\" ? null : r.join(\"\");\n    })\n  );\n}\nfunction isEqual(s1, s2) {\n  return get(s1).setNum === get(s2).setNum;\n}\nfunction isSubsetOf(set) {\n  const s = get(set).setNum;\n  return (notes2) => {\n    const o = get(notes2).setNum;\n    return s && s !== o && (o & s) === o;\n  };\n}\nfunction isSupersetOf(set) {\n  const s = get(set).setNum;\n  return (notes2) => {\n    const o = get(notes2).setNum;\n    return s && s !== o && (o | s) === o;\n  };\n}\nfunction isNoteIncludedIn(set) {\n  const s = get(set);\n  return (noteName) => {\n    const n = note(noteName);\n    return s && !n.empty && s.chroma.charAt(n.chroma) === \"1\";\n  };\n}\nvar includes = isNoteIncludedIn;\nfunction filter(set) {\n  const isIncluded = isNoteIncludedIn(set);\n  return (notes2) => {\n    return notes2.filter(isIncluded);\n  };\n}\nvar pcset_default = {\n  get,\n  chroma,\n  num,\n  intervals,\n  chromas,\n  isSupersetOf,\n  isSubsetOf,\n  isNoteIncludedIn,\n  isEqual,\n  filter,\n  modes,\n  notes,\n  // deprecated\n  pcset\n};\nfunction chromaRotations(chroma2) {\n  const binary = chroma2.split(\"\");\n  return binary.map((_, i) => rotate(i, binary).join(\"\"));\n}\nfunction chromaToPcset(chroma2) {\n  const setNum = chromaToNumber(chroma2);\n  const normalizedNum = chromaRotations(chroma2).map(chromaToNumber).filter((n) => n >= 2048).sort()[0];\n  const normalized = setNumToChroma(normalizedNum);\n  const intervals2 = chromaToIntervals(chroma2);\n  return {\n    empty: false,\n    name: \"\",\n    setNum,\n    chroma: chroma2,\n    normalized,\n    intervals: intervals2\n  };\n}\nfunction listToChroma(set) {\n  if (set.length === 0) {\n    return EmptyPcset.chroma;\n  }\n  let pitch;\n  const binary = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\n  for (let i = 0; i < set.length; i++) {\n    pitch = note(set[i]);\n    if (pitch.empty) pitch = interval(set[i]);\n    if (!pitch.empty) binary[pitch.chroma] = 1;\n  }\n  return binary.join(\"\");\n}\nexport {\n  EmptyPcset,\n  chroma,\n  chromas,\n  pcset_default as default,\n  filter,\n  get,\n  includes,\n  intervals,\n  isChroma,\n  isEqual,\n  isNoteIncludedIn,\n  isSubsetOf,\n  isSupersetOf,\n  modes,\n  notes,\n  num,\n  pcset\n};\n//# sourceMappingURL=index.mjs.map","// index.ts\nimport {\n  EmptyPcset,\n  get as pcset\n} from \"@tonaljs/pcset\";\n\n// data.ts\nvar CHORDS = [\n  // ==Major==\n  [\"1P 3M 5P\", \"major\", \"M ^  maj\"],\n  [\"1P 3M 5P 7M\", \"major seventh\", \"maj7 \\u0394 ma7 M7 Maj7 ^7\"],\n  [\"1P 3M 5P 7M 9M\", \"major ninth\", \"maj9 \\u03949 ^9\"],\n  [\"1P 3M 5P 7M 9M 13M\", \"major thirteenth\", \"maj13 Maj13 ^13\"],\n  [\"1P 3M 5P 6M\", \"sixth\", \"6 add6 add13 M6\"],\n  [\"1P 3M 5P 6M 9M\", \"sixth added ninth\", \"6add9 6/9 69 M69\"],\n  [\"1P 3M 6m 7M\", \"major seventh flat sixth\", \"M7b6 ^7b6\"],\n  [\n    \"1P 3M 5P 7M 11A\",\n    \"major seventh sharp eleventh\",\n    \"maj#4 \\u0394#4 \\u0394#11 M7#11 ^7#11 maj7#11\"\n  ],\n  // ==Minor==\n  // '''Normal'''\n  [\"1P 3m 5P\", \"minor\", \"m min -\"],\n  [\"1P 3m 5P 7m\", \"minor seventh\", \"m7 min7 mi7 -7\"],\n  [\n    \"1P 3m 5P 7M\",\n    \"minor/major seventh\",\n    \"m/ma7 m/maj7 mM7 mMaj7 m/M7 -\\u03947 m\\u0394 -^7 -maj7\"\n  ],\n  [\"1P 3m 5P 6M\", \"minor sixth\", \"m6 -6\"],\n  [\"1P 3m 5P 7m 9M\", \"minor ninth\", \"m9 -9\"],\n  [\"1P 3m 5P 7M 9M\", \"minor/major ninth\", \"mM9 mMaj9 -^9\"],\n  [\"1P 3m 5P 7m 9M 11P\", \"minor eleventh\", \"m11 -11\"],\n  [\"1P 3m 5P 7m 9M 13M\", \"minor thirteenth\", \"m13 -13\"],\n  // '''Diminished'''\n  [\"1P 3m 5d\", \"diminished\", \"dim \\xB0 o\"],\n  [\"1P 3m 5d 7d\", \"diminished seventh\", \"dim7 \\xB07 o7\"],\n  [\"1P 3m 5d 7m\", \"half-diminished\", \"m7b5 \\xF8 -7b5 h7 h\"],\n  // ==Dominant/Seventh==\n  // '''Normal'''\n  [\"1P 3M 5P 7m\", \"dominant seventh\", \"7 dom\"],\n  [\"1P 3M 5P 7m 9M\", \"dominant ninth\", \"9\"],\n  [\"1P 3M 5P 7m 9M 13M\", \"dominant thirteenth\", \"13\"],\n  [\"1P 3M 5P 7m 11A\", \"lydian dominant seventh\", \"7#11 7#4\"],\n  // '''Altered'''\n  [\"1P 3M 5P 7m 9m\", \"dominant flat ninth\", \"7b9\"],\n  [\"1P 3M 5P 7m 9A\", \"dominant sharp ninth\", \"7#9\"],\n  [\"1P 3M 7m 9m\", \"altered\", \"alt7\"],\n  // '''Suspended'''\n  [\"1P 4P 5P\", \"suspended fourth\", \"sus4 sus\"],\n  [\"1P 2M 5P\", \"suspended second\", \"sus2\"],\n  [\"1P 4P 5P 7m\", \"suspended fourth seventh\", \"7sus4 7sus\"],\n  [\"1P 5P 7m 9M 11P\", \"eleventh\", \"11\"],\n  [\n    \"1P 4P 5P 7m 9m\",\n    \"suspended fourth flat ninth\",\n    \"b9sus phryg 7b9sus 7b9sus4\"\n  ],\n  // ==Other==\n  [\"1P 5P\", \"fifth\", \"5\"],\n  [\"1P 3M 5A\", \"augmented\", \"aug + +5 ^#5\"],\n  [\"1P 3m 5A\", \"minor augmented\", \"m#5 -#5 m+\"],\n  [\"1P 3M 5A 7M\", \"augmented seventh\", \"maj7#5 maj7+5 +maj7 ^7#5\"],\n  [\n    \"1P 3M 5P 7M 9M 11A\",\n    \"major sharp eleventh (lydian)\",\n    \"maj9#11 \\u03949#11 ^9#11\"\n  ],\n  // ==Legacy==\n  [\"1P 2M 4P 5P\", \"\", \"sus24 sus4add9\"],\n  [\"1P 3M 5A 7M 9M\", \"\", \"maj9#5 Maj9#5\"],\n  [\"1P 3M 5A 7m\", \"\", \"7#5 +7 7+ 7aug aug7\"],\n  [\"1P 3M 5A 7m 9A\", \"\", \"7#5#9 7#9#5 7alt\"],\n  [\"1P 3M 5A 7m 9M\", \"\", \"9#5 9+\"],\n  [\"1P 3M 5A 7m 9M 11A\", \"\", \"9#5#11\"],\n  [\"1P 3M 5A 7m 9m\", \"\", \"7#5b9 7b9#5\"],\n  [\"1P 3M 5A 7m 9m 11A\", \"\", \"7#5b9#11\"],\n  [\"1P 3M 5A 9A\", \"\", \"+add#9\"],\n  [\"1P 3M 5A 9M\", \"\", \"M#5add9 +add9\"],\n  [\"1P 3M 5P 6M 11A\", \"\", \"M6#11 M6b5 6#11 6b5\"],\n  [\"1P 3M 5P 6M 7M 9M\", \"\", \"M7add13\"],\n  [\"1P 3M 5P 6M 9M 11A\", \"\", \"69#11\"],\n  [\"1P 3m 5P 6M 9M\", \"\", \"m69 -69\"],\n  [\"1P 3M 5P 6m 7m\", \"\", \"7b6\"],\n  [\"1P 3M 5P 7M 9A 11A\", \"\", \"maj7#9#11\"],\n  [\"1P 3M 5P 7M 9M 11A 13M\", \"\", \"M13#11 maj13#11 M13+4 M13#4\"],\n  [\"1P 3M 5P 7M 9m\", \"\", \"M7b9\"],\n  [\"1P 3M 5P 7m 11A 13m\", \"\", \"7#11b13 7b5b13\"],\n  [\"1P 3M 5P 7m 13M\", \"\", \"7add6 67 7add13\"],\n  [\"1P 3M 5P 7m 9A 11A\", \"\", \"7#9#11 7b5#9 7#9b5\"],\n  [\"1P 3M 5P 7m 9A 11A 13M\", \"\", \"13#9#11\"],\n  [\"1P 3M 5P 7m 9A 11A 13m\", \"\", \"7#9#11b13\"],\n  [\"1P 3M 5P 7m 9A 13M\", \"\", \"13#9\"],\n  [\"1P 3M 5P 7m 9A 13m\", \"\", \"7#9b13\"],\n  [\"1P 3M 5P 7m 9M 11A\", \"\", \"9#11 9+4 9#4\"],\n  [\"1P 3M 5P 7m 9M 11A 13M\", \"\", \"13#11 13+4 13#4\"],\n  [\"1P 3M 5P 7m 9M 11A 13m\", \"\", \"9#11b13 9b5b13\"],\n  [\"1P 3M 5P 7m 9m 11A\", \"\", \"7b9#11 7b5b9 7b9b5\"],\n  [\"1P 3M 5P 7m 9m 11A 13M\", \"\", \"13b9#11\"],\n  [\"1P 3M 5P 7m 9m 11A 13m\", \"\", \"7b9b13#11 7b9#11b13 7b5b9b13\"],\n  [\"1P 3M 5P 7m 9m 13M\", \"\", \"13b9\"],\n  [\"1P 3M 5P 7m 9m 13m\", \"\", \"7b9b13\"],\n  [\"1P 3M 5P 7m 9m 9A\", \"\", \"7b9#9\"],\n  [\"1P 3M 5P 9M\", \"\", \"Madd9 2 add9 add2\"],\n  [\"1P 3M 5P 9m\", \"\", \"Maddb9\"],\n  [\"1P 3M 5d\", \"\", \"Mb5\"],\n  [\"1P 3M 5d 6M 7m 9M\", \"\", \"13b5\"],\n  [\"1P 3M 5d 7M\", \"\", \"M7b5\"],\n  [\"1P 3M 5d 7M 9M\", \"\", \"M9b5\"],\n  [\"1P 3M 5d 7m\", \"\", \"7b5\"],\n  [\"1P 3M 5d 7m 9M\", \"\", \"9b5\"],\n  [\"1P 3M 7m\", \"\", \"7no5\"],\n  [\"1P 3M 7m 13m\", \"\", \"7b13\"],\n  [\"1P 3M 7m 9M\", \"\", \"9no5\"],\n  [\"1P 3M 7m 9M 13M\", \"\", \"13no5\"],\n  [\"1P 3M 7m 9M 13m\", \"\", \"9b13\"],\n  [\"1P 3m 4P 5P\", \"\", \"madd4\"],\n  [\"1P 3m 5P 6m 7M\", \"\", \"mMaj7b6\"],\n  [\"1P 3m 5P 6m 7M 9M\", \"\", \"mMaj9b6\"],\n  [\"1P 3m 5P 7m 11P\", \"\", \"m7add11 m7add4\"],\n  [\"1P 3m 5P 9M\", \"\", \"madd9\"],\n  [\"1P 3m 5d 6M 7M\", \"\", \"o7M7\"],\n  [\"1P 3m 5d 7M\", \"\", \"oM7\"],\n  [\"1P 3m 6m 7M\", \"\", \"mb6M7\"],\n  [\"1P 3m 6m 7m\", \"\", \"m7#5\"],\n  [\"1P 3m 6m 7m 9M\", \"\", \"m9#5\"],\n  [\"1P 3m 5A 7m 9M 11P\", \"\", \"m11A\"],\n  [\"1P 3m 6m 9m\", \"\", \"mb6b9\"],\n  [\"1P 2M 3m 5d 7m\", \"\", \"m9b5\"],\n  [\"1P 4P 5A 7M\", \"\", \"M7#5sus4\"],\n  [\"1P 4P 5A 7M 9M\", \"\", \"M9#5sus4\"],\n  [\"1P 4P 5A 7m\", \"\", \"7#5sus4\"],\n  [\"1P 4P 5P 7M\", \"\", \"M7sus4\"],\n  [\"1P 4P 5P 7M 9M\", \"\", \"M9sus4\"],\n  [\"1P 4P 5P 7m 9M\", \"\", \"9sus4 9sus\"],\n  [\"1P 4P 5P 7m 9M 13M\", \"\", \"13sus4 13sus\"],\n  [\"1P 4P 5P 7m 9m 13m\", \"\", \"7sus4b9b13 7b9b13sus4\"],\n  [\"1P 4P 7m 10m\", \"\", \"4 quartal\"],\n  [\"1P 5P 7m 9m 11P\", \"\", \"11b9\"]\n];\nvar data_default = CHORDS;\n\n// index.ts\nvar NoChordType = {\n  ...EmptyPcset,\n  name: \"\",\n  quality: \"Unknown\",\n  intervals: [],\n  aliases: []\n};\nvar dictionary = [];\nvar index = {};\nfunction get(type) {\n  return index[type] || NoChordType;\n}\nvar chordType = get;\nfunction names() {\n  return dictionary.map((chord) => chord.name).filter((x) => x);\n}\nfunction symbols() {\n  return dictionary.map((chord) => chord.aliases[0]).filter((x) => x);\n}\nfunction keys() {\n  return Object.keys(index);\n}\nfunction all() {\n  return dictionary.slice();\n}\nvar entries = all;\nfunction removeAll() {\n  dictionary = [];\n  index = {};\n}\nfunction add(intervals, aliases, fullName) {\n  const quality = getQuality(intervals);\n  const chord = {\n    ...pcset(intervals),\n    name: fullName || \"\",\n    quality,\n    intervals,\n    aliases\n  };\n  dictionary.push(chord);\n  if (chord.name) {\n    index[chord.name] = chord;\n  }\n  index[chord.setNum] = chord;\n  index[chord.chroma] = chord;\n  chord.aliases.forEach((alias) => addAlias(chord, alias));\n}\nfunction addAlias(chord, alias) {\n  index[alias] = chord;\n}\nfunction getQuality(intervals) {\n  const has = (interval) => intervals.indexOf(interval) !== -1;\n  return has(\"5A\") ? \"Augmented\" : has(\"3M\") ? \"Major\" : has(\"5d\") ? \"Diminished\" : has(\"3m\") ? \"Minor\" : \"Unknown\";\n}\ndata_default.forEach(\n  ([ivls, fullName, names2]) => add(ivls.split(\" \"), names2.split(\" \"), fullName)\n);\ndictionary.sort((a, b) => a.setNum - b.setNum);\nvar chord_type_default = {\n  names,\n  symbols,\n  get,\n  all,\n  add,\n  removeAll,\n  keys,\n  // deprecated\n  entries,\n  chordType\n};\nexport {\n  add,\n  addAlias,\n  all,\n  chordType,\n  chord_type_default as default,\n  entries,\n  get,\n  keys,\n  names,\n  removeAll,\n  symbols\n};\n//# sourceMappingURL=index.mjs.map","// index.ts\nimport { distance as dist } from \"@tonaljs/pitch-distance\";\nimport {\n  coordToInterval,\n  interval as props\n} from \"@tonaljs/pitch-interval\";\nfunction names() {\n  return \"1P 2M 3M 4P 5P 6m 7m\".split(\" \");\n}\nvar get = props;\nvar name = (name2) => props(name2).name;\nvar semitones = (name2) => props(name2).semitones;\nvar quality = (name2) => props(name2).q;\nvar num = (name2) => props(name2).num;\nfunction simplify(name2) {\n  const i = props(name2);\n  return i.empty ? \"\" : i.simple + i.q;\n}\nfunction invert(name2) {\n  const i = props(name2);\n  if (i.empty) {\n    return \"\";\n  }\n  const step = (7 - i.step) % 7;\n  const alt = i.type === \"perfectable\" ? -i.alt : -(i.alt + 1);\n  return props({ step, alt, oct: i.oct, dir: i.dir }).name;\n}\nvar IN = [1, 2, 2, 3, 3, 4, 5, 5, 6, 6, 7, 7];\nvar IQ = \"P m M m M P d P m M m M\".split(\" \");\nfunction fromSemitones(semitones2) {\n  const d = semitones2 < 0 ? -1 : 1;\n  const n = Math.abs(semitones2);\n  const c = n % 12;\n  const o = Math.floor(n / 12);\n  return d * (IN[c] + 7 * o) + IQ[c];\n}\nvar distance = dist;\nvar add = combinator((a, b) => [a[0] + b[0], a[1] + b[1]]);\nvar addTo = (interval) => (other) => add(interval, other);\nvar subtract = combinator((a, b) => [a[0] - b[0], a[1] - b[1]]);\nfunction transposeFifths(interval, fifths) {\n  const ivl = get(interval);\n  if (ivl.empty) return \"\";\n  const [nFifths, nOcts, dir] = ivl.coord;\n  return coordToInterval([nFifths + fifths, nOcts, dir]).name;\n}\nvar interval_default = {\n  names,\n  get,\n  name,\n  num,\n  semitones,\n  quality,\n  fromSemitones,\n  distance,\n  invert,\n  simplify,\n  add,\n  addTo,\n  subtract,\n  transposeFifths\n};\nfunction combinator(fn) {\n  return (a, b) => {\n    const coordA = props(a).coord;\n    const coordB = props(b).coord;\n    if (coordA && coordB) {\n      const coord = fn(coordA, coordB);\n      return coordToInterval(coord).name;\n    }\n  };\n}\nexport {\n  add,\n  addTo,\n  interval_default as default,\n  distance,\n  fromSemitones,\n  get,\n  invert,\n  name,\n  names,\n  num,\n  quality,\n  semitones,\n  simplify,\n  subtract,\n  transposeFifths\n};\n//# sourceMappingURL=index.mjs.map","// index.ts\nimport {\n  EmptyPcset,\n  get as pcset\n} from \"@tonaljs/pcset\";\n\n// data.ts\nvar SCALES = [\n  // Basic scales\n  [\"1P 2M 3M 5P 6M\", \"major pentatonic\", \"pentatonic\"],\n  [\"1P 2M 3M 4P 5P 6M 7M\", \"major\", \"ionian\"],\n  [\"1P 2M 3m 4P 5P 6m 7m\", \"minor\", \"aeolian\"],\n  // Jazz common scales\n  [\"1P 2M 3m 3M 5P 6M\", \"major blues\"],\n  [\"1P 3m 4P 5d 5P 7m\", \"minor blues\", \"blues\"],\n  [\"1P 2M 3m 4P 5P 6M 7M\", \"melodic minor\"],\n  [\"1P 2M 3m 4P 5P 6m 7M\", \"harmonic minor\"],\n  [\"1P 2M 3M 4P 5P 6M 7m 7M\", \"bebop\"],\n  [\"1P 2M 3m 4P 5d 6m 6M 7M\", \"diminished\", \"whole-half diminished\"],\n  // Modes\n  [\"1P 2M 3m 4P 5P 6M 7m\", \"dorian\"],\n  [\"1P 2M 3M 4A 5P 6M 7M\", \"lydian\"],\n  [\"1P 2M 3M 4P 5P 6M 7m\", \"mixolydian\", \"dominant\"],\n  [\"1P 2m 3m 4P 5P 6m 7m\", \"phrygian\"],\n  [\"1P 2m 3m 4P 5d 6m 7m\", \"locrian\"],\n  // 5-note scales\n  [\"1P 3M 4P 5P 7M\", \"ionian pentatonic\"],\n  [\"1P 3M 4P 5P 7m\", \"mixolydian pentatonic\", \"indian\"],\n  [\"1P 2M 4P 5P 6M\", \"ritusen\"],\n  [\"1P 2M 4P 5P 7m\", \"egyptian\"],\n  [\"1P 3M 4P 5d 7m\", \"neopolitan major pentatonic\"],\n  [\"1P 3m 4P 5P 6m\", \"vietnamese 1\"],\n  [\"1P 2m 3m 5P 6m\", \"pelog\"],\n  [\"1P 2m 4P 5P 6m\", \"kumoijoshi\"],\n  [\"1P 2M 3m 5P 6m\", \"hirajoshi\"],\n  [\"1P 2m 4P 5d 7m\", \"iwato\"],\n  [\"1P 2m 4P 5P 7m\", \"in-sen\"],\n  [\"1P 3M 4A 5P 7M\", \"lydian pentatonic\", \"chinese\"],\n  [\"1P 3m 4P 6m 7m\", \"malkos raga\"],\n  [\"1P 3m 4P 5d 7m\", \"locrian pentatonic\", \"minor seven flat five pentatonic\"],\n  [\"1P 3m 4P 5P 7m\", \"minor pentatonic\", \"vietnamese 2\"],\n  [\"1P 3m 4P 5P 6M\", \"minor six pentatonic\"],\n  [\"1P 2M 3m 5P 6M\", \"flat three pentatonic\", \"kumoi\"],\n  [\"1P 2M 3M 5P 6m\", \"flat six pentatonic\"],\n  [\"1P 2m 3M 5P 6M\", \"scriabin\"],\n  [\"1P 3M 5d 6m 7m\", \"whole tone pentatonic\"],\n  [\"1P 3M 4A 5A 7M\", \"lydian #5P pentatonic\"],\n  [\"1P 3M 4A 5P 7m\", \"lydian dominant pentatonic\"],\n  [\"1P 3m 4P 5P 7M\", \"minor #7M pentatonic\"],\n  [\"1P 3m 4d 5d 7m\", \"super locrian pentatonic\"],\n  // 6-note scales\n  [\"1P 2M 3m 4P 5P 7M\", \"minor hexatonic\"],\n  [\"1P 2A 3M 5P 5A 7M\", \"augmented\"],\n  [\"1P 2M 4P 5P 6M 7m\", \"piongio\"],\n  [\"1P 2m 3M 4A 6M 7m\", \"prometheus neopolitan\"],\n  [\"1P 2M 3M 4A 6M 7m\", \"prometheus\"],\n  [\"1P 2m 3M 5d 6m 7m\", \"mystery #1\"],\n  [\"1P 2m 3M 4P 5A 6M\", \"six tone symmetric\"],\n  [\"1P 2M 3M 4A 5A 6A\", \"whole tone\", \"messiaen's mode #1\"],\n  [\"1P 2m 4P 4A 5P 7M\", \"messiaen's mode #5\"],\n  // 7-note scales\n  [\"1P 2M 3M 4P 5d 6m 7m\", \"locrian major\", \"arabian\"],\n  [\"1P 2m 3M 4A 5P 6m 7M\", \"double harmonic lydian\"],\n  [\n    \"1P 2m 2A 3M 4A 6m 7m\",\n    \"altered\",\n    \"super locrian\",\n    \"diminished whole tone\",\n    \"pomeroy\"\n  ],\n  [\"1P 2M 3m 4P 5d 6m 7m\", \"locrian #2\", \"half-diminished\", \"aeolian b5\"],\n  [\n    \"1P 2M 3M 4P 5P 6m 7m\",\n    \"mixolydian b6\",\n    \"melodic minor fifth mode\",\n    \"hindu\"\n  ],\n  [\"1P 2M 3M 4A 5P 6M 7m\", \"lydian dominant\", \"lydian b7\", \"overtone\"],\n  [\"1P 2M 3M 4A 5A 6M 7M\", \"lydian augmented\"],\n  [\n    \"1P 2m 3m 4P 5P 6M 7m\",\n    \"dorian b2\",\n    \"phrygian #6\",\n    \"melodic minor second mode\"\n  ],\n  [\n    \"1P 2m 3m 4d 5d 6m 7d\",\n    \"ultralocrian\",\n    \"superlocrian bb7\",\n    \"superlocrian diminished\"\n  ],\n  [\"1P 2m 3m 4P 5d 6M 7m\", \"locrian 6\", \"locrian natural 6\", \"locrian sharp 6\"],\n  [\"1P 2A 3M 4P 5P 5A 7M\", \"augmented heptatonic\"],\n  // Source https://en.wikipedia.org/wiki/Ukrainian_Dorian_scale\n  [\n    \"1P 2M 3m 4A 5P 6M 7m\",\n    \"dorian #4\",\n    \"ukrainian dorian\",\n    \"romanian minor\",\n    \"altered dorian\"\n  ],\n  [\"1P 2M 3m 4A 5P 6M 7M\", \"lydian diminished\"],\n  [\"1P 2M 3M 4A 5A 7m 7M\", \"leading whole tone\"],\n  [\"1P 2M 3M 4A 5P 6m 7m\", \"lydian minor\"],\n  [\"1P 2m 3M 4P 5P 6m 7m\", \"phrygian dominant\", \"spanish\", \"phrygian major\"],\n  [\"1P 2m 3m 4P 5P 6m 7M\", \"balinese\"],\n  [\"1P 2m 3m 4P 5P 6M 7M\", \"neopolitan major\"],\n  [\"1P 2M 3M 4P 5P 6m 7M\", \"harmonic major\"],\n  [\"1P 2m 3M 4P 5P 6m 7M\", \"double harmonic major\", \"gypsy\"],\n  [\"1P 2M 3m 4A 5P 6m 7M\", \"hungarian minor\"],\n  [\"1P 2A 3M 4A 5P 6M 7m\", \"hungarian major\"],\n  [\"1P 2m 3M 4P 5d 6M 7m\", \"oriental\"],\n  [\"1P 2m 3m 3M 4A 5P 7m\", \"flamenco\"],\n  [\"1P 2m 3m 4A 5P 6m 7M\", \"todi raga\"],\n  [\"1P 2m 3M 4P 5d 6m 7M\", \"persian\"],\n  [\"1P 2m 3M 5d 6m 7m 7M\", \"enigmatic\"],\n  [\n    \"1P 2M 3M 4P 5A 6M 7M\",\n    \"major augmented\",\n    \"major #5\",\n    \"ionian augmented\",\n    \"ionian #5\"\n  ],\n  [\"1P 2A 3M 4A 5P 6M 7M\", \"lydian #9\"],\n  // 8-note scales\n  [\"1P 2m 2M 4P 4A 5P 6m 7M\", \"messiaen's mode #4\"],\n  [\"1P 2m 3M 4P 4A 5P 6m 7M\", \"purvi raga\"],\n  [\"1P 2m 3m 3M 4P 5P 6m 7m\", \"spanish heptatonic\"],\n  [\"1P 2M 3m 3M 4P 5P 6M 7m\", \"bebop minor\"],\n  [\"1P 2M 3M 4P 5P 5A 6M 7M\", \"bebop major\"],\n  [\"1P 2m 3m 4P 5d 5P 6m 7m\", \"bebop locrian\"],\n  [\"1P 2M 3m 4P 5P 6m 7m 7M\", \"minor bebop\"],\n  [\"1P 2M 3M 4P 5d 5P 6M 7M\", \"ichikosucho\"],\n  [\"1P 2M 3m 4P 5P 6m 6M 7M\", \"minor six diminished\"],\n  [\n    \"1P 2m 3m 3M 4A 5P 6M 7m\",\n    \"half-whole diminished\",\n    \"dominant diminished\",\n    \"messiaen's mode #2\"\n  ],\n  [\"1P 3m 3M 4P 5P 6M 7m 7M\", \"kafi raga\"],\n  [\"1P 2M 3M 4P 4A 5A 6A 7M\", \"messiaen's mode #6\"],\n  // 9-note scales\n  [\"1P 2M 3m 3M 4P 5d 5P 6M 7m\", \"composite blues\"],\n  [\"1P 2M 3m 3M 4A 5P 6m 7m 7M\", \"messiaen's mode #3\"],\n  // 10-note scales\n  [\"1P 2m 2M 3m 4P 4A 5P 6m 6M 7M\", \"messiaen's mode #7\"],\n  // 12-note scales\n  [\"1P 2m 2M 3m 3M 4P 5d 5P 6m 6M 7m 7M\", \"chromatic\"]\n];\nvar data_default = SCALES;\n\n// index.ts\nvar NoScaleType = {\n  ...EmptyPcset,\n  intervals: [],\n  aliases: []\n};\nvar dictionary = [];\nvar index = {};\nfunction names() {\n  return dictionary.map((scale) => scale.name);\n}\nfunction get(type) {\n  return index[type] || NoScaleType;\n}\nvar scaleType = get;\nfunction all() {\n  return dictionary.slice();\n}\nvar entries = all;\nfunction keys() {\n  return Object.keys(index);\n}\nfunction removeAll() {\n  dictionary = [];\n  index = {};\n}\nfunction add(intervals, name, aliases = []) {\n  const scale = { ...pcset(intervals), name, intervals, aliases };\n  dictionary.push(scale);\n  index[scale.name] = scale;\n  index[scale.setNum] = scale;\n  index[scale.chroma] = scale;\n  scale.aliases.forEach((alias) => addAlias(scale, alias));\n  return scale;\n}\nfunction addAlias(scale, alias) {\n  index[alias] = scale;\n}\ndata_default.forEach(\n  ([ivls, name, ...aliases]) => add(ivls.split(\" \"), name, aliases)\n);\nvar scale_type_default = {\n  names,\n  get,\n  all,\n  add,\n  removeAll,\n  keys,\n  // deprecated\n  entries,\n  scaleType\n};\nexport {\n  NoScaleType,\n  add,\n  addAlias,\n  all,\n  scale_type_default as default,\n  entries,\n  get,\n  keys,\n  names,\n  removeAll,\n  scaleType\n};\n//# sourceMappingURL=index.mjs.map","// index.ts\nimport { detect } from \"@tonaljs/chord-detect\";\nimport {\n  all as chordTypes,\n  get as getChordType\n} from \"@tonaljs/chord-type\";\nimport { subtract } from \"@tonaljs/interval\";\nimport { isSubsetOf, isSupersetOf } from \"@tonaljs/pcset\";\nimport {\n  distance,\n  tonicIntervalsTransposer,\n  transpose as transposeNote\n} from \"@tonaljs/pitch-distance\";\nimport { note, tokenizeNote } from \"@tonaljs/pitch-note\";\nimport { all as scaleTypes } from \"@tonaljs/scale-type\";\nimport { detect as detect2 } from \"@tonaljs/chord-detect\";\nvar NoChord = {\n  empty: true,\n  name: \"\",\n  symbol: \"\",\n  root: \"\",\n  bass: \"\",\n  rootDegree: 0,\n  type: \"\",\n  tonic: null,\n  setNum: NaN,\n  quality: \"Unknown\",\n  chroma: \"\",\n  normalized: \"\",\n  aliases: [],\n  notes: [],\n  intervals: []\n};\nfunction tokenize(name) {\n  const [letter, acc, oct, type] = tokenizeNote(name);\n  if (letter === \"\") {\n    return tokenizeBass(\"\", name);\n  } else if (letter === \"A\" && type === \"ug\") {\n    return tokenizeBass(\"\", \"aug\");\n  } else {\n    return tokenizeBass(letter + acc, oct + type);\n  }\n}\nfunction tokenizeBass(note2, chord2) {\n  const split = chord2.split(\"/\");\n  if (split.length === 1) {\n    return [note2, split[0], \"\"];\n  }\n  const [letter, acc, oct, type] = tokenizeNote(split[1]);\n  if (letter !== \"\" && oct === \"\" && type === \"\") {\n    return [note2, split[0], letter + acc];\n  } else {\n    return [note2, chord2, \"\"];\n  }\n}\nfunction get(src) {\n  if (Array.isArray(src)) {\n    return getChord(src[1] || \"\", src[0], src[2]);\n  } else if (src === \"\") {\n    return NoChord;\n  } else {\n    const [tonic, type, bass] = tokenize(src);\n    const chord2 = getChord(type, tonic, bass);\n    return chord2.empty ? getChord(src) : chord2;\n  }\n}\nfunction getChord(typeName, optionalTonic, optionalBass) {\n  const type = getChordType(typeName);\n  const tonic = note(optionalTonic || \"\");\n  const bass = note(optionalBass || \"\");\n  if (type.empty || optionalTonic && tonic.empty || optionalBass && bass.empty) {\n    return NoChord;\n  }\n  const bassInterval = distance(tonic.pc, bass.pc);\n  const bassIndex = type.intervals.indexOf(bassInterval);\n  const hasRoot = bassIndex >= 0;\n  const root = hasRoot ? bass : note(\"\");\n  const rootDegree = bassIndex === -1 ? NaN : bassIndex + 1;\n  const hasBass = bass.pc && bass.pc !== tonic.pc;\n  const intervals = Array.from(type.intervals);\n  if (hasRoot) {\n    for (let i = 1; i < rootDegree; i++) {\n      const num = intervals[0][0];\n      const quality = intervals[0][1];\n      const newNum = parseInt(num, 10) + 7;\n      intervals.push(`${newNum}${quality}`);\n      intervals.shift();\n    }\n  } else if (hasBass) {\n    const ivl = subtract(distance(tonic.pc, bass.pc), \"8P\");\n    if (ivl) intervals.unshift(ivl);\n  }\n  const notes2 = tonic.empty ? [] : intervals.map((i) => transposeNote(tonic.pc, i));\n  typeName = type.aliases.indexOf(typeName) !== -1 ? typeName : type.aliases[0];\n  const symbol = `${tonic.empty ? \"\" : tonic.pc}${typeName}${hasRoot && rootDegree > 1 ? \"/\" + root.pc : hasBass ? \"/\" + bass.pc : \"\"}`;\n  const name = `${optionalTonic ? tonic.pc + \" \" : \"\"}${type.name}${hasRoot && rootDegree > 1 ? \" over \" + root.pc : hasBass ? \" over \" + bass.pc : \"\"}`;\n  return {\n    ...type,\n    name,\n    symbol,\n    tonic: tonic.pc,\n    type: type.name,\n    root: root.pc,\n    bass: hasBass ? bass.pc : \"\",\n    intervals,\n    rootDegree,\n    notes: notes2\n  };\n}\nvar chord = get;\nfunction transpose(chordName, interval) {\n  const [tonic, type, bass] = tokenize(chordName);\n  if (!tonic) {\n    return chordName;\n  }\n  const tr = transposeNote(bass, interval);\n  const slash = tr ? \"/\" + tr : \"\";\n  return transposeNote(tonic, interval) + type + slash;\n}\nfunction chordScales(name) {\n  const s = get(name);\n  const isChordIncluded = isSupersetOf(s.chroma);\n  return scaleTypes().filter((scale) => isChordIncluded(scale.chroma)).map((scale) => scale.name);\n}\nfunction extended(chordName) {\n  const s = get(chordName);\n  const isSuperset = isSupersetOf(s.chroma);\n  return chordTypes().filter((chord2) => isSuperset(chord2.chroma)).map((chord2) => s.tonic + chord2.aliases[0]);\n}\nfunction reduced(chordName) {\n  const s = get(chordName);\n  const isSubset = isSubsetOf(s.chroma);\n  return chordTypes().filter((chord2) => isSubset(chord2.chroma)).map((chord2) => s.tonic + chord2.aliases[0]);\n}\nfunction notes(chordName, tonic) {\n  const chord2 = get(chordName);\n  const note2 = tonic || chord2.tonic;\n  if (!note2 || chord2.empty) return [];\n  return chord2.intervals.map((ivl) => transposeNote(note2, ivl));\n}\nfunction degrees(chordName, tonic) {\n  const chord2 = get(chordName);\n  const note2 = tonic || chord2.tonic;\n  const transpose2 = tonicIntervalsTransposer(chord2.intervals, note2);\n  return (degree) => degree ? transpose2(degree > 0 ? degree - 1 : degree) : \"\";\n}\nfunction steps(chordName, tonic) {\n  const chord2 = get(chordName);\n  const note2 = tonic || chord2.tonic;\n  return tonicIntervalsTransposer(chord2.intervals, note2);\n}\nvar chord_default = {\n  getChord,\n  get,\n  detect,\n  chordScales,\n  extended,\n  reduced,\n  tokenize,\n  transpose,\n  degrees,\n  steps,\n  notes,\n  chord\n};\nexport {\n  chord,\n  chordScales,\n  chord_default as default,\n  degrees,\n  detect2 as detect,\n  extended,\n  get,\n  getChord,\n  notes,\n  reduced,\n  steps,\n  tokenize,\n  transpose\n};\n//# sourceMappingURL=index.mjs.map","// data.ts\nvar DATA = [\n  [\n    0.125,\n    \"dl\",\n    [\"large\", \"duplex longa\", \"maxima\", \"octuple\", \"octuple whole\"]\n  ],\n  [0.25, \"l\", [\"long\", \"longa\"]],\n  [0.5, \"d\", [\"double whole\", \"double\", \"breve\"]],\n  [1, \"w\", [\"whole\", \"semibreve\"]],\n  [2, \"h\", [\"half\", \"minim\"]],\n  [4, \"q\", [\"quarter\", \"crotchet\"]],\n  [8, \"e\", [\"eighth\", \"quaver\"]],\n  [16, \"s\", [\"sixteenth\", \"semiquaver\"]],\n  [32, \"t\", [\"thirty-second\", \"demisemiquaver\"]],\n  [64, \"sf\", [\"sixty-fourth\", \"hemidemisemiquaver\"]],\n  [128, \"h\", [\"hundred twenty-eighth\"]],\n  [256, \"th\", [\"two hundred fifty-sixth\"]]\n];\nvar data_default = DATA;\n\n// index.ts\nvar VALUES = [];\ndata_default.forEach(\n  ([denominator, shorthand, names2]) => add(denominator, shorthand, names2)\n);\nvar NoDuration = {\n  empty: true,\n  name: \"\",\n  value: 0,\n  fraction: [0, 0],\n  shorthand: \"\",\n  dots: \"\",\n  names: []\n};\nfunction names() {\n  return VALUES.reduce((names2, duration) => {\n    duration.names.forEach((name) => names2.push(name));\n    return names2;\n  }, []);\n}\nfunction shorthands() {\n  return VALUES.map((dur) => dur.shorthand);\n}\nvar REGEX = /^([^.]+)(\\.*)$/;\nfunction get(name) {\n  const [_, simple, dots] = REGEX.exec(name) || [];\n  const base = VALUES.find(\n    (dur) => dur.shorthand === simple || dur.names.includes(simple)\n  );\n  if (!base) {\n    return NoDuration;\n  }\n  const fraction2 = calcDots(base.fraction, dots.length);\n  const value2 = fraction2[0] / fraction2[1];\n  return { ...base, name, dots, value: value2, fraction: fraction2 };\n}\nvar value = (name) => get(name).value;\nvar fraction = (name) => get(name).fraction;\nvar duration_value_default = { names, shorthands, get, value, fraction };\nfunction add(denominator, shorthand, names2) {\n  VALUES.push({\n    empty: false,\n    dots: \"\",\n    name: \"\",\n    value: 1 / denominator,\n    fraction: denominator < 1 ? [1 / denominator, 1] : [1, denominator],\n    shorthand,\n    names: names2\n  });\n}\nfunction calcDots(fraction2, dots) {\n  const pow = Math.pow(2, dots);\n  let numerator = fraction2[0] * pow;\n  let denominator = fraction2[1] * pow;\n  const base = numerator;\n  for (let i = 0; i < dots; i++) {\n    numerator += base / Math.pow(2, i + 1);\n  }\n  while (numerator % 2 === 0 && denominator % 2 === 0) {\n    numerator /= 2;\n    denominator /= 2;\n  }\n  return [numerator, denominator];\n}\nexport {\n  duration_value_default as default,\n  fraction,\n  get,\n  names,\n  shorthands,\n  value\n};\n//# sourceMappingURL=index.mjs.map","// index.ts\nimport { note as props } from \"@tonaljs/pitch-note\";\nfunction isMidi(arg) {\n  return +arg >= 0 && +arg <= 127;\n}\nfunction toMidi(note) {\n  if (isMidi(note)) {\n    return +note;\n  }\n  const n = props(note);\n  return n.empty ? null : n.midi;\n}\nfunction midiToFreq(midi, tuning = 440) {\n  return Math.pow(2, (midi - 69) / 12) * tuning;\n}\nvar L2 = Math.log(2);\nvar L440 = Math.log(440);\nfunction freqToMidi(freq) {\n  const v = 12 * (Math.log(freq) - L440) / L2 + 69;\n  return Math.round(v * 100) / 100;\n}\nvar SHARPS = \"C C# D D# E F F# G G# A A# B\".split(\" \");\nvar FLATS = \"C Db D Eb E F Gb G Ab A Bb B\".split(\" \");\nfunction midiToNoteName(midi, options = {}) {\n  if (isNaN(midi) || midi === -Infinity || midi === Infinity) return \"\";\n  midi = Math.round(midi);\n  const pcs = options.sharps === true ? SHARPS : FLATS;\n  const pc = pcs[midi % 12];\n  if (options.pitchClass) {\n    return pc;\n  }\n  const o = Math.floor(midi / 12) - 1;\n  return pc + o;\n}\nfunction chroma(midi) {\n  return midi % 12;\n}\nfunction pcsetFromChroma(chroma2) {\n  return chroma2.split(\"\").reduce((pcset2, val, index) => {\n    if (index < 12 && val === \"1\") pcset2.push(index);\n    return pcset2;\n  }, []);\n}\nfunction pcsetFromMidi(midi) {\n  return midi.map(chroma).sort((a, b) => a - b).filter((n, i, a) => i === 0 || n !== a[i - 1]);\n}\nfunction pcset(notes) {\n  return Array.isArray(notes) ? pcsetFromMidi(notes) : pcsetFromChroma(notes);\n}\nfunction pcsetNearest(notes) {\n  const set = pcset(notes);\n  return (midi) => {\n    const ch = chroma(midi);\n    for (let i = 0; i < 12; i++) {\n      if (set.includes(ch + i)) return midi + i;\n      if (set.includes(ch - i)) return midi - i;\n    }\n    return void 0;\n  };\n}\nfunction pcsetSteps(notes, tonic) {\n  const set = pcset(notes);\n  const len = set.length;\n  return (step) => {\n    const index = step < 0 ? (len - -step % len) % len : step % len;\n    const octaves = Math.floor(step / len);\n    return set[index] + octaves * 12 + tonic;\n  };\n}\nfunction pcsetDegrees(notes, tonic) {\n  const steps = pcsetSteps(notes, tonic);\n  return (degree) => {\n    if (degree === 0) return void 0;\n    return steps(degree > 0 ? degree - 1 : degree);\n  };\n}\nvar index_default = {\n  chroma,\n  freqToMidi,\n  isMidi,\n  midiToFreq,\n  midiToNoteName,\n  pcsetNearest,\n  pcset,\n  pcsetDegrees,\n  pcsetSteps,\n  toMidi\n};\nexport {\n  chroma,\n  index_default as default,\n  freqToMidi,\n  isMidi,\n  midiToFreq,\n  midiToNoteName,\n  pcset,\n  pcsetDegrees,\n  pcsetNearest,\n  pcsetSteps,\n  toMidi\n};\n//# sourceMappingURL=index.mjs.map","// index.ts\nimport { freqToMidi, midiToNoteName } from \"@tonaljs/midi\";\nimport { distance as _dist, transpose as _tr } from \"@tonaljs/pitch-distance\";\nimport {\n  note as props\n} from \"@tonaljs/pitch-note\";\nvar NAMES = [\"C\", \"D\", \"E\", \"F\", \"G\", \"A\", \"B\"];\nvar toName = (n) => n.name;\nvar onlyNotes = (array) => array.map(props).filter((n) => !n.empty);\nfunction names(array) {\n  if (array === void 0) {\n    return NAMES.slice();\n  } else if (!Array.isArray(array)) {\n    return [];\n  } else {\n    return onlyNotes(array).map(toName);\n  }\n}\nvar get = props;\nvar name = (note) => get(note).name;\nvar pitchClass = (note) => get(note).pc;\nvar accidentals = (note) => get(note).acc;\nvar octave = (note) => get(note).oct;\nvar midi = (note) => get(note).midi;\nvar freq = (note) => get(note).freq;\nvar chroma = (note) => get(note).chroma;\nfunction fromMidi(midi2) {\n  return midiToNoteName(midi2);\n}\nfunction fromFreq(freq2) {\n  return midiToNoteName(freqToMidi(freq2));\n}\nfunction fromFreqSharps(freq2) {\n  return midiToNoteName(freqToMidi(freq2), { sharps: true });\n}\nfunction fromMidiSharps(midi2) {\n  return midiToNoteName(midi2, { sharps: true });\n}\nvar distance = _dist;\nvar transpose = _tr;\nvar tr = _tr;\nvar transposeBy = (interval) => (note) => transpose(note, interval);\nvar trBy = transposeBy;\nvar transposeFrom = (note) => (interval) => transpose(note, interval);\nvar trFrom = transposeFrom;\nfunction transposeFifths(noteName, fifths) {\n  return transpose(noteName, [fifths, 0]);\n}\nvar trFifths = transposeFifths;\nfunction transposeOctaves(noteName, octaves) {\n  return transpose(noteName, [0, octaves]);\n}\nvar ascending = (a, b) => a.height - b.height;\nvar descending = (a, b) => b.height - a.height;\nfunction sortedNames(notes, comparator) {\n  comparator = comparator || ascending;\n  return onlyNotes(notes).sort(comparator).map(toName);\n}\nfunction sortedUniqNames(notes) {\n  return sortedNames(notes, ascending).filter(\n    (n, i, a) => i === 0 || n !== a[i - 1]\n  );\n}\nvar simplify = (noteName) => {\n  const note = get(noteName);\n  if (note.empty) {\n    return \"\";\n  }\n  return midiToNoteName(note.midi || note.chroma, {\n    sharps: note.alt > 0,\n    pitchClass: note.midi === null\n  });\n};\nfunction enharmonic(noteName, destName) {\n  const src = get(noteName);\n  if (src.empty) {\n    return \"\";\n  }\n  const dest = get(\n    destName || midiToNoteName(src.midi || src.chroma, {\n      sharps: src.alt < 0,\n      pitchClass: true\n    })\n  );\n  if (dest.empty || dest.chroma !== src.chroma) {\n    return \"\";\n  }\n  if (src.oct === void 0) {\n    return dest.pc;\n  }\n  const srcChroma = src.chroma - src.alt;\n  const destChroma = dest.chroma - dest.alt;\n  const destOctOffset = srcChroma > 11 || destChroma < 0 ? -1 : srcChroma < 0 || destChroma > 11 ? 1 : 0;\n  const destOct = src.oct + destOctOffset;\n  return dest.pc + destOct;\n}\nvar index_default = {\n  names,\n  get,\n  name,\n  pitchClass,\n  accidentals,\n  octave,\n  midi,\n  ascending,\n  descending,\n  distance,\n  sortedNames,\n  sortedUniqNames,\n  fromMidi,\n  fromMidiSharps,\n  freq,\n  fromFreq,\n  fromFreqSharps,\n  chroma,\n  transpose,\n  tr,\n  transposeBy,\n  trBy,\n  transposeFrom,\n  trFrom,\n  transposeFifths,\n  transposeOctaves,\n  trFifths,\n  simplify,\n  enharmonic\n};\nexport {\n  accidentals,\n  ascending,\n  chroma,\n  index_default as default,\n  descending,\n  distance,\n  enharmonic,\n  freq,\n  fromFreq,\n  fromFreqSharps,\n  fromMidi,\n  fromMidiSharps,\n  get,\n  midi,\n  name,\n  names,\n  octave,\n  pitchClass,\n  simplify,\n  sortedNames,\n  sortedUniqNames,\n  tr,\n  trBy,\n  trFifths,\n  trFrom,\n  transpose,\n  transposeBy,\n  transposeFifths,\n  transposeFrom,\n  transposeOctaves\n};\n//# sourceMappingURL=index.mjs.map","// index.ts\nimport { rotate } from \"@tonaljs/collection\";\nimport { simplify, transposeFifths } from \"@tonaljs/interval\";\nimport { EmptyPcset } from \"@tonaljs/pcset\";\nimport { transpose } from \"@tonaljs/pitch-distance\";\nimport { get as getType } from \"@tonaljs/scale-type\";\nvar MODES = [\n  [0, 2773, 0, \"ionian\", \"\", \"Maj7\", \"major\"],\n  [1, 2902, 2, \"dorian\", \"m\", \"m7\"],\n  [2, 3418, 4, \"phrygian\", \"m\", \"m7\"],\n  [3, 2741, -1, \"lydian\", \"\", \"Maj7\"],\n  [4, 2774, 1, \"mixolydian\", \"\", \"7\"],\n  [5, 2906, 3, \"aeolian\", \"m\", \"m7\", \"minor\"],\n  [6, 3434, 5, \"locrian\", \"dim\", \"m7b5\"]\n];\nvar NoMode = {\n  ...EmptyPcset,\n  name: \"\",\n  alt: 0,\n  modeNum: NaN,\n  triad: \"\",\n  seventh: \"\",\n  aliases: []\n};\nvar modes = MODES.map(toMode);\nvar index = {};\nmodes.forEach((mode2) => {\n  index[mode2.name] = mode2;\n  mode2.aliases.forEach((alias) => {\n    index[alias] = mode2;\n  });\n});\nfunction get(name) {\n  return typeof name === \"string\" ? index[name.toLowerCase()] || NoMode : name && name.name ? get(name.name) : NoMode;\n}\nvar mode = get;\nfunction all() {\n  return modes.slice();\n}\nvar entries = all;\nfunction names() {\n  return modes.map((mode2) => mode2.name);\n}\nfunction toMode(mode2) {\n  const [modeNum, setNum, alt, name, triad, seventh, alias] = mode2;\n  const aliases = alias ? [alias] : [];\n  const chroma = Number(setNum).toString(2);\n  const intervals = getType(name).intervals;\n  return {\n    empty: false,\n    intervals,\n    modeNum,\n    chroma,\n    normalized: chroma,\n    name,\n    setNum,\n    alt,\n    triad,\n    seventh,\n    aliases\n  };\n}\nfunction notes(modeName, tonic) {\n  return get(modeName).intervals.map((ivl) => transpose(tonic, ivl));\n}\nfunction chords(chords2) {\n  return (modeName, tonic) => {\n    const mode2 = get(modeName);\n    if (mode2.empty) return [];\n    const triads2 = rotate(mode2.modeNum, chords2);\n    const tonics = mode2.intervals.map((i) => transpose(tonic, i));\n    return triads2.map((triad, i) => tonics[i] + triad);\n  };\n}\nvar triads = chords(MODES.map((x) => x[4]));\nvar seventhChords = chords(MODES.map((x) => x[5]));\nfunction distance(destination, source) {\n  const from = get(source);\n  const to = get(destination);\n  if (from.empty || to.empty) return \"\";\n  return simplify(transposeFifths(\"1P\", to.alt - from.alt));\n}\nfunction relativeTonic(destination, source, tonic) {\n  return transpose(tonic, distance(destination, source));\n}\nvar mode_default = {\n  get,\n  names,\n  all,\n  distance,\n  relativeTonic,\n  notes,\n  triads,\n  seventhChords,\n  // deprecated\n  entries,\n  mode\n};\nexport {\n  all,\n  mode_default as default,\n  distance,\n  entries,\n  get,\n  mode,\n  names,\n  notes,\n  relativeTonic,\n  seventhChords,\n  triads\n};\n//# sourceMappingURL=index.mjs.map","// index.ts\nimport { all as chordTypes } from \"@tonaljs/chord-type\";\nimport { range as nums, rotate } from \"@tonaljs/collection\";\nimport { enharmonic, fromMidi, sortedUniqNames } from \"@tonaljs/note\";\nimport {\n  chroma,\n  isChroma,\n  isSubsetOf,\n  isSupersetOf,\n  modes\n} from \"@tonaljs/pcset\";\nimport { tonicIntervalsTransposer, transpose } from \"@tonaljs/pitch-distance\";\nimport { note } from \"@tonaljs/pitch-note\";\nimport {\n  all,\n  get as getScaleType,\n  names as scaleTypeNames,\n  all as scaleTypes\n} from \"@tonaljs/scale-type\";\nvar NoScale = {\n  empty: true,\n  name: \"\",\n  type: \"\",\n  tonic: null,\n  setNum: NaN,\n  chroma: \"\",\n  normalized: \"\",\n  aliases: [],\n  notes: [],\n  intervals: []\n};\nfunction tokenize(name) {\n  if (typeof name !== \"string\") {\n    return [\"\", \"\"];\n  }\n  const i = name.indexOf(\" \");\n  const tonic = note(name.substring(0, i));\n  if (tonic.empty) {\n    const n = note(name);\n    return n.empty ? [\"\", name.toLowerCase()] : [n.name, \"\"];\n  }\n  const type = name.substring(tonic.name.length + 1).toLowerCase();\n  return [tonic.name, type.length ? type : \"\"];\n}\nvar names = scaleTypeNames;\nfunction get(src) {\n  const tokens = Array.isArray(src) ? src : tokenize(src);\n  const tonic = note(tokens[0]).name;\n  const st = getScaleType(tokens[1]);\n  if (st.empty) {\n    return NoScale;\n  }\n  const type = st.name;\n  const notes = tonic ? st.intervals.map((i) => transpose(tonic, i)) : [];\n  const name = tonic ? tonic + \" \" + type : type;\n  return { ...st, name, type, tonic, notes };\n}\nvar scale = get;\nfunction detect(notes, options = {}) {\n  const notesChroma = chroma(notes);\n  const tonic = note(options.tonic ?? notes[0] ?? \"\");\n  const tonicChroma = tonic.chroma;\n  if (tonicChroma === void 0) {\n    return [];\n  }\n  const pitchClasses = notesChroma.split(\"\");\n  pitchClasses[tonicChroma] = \"1\";\n  const scaleChroma = rotate(tonicChroma, pitchClasses).join(\"\");\n  const match = all().find((scaleType) => scaleType.chroma === scaleChroma);\n  const results = [];\n  if (match) {\n    results.push(tonic.name + \" \" + match.name);\n  }\n  if (options.match === \"exact\") {\n    return results;\n  }\n  extended(scaleChroma).forEach((scaleName) => {\n    results.push(tonic.name + \" \" + scaleName);\n  });\n  return results;\n}\nfunction scaleChords(name) {\n  const s = get(name);\n  const inScale = isSubsetOf(s.chroma);\n  return chordTypes().filter((chord) => inScale(chord.chroma)).map((chord) => chord.aliases[0]);\n}\nfunction extended(name) {\n  const chroma2 = isChroma(name) ? name : get(name).chroma;\n  const isSuperset = isSupersetOf(chroma2);\n  return scaleTypes().filter((scale2) => isSuperset(scale2.chroma)).map((scale2) => scale2.name);\n}\nfunction reduced(name) {\n  const isSubset = isSubsetOf(get(name).chroma);\n  return scaleTypes().filter((scale2) => isSubset(scale2.chroma)).map((scale2) => scale2.name);\n}\nfunction scaleNotes(notes) {\n  const pcset = notes.map((n) => note(n).pc).filter((x) => x);\n  const tonic = pcset[0];\n  const scale2 = sortedUniqNames(pcset);\n  return rotate(scale2.indexOf(tonic), scale2);\n}\nfunction modeNames(name) {\n  const s = get(name);\n  if (s.empty) {\n    return [];\n  }\n  const tonics = s.tonic ? s.notes : s.intervals;\n  return modes(s.chroma).map((chroma2, i) => {\n    const modeName = get(chroma2).name;\n    return modeName ? [tonics[i], modeName] : [\"\", \"\"];\n  }).filter((x) => x[0]);\n}\nfunction getNoteNameOf(scale2) {\n  const names2 = Array.isArray(scale2) ? scaleNotes(scale2) : get(scale2).notes;\n  const chromas = names2.map((name) => note(name).chroma);\n  return (noteOrMidi) => {\n    const currNote = typeof noteOrMidi === \"number\" ? note(fromMidi(noteOrMidi)) : note(noteOrMidi);\n    const height = currNote.height;\n    if (height === void 0) return void 0;\n    const chroma2 = height % 12;\n    const position = chromas.indexOf(chroma2);\n    if (position === -1) return void 0;\n    return enharmonic(currNote.name, names2[position]);\n  };\n}\nfunction rangeOf(scale2) {\n  const getName = getNoteNameOf(scale2);\n  return (fromNote, toNote) => {\n    const from = note(fromNote).height;\n    const to = note(toNote).height;\n    if (from === void 0 || to === void 0) return [];\n    return nums(from, to).map(getName).filter((x) => x);\n  };\n}\nfunction degrees(scaleName) {\n  const { intervals, tonic } = get(scaleName);\n  const transpose2 = tonicIntervalsTransposer(intervals, tonic);\n  return (degree) => degree ? transpose2(degree > 0 ? degree - 1 : degree) : \"\";\n}\nfunction steps(scaleName) {\n  const { intervals, tonic } = get(scaleName);\n  return tonicIntervalsTransposer(intervals, tonic);\n}\nvar index_default = {\n  degrees,\n  detect,\n  extended,\n  get,\n  modeNames,\n  names,\n  rangeOf,\n  reduced,\n  scaleChords,\n  scaleNotes,\n  steps,\n  tokenize,\n  // deprecated\n  scale\n};\nexport {\n  index_default as default,\n  degrees,\n  detect,\n  extended,\n  get,\n  modeNames,\n  names,\n  rangeOf,\n  reduced,\n  scale,\n  scaleChords,\n  scaleNotes,\n  steps,\n  tokenize\n};\n//# sourceMappingURL=index.mjs.map","/**\n * Instrument Configuration System\n * Defines profiles for different instruments with input methods, ranges, and settings\n */\n\n// Instrument type constants\nexport const InstrumentType = {\n    PIANO: 'piano',\n    PIANO_VIRTUAL: 'piano-virtual',\n    VIOLIN: 'violin',\n    GUITAR: 'guitar'\n} as const;\n\nexport type InstrumentTypeValue = typeof InstrumentType[keyof typeof InstrumentType];\n\n// Input method constants\nexport const InputMethod = {\n    MIDI: 'midi',\n    MICROPHONE: 'microphone',\n    VIRTUAL: 'virtual'\n} as const;\n\nexport type InputMethodValue = typeof InputMethod[keyof typeof InputMethod];\n\n// Clef constants\nexport const Clef = {\n    TREBLE: 'treble',\n    BASS: 'bass'\n} as const;\n\nexport type ClefValue = typeof Clef[keyof typeof Clef];\n\n// Type definitions\nexport interface NoteRange {\n    min: number;\n    max: number;\n}\n\nexport interface RangeConfig {\n    min: number;\n    max: number;\n    default: NoteRange;\n}\n\nexport interface TuningInfo {\n    note: string;\n    midi: number;\n    frequency: number;\n    string?: number;\n}\n\nexport interface ValidationConfig {\n    exactMatch: boolean;\n    pitchTolerance: number;\n    pitchToleranceAdvanced?: number;\n    octaveFlexible: boolean;\n    minDuration: number;\n    minClarity?: number;\n}\n\nexport interface PracticeConfig {\n    defaultNoteCount: number;\n    adaptiveDifficulty: boolean;\n    supportedModes: string[];\n    calibrationRequired?: boolean;\n    tuningCheckRecommended?: boolean;\n    fretIndependent?: boolean;\n}\n\nexport interface UIConfig {\n    showVirtualKeyboard: boolean;\n    showMidiStatus: boolean;\n    showPitchAccuracy: boolean;\n    showMicrophoneLevel?: boolean;\n    showTuningReference?: boolean;\n    showCentsDeviation?: boolean;\n    showFretboardReference?: boolean;\n}\n\nexport interface AudioConfig {\n    bufferSize: number;\n    noiseGate: number;\n    minFrequency: number;\n    maxFrequency: number;\n}\n\nexport interface InstrumentConfig {\n    id: InstrumentTypeValue;\n    name: string;\n    displayName: string;\n    emoji: string;\n    inputType: InputMethodValue;\n    range: RangeConfig;\n    clefs: ClefValue[];\n    defaultClef: ClefValue;\n    polyphonic: boolean;\n    requiresSustain: boolean;\n    tuning?: TuningInfo[];\n    validation: ValidationConfig;\n    practice: PracticeConfig;\n    ui: UIConfig;\n    audio?: AudioConfig;\n}\n\n/**\n * Instrument configuration profiles\n * Each profile defines all settings needed for instrument-specific practice\n */\nexport const INSTRUMENTS: Record<InstrumentTypeValue, InstrumentConfig> = {\n    [InstrumentType.PIANO]: {\n        id: InstrumentType.PIANO,\n        name: 'Piano',\n        displayName: 'Piano/Keyboard',\n        emoji: '',\n        inputType: InputMethod.MIDI,\n\n        // Range settings (MIDI note numbers)\n        range: {\n            min: 21,  // A0\n            max: 108, // C8\n            default: {\n                min: 48,  // C3\n                max: 84   // C6\n            }\n        },\n\n        // Clef settings\n        clefs: [Clef.TREBLE, Clef.BASS],\n        defaultClef: Clef.TREBLE,\n\n        // Input capabilities\n        polyphonic: true,  // Can detect multiple simultaneous notes\n        requiresSustain: false,\n\n        // Validation settings\n        validation: {\n            exactMatch: true,  // MIDI requires exact note match\n            pitchTolerance: 0, // No tolerance for MIDI\n            octaveFlexible: false, // Can enable for practice mode\n            minDuration: 0 // No minimum duration required\n        },\n\n        // Practice settings\n        practice: {\n            defaultNoteCount: 20,\n            adaptiveDifficulty: true,\n            supportedModes: ['sight-reading', 'scales', 'chords', 'arpeggios', 'key-signatures']\n        },\n\n        // UI settings\n        ui: {\n            showVirtualKeyboard: false,\n            showMidiStatus: true,\n            showPitchAccuracy: false\n        }\n    },\n\n    [InstrumentType.PIANO_VIRTUAL]: {\n        id: InstrumentType.PIANO_VIRTUAL,\n        name: 'Piano (Virtual)',\n        displayName: 'Piano/Keyboard (Virtual)',\n        emoji: '',\n        inputType: InputMethod.VIRTUAL,\n\n        // Range settings (MIDI note numbers)\n        range: {\n            min: 21,  // A0\n            max: 108, // C8\n            default: {\n                min: 48,  // C3\n                max: 84   // C6\n            }\n        },\n\n        // Clef settings\n        clefs: [Clef.TREBLE, Clef.BASS],\n        defaultClef: Clef.TREBLE,\n\n        // Input capabilities\n        polyphonic: true,  // Can play multiple simultaneous notes\n        requiresSustain: false,\n\n        // Validation settings\n        validation: {\n            exactMatch: true,  // Virtual keyboard gives exact notes\n            pitchTolerance: 0, // No tolerance needed\n            octaveFlexible: false,\n            minDuration: 0 // No minimum duration required\n        },\n\n        // Practice settings\n        practice: {\n            defaultNoteCount: 20,\n            adaptiveDifficulty: true,\n            supportedModes: ['sight-reading', 'scales', 'chords', 'arpeggios', 'key-signatures']\n        },\n\n        // UI settings\n        ui: {\n            showVirtualKeyboard: true,\n            showMidiStatus: false,\n            showPitchAccuracy: false\n        }\n    },\n\n    [InstrumentType.VIOLIN]: {\n        id: InstrumentType.VIOLIN,\n        name: 'Violin',\n        displayName: 'Violin',\n        emoji: '',\n        inputType: InputMethod.MICROPHONE,\n\n        // Range settings (MIDI note numbers)\n        range: {\n            min: 55,  // G3\n            max: 91,  // G6 (extended range)\n            default: {\n                min: 60,  // C4 (first position, beginner friendly)\n                max: 72   // C5 (one octave, first position only)\n            }\n        },\n\n        // Clef settings\n        clefs: [Clef.TREBLE],\n        defaultClef: Clef.TREBLE,\n\n        // Input capabilities\n        polyphonic: false,  // Monophonic pitch detection\n        requiresSustain: true,\n\n        // String tuning (open strings in scientific pitch notation)\n        tuning: [\n            { note: 'G3', midi: 55, frequency: 196.00 },\n            { note: 'D4', midi: 62, frequency: 293.66 },\n            { note: 'A4', midi: 69, frequency: 440.00 },\n            { note: 'E5', midi: 76, frequency: 659.26 }\n        ],\n\n        // Validation settings\n        validation: {\n            exactMatch: false,\n            pitchTolerance: 50,  // 50 cents for beginners\n            pitchToleranceAdvanced: 20, // 20 cents for advanced\n            octaveFlexible: false,\n            minDuration: 500, // 500ms minimum note sustain\n            minClarity: 0.80  // 80% pitch clarity threshold\n        },\n\n        // Practice settings\n        practice: {\n            defaultNoteCount: 15,\n            adaptiveDifficulty: true,\n            supportedModes: ['sight-reading', 'scales', 'arpeggios', 'intonation', 'key-signatures'],\n            calibrationRequired: true, // Require A4 calibration\n            tuningCheckRecommended: true\n        },\n\n        // UI settings\n        ui: {\n            showVirtualKeyboard: false,\n            showMidiStatus: false,\n            showPitchAccuracy: true,\n            showMicrophoneLevel: true,\n            showTuningReference: true,\n            showCentsDeviation: true\n        },\n\n        // Audio processing settings\n        audio: {\n            bufferSize: 2048,  // ~46ms at 44.1kHz\n            noiseGate: -40,    // dB threshold\n            minFrequency: 180, // Hz (below G3)\n            maxFrequency: 1600 // Hz (above G6)\n        }\n    },\n\n    [InstrumentType.GUITAR]: {\n        id: InstrumentType.GUITAR,\n        name: 'Guitar',\n        displayName: 'Guitar',\n        emoji: '',\n        inputType: InputMethod.MICROPHONE,\n\n        // Range settings (MIDI note numbers)\n        range: {\n            min: 40,  // E2\n            max: 88,  // E6 (24th fret on high E)\n            default: {\n                min: 40,  // E2\n                max: 76   // E5 (12th fret on high E)\n            }\n        },\n\n        // Clef settings\n        clefs: [Clef.TREBLE],\n        defaultClef: Clef.TREBLE,\n\n        // Input capabilities\n        polyphonic: false,  // Monophonic for POC (polyphonic future)\n        requiresSustain: true,\n\n        // Standard tuning (EADGBE in scientific pitch notation)\n        tuning: [\n            { note: 'E2', midi: 40, frequency: 82.41, string: 6 },\n            { note: 'A2', midi: 45, frequency: 110.00, string: 5 },\n            { note: 'D3', midi: 50, frequency: 146.83, string: 4 },\n            { note: 'G3', midi: 55, frequency: 196.00, string: 3 },\n            { note: 'B3', midi: 59, frequency: 246.94, string: 2 },\n            { note: 'E4', midi: 64, frequency: 329.63, string: 1 }\n        ],\n\n        // Validation settings\n        validation: {\n            exactMatch: false,\n            pitchTolerance: 50,  // 50 cents (guitar can be slightly out of tune)\n            pitchToleranceAdvanced: 30, // 30 cents for advanced\n            octaveFlexible: false,\n            minDuration: 400, // 400ms minimum (pluck sustain)\n            minClarity: 0.75  // 75% clarity (guitar harmonics can confuse)\n        },\n\n        // Practice settings\n        practice: {\n            defaultNoteCount: 15,\n            adaptiveDifficulty: true,\n            supportedModes: ['sight-reading', 'scales', 'arpeggios', 'key-signatures'],\n            calibrationRequired: false,\n            tuningCheckRecommended: true,\n            fretIndependent: true // Focus on pitch, not fret position\n        },\n\n        // UI settings\n        ui: {\n            showVirtualKeyboard: false,\n            showMidiStatus: false,\n            showPitchAccuracy: true,\n            showMicrophoneLevel: true,\n            showTuningReference: true,\n            showCentsDeviation: true,\n            showFretboardReference: false // Future feature\n        },\n\n        // Audio processing settings\n        audio: {\n            bufferSize: 2048,  // ~46ms at 44.1kHz\n            noiseGate: -35,    // dB threshold (slightly higher due to picking noise)\n            minFrequency: 70,  // Hz (below E2)\n            maxFrequency: 1400 // Hz (above E6 fundamental)\n        }\n    }\n};\n\n/**\n * Get instrument configuration by ID\n */\nexport function getInstrument(instrumentId: string): InstrumentConfig {\n    const instrument = INSTRUMENTS[instrumentId as InstrumentTypeValue];\n    if (!instrument) {\n        console.warn(`Unknown instrument: ${instrumentId}, defaulting to piano`);\n        return INSTRUMENTS[InstrumentType.PIANO];\n    }\n    return instrument;\n}\n\n/**\n * Get list of all instruments\n */\nexport function getAllInstruments(): InstrumentConfig[] {\n    return Object.values(INSTRUMENTS);\n}\n\n/**\n * Get instruments by input method\n */\nexport function getInstrumentsByInputMethod(inputMethod: InputMethodValue): InstrumentConfig[] {\n    return getAllInstruments().filter(inst => inst.inputType === inputMethod);\n}\n\n/**\n * Check if instrument requires microphone\n */\nexport function requiresMicrophone(instrumentId: string): boolean {\n    const instrument = getInstrument(instrumentId);\n    return instrument.inputType === InputMethod.MICROPHONE;\n}\n\n/**\n * Check if instrument requires MIDI\n */\nexport function requiresMIDI(instrumentId: string): boolean {\n    const instrument = getInstrument(instrumentId);\n    return instrument.inputType === InputMethod.MIDI;\n}\n\n/**\n * Check if instrument uses virtual keyboard\n */\nexport function requiresVirtualKeyboard(instrumentId: string): boolean {\n    const instrument = getInstrument(instrumentId);\n    return instrument.inputType === InputMethod.VIRTUAL;\n}\n\n/**\n * Get supported modules for an instrument\n */\nexport function getSupportedModules(instrumentId: string): string[] {\n    const instrument = getInstrument(instrumentId);\n    return instrument.practice.supportedModes;\n}\n\n/**\n * Get MIDI note range for an instrument\n */\nexport function getNoteRange(instrumentId: string, useDefault = true): NoteRange {\n    const instrument = getInstrument(instrumentId);\n    return useDefault ? instrument.range.default : {\n        min: instrument.range.min,\n        max: instrument.range.max\n    };\n}\n\n/**\n * Get tuning information for stringed instruments\n */\nexport function getTuning(instrumentId: string): TuningInfo[] | null {\n    const instrument = getInstrument(instrumentId);\n    return instrument.tuning || null;\n}\n\n/**\n * Validate note is within instrument range\n */\nexport function isNoteInRange(instrumentId: string, midiNote: number): boolean {\n    const instrument = getInstrument(instrumentId);\n    return midiNote >= instrument.range.min && midiNote <= instrument.range.max;\n}\n\n/**\n * Get pitch tolerance for an instrument\n */\nexport function getPitchTolerance(instrumentId: string, advanced = false): number {\n    const instrument = getInstrument(instrumentId);\n    if (advanced && instrument.validation.pitchToleranceAdvanced !== undefined) {\n        return instrument.validation.pitchToleranceAdvanced;\n    }\n    return instrument.validation.pitchTolerance;\n}\n\n/**\n * Create a custom instrument profile (for future extensibility)\n */\nexport function createCustomInstrument(config: Partial<InstrumentConfig>): InstrumentConfig {\n    // Merge with piano defaults as base\n    const defaults = { ...INSTRUMENTS[InstrumentType.PIANO] };\n    return {\n        ...defaults,\n        ...config,\n        range: { ...defaults.range, ...(config.range || {}) },\n        validation: { ...defaults.validation, ...(config.validation || {}) },\n        practice: { ...defaults.practice, ...(config.practice || {}) },\n        ui: { ...defaults.ui, ...(config.ui || {}) }\n    } as InstrumentConfig;\n}\n\n/**\n * Export default instrument (Piano)\n */\nexport const DEFAULT_INSTRUMENT: InstrumentTypeValue = InstrumentType.PIANO;\n","/**\n * Music Theory Utilities\n * Provides helper functions for note generation, validation, and music theory operations\n */\n\nimport { Note, Scale, Chord } from 'tonal';\nimport { getTuning } from './instrument-config';\n\n// Type definitions\nexport interface NoteInfo {\n    vexflowNote: string;\n    midiNote: number;\n}\n\nexport interface ValidationResult {\n    isCorrect: boolean;\n    message: string;\n    centsOff?: number;\n}\n\nexport interface ValidationOptions {\n    allowOctaveError?: boolean;\n    tolerance?: number;\n    pitchToleranceCents?: number;\n}\n\nexport interface KeySignature {\n    name: string;\n    sharps: number;\n    flats: number;\n}\n\nexport type ClefType = 'treble' | 'bass';\n\n// Note names and their MIDI numbers (C4 = Middle C = 60)\nexport const noteNames = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];\n\n// VexFlow note names (with octaves) - natural notes only for basic mode\nexport const vexflowNoteNames: Record<ClefType, Record<string, number>> = {\n    treble: {\n        'c/4': 60, 'd/4': 62, 'e/4': 64, 'f/4': 65, 'g/4': 67, 'a/4': 69, 'b/4': 71,\n        'c/5': 72, 'd/5': 74, 'e/5': 76, 'f/5': 77, 'g/5': 79, 'a/5': 81, 'b/5': 83,\n        'c/6': 84\n    },\n    bass: {\n        'a/2': 45, 'b/2': 47,\n        'c/3': 48, 'd/3': 50, 'e/3': 52, 'f/3': 53, 'g/3': 55, 'a/3': 57, 'b/3': 59,\n        'c/4': 60, 'd/4': 62, 'e/4': 64, 'f/4': 65\n    }\n};\n\n/**\n * Convert MIDI note number to note name with octave using Tonal\n */\nexport function midiToNoteName(midiNote: number): string {\n    return Note.fromMidi(midiNote) || '';\n}\n\n/**\n * Convert note name to MIDI number using Tonal\n */\nexport function noteNameToMidi(noteName: string): number {\n    const midi = Note.midi(noteName);\n    return midi !== null ? midi : -1;\n}\n\n/**\n * Convert MIDI note to VexFlow notation format\n */\nexport function midiToVexflow(midiNote: number, clef: ClefType = 'treble'): string | null {\n    const octave = Math.floor(midiNote / 12) - 1;\n    const noteIndex = midiNote % 12;\n    const noteName = noteNames[noteIndex].toLowerCase().replace('#', '#');\n\n    // For natural notes only (no sharps/flats in basic implementation)\n    if (noteName.includes('#')) {\n        return null; // Skip sharps for now in basic mode\n    }\n\n    return `${noteName}/${octave}`;\n}\n\n/**\n * Generate a random note within a specified range\n */\nexport function generateRandomNote(\n    range: string = 'c4-c5',\n    clef: ClefType = 'treble',\n    naturalsOnly: boolean = true\n): NoteInfo | null {\n    const [start, end] = range.split('-');\n    const startMidi = noteNameToMidi(start.toUpperCase());\n    const endMidi = noteNameToMidi(end.toUpperCase());\n\n    if (startMidi === -1 || endMidi === -1) {\n        console.error('Invalid range');\n        return null;\n    }\n\n    // Get available notes from VexFlow mapping for the clef\n    const availableNotes = Object.entries(vexflowNoteNames[clef])\n        .filter(([_, midi]) => midi >= startMidi && midi <= endMidi)\n        .map(([note, midi]) => ({ vexflowNote: note, midiNote: midi }));\n\n    if (availableNotes.length === 0) {\n        console.error('No notes available in range');\n        return null;\n    }\n\n    const randomIndex = Math.floor(Math.random() * availableNotes.length);\n    return availableNotes[randomIndex];\n}\n\n/**\n * Generate a random note from MIDI range\n */\nexport function generateRandomNoteFromMidiRange(minMidi: number, maxMidi: number, naturalsOnly: boolean = true): number {\n    const availableNotes: number[] = [];\n\n    for (let midi = minMidi; midi <= maxMidi; midi++) {\n        if (naturalsOnly) {\n            const noteIndex = midi % 12;\n            // Only include natural notes (no sharps/flats)\n            if (![1, 3, 6, 8, 10].includes(noteIndex)) {\n                availableNotes.push(midi);\n            }\n        } else {\n            availableNotes.push(midi);\n        }\n    }\n\n    if (availableNotes.length === 0) {\n        return minMidi;\n    }\n\n    return availableNotes[Math.floor(Math.random() * availableNotes.length)];\n}\n\n/**\n * Validate if a played note matches the target note\n */\nexport function validateNote(\n    playedMidi: number,\n    targetMidi: number,\n    options: ValidationOptions = {}\n): ValidationResult {\n    const {\n        allowOctaveError = true,\n        tolerance = 0,\n        pitchToleranceCents = 0\n    } = options;\n\n    if (playedMidi === targetMidi) {\n        return { isCorrect: true, message: 'Perfect!', centsOff: 0 };\n    }\n\n    // Check for octave errors\n    if (allowOctaveError) {\n        const playedPitch = playedMidi % 12;\n        const targetPitch = targetMidi % 12;\n\n        if (playedPitch === targetPitch) {\n            return {\n                isCorrect: true,\n                message: 'Correct note, wrong octave!'\n            };\n        }\n    }\n\n    // Check tolerance (for MIDI semitone tolerance)\n    if (tolerance > 0) {\n        const diff = Math.abs(playedMidi - targetMidi);\n        if (diff <= tolerance) {\n            return {\n                isCorrect: true,\n                message: 'Close enough!'\n            };\n        }\n    }\n\n    return {\n        isCorrect: false,\n        message: `Try again. You played ${midiToNoteName(playedMidi)}`\n    };\n}\n\n/**\n * Validate pitch with cents tolerance (for microphone input)\n */\nexport function validatePitchWithCents(\n    playedFrequency: number,\n    targetMidi: number,\n    toleranceCents: number = 50\n): ValidationResult {\n    const targetFrequency = midiToFrequency(targetMidi);\n    const playedMidi = frequencyToMidi(playedFrequency);\n    const centsOff = getCentsDeviation(playedFrequency, targetFrequency);\n\n    if (Math.abs(centsOff) <= toleranceCents) {\n        let message = 'Perfect!';\n        if (Math.abs(centsOff) > 5) {\n            message = `${Math.abs(centsOff).toFixed(0)} cents ${centsOff > 0 ? 'sharp' : 'flat'}`;\n        }\n        return {\n            isCorrect: true,\n            message,\n            centsOff\n        };\n    }\n\n    return {\n        isCorrect: false,\n        message: `Try again. You played ${midiToNoteName(playedMidi)} (${Math.abs(centsOff).toFixed(0)} cents ${centsOff > 0 ? 'sharp' : 'flat'})`,\n        centsOff\n    };\n}\n\n/**\n * Get frequency from MIDI note number using Tonal\n */\nexport function midiToFrequency(midiNote: number): number {\n    const noteName = Note.fromMidi(midiNote);\n    return noteName ? Note.freq(noteName) || 440 : 440;\n}\n\n/**\n * Convert frequency to MIDI note number\n */\nexport function frequencyToMidi(frequency: number): number {\n    return Math.round(12 * Math.log2(frequency / 440) + 69);\n}\n\n/**\n * Get cents deviation between two frequencies\n */\nexport function getCentsDeviation(frequency: number, targetFrequency: number): number {\n    return 1200 * Math.log2(frequency / targetFrequency);\n}\n\n/**\n * Get cents deviation from target MIDI note\n */\nexport function getCentsFromMidi(frequency: number, targetMidi: number): number {\n    const targetFrequency = midiToFrequency(targetMidi);\n    return getCentsDeviation(frequency, targetFrequency);\n}\n\n/**\n * Generate a major scale using Tonal\n */\nexport function generateMajorScale(root: string): number[] {\n    const scale = Scale.get(`${root} major`);\n    return scale.notes.map(note => noteNameToMidi(note)).filter(midi => midi !== -1);\n}\n\n/**\n * Generate a minor scale (natural minor) using Tonal\n */\nexport function generateMinorScale(root: string): number[] {\n    const scale = Scale.get(`${root} minor`);\n    return scale.notes.map(note => noteNameToMidi(note)).filter(midi => midi !== -1);\n}\n\n/**\n * Generate a scale by type using Tonal\n */\nexport function generateScale(root: string, scaleType: string = 'major'): number[] {\n    const scale = Scale.get(`${root} ${scaleType}`);\n    return scale.notes.map(note => noteNameToMidi(note)).filter(midi => midi !== -1);\n}\n\n/**\n * Generate a chord using Tonal\n */\nexport function generateChord(root: string, type: string = 'major'): number[] {\n    const chord = Chord.get(`${root}${type}`);\n    return chord.notes.map(note => noteNameToMidi(note)).filter(midi => midi !== -1);\n}\n\n/**\n * Get all key signatures\n */\nexport function getAllKeySignatures(): KeySignature[] {\n    return [\n        { name: 'C Major / A Minor', sharps: 0, flats: 0 },\n        { name: 'G Major / E Minor', sharps: 1, flats: 0 },\n        { name: 'D Major / B Minor', sharps: 2, flats: 0 },\n        { name: 'A Major / F# Minor', sharps: 3, flats: 0 },\n        { name: 'E Major / C# Minor', sharps: 4, flats: 0 },\n        { name: 'B Major / G# Minor', sharps: 5, flats: 0 },\n        { name: 'F# Major / D# Minor', sharps: 6, flats: 0 },\n        { name: 'F Major / D Minor', sharps: 0, flats: 1 },\n        { name: 'Bb Major / G Minor', sharps: 0, flats: 2 },\n        { name: 'Eb Major / C Minor', sharps: 0, flats: 3 },\n        { name: 'Ab Major / F Minor', sharps: 0, flats: 4 },\n        { name: 'Db Major / Bb Minor', sharps: 0, flats: 5 },\n        { name: 'Gb Major / Eb Minor', sharps: 0, flats: 6 }\n    ];\n}\n\n/**\n * Get interval between two notes in semitones\n */\nexport function getInterval(note1: string, note2: string): number {\n    const midi1 = noteNameToMidi(note1);\n    const midi2 = noteNameToMidi(note2);\n    return Math.abs(midi2 - midi1);\n}\n\n/**\n * Check if frequency is within valid range for instrument\n */\nexport function isFrequencyInRange(frequency: number, minFreq: number, maxFreq: number): boolean {\n    return frequency >= minFreq && frequency <= maxFreq;\n}\n\n/**\n * Convert MIDI note to guitar tablature position\n * Returns the optimal string and fret combination for a given note\n */\nexport interface TabPosition {\n    string: number; // 1-6, where 1 is highest (thinnest E) and 6 is lowest (thickest E)\n    fret: number;   // 0-24, where 0 is open string\n}\n\nexport function midiToTabPosition(midiNote: number, instrumentId: string = 'guitar'): TabPosition | null {\n    // Get tuning for the instrument\n    const tuning = getTuning(instrumentId);\n    if (!tuning) {\n        console.error('No tuning information available for instrument:', instrumentId);\n        return null;\n    }\n\n    // Find all possible positions for this note\n    const possiblePositions: TabPosition[] = [];\n\n    tuning.forEach((stringInfo) => {\n        const openStringMidi = stringInfo.midi;\n        const stringNumber = stringInfo.string || 0;\n\n        // Calculate fret number (difference from open string)\n        const fret = midiNote - openStringMidi;\n\n        // Check if this is a valid position (within typical fret range 0-24)\n        if (fret >= 0 && fret <= 24) {\n            possiblePositions.push({\n                string: stringNumber,\n                fret: fret\n            });\n        }\n    });\n\n    if (possiblePositions.length === 0) {\n        console.warn('Note out of range for tablature:', midiNote);\n        return null;\n    }\n\n    // Choose the optimal position\n    // Strategy: Prefer lower frets (easier to play) and middle strings when possible\n    // Priority: 1) Lowest fret number, 2) Middle strings (strings 2-4)\n    possiblePositions.sort((a, b) => {\n        // First, compare by fret (prefer lower frets)\n        if (a.fret !== b.fret) {\n            return a.fret - b.fret;\n        }\n\n        // If same fret, prefer middle strings (2-4)\n        const aMiddleBonus = (a.string >= 2 && a.string <= 4) ? -1 : 0;\n        const bMiddleBonus = (b.string >= 2 && b.string <= 4) ? -1 : 0;\n        return aMiddleBonus - bMiddleBonus;\n    });\n\n    return possiblePositions[0];\n}\n\n/**\n * Get all possible tab positions for a MIDI note\n * Useful for showing alternative fingerings\n */\nexport function getAllTabPositions(midiNote: number, instrumentId: string = 'guitar'): TabPosition[] {\n    const tuning = getTuning(instrumentId);\n    if (!tuning) {\n        return [];\n    }\n\n    const positions: TabPosition[] = [];\n\n    tuning.forEach((stringInfo) => {\n        const openStringMidi = stringInfo.midi;\n        const stringNumber = stringInfo.string || 0;\n        const fret = midiNote - openStringMidi;\n\n        if (fret >= 0 && fret <= 24) {\n            positions.push({\n                string: stringNumber,\n                fret: fret\n            });\n        }\n    });\n\n    return positions;\n}\n\n// Export as namespace for backward compatibility\nexport const MusicTheory = {\n    noteNames,\n    vexflowNoteNames,\n    midiToNoteName,\n    noteNameToMidi,\n    midiToVexflow,\n    generateRandomNote,\n    generateRandomNoteFromMidiRange,\n    validateNote,\n    validatePitchWithCents,\n    midiToFrequency,\n    frequencyToMidi,\n    getCentsDeviation,\n    getCentsFromMidi,\n    generateMajorScale,\n    generateMinorScale,\n    generateScale,\n    generateChord,\n    getAllKeySignatures,\n    getInterval,\n    isFrequencyInRange,\n    midiToTabPosition,\n    getAllTabPositions\n};\n\n// Make available globally for legacy code\nif (typeof window !== 'undefined') {\n    (window as any).MusicTheory = MusicTheory;\n}\n","/**\n * MIDI Manager\n * Handles MIDI device connection, input detection, and note events\n */\n\nimport { midiToNoteName, midiToFrequency } from '../utils/music-theory';\n\n// Type definitions\nexport interface MIDIDevice {\n    id: string;\n    name: string;\n    manufacturer: string;\n    state: MIDIPortDeviceState;\n    connection: MIDIPortConnectionState;\n}\n\nexport interface NoteOnEvent {\n    note: number;\n    velocity: number;\n    noteName: string;\n    frequency: number;\n    timestamp: number;\n}\n\nexport interface NoteOffEvent {\n    note: number;\n    noteName: string;\n    timestamp: number;\n}\n\nexport interface DeviceChangeEvent {\n    connected?: boolean;\n    device?: MIDIInput | null;\n    type?: string;\n    port?: MIDIPort;\n}\n\nexport interface ErrorEvent {\n    message: string;\n}\n\ntype EventCallback<T> = (event: T) => void;\n\ninterface Listeners {\n    noteOn: EventCallback<NoteOnEvent>[];\n    noteOff: EventCallback<NoteOffEvent>[];\n    deviceChange: EventCallback<DeviceChangeEvent>[];\n    error: EventCallback<ErrorEvent>[];\n}\n\nexport type EventType = keyof Listeners;\n\nexport class MidiManager {\n    private midiAccess: MIDIAccess | null = null;\n    private selectedInput: MIDIInput | null = null;\n    private listeners: Listeners;\n    private activeNotes: Set<number>;\n\n    constructor() {\n        this.listeners = {\n            noteOn: [],\n            noteOff: [],\n            deviceChange: [],\n            error: []\n        };\n        this.activeNotes = new Set<number>();\n    }\n\n    /**\n     * Initialize MIDI access\n     */\n    async init(): Promise<boolean> {\n        try {\n            // Check for Web MIDI API support\n            if (!navigator.requestMIDIAccess) {\n                this.emitError('Web MIDI API is not supported in this browser. Try Chrome or Edge.');\n                return false;\n            }\n\n            // Request MIDI access\n            this.midiAccess = await navigator.requestMIDIAccess();\n\n            // Listen for device connections/disconnections\n            this.midiAccess.addEventListener('statechange', (e: Event) => {\n                this.handleStateChange(e as MIDIConnectionEvent);\n            });\n\n            // Initialize available devices\n            this.updateDeviceList();\n\n            console.log('MIDI initialized successfully');\n            return true;\n        } catch (error) {\n            console.error('Failed to initialize MIDI:', error);\n            this.emitError('Failed to access MIDI devices. Please check your browser permissions.');\n            return false;\n        }\n    }\n\n    /**\n     * Get list of available MIDI input devices\n     */\n    getInputDevices(): MIDIDevice[] {\n        if (!this.midiAccess) return [];\n\n        const devices: MIDIDevice[] = [];\n        for (const input of this.midiAccess.inputs.values()) {\n            devices.push({\n                id: input.id,\n                name: input.name || 'Unknown Device',\n                manufacturer: input.manufacturer || 'Unknown',\n                state: input.state,\n                connection: input.connection\n            });\n        }\n\n        return devices;\n    }\n\n    /**\n     * Connect to a specific MIDI input device\n     */\n    connectDevice(deviceId: string): boolean {\n        if (!this.midiAccess) {\n            console.error('MIDI not initialized');\n            return false;\n        }\n\n        // Disconnect current device\n        this.disconnectDevice();\n\n        // Get the input device\n        const input = this.midiAccess.inputs.get(deviceId);\n\n        if (!input) {\n            console.error('Device not found:', deviceId);\n            return false;\n        }\n\n        // Attach event listener\n        input.onmidimessage = (message: MIDIMessageEvent) => this.handleMidiMessage(message);\n\n        this.selectedInput = input;\n        this.emitDeviceChange({ connected: true, device: input });\n\n        console.log('Connected to MIDI device:', input.name);\n        return true;\n    }\n\n    /**\n     * Disconnect current MIDI device\n     */\n    disconnectDevice(): void {\n        if (this.selectedInput) {\n            this.selectedInput.onmidimessage = null;\n            this.selectedInput = null;\n            this.activeNotes.clear();\n            this.emitDeviceChange({ connected: false, device: null });\n            console.log('Disconnected MIDI device');\n        }\n    }\n\n    /**\n     * Handle incoming MIDI messages\n     */\n    private handleMidiMessage(message: MIDIMessageEvent): void {\n        if (!message.data || message.data.length < 3) return;\n\n        const status = message.data[0];\n        const note = message.data[1];\n        const velocity = message.data[2];\n\n        // Extract message type from status byte\n        const messageType = status & 0xf0;\n\n        switch (messageType) {\n            case 0x90: // Note On\n                if (velocity > 0) {\n                    this.handleNoteOn(note, velocity);\n                } else {\n                    // Note on with velocity 0 is treated as note off\n                    this.handleNoteOff(note);\n                }\n                break;\n\n            case 0x80: // Note Off\n                this.handleNoteOff(note);\n                break;\n\n            default:\n                // Ignore other MIDI messages (control change, pitch bend, etc.)\n                break;\n        }\n    }\n\n    /**\n     * Handle note on event\n     */\n    private handleNoteOn(note: number, velocity: number): void {\n        this.activeNotes.add(note);\n\n        // Emit to all registered listeners\n        this.listeners.noteOn.forEach(callback => {\n            try {\n                callback({\n                    note,\n                    velocity,\n                    noteName: midiToNoteName(note),\n                    frequency: midiToFrequency(note),\n                    timestamp: Date.now()\n                });\n            } catch (error) {\n                console.error('Error in noteOn listener:', error);\n            }\n        });\n    }\n\n    /**\n     * Handle note off event\n     */\n    private handleNoteOff(note: number): void {\n        this.activeNotes.delete(note);\n\n        // Emit to all registered listeners\n        this.listeners.noteOff.forEach(callback => {\n            try {\n                callback({\n                    note,\n                    noteName: midiToNoteName(note),\n                    timestamp: Date.now()\n                });\n            } catch (error) {\n                console.error('Error in noteOff listener:', error);\n            }\n        });\n    }\n\n    /**\n     * Handle device state changes (connection/disconnection)\n     */\n    private handleStateChange(event: MIDIConnectionEvent): void {\n        if (!event.port) return;\n\n        console.log('MIDI device state changed:', event.port.name, event.port.state);\n        this.updateDeviceList();\n\n        // If the currently selected device was disconnected\n        if (this.selectedInput && event.port.id === this.selectedInput.id && event.port.state === 'disconnected') {\n            this.disconnectDevice();\n        }\n\n        this.emitDeviceChange({\n            type: 'statechange',\n            port: event.port\n        });\n    }\n\n    /**\n     * Update the device list (called on state changes)\n     */\n    private updateDeviceList(): void {\n        const devices = this.getInputDevices();\n        console.log('Available MIDI devices:', devices);\n\n        // Auto-connect to first device if none selected\n        if (!this.selectedInput && devices.length > 0) {\n            this.connectDevice(devices[0].id);\n        }\n    }\n\n    /**\n     * Register an event listener\n     */\n    on<T extends EventType>(event: T, callback: Listeners[T][number]): void {\n        if (this.listeners[event]) {\n            this.listeners[event].push(callback as any);\n        } else {\n            console.warn('Unknown event type:', event);\n        }\n    }\n\n    /**\n     * Remove an event listener\n     */\n    off<T extends EventType>(event: T, callback: Listeners[T][number]): void {\n        if (this.listeners[event]) {\n            const index = this.listeners[event].indexOf(callback as any);\n            if (index > -1) {\n                this.listeners[event].splice(index, 1);\n            }\n        }\n    }\n\n    /**\n     * Emit device change event\n     */\n    private emitDeviceChange(data: DeviceChangeEvent): void {\n        this.listeners.deviceChange.forEach(callback => {\n            try {\n                callback(data);\n            } catch (error) {\n                console.error('Error in deviceChange listener:', error);\n            }\n        });\n    }\n\n    /**\n     * Emit error event\n     */\n    private emitError(message: string): void {\n        this.listeners.error.forEach(callback => {\n            try {\n                callback({ message });\n            } catch (error) {\n                console.error('Error in error listener:', error);\n            }\n        });\n    }\n\n    /**\n     * Check if a note is currently being played\n     */\n    isNoteActive(note: number): boolean {\n        return this.activeNotes.has(note);\n    }\n\n    /**\n     * Get all currently active notes\n     */\n    getActiveNotes(): number[] {\n        return Array.from(this.activeNotes);\n    }\n\n    /**\n     * Simulate a note (for testing without MIDI device)\n     */\n    simulateNote(note: number, velocity: number = 64, duration: number = 500): void {\n        this.handleNoteOn(note, velocity);\n\n        setTimeout(() => {\n            this.handleNoteOff(note);\n        }, duration);\n    }\n\n    /**\n     * Check if MIDI is supported\n     */\n    static isSupported(): boolean {\n        return typeof navigator !== 'undefined' && !!navigator.requestMIDIAccess;\n    }\n\n    /**\n     * Get current connected device\n     */\n    getConnectedDevice(): MIDIDevice | null {\n        if (!this.selectedInput) return null;\n\n        return {\n            id: this.selectedInput.id,\n            name: this.selectedInput.name || 'Unknown Device',\n            manufacturer: this.selectedInput.manufacturer || 'Unknown',\n            state: this.selectedInput.state,\n            connection: this.selectedInput.connection\n        };\n    }\n}\n\n// Make available globally for legacy code\nif (typeof window !== 'undefined') {\n    (window as any).MidiManager = MidiManager;\n}\n","'use strict';\n\nfunction FFT(size) {\n  this.size = size | 0;\n  if (this.size <= 1 || (this.size & (this.size - 1)) !== 0)\n    throw new Error('FFT size must be a power of two and bigger than 1');\n\n  this._csize = size << 1;\n\n  // NOTE: Use of `var` is intentional for old V8 versions\n  var table = new Array(this.size * 2);\n  for (var i = 0; i < table.length; i += 2) {\n    const angle = Math.PI * i / this.size;\n    table[i] = Math.cos(angle);\n    table[i + 1] = -Math.sin(angle);\n  }\n  this.table = table;\n\n  // Find size's power of two\n  var power = 0;\n  for (var t = 1; this.size > t; t <<= 1)\n    power++;\n\n  // Calculate initial step's width:\n  //   * If we are full radix-4 - it is 2x smaller to give inital len=8\n  //   * Otherwise it is the same as `power` to give len=4\n  this._width = power % 2 === 0 ? power - 1 : power;\n\n  // Pre-compute bit-reversal patterns\n  this._bitrev = new Array(1 << this._width);\n  for (var j = 0; j < this._bitrev.length; j++) {\n    this._bitrev[j] = 0;\n    for (var shift = 0; shift < this._width; shift += 2) {\n      var revShift = this._width - shift - 2;\n      this._bitrev[j] |= ((j >>> shift) & 3) << revShift;\n    }\n  }\n\n  this._out = null;\n  this._data = null;\n  this._inv = 0;\n}\nmodule.exports = FFT;\n\nFFT.prototype.fromComplexArray = function fromComplexArray(complex, storage) {\n  var res = storage || new Array(complex.length >>> 1);\n  for (var i = 0; i < complex.length; i += 2)\n    res[i >>> 1] = complex[i];\n  return res;\n};\n\nFFT.prototype.createComplexArray = function createComplexArray() {\n  const res = new Array(this._csize);\n  for (var i = 0; i < res.length; i++)\n    res[i] = 0;\n  return res;\n};\n\nFFT.prototype.toComplexArray = function toComplexArray(input, storage) {\n  var res = storage || this.createComplexArray();\n  for (var i = 0; i < res.length; i += 2) {\n    res[i] = input[i >>> 1];\n    res[i + 1] = 0;\n  }\n  return res;\n};\n\nFFT.prototype.completeSpectrum = function completeSpectrum(spectrum) {\n  var size = this._csize;\n  var half = size >>> 1;\n  for (var i = 2; i < half; i += 2) {\n    spectrum[size - i] = spectrum[i];\n    spectrum[size - i + 1] = -spectrum[i + 1];\n  }\n};\n\nFFT.prototype.transform = function transform(out, data) {\n  if (out === data)\n    throw new Error('Input and output buffers must be different');\n\n  this._out = out;\n  this._data = data;\n  this._inv = 0;\n  this._transform4();\n  this._out = null;\n  this._data = null;\n};\n\nFFT.prototype.realTransform = function realTransform(out, data) {\n  if (out === data)\n    throw new Error('Input and output buffers must be different');\n\n  this._out = out;\n  this._data = data;\n  this._inv = 0;\n  this._realTransform4();\n  this._out = null;\n  this._data = null;\n};\n\nFFT.prototype.inverseTransform = function inverseTransform(out, data) {\n  if (out === data)\n    throw new Error('Input and output buffers must be different');\n\n  this._out = out;\n  this._data = data;\n  this._inv = 1;\n  this._transform4();\n  for (var i = 0; i < out.length; i++)\n    out[i] /= this.size;\n  this._out = null;\n  this._data = null;\n};\n\n// radix-4 implementation\n//\n// NOTE: Uses of `var` are intentional for older V8 version that do not\n// support both `let compound assignments` and `const phi`\nFFT.prototype._transform4 = function _transform4() {\n  var out = this._out;\n  var size = this._csize;\n\n  // Initial step (permute and transform)\n  var width = this._width;\n  var step = 1 << width;\n  var len = (size / step) << 1;\n\n  var outOff;\n  var t;\n  var bitrev = this._bitrev;\n  if (len === 4) {\n    for (outOff = 0, t = 0; outOff < size; outOff += len, t++) {\n      const off = bitrev[t];\n      this._singleTransform2(outOff, off, step);\n    }\n  } else {\n    // len === 8\n    for (outOff = 0, t = 0; outOff < size; outOff += len, t++) {\n      const off = bitrev[t];\n      this._singleTransform4(outOff, off, step);\n    }\n  }\n\n  // Loop through steps in decreasing order\n  var inv = this._inv ? -1 : 1;\n  var table = this.table;\n  for (step >>= 2; step >= 2; step >>= 2) {\n    len = (size / step) << 1;\n    var quarterLen = len >>> 2;\n\n    // Loop through offsets in the data\n    for (outOff = 0; outOff < size; outOff += len) {\n      // Full case\n      var limit = outOff + quarterLen;\n      for (var i = outOff, k = 0; i < limit; i += 2, k += step) {\n        const A = i;\n        const B = A + quarterLen;\n        const C = B + quarterLen;\n        const D = C + quarterLen;\n\n        // Original values\n        const Ar = out[A];\n        const Ai = out[A + 1];\n        const Br = out[B];\n        const Bi = out[B + 1];\n        const Cr = out[C];\n        const Ci = out[C + 1];\n        const Dr = out[D];\n        const Di = out[D + 1];\n\n        // Middle values\n        const MAr = Ar;\n        const MAi = Ai;\n\n        const tableBr = table[k];\n        const tableBi = inv * table[k + 1];\n        const MBr = Br * tableBr - Bi * tableBi;\n        const MBi = Br * tableBi + Bi * tableBr;\n\n        const tableCr = table[2 * k];\n        const tableCi = inv * table[2 * k + 1];\n        const MCr = Cr * tableCr - Ci * tableCi;\n        const MCi = Cr * tableCi + Ci * tableCr;\n\n        const tableDr = table[3 * k];\n        const tableDi = inv * table[3 * k + 1];\n        const MDr = Dr * tableDr - Di * tableDi;\n        const MDi = Dr * tableDi + Di * tableDr;\n\n        // Pre-Final values\n        const T0r = MAr + MCr;\n        const T0i = MAi + MCi;\n        const T1r = MAr - MCr;\n        const T1i = MAi - MCi;\n        const T2r = MBr + MDr;\n        const T2i = MBi + MDi;\n        const T3r = inv * (MBr - MDr);\n        const T3i = inv * (MBi - MDi);\n\n        // Final values\n        const FAr = T0r + T2r;\n        const FAi = T0i + T2i;\n\n        const FCr = T0r - T2r;\n        const FCi = T0i - T2i;\n\n        const FBr = T1r + T3i;\n        const FBi = T1i - T3r;\n\n        const FDr = T1r - T3i;\n        const FDi = T1i + T3r;\n\n        out[A] = FAr;\n        out[A + 1] = FAi;\n        out[B] = FBr;\n        out[B + 1] = FBi;\n        out[C] = FCr;\n        out[C + 1] = FCi;\n        out[D] = FDr;\n        out[D + 1] = FDi;\n      }\n    }\n  }\n};\n\n// radix-2 implementation\n//\n// NOTE: Only called for len=4\nFFT.prototype._singleTransform2 = function _singleTransform2(outOff, off,\n                                                             step) {\n  const out = this._out;\n  const data = this._data;\n\n  const evenR = data[off];\n  const evenI = data[off + 1];\n  const oddR = data[off + step];\n  const oddI = data[off + step + 1];\n\n  const leftR = evenR + oddR;\n  const leftI = evenI + oddI;\n  const rightR = evenR - oddR;\n  const rightI = evenI - oddI;\n\n  out[outOff] = leftR;\n  out[outOff + 1] = leftI;\n  out[outOff + 2] = rightR;\n  out[outOff + 3] = rightI;\n};\n\n// radix-4\n//\n// NOTE: Only called for len=8\nFFT.prototype._singleTransform4 = function _singleTransform4(outOff, off,\n                                                             step) {\n  const out = this._out;\n  const data = this._data;\n  const inv = this._inv ? -1 : 1;\n  const step2 = step * 2;\n  const step3 = step * 3;\n\n  // Original values\n  const Ar = data[off];\n  const Ai = data[off + 1];\n  const Br = data[off + step];\n  const Bi = data[off + step + 1];\n  const Cr = data[off + step2];\n  const Ci = data[off + step2 + 1];\n  const Dr = data[off + step3];\n  const Di = data[off + step3 + 1];\n\n  // Pre-Final values\n  const T0r = Ar + Cr;\n  const T0i = Ai + Ci;\n  const T1r = Ar - Cr;\n  const T1i = Ai - Ci;\n  const T2r = Br + Dr;\n  const T2i = Bi + Di;\n  const T3r = inv * (Br - Dr);\n  const T3i = inv * (Bi - Di);\n\n  // Final values\n  const FAr = T0r + T2r;\n  const FAi = T0i + T2i;\n\n  const FBr = T1r + T3i;\n  const FBi = T1i - T3r;\n\n  const FCr = T0r - T2r;\n  const FCi = T0i - T2i;\n\n  const FDr = T1r - T3i;\n  const FDi = T1i + T3r;\n\n  out[outOff] = FAr;\n  out[outOff + 1] = FAi;\n  out[outOff + 2] = FBr;\n  out[outOff + 3] = FBi;\n  out[outOff + 4] = FCr;\n  out[outOff + 5] = FCi;\n  out[outOff + 6] = FDr;\n  out[outOff + 7] = FDi;\n};\n\n// Real input radix-4 implementation\nFFT.prototype._realTransform4 = function _realTransform4() {\n  var out = this._out;\n  var size = this._csize;\n\n  // Initial step (permute and transform)\n  var width = this._width;\n  var step = 1 << width;\n  var len = (size / step) << 1;\n\n  var outOff;\n  var t;\n  var bitrev = this._bitrev;\n  if (len === 4) {\n    for (outOff = 0, t = 0; outOff < size; outOff += len, t++) {\n      const off = bitrev[t];\n      this._singleRealTransform2(outOff, off >>> 1, step >>> 1);\n    }\n  } else {\n    // len === 8\n    for (outOff = 0, t = 0; outOff < size; outOff += len, t++) {\n      const off = bitrev[t];\n      this._singleRealTransform4(outOff, off >>> 1, step >>> 1);\n    }\n  }\n\n  // Loop through steps in decreasing order\n  var inv = this._inv ? -1 : 1;\n  var table = this.table;\n  for (step >>= 2; step >= 2; step >>= 2) {\n    len = (size / step) << 1;\n    var halfLen = len >>> 1;\n    var quarterLen = halfLen >>> 1;\n    var hquarterLen = quarterLen >>> 1;\n\n    // Loop through offsets in the data\n    for (outOff = 0; outOff < size; outOff += len) {\n      for (var i = 0, k = 0; i <= hquarterLen; i += 2, k += step) {\n        var A = outOff + i;\n        var B = A + quarterLen;\n        var C = B + quarterLen;\n        var D = C + quarterLen;\n\n        // Original values\n        var Ar = out[A];\n        var Ai = out[A + 1];\n        var Br = out[B];\n        var Bi = out[B + 1];\n        var Cr = out[C];\n        var Ci = out[C + 1];\n        var Dr = out[D];\n        var Di = out[D + 1];\n\n        // Middle values\n        var MAr = Ar;\n        var MAi = Ai;\n\n        var tableBr = table[k];\n        var tableBi = inv * table[k + 1];\n        var MBr = Br * tableBr - Bi * tableBi;\n        var MBi = Br * tableBi + Bi * tableBr;\n\n        var tableCr = table[2 * k];\n        var tableCi = inv * table[2 * k + 1];\n        var MCr = Cr * tableCr - Ci * tableCi;\n        var MCi = Cr * tableCi + Ci * tableCr;\n\n        var tableDr = table[3 * k];\n        var tableDi = inv * table[3 * k + 1];\n        var MDr = Dr * tableDr - Di * tableDi;\n        var MDi = Dr * tableDi + Di * tableDr;\n\n        // Pre-Final values\n        var T0r = MAr + MCr;\n        var T0i = MAi + MCi;\n        var T1r = MAr - MCr;\n        var T1i = MAi - MCi;\n        var T2r = MBr + MDr;\n        var T2i = MBi + MDi;\n        var T3r = inv * (MBr - MDr);\n        var T3i = inv * (MBi - MDi);\n\n        // Final values\n        var FAr = T0r + T2r;\n        var FAi = T0i + T2i;\n\n        var FBr = T1r + T3i;\n        var FBi = T1i - T3r;\n\n        out[A] = FAr;\n        out[A + 1] = FAi;\n        out[B] = FBr;\n        out[B + 1] = FBi;\n\n        // Output final middle point\n        if (i === 0) {\n          var FCr = T0r - T2r;\n          var FCi = T0i - T2i;\n          out[C] = FCr;\n          out[C + 1] = FCi;\n          continue;\n        }\n\n        // Do not overwrite ourselves\n        if (i === hquarterLen)\n          continue;\n\n        // In the flipped case:\n        // MAi = -MAi\n        // MBr=-MBi, MBi=-MBr\n        // MCr=-MCr\n        // MDr=MDi, MDi=MDr\n        var ST0r = T1r;\n        var ST0i = -T1i;\n        var ST1r = T0r;\n        var ST1i = -T0i;\n        var ST2r = -inv * T3i;\n        var ST2i = -inv * T3r;\n        var ST3r = -inv * T2i;\n        var ST3i = -inv * T2r;\n\n        var SFAr = ST0r + ST2r;\n        var SFAi = ST0i + ST2i;\n\n        var SFBr = ST1r + ST3i;\n        var SFBi = ST1i - ST3r;\n\n        var SA = outOff + quarterLen - i;\n        var SB = outOff + halfLen - i;\n\n        out[SA] = SFAr;\n        out[SA + 1] = SFAi;\n        out[SB] = SFBr;\n        out[SB + 1] = SFBi;\n      }\n    }\n  }\n};\n\n// radix-2 implementation\n//\n// NOTE: Only called for len=4\nFFT.prototype._singleRealTransform2 = function _singleRealTransform2(outOff,\n                                                                     off,\n                                                                     step) {\n  const out = this._out;\n  const data = this._data;\n\n  const evenR = data[off];\n  const oddR = data[off + step];\n\n  const leftR = evenR + oddR;\n  const rightR = evenR - oddR;\n\n  out[outOff] = leftR;\n  out[outOff + 1] = 0;\n  out[outOff + 2] = rightR;\n  out[outOff + 3] = 0;\n};\n\n// radix-4\n//\n// NOTE: Only called for len=8\nFFT.prototype._singleRealTransform4 = function _singleRealTransform4(outOff,\n                                                                     off,\n                                                                     step) {\n  const out = this._out;\n  const data = this._data;\n  const inv = this._inv ? -1 : 1;\n  const step2 = step * 2;\n  const step3 = step * 3;\n\n  // Original values\n  const Ar = data[off];\n  const Br = data[off + step];\n  const Cr = data[off + step2];\n  const Dr = data[off + step3];\n\n  // Pre-Final values\n  const T0r = Ar + Cr;\n  const T1r = Ar - Cr;\n  const T2r = Br + Dr;\n  const T3r = inv * (Br - Dr);\n\n  // Final values\n  const FAr = T0r + T2r;\n\n  const FBr = T1r;\n  const FBi = -T3r;\n\n  const FCr = T0r - T2r;\n\n  const FDr = T1r;\n  const FDi = T3r;\n\n  out[outOff] = FAr;\n  out[outOff + 1] = 0;\n  out[outOff + 2] = FBr;\n  out[outOff + 3] = FBi;\n  out[outOff + 4] = FCr;\n  out[outOff + 5] = 0;\n  out[outOff + 6] = FDr;\n  out[outOff + 7] = FDi;\n};\n","import FFT from \"fft.js\";\n\n/**\n * @typedef {Float32Array | Float64Array | number[]} Buffer One of the supported\n * buffer types. Other numeric array types may not work correctly.\n */\n\n/**\n * A class that can perform autocorrelation on input arrays of a given size.\n *\n * The class holds internal buffers so that no additional allocations are\n * necessary while performing the operation.\n *\n * @template {Buffer} T the buffer type to use. While inputs to the\n * autocorrelation process can be any array-like type, the output buffer\n * (whether provided explicitly or using a fresh buffer) is always of this type.\n */\nexport class Autocorrelator {\n  /** @private @readonly @type {number} */\n  _inputLength;\n  /** @private @type {FFT} */\n  _fft;\n  /** @private @type {(size: number) => T} */\n  _bufferSupplier;\n  /** @private @type {T} */\n  _paddedInputBuffer;\n  /** @private @type {T} */\n  _transformBuffer;\n  /** @private @type {T} */\n  _inverseBuffer;\n\n  /**\n   * A helper method to create an {@link Autocorrelator} using\n   * {@link Float32Array} buffers.\n   *\n   * @param inputLength {number} the input array length to support\n   * @returns {Autocorrelator<Float32Array>}\n   */\n  static forFloat32Array(inputLength) {\n    return new Autocorrelator(\n      inputLength,\n      (length) => new Float32Array(length),\n    );\n  }\n\n  /**\n   * A helper method to create an {@link Autocorrelator} using\n   * {@link Float64Array} buffers.\n   *\n   * @param inputLength {number} the input array length to support\n   * @returns {Autocorrelator<Float64Array>}\n   */\n  static forFloat64Array(inputLength) {\n    return new Autocorrelator(\n      inputLength,\n      (length) => new Float64Array(length),\n    );\n  }\n\n  /**\n   * A helper method to create an {@link Autocorrelator} using `number[]`\n   * buffers.\n   *\n   * @param inputLength {number} the input array length to support\n   * @returns {Autocorrelator<number[]>}\n   */\n  static forNumberArray(inputLength) {\n    return new Autocorrelator(inputLength, (length) => Array(length));\n  }\n\n  /**\n   * Constructs a new {@link Autocorrelator} able to handle input arrays of the\n   * given length.\n   *\n   * @param inputLength {number} the input array length to support. This\n   * `Autocorrelator` will only support operation on arrays of this length.\n   * @param bufferSupplier {(length: number) => T} the function to use for\n   * creating buffers, accepting the length of the buffer to create and\n   * returning a new buffer of that length. The values of the returned buffer\n   * need not be initialized in any particular way.\n   */\n  constructor(inputLength, bufferSupplier) {\n    if (inputLength < 1) {\n      throw new Error(`Input length must be at least one`);\n    }\n    this._inputLength = inputLength;\n    // We need to double the input length to get correct results, and the FFT\n    // algorithm we use requires a length that's a power of 2\n    this._fft = new FFT(ceilPow2(2 * inputLength));\n    this._bufferSupplier = bufferSupplier;\n    this._paddedInputBuffer = this._bufferSupplier(this._fft.size);\n    this._transformBuffer = this._bufferSupplier(2 * this._fft.size);\n    this._inverseBuffer = this._bufferSupplier(2 * this._fft.size);\n  }\n\n  /**\n   * Returns the supported input length.\n   *\n   * @returns {number} the supported input length\n   */\n  get inputLength() {\n    return this._inputLength;\n  }\n\n  /**\n   * Autocorrelates the given input data.\n   *\n   * @param input {ArrayLike<number>} the input data to autocorrelate\n   * @param output {T} the output buffer into which to write the autocorrelated\n   * data. If not provided, a new buffer will be created.\n   * @returns {T} `output`\n   */\n  autocorrelate(input, output = this._bufferSupplier(input.length)) {\n    if (input.length !== this._inputLength) {\n      throw new Error(\n        `Input must have length ${this._inputLength} but had length ${input.length}`,\n      );\n    }\n    // Step 0: pad the input array with zeros\n    for (let i = 0; i < input.length; i++) {\n      this._paddedInputBuffer[i] = input[i];\n    }\n    for (let i = input.length; i < this._paddedInputBuffer.length; i++) {\n      this._paddedInputBuffer[i] = 0;\n    }\n\n    // Step 1: get the DFT of the input array\n    this._fft.realTransform(this._transformBuffer, this._paddedInputBuffer);\n    // We need to fill in the right half of the array too\n    this._fft.completeSpectrum(this._transformBuffer);\n    // Step 2: multiply each entry by its conjugate\n    const tb = this._transformBuffer;\n    for (let i = 0; i < tb.length; i += 2) {\n      tb[i] = tb[i] * tb[i] + tb[i + 1] * tb[i + 1];\n      tb[i + 1] = 0;\n    }\n    // Step 3: perform the inverse transform\n    this._fft.inverseTransform(this._inverseBuffer, this._transformBuffer);\n\n    // This last result (the inverse transform) contains the autocorrelation\n    // data, which is completely real\n    for (let i = 0; i < input.length; i++) {\n      output[i] = this._inverseBuffer[2 * i];\n    }\n    return output;\n  }\n}\n\n/**\n * Returns an array of all the key maximum positions in the given input array.\n *\n * In McLeod's paper, a key maximum is the highest maximum between a positively\n * sloped zero crossing and a negatively sloped one.\n *\n * TODO: it may be more efficient not to construct a new output array each time,\n * but that would also make the code more complicated (more so than the changes\n * that were needed to remove the other allocations).\n *\n * @param input {ArrayLike<number>}\n * @returns {number[]}\n */\nfunction getKeyMaximumIndices(input) {\n  // The indices of the key maxima\n  /** @type {number[]} */ const keyIndices = [];\n  // Whether the last zero crossing found was positively sloped; equivalently,\n  // whether we're looking for a key maximum\n  let lookingForMaximum = false;\n  // The largest local maximum found so far\n  let max = -Infinity;\n  // The index of the largest local maximum so far\n  let maxIndex = -1;\n\n  for (let i = 1; i < input.length - 1; i++) {\n    if (input[i - 1] <= 0 && input[i] > 0) {\n      // Positively sloped zero crossing\n      lookingForMaximum = true;\n      maxIndex = i;\n      max = input[i];\n    } else if (input[i - 1] > 0 && input[i] <= 0) {\n      // Negatively sloped zero crossing\n      lookingForMaximum = false;\n      if (maxIndex !== -1) {\n        keyIndices.push(maxIndex);\n      }\n    } else if (lookingForMaximum && input[i] > max) {\n      max = input[i];\n      maxIndex = i;\n    }\n  }\n\n  return keyIndices;\n}\n\n/**\n * Refines the chosen key maximum index chosen from the given data by\n * interpolating a parabola using the key maximum index and its two neighbors\n * and finding the position of that parabola's maximum value.\n *\n * This is described in section 5 of the MPM paper as a way to refine the\n * position of the maximum.\n *\n * @param index {number} the chosen key maximum index. This must be between `1`\n * and `data.length - 2`, inclusive, since it and its two neighbors need to be\n * valid indexes of `data`.\n * @param data {ArrayLike<number>} the input array from which `index` was chosen\n * @returns {[number, number]} a pair consisting of the refined key maximum index and the\n * interpolated value of `data` at that index (the latter of which is used as a\n * measure of clarity)\n */\nfunction refineResultIndex(index, data) {\n  const [x0, x1, x2] = [index - 1, index, index + 1];\n  const [y0, y1, y2] = [data[x0], data[x1], data[x2]];\n\n  // The parabola going through the three data points can be written as\n  // y = y0(x - x1)(x - x2)/(x0 - x1)(x0 - x2)\n  //   + y1(x - x0)(x - x2)/(x1 - x0)(x1 - x2)\n  //   + y2(x - x0)(x - x1)/(x2 - x0)(x2 - x1)\n  // Given the definitions of x0, x1, and x2, we can simplify the denominators:\n  // y = y0(x - x1)(x - x2)/2\n  //   - y1(x - x0)(x - x2)\n  //   + y2(x - x0)(x - x1)/2\n  // We can expand this out and get the coefficients in standard form:\n  // a = y0/2 - y1 + y2/2\n  // b = -(y0/2)(x1 + x2) + y1(x0 + x2) - (y2/2)(x0 + x1)\n  // c = y0x1x2/2 - y1x0x2 + y2x0x1/2\n  // The index of the maximum is -b / 2a (by solving for x where the derivative\n  // is 0).\n\n  const a = y0 / 2 - y1 + y2 / 2;\n  const b = -(y0 / 2) * (x1 + x2) + y1 * (x0 + x2) - (y2 / 2) * (x0 + x1);\n  const c = (y0 * x1 * x2) / 2 - y1 * x0 * x2 + (y2 * x0 * x1) / 2;\n\n  const xMax = -b / (2 * a);\n  const yMax = a * xMax * xMax + b * xMax + c;\n  return [xMax, yMax];\n}\n\n/**\n * A class that can detect the pitch of a note from a time-domain input array.\n *\n * This class uses the McLeod pitch method (MPM) to detect pitches. MPM is\n * described in the paper 'A Smarter Way to Find Pitch' by Philip McLeod and\n * Geoff Wyvill\n * (http://miracle.otago.ac.nz/tartini/papers/A_Smarter_Way_to_Find_Pitch.pdf).\n *\n * The class holds internal buffers so that a minimal number of additional\n * allocations are necessary while performing the operation.\n *\n * @template {Buffer} T the buffer type to use internally. Inputs to the\n * pitch-detection process can be any numeric array type.\n */\nexport class PitchDetector {\n  /** @private @type {Autocorrelator<T>} */\n  _autocorrelator;\n  /** @private @type {T} */\n  _nsdfBuffer;\n  /** @private @type {number} */\n  _clarityThreshold = 0.9;\n  /** @private @type {number} */\n  _minVolumeAbsolute = 0.0;\n  /** @private @type {number} */\n  _maxInputAmplitude = 1.0;\n\n  /**\n   * A helper method to create an {@link PitchDetector} using {@link Float32Array} buffers.\n   *\n   * @param inputLength {number} the input array length to support\n   * @returns {PitchDetector<Float32Array>}\n   */\n  static forFloat32Array(inputLength) {\n    return new PitchDetector(inputLength, (length) => new Float32Array(length));\n  }\n\n  /**\n   * A helper method to create an {@link PitchDetector} using {@link Float64Array} buffers.\n   *\n   * @param inputLength {number} the input array length to support\n   * @returns {PitchDetector<Float64Array>}\n   */\n  static forFloat64Array(inputLength) {\n    return new PitchDetector(inputLength, (length) => new Float64Array(length));\n  }\n\n  /**\n   * A helper method to create an {@link PitchDetector} using `number[]` buffers.\n   *\n   * @param inputLength {number} the input array length to support\n   * @returns {PitchDetector<number[]>}\n   */\n  static forNumberArray(inputLength) {\n    return new PitchDetector(inputLength, (length) => Array(length));\n  }\n\n  /**\n   * Constructs a new {@link PitchDetector} able to handle input arrays of the\n   * given length.\n   *\n   * @param inputLength {number} the input array length to support. This\n   * `PitchDetector` will only support operation on arrays of this length.\n   * @param bufferSupplier {(inputLength: number) => T} the function to use for\n   * creating buffers, accepting the length of the buffer to create and\n   * returning a new buffer of that length. The values of the returned buffer\n   * need not be initialized in any particular way.\n   */\n  constructor(inputLength, bufferSupplier) {\n    this._autocorrelator = new Autocorrelator(inputLength, bufferSupplier);\n    this._nsdfBuffer = bufferSupplier(inputLength);\n  }\n\n  /**\n   * Returns the supported input length.\n   *\n   * @returns {number} the supported input length\n   */\n  get inputLength() {\n    return this._autocorrelator.inputLength;\n  }\n\n  /**\n   * Sets the clarity threshold used when identifying the correct pitch (the constant\n   * `k` from the MPM paper). The value must be between 0 (exclusive) and 1\n   * (inclusive), with the most suitable range being between 0.8 and 1.\n   *\n   * @param threshold {number} the clarity threshold\n   */\n  set clarityThreshold(threshold) {\n    if (!Number.isFinite(threshold) || threshold <= 0 || threshold > 1) {\n      throw new Error(\"clarityThreshold must be a number in the range (0, 1]\");\n    }\n    this._clarityThreshold = threshold;\n  }\n\n  /**\n   * Sets the minimum detectable volume, as an absolute number between 0 and\n   * `maxInputAmplitude`, inclusive, to consider in a sample when detecting the\n   * pitch. If a sample fails to meet this minimum volume, `findPitch` will\n   * return a clarity of 0.\n   *\n   * Volume is calculated as the RMS (root mean square) of the input samples.\n   *\n   * @param volume {number} the minimum volume as an absolute amplitude value\n   */\n  set minVolumeAbsolute(volume) {\n    if (\n      !Number.isFinite(volume) ||\n      volume < 0 ||\n      volume > this._maxInputAmplitude\n    ) {\n      throw new Error(\n        `minVolumeAbsolute must be a number in the range [0, ${this._maxInputAmplitude}]`,\n      );\n    }\n    this._minVolumeAbsolute = volume;\n  }\n\n  /**\n   * Sets the minimum volume using a decibel measurement. Must be less than or\n   * equal to 0: 0 indicates the loudest possible sound (see\n   * `maxInputAmplitude`), -10 is a sound with a tenth of the volume of the\n   * loudest possible sound, etc.\n   *\n   * Volume is calculated as the RMS (root mean square) of the input samples.\n   *\n   * @param db {number} the minimum volume in decibels, with 0 being the loudest\n   * sound\n   */\n  set minVolumeDecibels(db) {\n    if (!Number.isFinite(db) || db > 0) {\n      throw new Error(\"minVolumeDecibels must be a number <= 0\");\n    }\n    this._minVolumeAbsolute = this._maxInputAmplitude * 10 ** (db / 10);\n  }\n\n  /**\n   * Sets the maximum amplitude of an input reading. Must be greater than 0.\n   *\n   * @param amplitude {number} the maximum amplitude (absolute value) of an input reading\n   */\n  set maxInputAmplitude(amplitude) {\n    if (!Number.isFinite(amplitude) || amplitude <= 0) {\n      throw new Error(\"maxInputAmplitude must be a number > 0\");\n    }\n    this._maxInputAmplitude = amplitude;\n  }\n\n  /**\n   * Returns the pitch detected using McLeod Pitch Method (MPM) along with a\n   * measure of its clarity.\n   *\n   * The clarity is a value between 0 and 1 (potentially inclusive) that\n   * represents how \"clear\" the pitch was. A clarity value of 1 indicates that\n   * the pitch was very distinct, while lower clarity values indicate less\n   * definite pitches.\n   *\n   * @param input {ArrayLike<number>} the time-domain input data\n   * @param sampleRate {number} the sample rate at which the input data was\n   * collected\n   * @returns {[number, number]} the detected pitch, in Hz, followed by the\n   * clarity. If a pitch cannot be determined from the input, such as if the\n   * volume is too low (see `minVolumeAbsolute` and `minVolumeDecibels`), this\n   * will be `[0, 0]`.\n   */\n  findPitch(input, sampleRate) {\n    // If the highest key maximum is less than the minimum volume, we don't need\n    // to bother detecting the pitch, as the sample is too quiet.\n    if (this._belowMinimumVolume(input)) return [0, 0];\n    this._nsdf(input);\n    const keyMaximumIndices = getKeyMaximumIndices(this._nsdfBuffer);\n    if (keyMaximumIndices.length === 0) {\n      // No key maxima means that we either don't have enough data to analyze or\n      // that the data was flawed (such as an input array of zeroes)\n      return [0, 0];\n    }\n    // The highest key maximum\n    const nMax = Math.max(...keyMaximumIndices.map((i) => this._nsdfBuffer[i]));\n    // Following the paper, we return the pitch corresponding to the first key\n    // maximum higher than K * nMax. This is guaranteed not to be undefined, since\n    // we know of at least one key maximum satisfying this condition (whichever\n    // key maximum gave us nMax).\n    const resultIndex = keyMaximumIndices.find(\n      (i) => this._nsdfBuffer[i] >= this._clarityThreshold * nMax,\n    );\n    const [refinedResultIndex, clarity] = refineResultIndex(\n      // @ts-expect-error resultIndex is guaranteed to be defined\n      resultIndex,\n      this._nsdfBuffer,\n    );\n\n    // Due to floating point errors, the clarity may occasionally come out to be\n    // slightly over 1.0. We can avoid incorrect results by clamping the value.\n    return [sampleRate / refinedResultIndex, Math.min(clarity, 1.0)];\n  }\n\n  /**\n   * Returns whether the input audio data is below the minimum volume allowed by\n   * the pitch detector.\n   *\n   * @private\n   * @param input {ArrayLike<number>}\n   * @returns {boolean}\n   */\n  _belowMinimumVolume(input) {\n    if (this._minVolumeAbsolute === 0) return false;\n    let squareSum = 0;\n    for (let i = 0; i < input.length; i++) {\n      squareSum += input[i] ** 2;\n    }\n    return Math.sqrt(squareSum / input.length) < this._minVolumeAbsolute;\n  }\n\n  /**\n   * Computes the NSDF of the input and stores it in the internal buffer. This\n   * is equation (9) in the McLeod pitch method paper.\n   *\n   * @private\n   * @param input {ArrayLike<number>}\n   */\n  _nsdf(input) {\n    // The function r'(tau) is the autocorrelation\n    this._autocorrelator.autocorrelate(input, this._nsdfBuffer);\n    // The function m'(tau) (defined in equation (6)) can be computed starting\n    // with m'(0), which is equal to 2r'(0), and then iteratively modified to\n    // get m'(1), m'(2), etc. For example, to get m'(1), we take m'(0) and\n    // subtract x_0^2 and x_{W-1}^2. Then, to get m'(2), we take m'(1) and\n    // subtract x_1^2 and x_{W-2}^2, and further values are similar (see the\n    // note at the end of section 6 in the MPM paper).\n    //\n    // The resulting array values are 2 * r'(tau) / m'(tau). We use m below as\n    // the incremental value of m'.\n    let m = 2 * this._nsdfBuffer[0];\n    /** @type {number} */ let i;\n    // As pointed out by issuefiler on GitHub, we can take advantage of the fact\n    // that m will never increase to avoid division by zero by ending this loop\n    // once m === 0. The rest of the array values after m becomes 0 will just be\n    // set to 0 themselves. We actually check for m > 0 rather than m === 0\n    // because there may be small floating-point errors that cause m to become\n    // negative rather than exactly 0.\n    for (i = 0; i < this._nsdfBuffer.length && m > 0; i++) {\n      this._nsdfBuffer[i] = (2 * this._nsdfBuffer[i]) / m;\n      m -= input[i] ** 2 + input[input.length - i - 1] ** 2;\n    }\n    // If there are any array values remaining, it means m === 0 for those\n    // values of tau, so we can just set them to 0\n    for (; i < this._nsdfBuffer.length; i++) {\n      this._nsdfBuffer[i] = 0;\n    }\n  }\n}\n\n/**\n * Rounds up the input to the next power of 2.\n *\n * @param {number} v\n * @returns {number} the next power of 2 at least as large as `v`\n */\nfunction ceilPow2(v) {\n  // https://graphics.stanford.edu/~seander/bithacks.html#RoundUpPowerOf2\n  v--;\n  v |= v >> 1;\n  v |= v >> 2;\n  v |= v >> 4;\n  v |= v >> 8;\n  v |= v >> 16;\n  v++;\n  return v;\n}\n","/**\n * Pitch Detector\n * Wraps the pitchy library for real-time monophonic pitch detection\n * Uses McLeod Pitch Method (MPM) for accurate fundamental frequency detection\n */\n\nimport { PitchDetector as PitchyDetector } from 'pitchy';\nimport { frequencyToMidi, getCentsFromMidi } from './music-theory';\n\n// Type definitions\nexport interface PitchResult {\n    frequency: number;\n    midi: number;\n    cents: number;\n    clarity: number;\n    detected: boolean;\n}\n\nexport interface DetectorConfig {\n    bufferSize: number;\n    sampleRate: number;\n    minClarity: number;\n    minFrequency: number;\n    maxFrequency: number;\n}\n\nexport class PitchDetector {\n    private detector: PitchyDetector<Float32Array>;\n    private config: DetectorConfig;\n\n    constructor(config: Partial<DetectorConfig> = {}) {\n        // Default configuration optimized for musical instruments\n        this.config = {\n            bufferSize: config.bufferSize || 2048,\n            sampleRate: config.sampleRate || 44100,\n            minClarity: config.minClarity || 0.75,\n            minFrequency: config.minFrequency || 70,  // Below E2 (guitar low E)\n            maxFrequency: config.maxFrequency || 1600 // Above G6 (violin high range)\n        };\n\n        // Initialize pitchy detector\n        this.detector = PitchyDetector.forFloat32Array(this.config.bufferSize);\n        this.detector.minVolumeDecibels = -40; // Noise gate\n    }\n\n    /**\n     * Detect pitch from audio buffer\n     * @param buffer - Float32Array of audio samples\n     * @param sampleRate - Sample rate of the audio (optional, uses config default)\n     * @returns PitchResult with frequency, MIDI note, and clarity\n     */\n    detectPitch(buffer: Float32Array, sampleRate?: number): PitchResult {\n        const rate = sampleRate || this.config.sampleRate;\n\n        // Use pitchy's findPitch method (returns [frequency, clarity])\n        const [frequency, clarity] = this.detector.findPitch(buffer, rate);\n\n        // Check if detection is valid\n        const isValid = this.isValidDetection(frequency, clarity);\n\n        if (!isValid) {\n            return {\n                frequency: 0,\n                midi: 0,\n                cents: 0,\n                clarity: clarity || 0,\n                detected: false\n            };\n        }\n\n        // Convert frequency to MIDI note\n        const midi = frequencyToMidi(frequency);\n\n        // Calculate cents deviation from the MIDI note\n        const cents = getCentsFromMidi(frequency, midi);\n\n        return {\n            frequency,\n            midi,\n            cents,\n            clarity: clarity || 0,\n            detected: true\n        };\n    }\n\n    /**\n     * Check if detected pitch is valid based on clarity and frequency range\n     */\n    private isValidDetection(frequency: number, clarity: number): boolean {\n        if (!frequency || frequency <= 0) return false;\n        if (!clarity || clarity < this.config.minClarity) return false;\n        if (frequency < this.config.minFrequency) return false;\n        if (frequency > this.config.maxFrequency) return false;\n        return true;\n    }\n\n    /**\n     * Update detector configuration\n     */\n    updateConfig(config: Partial<DetectorConfig>): void {\n        this.config = { ...this.config, ...config };\n\n        // Recreate detector if buffer size changed\n        if (config.bufferSize && config.bufferSize !== this.config.bufferSize) {\n            this.detector = PitchyDetector.forFloat32Array(this.config.bufferSize);\n            this.detector.minVolumeDecibels = -40;\n        }\n    }\n\n    /**\n     * Get current configuration\n     */\n    getConfig(): DetectorConfig {\n        return { ...this.config };\n    }\n\n    /**\n     * Set minimum clarity threshold\n     */\n    setMinClarity(clarity: number): void {\n        this.config.minClarity = Math.max(0, Math.min(1, clarity));\n    }\n\n    /**\n     * Set frequency range for detection\n     */\n    setFrequencyRange(min: number, max: number): void {\n        this.config.minFrequency = min;\n        this.config.maxFrequency = max;\n    }\n\n    /**\n     * Create detector optimized for specific instrument\n     */\n    static forInstrument(instrument: 'guitar' | 'violin' | 'voice'): PitchDetector {\n        const configs = {\n            guitar: {\n                bufferSize: 2048,\n                minClarity: 0.75,\n                minFrequency: 70,   // E2\n                maxFrequency: 1400  // E6\n            },\n            violin: {\n                bufferSize: 2048,\n                minClarity: 0.80,\n                minFrequency: 180,  // Below G3\n                maxFrequency: 1600  // Above G6\n            },\n            voice: {\n                bufferSize: 2048,\n                minClarity: 0.85,\n                minFrequency: 80,   // E2\n                maxFrequency: 1200  // D6\n            }\n        };\n\n        return new PitchDetector(configs[instrument]);\n    }\n}\n\n/**\n * Helper function to create a pitch detector with default settings\n */\nexport function createPitchDetector(config?: Partial<DetectorConfig>): PitchDetector {\n    return new PitchDetector(config);\n}\n\n/**\n * Simplified pitch detection function for quick use\n * @param buffer - Audio buffer\n * @param sampleRate - Sample rate\n * @param minClarity - Minimum clarity threshold (0-1)\n * @returns Detected frequency or null if no pitch detected\n */\nexport function detectFrequency(\n    buffer: Float32Array,\n    sampleRate: number = 44100,\n    minClarity: number = 0.75\n): number | null {\n    const detector = new PitchDetector({ sampleRate, minClarity });\n    const result = detector.detectPitch(buffer);\n    return result.detected ? result.frequency : null;\n}\n","/**\n * Audio Manager\n * Manages microphone access and real-time pitch detection for stringed/bowed instruments\n */\n\nimport { PitchDetector, PitchResult } from '../utils/pitch-detector';\nimport { midiToNoteName } from '../utils/music-theory';\n\n// Type definitions\nexport interface AudioConfig {\n    bufferSize: number;\n    smoothing: number;\n    minClarity: number;\n    minFrequency: number;\n    maxFrequency: number;\n}\n\nexport interface PitchDetectedEvent {\n    frequency: number;\n    midi: number;\n    cents: number;\n    clarity: number;\n    noteName: string;\n    timestamp: number;\n}\n\nexport interface AudioLevelEvent {\n    level: number; // 0-1\n    timestamp: number;\n}\n\nexport interface ErrorEvent {\n    message: string;\n    error?: Error;\n}\n\nexport interface StatusChangeEvent {\n    listening: boolean;\n    microphoneActive: boolean;\n}\n\ntype EventCallback<T> = (event: T) => void;\n\ninterface Listeners {\n    pitchDetected: EventCallback<PitchDetectedEvent>[];\n    audioLevel: EventCallback<AudioLevelEvent>[];\n    error: EventCallback<ErrorEvent>[];\n    statusChange: EventCallback<StatusChangeEvent>[];\n}\n\nexport type EventType = keyof Listeners;\n\nexport class AudioManager {\n    private audioContext: AudioContext | null = null;\n    private microphone: MediaStreamAudioSourceNode | null = null;\n    private analyser: AnalyserNode | null = null;\n    private pitchDetector: PitchDetector | null = null;\n    private animationFrameId: number | null = null;\n    private stream: MediaStream | null = null;\n\n    private config: AudioConfig;\n    private listeners: Listeners;\n    private isListening: boolean = false;\n    private buffer: Float32Array<ArrayBuffer> | null = null;\n\n    // Debouncing for note detection\n    private lastDetectedMidi: number | null = null;\n    private lastDetectedTime: number = 0;\n    private noteDebounceMs: number = 100; // Min time between note detections\n\n    constructor(config: Partial<AudioConfig> = {}) {\n        this.config = {\n            bufferSize: config.bufferSize || 2048,\n            smoothing: config.smoothing || 0.8,\n            minClarity: config.minClarity || 0.75,\n            minFrequency: config.minFrequency || 70,\n            maxFrequency: config.maxFrequency || 1600\n        };\n\n        this.listeners = {\n            pitchDetected: [],\n            audioLevel: [],\n            error: [],\n            statusChange: []\n        };\n    }\n\n    /**\n     * Initialize audio context and request microphone access\n     * @param deviceId - Optional specific device ID to use\n     */\n    async init(deviceId?: string): Promise<boolean> {\n        try {\n            // Check if getUserMedia is supported\n            if (!navigator.mediaDevices || !navigator.mediaDevices.getUserMedia) {\n                console.error('Microphone access is not supported in this browser');\n                return false;\n            }\n\n            // Create audio context\n            this.audioContext = new (window.AudioContext || (window as any).webkitAudioContext)();\n\n            if (!this.audioContext) {\n                console.error('Failed to create audio context');\n                return false;\n            }\n\n            // Set up error handler for audio context\n            this.setupAudioContextErrorHandlers();\n\n            // Resume audio context if it's suspended\n            if (this.audioContext.state === 'suspended') {\n                await this.audioContext.resume();\n            }\n\n            // Request microphone access\n            const audioConstraints: MediaTrackConstraints = {\n                echoCancellation: false,\n                noiseSuppression: false,\n                autoGainControl: false,\n                sampleRate: 44100\n            };\n\n            // Add device ID if specified\n            if (deviceId) {\n                audioConstraints.deviceId = { exact: deviceId };\n            }\n\n            this.stream = await navigator.mediaDevices.getUserMedia({\n                audio: audioConstraints\n            });\n\n            // Verify audio context is still valid\n            if (!this.audioContext) {\n                console.error('Audio context was lost during initialization');\n                return false;\n            }\n\n            // Create audio nodes\n            this.microphone = this.audioContext.createMediaStreamSource(this.stream);\n            this.analyser = this.audioContext.createAnalyser();\n            this.analyser.fftSize = this.config.bufferSize * 2;\n            this.analyser.smoothingTimeConstant = this.config.smoothing;\n\n            // Connect nodes\n            this.microphone.connect(this.analyser);\n\n            // Create buffer for time-domain data\n            this.buffer = new Float32Array(this.config.bufferSize) as Float32Array<ArrayBuffer>;\n\n            // Initialize pitch detector\n            this.pitchDetector = new PitchDetector({\n                bufferSize: this.config.bufferSize,\n                sampleRate: this.audioContext.sampleRate,\n                minClarity: this.config.minClarity,\n                minFrequency: this.config.minFrequency,\n                maxFrequency: this.config.maxFrequency\n            });\n\n            console.log('Audio Manager initialized successfully');\n            console.log('Sample rate:', this.audioContext.sampleRate);\n            console.log('Buffer size:', this.config.bufferSize);\n            console.log('Audio context state:', this.audioContext.state);\n\n            this.emitStatusChange({ listening: false, microphoneActive: true });\n            return true;\n        } catch (error) {\n            console.error('Failed to initialize audio:', error);\n            // Don't emit error event during init - let the caller handle it\n            // Clean up audio context if it was created\n            if (this.audioContext) {\n                this.audioContext.close().catch(() => {});\n                this.audioContext = null;\n            }\n            return false;\n        }\n    }\n\n    /**\n     * Setup error handlers for AudioContext\n     */\n    private stateChangeHandler = () => {\n        if (!this.audioContext) return;\n\n        console.log('AudioContext state changed to:', this.audioContext.state);\n\n        if (this.audioContext.state === 'suspended') {\n            console.warn('AudioContext suspended, attempting to resume...');\n            this.audioContext.resume().catch(err => {\n                console.error('Failed to resume AudioContext:', err);\n            });\n        } else if (this.audioContext.state === 'closed') {\n            console.error('AudioContext closed');\n            // Don't emit error for intentional disconnects\n        }\n    };\n\n    private setupAudioContextErrorHandlers(): void {\n        if (!this.audioContext) return;\n\n        // Handle state changes\n        this.audioContext.addEventListener('statechange', this.stateChangeHandler);\n    }\n\n    /**\n     * Start listening for pitch\n     */\n    startListening(): void {\n        if (!this.audioContext || !this.analyser || !this.pitchDetector || !this.buffer) {\n            console.error('Audio Manager not initialized');\n            return;\n        }\n\n        if (this.isListening) {\n            console.warn('Already listening');\n            return;\n        }\n\n        this.isListening = true;\n        this.emitStatusChange({ listening: true, microphoneActive: true });\n        this.detectPitchLoop();\n        console.log('Started listening for pitch');\n    }\n\n    /**\n     * Stop listening for pitch\n     */\n    stopListening(): void {\n        if (!this.isListening) return;\n\n        this.isListening = false;\n        if (this.animationFrameId !== null) {\n            cancelAnimationFrame(this.animationFrameId);\n            this.animationFrameId = null;\n        }\n\n        this.emitStatusChange({ listening: false, microphoneActive: this.stream !== null });\n        console.log('Stopped listening for pitch');\n    }\n\n    /**\n     * Main pitch detection loop\n     */\n    private detectPitchLoop(): void {\n        if (!this.isListening || !this.analyser || !this.pitchDetector || !this.buffer || !this.audioContext) {\n            return;\n        }\n\n        // Check if audio context is in a valid state\n        if (this.audioContext.state === 'suspended') {\n            console.warn('AudioContext suspended during pitch detection, attempting resume...');\n            this.audioContext.resume().then(() => {\n                console.log('AudioContext resumed successfully');\n            }).catch(err => {\n                console.error('Failed to resume AudioContext:', err);\n                this.stopListening();\n                this.emitError('Audio system paused. Please restart your practice session.');\n            });\n            return;\n        }\n\n        if (this.audioContext.state === 'closed') {\n            console.error('AudioContext closed during pitch detection');\n            this.stopListening();\n            this.emitError('Audio system closed. Please reconnect your microphone.');\n            return;\n        }\n\n        try {\n            // Get time-domain data from analyser\n            this.analyser.getFloatTimeDomainData(this.buffer);\n\n            // Calculate audio level (RMS)\n            const level = this.calculateRMS(this.buffer);\n            this.emitAudioLevel(level);\n\n            // Detect pitch\n            const result: PitchResult = this.pitchDetector.detectPitch(this.buffer, this.audioContext.sampleRate);\n\n            // Emit pitch detected event if valid\n            if (result.detected) {\n                // Debounce rapid detections of the same note\n                const now = Date.now();\n                if (\n                    result.midi !== this.lastDetectedMidi ||\n                    now - this.lastDetectedTime > this.noteDebounceMs\n                ) {\n                    this.emitPitchDetected({\n                        frequency: result.frequency,\n                        midi: result.midi,\n                        cents: result.cents,\n                        clarity: result.clarity,\n                        noteName: midiToNoteName(result.midi),\n                        timestamp: now\n                    });\n\n                    this.lastDetectedMidi = result.midi;\n                    this.lastDetectedTime = now;\n                }\n            }\n        } catch (error) {\n            console.error('Error in pitch detection loop:', error);\n            // Don't stop the loop on error, just log and continue\n        }\n\n        // Continue loop\n        if (this.isListening) {\n            this.animationFrameId = requestAnimationFrame(() => this.detectPitchLoop());\n        }\n    }\n\n    /**\n     * Calculate RMS (Root Mean Square) for audio level\n     */\n    private calculateRMS(buffer: Float32Array<ArrayBuffer>): number {\n        let sum = 0;\n        for (let i = 0; i < buffer.length; i++) {\n            sum += buffer[i] * buffer[i];\n        }\n        return Math.sqrt(sum / buffer.length);\n    }\n\n    /**\n     * Disconnect microphone and clean up resources\n     */\n    disconnect(): void {\n        this.stopListening();\n\n        if (this.microphone) {\n            this.microphone.disconnect();\n            this.microphone = null;\n        }\n\n        if (this.stream) {\n            this.stream.getTracks().forEach(track => track.stop());\n            this.stream = null;\n        }\n\n        if (this.audioContext) {\n            // Remove event listener before closing to prevent statechange events\n            this.audioContext.removeEventListener('statechange', this.stateChangeHandler);\n            this.audioContext.close();\n            this.audioContext = null;\n        }\n\n        this.analyser = null;\n        this.pitchDetector = null;\n        this.buffer = null;\n\n        this.emitStatusChange({ listening: false, microphoneActive: false });\n        console.log('Audio Manager disconnected');\n    }\n\n    /**\n     * Update configuration\n     */\n    updateConfig(config: Partial<AudioConfig>): void {\n        this.config = { ...this.config, ...config };\n\n        if (this.pitchDetector) {\n            this.pitchDetector.updateConfig({\n                minClarity: this.config.minClarity,\n                minFrequency: this.config.minFrequency,\n                maxFrequency: this.config.maxFrequency\n            });\n        }\n\n        if (this.analyser) {\n            this.analyser.smoothingTimeConstant = this.config.smoothing;\n        }\n    }\n\n    /**\n     * Set note debounce time\n     */\n    setDebounceTime(ms: number): void {\n        this.noteDebounceMs = Math.max(0, ms);\n    }\n\n    /**\n     * Register an event listener\n     */\n    on<T extends EventType>(event: T, callback: Listeners[T][number]): void {\n        if (this.listeners[event]) {\n            this.listeners[event].push(callback as any);\n        } else {\n            console.warn('Unknown event type:', event);\n        }\n    }\n\n    /**\n     * Remove an event listener\n     */\n    off<T extends EventType>(event: T, callback: Listeners[T][number]): void {\n        if (this.listeners[event]) {\n            const index = this.listeners[event].indexOf(callback as any);\n            if (index > -1) {\n                this.listeners[event].splice(index, 1);\n            }\n        }\n    }\n\n    /**\n     * Emit pitch detected event\n     */\n    private emitPitchDetected(data: PitchDetectedEvent): void {\n        this.listeners.pitchDetected.forEach(callback => {\n            try {\n                callback(data);\n            } catch (error) {\n                console.error('Error in pitchDetected listener:', error);\n            }\n        });\n    }\n\n    /**\n     * Emit audio level event\n     */\n    private emitAudioLevel(level: number): void {\n        this.listeners.audioLevel.forEach(callback => {\n            try {\n                callback({ level, timestamp: Date.now() });\n            } catch (error) {\n                console.error('Error in audioLevel listener:', error);\n            }\n        });\n    }\n\n    /**\n     * Emit error event\n     */\n    private emitError(message: string, error?: Error): void {\n        this.listeners.error.forEach(callback => {\n            try {\n                callback({ message, error });\n            } catch (err) {\n                console.error('Error in error listener:', err);\n            }\n        });\n    }\n\n    /**\n     * Emit status change event\n     */\n    private emitStatusChange(status: StatusChangeEvent): void {\n        this.listeners.statusChange.forEach(callback => {\n            try {\n                callback(status);\n            } catch (error) {\n                console.error('Error in statusChange listener:', error);\n            }\n        });\n    }\n\n    /**\n     * Get current audio level (0-1)\n     */\n    getCurrentLevel(): number {\n        if (!this.buffer) return 0;\n        return this.calculateRMS(this.buffer);\n    }\n\n    /**\n     * Check if microphone is active\n     */\n    isMicrophoneActive(): boolean {\n        return this.stream !== null && this.audioContext !== null;\n    }\n\n    /**\n     * Check if currently listening\n     */\n    isCurrentlyListening(): boolean {\n        return this.isListening;\n    }\n\n    /**\n     * Get audio context sample rate\n     */\n    getSampleRate(): number {\n        return this.audioContext?.sampleRate || 44100;\n    }\n\n    /**\n     * Simulate frequency detection (for testing without microphone)\n     */\n    simulateFrequency(frequency: number): void {\n        const midi = Math.round(12 * Math.log2(frequency / 440) + 69);\n        this.emitPitchDetected({\n            frequency,\n            midi,\n            cents: 0,\n            clarity: 1.0,\n            noteName: midiToNoteName(midi),\n            timestamp: Date.now()\n        });\n    }\n\n    /**\n     * Get available audio input devices\n     */\n    static async getAudioInputDevices(): Promise<MediaDeviceInfo[]> {\n        try {\n            // First request permission to enumerate devices\n            await navigator.mediaDevices.getUserMedia({ audio: true });\n\n            // Then enumerate all devices\n            const devices = await navigator.mediaDevices.enumerateDevices();\n            return devices.filter(device => device.kind === 'audioinput');\n        } catch (error) {\n            console.error('Failed to enumerate audio devices:', error);\n            return [];\n        }\n    }\n\n    /**\n     * Get the currently active audio input device\n     */\n    getActiveDevice(): MediaDeviceInfo | null {\n        if (!this.stream) return null;\n\n        const audioTrack = this.stream.getAudioTracks()[0];\n        if (!audioTrack) return null;\n\n        // Return basic device info from the track\n        return {\n            deviceId: audioTrack.getSettings().deviceId || '',\n            groupId: audioTrack.getSettings().groupId || '',\n            kind: 'audioinput',\n            label: audioTrack.label,\n            toJSON: () => ({})\n        } as MediaDeviceInfo;\n    }\n\n    /**\n     * Check if microphone access is supported\n     */\n    static isSupported(): boolean {\n        return !!(navigator.mediaDevices && navigator.mediaDevices.getUserMedia);\n    }\n}\n\n// Make available globally for legacy code\nif (typeof window !== 'undefined') {\n    (window as any).AudioManager = AudioManager;\n}\n","/**\n * Staff Renderer\n * Uses VexFlow to render musical notation on staff\n */\n\nimport { MusicTheory } from '../utils/music-theory';\n\n// VexFlow types (declare global types for VexFlow library)\ndeclare global {\n    interface Window {\n        Vex: any;\n    }\n    const Vex: any;\n}\n\n// Type definitions\nexport type ClefType = 'treble' | 'bass';\n\ninterface RenderOptions {\n    highlight?: boolean;\n}\n\nexport class StaffRenderer {\n    private containerId: string;\n    private container: HTMLElement | null;\n    private renderer: any = null;\n    private context: any = null;\n    private currentNote: string | null = null;\n    private clef: ClefType = 'treble';\n\n    constructor(containerId: string) {\n        this.containerId = containerId;\n        this.container = document.getElementById(containerId);\n\n        if (!this.container) {\n            console.error('Container not found:', containerId);\n            return;\n        }\n\n        this.init();\n    }\n\n    /**\n     * Check if dark mode is active\n     */\n    private isDarkMode(): boolean {\n        return document.documentElement.classList.contains('dark');\n    }\n\n    /**\n     * Get the appropriate stroke color based on theme\n     */\n    private getStrokeColor(): string {\n        return this.isDarkMode() ? '#e5e5e5' : '#000000';\n    }\n\n    /**\n     * Apply theme-aware styling to SVG\n     */\n    private applyThemeToSVG(svg: SVGElement): void {\n        const strokeColor = this.getStrokeColor();\n\n        // Style all staff lines and note elements\n        svg.style.color = strokeColor;\n\n        // Apply stroke color to all paths and lines\n        const elements = svg.querySelectorAll('path, line, rect, circle, ellipse');\n        elements.forEach(el => {\n            const element = el as SVGElement;\n            if (!element.style.fill || element.style.fill === 'black' || element.style.fill === 'rgb(0, 0, 0)') {\n                element.style.stroke = strokeColor;\n                element.style.fill = strokeColor;\n            }\n        });\n    }\n\n    /**\n     * Initialize VexFlow renderer\n     */\n    private init(): void {\n        try {\n            // Check if VexFlow is loaded\n            if (typeof Vex === 'undefined' || typeof window.Vex === 'undefined') {\n                console.error('VexFlow not loaded - waiting...');\n                // Try again after a short delay\n                setTimeout(() => this.init(), 500);\n                return;\n            }\n\n            if (!this.container) {\n                console.error('Container not found, cannot initialize');\n                return;\n            }\n\n            // Clear container\n            this.container.innerHTML = '';\n\n            // Create VexFlow renderer\n            const VF = Vex.Flow;\n\n            if (!VF || !VF.Renderer) {\n                console.error('VexFlow.Renderer not available');\n                return;\n            }\n\n            this.renderer = new VF.Renderer(\n                this.container,\n                VF.Renderer.Backends.SVG\n            );\n\n            // Size the canvas\n            this.renderer.resize(500, 200);\n\n            // Get drawing context\n            this.context = this.renderer.getContext();\n\n            console.log('StaffRenderer initialized successfully');\n        } catch (error) {\n            console.error('Failed to initialize StaffRenderer:', error);\n            this.showError('Unable to initialize music notation renderer');\n        }\n    }\n\n    /**\n     * Set the clef type\n     * @param clef - 'treble' or 'bass'\n     */\n    setClef(clef: ClefType): void {\n        this.clef = clef;\n    }\n\n    /**\n     * Render a single note on the staff\n     * @param vexflowNote - Note in VexFlow format (e.g., \"c/4\")\n     * @param options - Rendering options\n     */\n    renderNote(vexflowNote: string, options: RenderOptions = {}): void {\n        if (!this.context) {\n            console.warn('Renderer not initialized, attempting to initialize...');\n            this.init();\n            if (!this.context) {\n                console.error('Failed to initialize renderer');\n                this.showError('Unable to display notation - please refresh');\n                return;\n            }\n        }\n\n        try {\n            const VF = Vex.Flow;\n\n            if (!this.container) return;\n\n            // Clear previous content\n            this.context.clear();\n            this.container.innerHTML = '';\n\n            // Recreate context after clear\n            this.renderer = new VF.Renderer(\n                this.container,\n                VF.Renderer.Backends.SVG\n            );\n            this.renderer.resize(500, 200);\n            this.context = this.renderer.getContext();\n\n            // Create a stave\n            const stave = new VF.Stave(10, 20, 400);\n\n            // Add clef\n            stave.addClef(this.clef);\n\n            // Draw the stave\n            stave.setContext(this.context).draw();\n\n            // Create note\n            const note = new VF.StaveNote({\n                keys: [vexflowNote],\n                duration: 'w', // Whole note\n                clef: this.clef\n            });\n\n            // Create a voice and add the note\n            const voice = new VF.Voice({\n                num_beats: 4,\n                beat_value: 4\n            });\n            voice.addTickable(note);\n\n            // Format and draw\n            new VF.Formatter()\n                .joinVoices([voice])\n                .format([voice], 350);\n\n            voice.draw(this.context, stave);\n\n            this.currentNote = vexflowNote;\n\n            // Apply theme styling\n            const svg = this.container?.querySelector('svg');\n            if (svg) {\n                this.applyThemeToSVG(svg);\n            }\n\n            // Apply highlight if specified\n            if (options.highlight) {\n                this.highlightNote();\n            }\n\n        } catch (error) {\n            console.error('Failed to render note:', error);\n            this.showError('Unable to display note');\n        }\n    }\n\n    /**\n     * Render multiple notes on the staff\n     * @param notes - Array of VexFlow notes\n     */\n    renderNotes(notes: string[]): void {\n        if (!this.context) {\n            console.error('Renderer not initialized');\n            return;\n        }\n\n        try {\n            const VF = Vex.Flow;\n\n            if (!this.container) return;\n\n            // Clear previous content\n            this.context.clear();\n            this.container.innerHTML = '';\n\n            // Recreate context\n            this.renderer = new VF.Renderer(\n                this.container,\n                VF.Renderer.Backends.SVG\n            );\n            this.renderer.resize(700, 200);\n            this.context = this.renderer.getContext();\n\n            // Create a stave\n            const stave = new VF.Stave(10, 20, 650);\n            stave.addClef(this.clef);\n            stave.setContext(this.context).draw();\n\n            // Create notes\n            const staveNotes = notes.map(note => {\n                return new VF.StaveNote({\n                    keys: [note],\n                    duration: 'q', // Quarter note\n                    clef: this.clef\n                });\n            });\n\n            // Create a voice\n            const voice = new VF.Voice({\n                num_beats: staveNotes.length,\n                beat_value: 4\n            });\n            voice.addTickables(staveNotes);\n\n            // Format and draw\n            new VF.Formatter()\n                .joinVoices([voice])\n                .format([voice], 600);\n\n            voice.draw(this.context, stave);\n\n            // Apply theme styling\n            const svg = this.container?.querySelector('svg');\n            if (svg) {\n                this.applyThemeToSVG(svg);\n            }\n\n        } catch (error) {\n            console.error('Failed to render notes:', error);\n            this.showError('Unable to display notes');\n        }\n    }\n\n    /**\n     * Render a scale on the staff\n     * @param midiNotes - Array of MIDI note numbers\n     */\n    renderScale(midiNotes: number[]): void {\n        const vexflowNotes = midiNotes\n            .map(midi => MusicTheory.midiToVexflow(midi, this.clef))\n            .filter((note): note is string => note !== null);\n\n        if (vexflowNotes.length > 0) {\n            this.renderNotes(vexflowNotes);\n        }\n    }\n\n    /**\n     * Highlight the current note (visual feedback)\n     */\n    private highlightNote(): void {\n        if (!this.container) return;\n\n        // Add a visual highlight to the SVG\n        const svg = this.container.querySelector('svg');\n        if (svg) {\n            const noteheads = svg.querySelectorAll('.vf-notehead');\n            noteheads.forEach(notehead => {\n                (notehead as HTMLElement).style.fill = '#3b82f6';\n            });\n        }\n    }\n\n    /**\n     * Show feedback for correct/incorrect note\n     * @param isCorrect - Whether the note was correct\n     */\n    showFeedback(isCorrect: boolean): void {\n        if (!this.container) return;\n\n        const svg = this.container.querySelector('svg');\n        if (!svg) return;\n\n        const noteheads = svg.querySelectorAll('.vf-notehead');\n        const color = isCorrect ? '#10b981' : '#ef4444';\n\n        noteheads.forEach(notehead => {\n            const element = notehead as HTMLElement;\n            element.style.fill = color;\n            element.style.transition = 'fill 0.3s ease';\n        });\n\n        // Reset after animation\n        setTimeout(() => {\n            noteheads.forEach(notehead => {\n                (notehead as HTMLElement).style.fill = '';\n            });\n        }, 500);\n    }\n\n    /**\n     * Show error message\n     * @param message - Error message to display\n     */\n    private showError(message: string): void {\n        if (!this.container) return;\n\n        this.container.innerHTML = `\n            <div style=\"\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                height: 200px;\n                color: var(--text-secondary);\n                font-size: 1rem;\n            \">\n                ${message}\n            </div>\n        `;\n    }\n\n    /**\n     * Show welcome message\n     */\n    showWelcome(): void {\n        if (!this.container) return;\n\n        this.container.innerHTML = `\n            <div style=\"\n                display: flex;\n                flex-direction: column;\n                align-items: center;\n                justify-content: center;\n                height: 200px;\n                color: var(--text-secondary);\n                text-align: center;\n                padding: 2rem;\n            \">\n                <p style=\"font-size: 3rem; margin-bottom: 0.5rem;\"></p>\n                <p style=\"font-size: 1.2rem; font-weight: 600; margin-bottom: 0.5rem;\">\n                    Ready to Practice\n                </p>\n                <p style=\"font-size: 0.95rem;\">\n                    Click \"Start Practice\" to begin\n                </p>\n            </div>\n        `;\n    }\n\n    /**\n     * Clear the staff\n     */\n    clear(): void {\n        if (this.context) {\n            this.context.clear();\n        }\n        if (this.container) {\n            this.container.innerHTML = '';\n        }\n        this.currentNote = null;\n    }\n\n    /**\n     * Get the current note\n     * @returns Current VexFlow note\n     */\n    getCurrentNote(): string | null {\n        return this.currentNote;\n    }\n}\n\n// Make available globally\nif (typeof window !== 'undefined') {\n    (window as any).StaffRenderer = StaffRenderer;\n}\n","/**\n * Guitar Tab Renderer\n * Uses VexFlow to render guitar tablature notation\n */\n\nimport { midiToTabPosition } from '../utils/music-theory';\n\n// Use the Vex global from window\ndeclare const Vex: any;\n\n// Type definitions\nexport interface TabPosition {\n    string: number;\n    fret: number;\n}\n\ninterface RenderOptions {\n    highlight?: boolean;\n    showStaff?: boolean; // Show staff notation above tab\n}\n\nexport class TabRenderer {\n    private container: HTMLElement | null;\n    private renderer: any = null;\n    private context: any = null;\n    private currentNote: number | null = null;\n    private instrumentId: string = 'guitar';\n    private tabOrientation: 'standard' | 'leftHanded' = 'standard';\n\n    constructor(containerId: string, instrumentId: string = 'guitar', tabOrientation: 'standard' | 'leftHanded' = 'standard') {\n        this.instrumentId = instrumentId;\n        this.tabOrientation = tabOrientation;\n        this.container = document.getElementById(containerId);\n\n        if (!this.container) {\n            console.error('Container not found:', containerId);\n            return;\n        }\n\n        this.init();\n    }\n\n    /**\n     * Set the tab orientation (standard or left-handed)\n     * @param orientation - 'standard' (low E on bottom) or 'leftHanded' (low E on top)\n     */\n    setTabOrientation(orientation: 'standard' | 'leftHanded'): void {\n        this.tabOrientation = orientation;\n    }\n\n    /**\n     * Convert string number based on orientation\n     * Standard: 1=high E (top), 6=low E (bottom)\n     * LeftHanded: reverse the strings so 6 appears on top, 1 on bottom\n     * @param stringNumber - VexFlow string number (1-6)\n     * @returns Adjusted string number for current orientation\n     */\n    private getOrientedString(stringNumber: number): number {\n        if (this.tabOrientation === 'leftHanded') {\n            // Reverse: 16, 25, 34, 43, 52, 61\n            return 7 - stringNumber;\n        }\n        return stringNumber;\n    }\n\n    /**\n     * Check if dark mode is active\n     */\n    private isDarkMode(): boolean {\n        return document.documentElement.classList.contains('dark');\n    }\n\n    /**\n     * Get the appropriate stroke color based on theme\n     */\n    private getStrokeColor(): string {\n        return this.isDarkMode() ? '#e5e5e5' : '#000000';\n    }\n\n    /**\n     * Apply theme-aware styling to SVG\n     */\n    private applyThemeToSVG(svg: SVGElement): void {\n        const strokeColor = this.getStrokeColor();\n\n        // Style all staff lines and note elements\n        svg.style.color = strokeColor;\n\n        // Apply stroke color to paths, lines, and other elements (but NOT rects with white fill)\n        const elements = svg.querySelectorAll('path, line, circle, ellipse');\n        elements.forEach(el => {\n            const element = el as SVGElement;\n            if (!element.style.fill || element.style.fill === 'black' || element.style.fill === 'rgb(0, 0, 0)') {\n                element.style.stroke = strokeColor;\n                element.style.fill = strokeColor;\n            }\n        });\n\n        // Handle rectangles separately - only style staff lines, not white backgrounds\n        const rects = svg.querySelectorAll('rect');\n        rects.forEach(el => {\n            const element = el as SVGElement;\n            const fill = element.getAttribute('fill');\n            // Only style rectangles that are NOT white backgrounds (those are for tab numbers)\n            if (fill !== 'white') {\n                element.style.stroke = strokeColor;\n                element.style.fill = strokeColor;\n            }\n        });\n\n        // Style text elements\n        const texts = svg.querySelectorAll('text');\n        texts.forEach(el => {\n            const element = el as SVGElement;\n            element.style.stroke = strokeColor;\n            element.style.fill = strokeColor;\n        });\n    }\n\n    /**\n     * Initialize VexFlow renderer\n     */\n    private init(): void {\n        try {\n            // Check if VexFlow is loaded\n            if (typeof Vex === 'undefined' || typeof window.Vex === 'undefined') {\n                console.error('VexFlow not loaded - waiting...');\n                // Try again after a short delay\n                setTimeout(() => this.init(), 500);\n                return;\n            }\n\n            if (!this.container) {\n                console.error('Container not found, cannot initialize');\n                return;\n            }\n\n            // Clear container\n            this.container.innerHTML = '';\n\n            // Create VexFlow renderer\n            const VF = Vex.Flow;\n\n            if (!VF || !VF.Renderer) {\n                console.error('VexFlow.Renderer not available');\n                return;\n            }\n\n            this.renderer = new VF.Renderer(\n                this.container,\n                VF.Renderer.Backends.SVG\n            );\n\n            // Size the canvas (tabs are typically shorter than staff)\n            this.renderer.resize(500, 180);\n\n            // Get drawing context\n            this.context = this.renderer.getContext();\n\n            console.log('TabRenderer initialized successfully');\n        } catch (error) {\n            console.error('Failed to initialize TabRenderer:', error);\n            this.showError('Unable to initialize tablature renderer');\n        }\n    }\n\n    /**\n     * Render a single note on the tab staff\n     * @param midiNote - MIDI note number\n     * @param options - Rendering options\n     */\n    renderNote(midiNote: number, options: RenderOptions = {}): void {\n        if (!this.context) {\n            console.warn('Renderer not initialized, attempting to initialize...');\n            this.init();\n            if (!this.context) {\n                console.error('Failed to initialize renderer');\n                this.showError('Unable to display tablature - please refresh');\n                return;\n            }\n        }\n\n        try {\n            const VF = Vex.Flow;\n\n            if (!this.container) return;\n\n            // Convert MIDI to tab position\n            const tabPosition = midiToTabPosition(midiNote, this.instrumentId);\n            if (!tabPosition) {\n                console.error('Unable to convert MIDI note to tab position:', midiNote);\n                this.showError('Note out of range for tablature');\n                return;\n            }\n\n            // Clear previous content\n            this.context.clear();\n            this.container.innerHTML = '';\n\n            // Recreate context after clear\n            this.renderer = new VF.Renderer(\n                this.container,\n                VF.Renderer.Backends.SVG\n            );\n            this.renderer.resize(500, 180);\n            this.context = this.renderer.getContext();\n\n            // Create a tab stave (6 strings for guitar)\n            const tabStave = new VF.TabStave(10, 20, 400);\n\n            // Add clef (tab clef shows \"TAB\")\n            tabStave.addTabGlyph();\n\n            // Draw the stave\n            tabStave.setContext(this.context).draw();\n\n            // Create tab note\n            // TabNote format: positions array where each element is {str: string_number, fret: fret_number}\n            // String 1 is the highest (thinnest), string 6 is the lowest (thickest)\n            // Apply orientation for left-handed users\n            const orientedString = this.getOrientedString(tabPosition.string);\n            const tabNote = new VF.TabNote({\n                positions: [{ str: orientedString, fret: tabPosition.fret }],\n                duration: 'w' // Whole note\n            });\n\n            // Create a voice and add the note\n            const voice = new VF.Voice({\n                num_beats: 4,\n                beat_value: 4\n            });\n            voice.addTickable(tabNote);\n\n            // Format and draw\n            new VF.Formatter()\n                .joinVoices([voice])\n                .format([voice], 350);\n\n            voice.draw(this.context, tabStave);\n\n            this.currentNote = midiNote;\n\n            // Apply theme styling\n            const svg = this.container?.querySelector('svg');\n            if (svg) {\n                this.applyThemeToSVG(svg);\n            }\n\n            // Apply highlight if specified\n            if (options.highlight) {\n                this.highlightNote();\n            }\n\n        } catch (error) {\n            console.error('Failed to render tab note:', error);\n            this.showError('Unable to display tab note');\n        }\n    }\n\n    /**\n     * Render multiple notes on the tab staff\n     * @param midiNotes - Array of MIDI note numbers\n     */\n    renderNotes(midiNotes: number[]): void {\n        if (!this.context) {\n            console.error('Renderer not initialized');\n            return;\n        }\n\n        try {\n            const VF = Vex.Flow;\n\n            if (!this.container) return;\n\n            // Convert MIDI notes to tab positions\n            const tabPositions = midiNotes\n                .map(midi => midiToTabPosition(midi, this.instrumentId))\n                .filter((pos): pos is TabPosition => pos !== null);\n\n            if (tabPositions.length === 0) {\n                console.error('No valid tab positions found');\n                return;\n            }\n\n            // Clear previous content\n            this.context.clear();\n            this.container.innerHTML = '';\n\n            // Recreate context\n            this.renderer = new VF.Renderer(\n                this.container,\n                VF.Renderer.Backends.SVG\n            );\n            this.renderer.resize(700, 180);\n            this.context = this.renderer.getContext();\n\n            // Create a tab stave\n            const tabStave = new VF.TabStave(10, 20, 650);\n            tabStave.addTabGlyph();\n            tabStave.setContext(this.context).draw();\n\n            // Create tab notes with orientation applied\n            const tabNotes = tabPositions.map(pos => {\n                const orientedString = this.getOrientedString(pos.string);\n                return new VF.TabNote({\n                    positions: [{ str: orientedString, fret: pos.fret }],\n                    duration: 'q' // Quarter note\n                });\n            });\n\n            // Create a voice\n            const voice = new VF.Voice({\n                num_beats: tabNotes.length,\n                beat_value: 4\n            });\n            voice.addTickables(tabNotes);\n\n            // Format and draw\n            new VF.Formatter()\n                .joinVoices([voice])\n                .format([voice], 600);\n\n            voice.draw(this.context, tabStave);\n\n            // Apply theme styling\n            const svg = this.container?.querySelector('svg');\n            if (svg) {\n                this.applyThemeToSVG(svg);\n            }\n\n        } catch (error) {\n            console.error('Failed to render tab notes:', error);\n            this.showError('Unable to display tab notes');\n        }\n    }\n\n    /**\n     * Render both staff and tab together (combined view)\n     * @param midiNote - MIDI note number\n     */\n    renderStaffAndTab(midiNote: number): void {\n        if (!this.context) {\n            console.warn('Renderer not initialized, attempting to initialize...');\n            this.init();\n            if (!this.context) {\n                console.error('Failed to initialize renderer');\n                this.showError('Unable to display notation - please refresh');\n                return;\n            }\n        }\n\n        try {\n            const VF = Vex.Flow;\n\n            if (!this.container) return;\n\n            // Convert MIDI to tab position\n            const tabPosition = midiToTabPosition(midiNote, this.instrumentId);\n            if (!tabPosition) {\n                console.error('Unable to convert MIDI note to tab position:', midiNote);\n                this.showError('Note out of range for tablature');\n                return;\n            }\n\n            // Clear previous content\n            this.context.clear();\n            this.container.innerHTML = '';\n\n            // Recreate context with taller height for staff + tab\n            this.renderer = new VF.Renderer(\n                this.container,\n                VF.Renderer.Backends.SVG\n            );\n            this.renderer.resize(500, 300);\n            this.context = this.renderer.getContext();\n\n            // Create staff stave (treble clef)\n            const staffStave = new VF.Stave(10, 20, 400);\n            staffStave.addClef('treble');\n            staffStave.setContext(this.context).draw();\n\n            // Create tab stave below staff\n            const tabStave = new VF.TabStave(10, 140, 400);\n            tabStave.addTabGlyph();\n            tabStave.setContext(this.context).draw();\n\n            // Connect staff and tab with connector\n            const connector = new VF.StaveConnector(staffStave, tabStave);\n            connector.setType(VF.StaveConnector.type.BRACKET);\n            connector.setContext(this.context).draw();\n\n            // Create staff note (using VexFlow notation)\n            const octave = Math.floor(midiNote / 12) - 1;\n            const noteIndex = midiNote % 12;\n            const noteNames = ['c', 'c#', 'd', 'd#', 'e', 'f', 'f#', 'g', 'g#', 'a', 'a#', 'b'];\n            const vexflowNote = `${noteNames[noteIndex]}/${octave}`;\n\n            const staffNote = new VF.StaveNote({\n                keys: [vexflowNote],\n                duration: 'w',\n                clef: 'treble'\n            });\n\n            // Add accidental if needed\n            if (noteNames[noteIndex].includes('#')) {\n                staffNote.addModifier(new VF.Accidental('#'), 0);\n            }\n\n            // Create tab note with orientation applied\n            const orientedString = this.getOrientedString(tabPosition.string);\n            const tabNote = new VF.TabNote({\n                positions: [{ str: orientedString, fret: tabPosition.fret }],\n                duration: 'w'\n            });\n\n            // Create voices for staff and tab\n            const staffVoice = new VF.Voice({ num_beats: 4, beat_value: 4 });\n            staffVoice.addTickable(staffNote);\n\n            const tabVoice = new VF.Voice({ num_beats: 4, beat_value: 4 });\n            tabVoice.addTickable(tabNote);\n\n            // Format and draw both\n            new VF.Formatter()\n                .joinVoices([staffVoice])\n                .format([staffVoice], 350);\n\n            new VF.Formatter()\n                .joinVoices([tabVoice])\n                .format([tabVoice], 350);\n\n            staffVoice.draw(this.context, staffStave);\n            tabVoice.draw(this.context, tabStave);\n\n            this.currentNote = midiNote;\n\n            // Apply theme styling\n            const svg = this.container?.querySelector('svg');\n            if (svg) {\n                this.applyThemeToSVG(svg);\n            }\n\n        } catch (error) {\n            console.error('Failed to render staff and tab:', error);\n            this.showError('Unable to display notation');\n        }\n    }\n\n    /**\n     * Highlight the current note (visual feedback)\n     */\n    private highlightNote(): void {\n        if (!this.container) return;\n\n        // Add a visual highlight to the SVG\n        const svg = this.container.querySelector('svg');\n        if (svg) {\n            const noteText = svg.querySelectorAll('text');\n            noteText.forEach(text => {\n                (text as SVGTextElement).style.fill = '#3b82f6';\n            });\n        }\n    }\n\n    /**\n     * Show feedback for correct/incorrect note\n     * @param isCorrect - Whether the note was correct\n     */\n    showFeedback(isCorrect: boolean): void {\n        if (!this.container) return;\n\n        const svg = this.container.querySelector('svg');\n        if (!svg) return;\n\n        const noteText = svg.querySelectorAll('text');\n        const color = isCorrect ? '#10b981' : '#ef4444';\n\n        noteText.forEach(text => {\n            const element = text as SVGTextElement;\n            element.style.fill = color;\n            element.style.transition = 'fill 0.3s ease';\n        });\n\n        // Reset after animation\n        setTimeout(() => {\n            noteText.forEach(text => {\n                (text as SVGTextElement).style.fill = '';\n            });\n        }, 500);\n    }\n\n    /**\n     * Show error message\n     * @param message - Error message to display\n     */\n    private showError(message: string): void {\n        if (!this.container) return;\n\n        this.container.innerHTML = `\n            <div style=\"\n                display: flex;\n                align-items: center;\n                justify-content: center;\n                height: 180px;\n                color: var(--text-secondary);\n                font-size: 1rem;\n            \">\n                ${message}\n            </div>\n        `;\n    }\n\n    /**\n     * Show welcome message\n     */\n    showWelcome(): void {\n        if (!this.container) return;\n\n        this.container.innerHTML = `\n            <div style=\"\n                display: flex;\n                flex-direction: column;\n                align-items: center;\n                justify-content: center;\n                height: 180px;\n                color: var(--text-secondary);\n                text-align: center;\n                padding: 2rem;\n            \">\n                <p style=\"font-size: 3rem; margin-bottom: 0.5rem;\"></p>\n                <p style=\"font-size: 1.2rem; font-weight: 600; margin-bottom: 0.5rem;\">\n                    Ready to Practice Guitar\n                </p>\n                <p style=\"font-size: 0.95rem;\">\n                    Click \"Start Practice\" to begin\n                </p>\n            </div>\n        `;\n    }\n\n    /**\n     * Clear the tab\n     */\n    clear(): void {\n        if (this.context) {\n            this.context.clear();\n        }\n        if (this.container) {\n            this.container.innerHTML = '';\n        }\n        this.currentNote = null;\n    }\n\n    /**\n     * Get the current note\n     * @returns Current MIDI note\n     */\n    getCurrentNote(): number | null {\n        return this.currentNote;\n    }\n}\n\n// Make available globally\nif (typeof window !== 'undefined') {\n    (window as any).TabRenderer = TabRenderer;\n}\n","/**\n * Storage Utilities\n * Handles local storage for progress tracking and session data\n */\n\n// Type definitions\nexport interface ModuleStats {\n    sessions: number;\n    correct: number;\n    incorrect: number;\n}\n\nexport interface Stats {\n    totalSessions: number;\n    totalCorrect: number;\n    totalIncorrect: number;\n    totalNotes: number;\n    avgResponseTime: number;\n    bestStreak: number;\n    lastPracticeDate: number | null;\n    byModule: Record<string, ModuleStats>;\n    // Game mode stats\n    lifetimeScore: number;\n    currentLevel: number;\n    highestStreak: number;\n}\n\nexport interface SessionData {\n    module?: string;\n    correct?: number;\n    incorrect?: number;\n    avgResponseTime?: number;\n    bestStreak?: number;\n    instrument?: string;\n    clef?: string;\n    range?: string;\n    timestamp?: number;\n    id?: string;\n    // Game mode data\n    gameMode?: 'practice' | 'timed';\n    roundScore?: number;\n    timeLeft?: number;\n    livesRemaining?: number;\n    [key: string]: any; // Allow additional properties\n}\n\nexport interface Session extends SessionData {\n    timestamp: number;\n    id: string;\n}\n\nexport interface Settings {\n    theme: 'light' | 'dark';\n    clef: 'treble' | 'bass';\n    range: string;\n    fallingNotesMode: boolean;\n    allowOctaveError: boolean;\n    midiDeviceId: string | null;\n    audioDeviceId: string | null;\n    virtualKeyboard: boolean;\n    instrument?: string;\n    pitchTolerance?: number;\n    // Game mode settings\n    gameMode?: 'practice' | 'timed';\n    soundEffectsEnabled?: boolean;\n    soundEffectsVolume?: number;\n    animationsEnabled?: boolean;\n    confettiEnabled?: boolean;\n    // Tab notation settings\n    tabOrientation?: 'standard' | 'leftHanded'; // standard: high E left, low E right; leftHanded: low E left, high E right\n    [key: string]: any; // Allow additional settings\n}\n\nexport interface ExportData {\n    sessions: Session[];\n    stats: Stats;\n    settings: Settings;\n    exportDate: number;\n}\n\n// Storage keys\nconst KEYS = {\n    SESSIONS: 'music_practice_sessions',\n    SETTINGS: 'music_practice_settings',\n    STATS: 'music_practice_stats'\n} as const;\n\n/**\n * Check if localStorage is available\n */\nfunction isLocalStorageAvailable(): boolean {\n    try {\n        return typeof window !== 'undefined' && typeof localStorage !== 'undefined';\n    } catch {\n        return false;\n    }\n}\n\n/**\n * Save a practice session\n */\nexport function saveSession(sessionData: SessionData): void {\n    if (!isLocalStorageAvailable()) {\n        console.warn('localStorage not available');\n        return;\n    }\n\n    try {\n        const sessions = getSessions();\n        const newSession: Session = {\n            ...sessionData,\n            timestamp: Date.now(),\n            id: generateId()\n        };\n        sessions.push(newSession);\n\n        // Keep only last 100 sessions\n        if (sessions.length > 100) {\n            sessions.shift();\n        }\n\n        localStorage.setItem(KEYS.SESSIONS, JSON.stringify(sessions));\n        updateStats(sessionData);\n    } catch (error) {\n        console.error('Error saving session:', error);\n    }\n}\n\n/**\n * Get all saved sessions\n */\nexport function getSessions(): Session[] {\n    if (!isLocalStorageAvailable()) {\n        return [];\n    }\n\n    try {\n        const data = localStorage.getItem(KEYS.SESSIONS);\n        return data ? JSON.parse(data) : [];\n    } catch (error) {\n        console.error('Error loading sessions:', error);\n        return [];\n    }\n}\n\n/**\n * Get sessions by instrument\n */\nexport function getSessionsByInstrument(instrumentId: string): Session[] {\n    return getSessions().filter(session => session.instrument === instrumentId);\n}\n\n/**\n * Update overall statistics\n */\nexport function updateStats(sessionData: SessionData): void {\n    if (!isLocalStorageAvailable()) {\n        return;\n    }\n\n    try {\n        const stats = getStats();\n\n        // Update counts\n        stats.totalSessions++;\n        stats.totalCorrect += sessionData.correct || 0;\n        stats.totalIncorrect += sessionData.incorrect || 0;\n        stats.totalNotes += (sessionData.correct || 0) + (sessionData.incorrect || 0);\n\n        // Update averages\n        if (sessionData.avgResponseTime) {\n            const totalTime = stats.avgResponseTime * (stats.totalSessions - 1) + sessionData.avgResponseTime;\n            stats.avgResponseTime = totalTime / stats.totalSessions;\n        }\n\n        // Track best streak\n        if ((sessionData.bestStreak || 0) > stats.bestStreak) {\n            stats.bestStreak = sessionData.bestStreak || 0;\n        }\n\n        // Track by module\n        const module = sessionData.module || 'sightReading';\n        if (!stats.byModule[module]) {\n            stats.byModule[module] = {\n                sessions: 0,\n                correct: 0,\n                incorrect: 0\n            };\n        }\n\n        stats.byModule[module].sessions++;\n        stats.byModule[module].correct += sessionData.correct || 0;\n        stats.byModule[module].incorrect += sessionData.incorrect || 0;\n\n        // Save last practice date\n        stats.lastPracticeDate = Date.now();\n\n        localStorage.setItem(KEYS.STATS, JSON.stringify(stats));\n    } catch (error) {\n        console.error('Error updating stats:', error);\n    }\n}\n\n/**\n * Get overall statistics\n */\nexport function getStats(): Stats {\n    if (!isLocalStorageAvailable()) {\n        return getDefaultStats();\n    }\n\n    try {\n        const data = localStorage.getItem(KEYS.STATS);\n        return data ? JSON.parse(data) : getDefaultStats();\n    } catch (error) {\n        console.error('Error loading stats:', error);\n        return getDefaultStats();\n    }\n}\n\n/**\n * Get default statistics object\n */\nexport function getDefaultStats(): Stats {\n    return {\n        totalSessions: 0,\n        totalCorrect: 0,\n        totalIncorrect: 0,\n        totalNotes: 0,\n        avgResponseTime: 0,\n        bestStreak: 0,\n        lastPracticeDate: null,\n        byModule: {},\n        lifetimeScore: 0,\n        currentLevel: 1,\n        highestStreak: 0\n    };\n}\n\n/**\n * Save user settings\n */\nexport function saveSettings(settings: Partial<Settings>): void {\n    if (!isLocalStorageAvailable()) {\n        console.warn('localStorage not available');\n        return;\n    }\n\n    try {\n        const currentSettings = getSettings();\n        const updatedSettings = { ...currentSettings, ...settings };\n        localStorage.setItem(KEYS.SETTINGS, JSON.stringify(updatedSettings));\n    } catch (error) {\n        console.error('Error saving settings:', error);\n    }\n}\n\n/**\n * Get user settings\n */\nexport function getSettings(): Settings {\n    if (!isLocalStorageAvailable()) {\n        return getDefaultSettings();\n    }\n\n    try {\n        const data = localStorage.getItem(KEYS.SETTINGS);\n        return data ? JSON.parse(data) : getDefaultSettings();\n    } catch (error) {\n        console.error('Error loading settings:', error);\n        return getDefaultSettings();\n    }\n}\n\n/**\n * Get default settings\n */\nexport function getDefaultSettings(): Settings {\n    return {\n        theme: 'light',\n        clef: 'treble',\n        range: 'c4-c5',\n        fallingNotesMode: false,\n        allowOctaveError: true,\n        midiDeviceId: null,\n        audioDeviceId: null,\n        virtualKeyboard: false,\n        instrument: 'piano',\n        pitchTolerance: 50,\n        gameMode: 'practice',\n        soundEffectsEnabled: true,\n        soundEffectsVolume: 0.7,\n        animationsEnabled: true,\n        confettiEnabled: true,\n        tabOrientation: 'standard'\n    };\n}\n\n/**\n * Clear all data (keep settings)\n */\nexport function clearAll(): void {\n    if (!isLocalStorageAvailable()) {\n        return;\n    }\n\n    try {\n        localStorage.removeItem(KEYS.SESSIONS);\n        localStorage.removeItem(KEYS.STATS);\n        // Keep settings\n    } catch (error) {\n        console.error('Error clearing data:', error);\n    }\n}\n\n/**\n * Clear all data including settings\n */\nexport function clearAllIncludingSettings(): void {\n    if (!isLocalStorageAvailable()) {\n        return;\n    }\n\n    try {\n        localStorage.removeItem(KEYS.SESSIONS);\n        localStorage.removeItem(KEYS.STATS);\n        localStorage.removeItem(KEYS.SETTINGS);\n    } catch (error) {\n        console.error('Error clearing data:', error);\n    }\n}\n\n/**\n * Export data as JSON\n */\nexport function exportData(): string {\n    return JSON.stringify({\n        sessions: getSessions(),\n        stats: getStats(),\n        settings: getSettings(),\n        exportDate: Date.now()\n    }, null, 2);\n}\n\n/**\n * Import data from JSON\n */\nexport function importData(jsonData: string): boolean {\n    if (!isLocalStorageAvailable()) {\n        console.warn('localStorage not available');\n        return false;\n    }\n\n    try {\n        const data: Partial<ExportData> = JSON.parse(jsonData);\n\n        if (data.sessions) {\n            localStorage.setItem(KEYS.SESSIONS, JSON.stringify(data.sessions));\n        }\n        if (data.stats) {\n            localStorage.setItem(KEYS.STATS, JSON.stringify(data.stats));\n        }\n        if (data.settings) {\n            localStorage.setItem(KEYS.SETTINGS, JSON.stringify(data.settings));\n        }\n\n        return true;\n    } catch (error) {\n        console.error('Error importing data:', error);\n        return false;\n    }\n}\n\n/**\n * Generate a unique ID\n */\nexport function generateId(): string {\n    return Date.now().toString(36) + Math.random().toString(36).substr(2);\n}\n\n// Export as namespace for backward compatibility\nexport const Storage = {\n    KEYS,\n    saveSession,\n    getSessions,\n    getSessionsByInstrument,\n    updateStats,\n    getStats,\n    getDefaultStats,\n    saveSettings,\n    getSettings,\n    getDefaultSettings,\n    clearAll,\n    clearAllIncludingSettings,\n    exportData,\n    importData,\n    generateId\n};\n\n// Make available globally for legacy code\nif (typeof window !== 'undefined') {\n    (window as any).Storage = Storage;\n}\n","/**\n * Audio Playback Utility\n * Synthesizes piano-like sounds using Web Audio API\n */\n\nexport class AudioPlayback {\n  private audioContext: AudioContext | null = null;\n  private masterGain: GainNode | null = null;\n\n  constructor() {\n    this.init();\n  }\n\n  private init(): void {\n    try {\n      this.audioContext = new (window.AudioContext || (window as any).webkitAudioContext)();\n      this.masterGain = this.audioContext.createGain();\n      this.masterGain.gain.value = 0.12; // Master volume (softer)\n      this.masterGain.connect(this.audioContext.destination);\n    } catch (error) {\n      console.error('Failed to initialize audio context:', error);\n    }\n  }\n\n  /**\n   * Play a note with a piano-like sound\n   * @param midiNote - MIDI note number (0-127)\n   * @param duration - Duration in seconds (default: 0.5)\n   */\n  public playNote(midiNote: number, duration: number = 0.5): void {\n    if (!this.audioContext || !this.masterGain) {\n      console.warn('Audio context not initialized');\n      return;\n    }\n\n    // Resume audio context if suspended (for user gesture requirement)\n    if (this.audioContext.state === 'suspended') {\n      this.audioContext.resume();\n    }\n\n    const frequency = this.midiToFrequency(midiNote);\n    const now = this.audioContext.currentTime;\n\n    // Create oscillators for a softer, mellower piano-like sound\n    // Fundamental frequency (pure sine for softness)\n    const osc1 = this.audioContext.createOscillator();\n    osc1.type = 'sine';\n    osc1.frequency.value = frequency;\n\n    // Second harmonic (subtle brightness)\n    const osc2 = this.audioContext.createOscillator();\n    osc2.type = 'sine';\n    osc2.frequency.value = frequency * 2;\n\n    // Third harmonic (very subtle warmth)\n    const osc3 = this.audioContext.createOscillator();\n    osc3.type = 'sine'; // Changed to sine for softer sound\n    osc3.frequency.value = frequency * 3;\n\n    // Create gain nodes for each oscillator\n    const gain1 = this.audioContext.createGain();\n    const gain2 = this.audioContext.createGain();\n    const gain3 = this.audioContext.createGain();\n\n    // Set relative volumes for each harmonic (much softer mix)\n    gain1.gain.value = 1.0;    // Fundamental\n    gain2.gain.value = 0.15;   // Second harmonic (reduced)\n    gain3.gain.value = 0.08;   // Third harmonic (reduced)\n\n    // Connect oscillators to their gains\n    osc1.connect(gain1);\n    osc2.connect(gain2);\n    osc3.connect(gain3);\n\n    // Create envelope gain for ADSR\n    const envelopeGain = this.audioContext.createGain();\n    gain1.connect(envelopeGain);\n    gain2.connect(envelopeGain);\n    gain3.connect(envelopeGain);\n\n    // Connect to master gain\n    envelopeGain.connect(this.masterGain);\n\n    // ADSR Envelope (soft and mellow)\n    const attackTime = 0.02;   // Gentle attack\n    const decayTime = 0.15;    // Smooth decay\n    const sustainLevel = 0.5;  // Lower sustain (softer)\n    const releaseTime = 0.4;   // Longer release for smoothness\n\n    envelopeGain.gain.setValueAtTime(0, now);\n    envelopeGain.gain.exponentialRampToValueAtTime(0.8, now + attackTime); // Softer peak\n    envelopeGain.gain.exponentialRampToValueAtTime(sustainLevel, now + attackTime + decayTime);\n    envelopeGain.gain.setValueAtTime(sustainLevel, now + duration - releaseTime);\n    envelopeGain.gain.exponentialRampToValueAtTime(0.001, now + duration); // Smooth fade out\n\n    // Start and stop oscillators\n    osc1.start(now);\n    osc2.start(now);\n    osc3.start(now);\n\n    osc1.stop(now + duration);\n    osc2.stop(now + duration);\n    osc3.stop(now + duration);\n  }\n\n  /**\n   * Convert MIDI note number to frequency in Hz\n   * @param midiNote - MIDI note number (0-127)\n   * @returns Frequency in Hz\n   */\n  private midiToFrequency(midiNote: number): number {\n    // A4 (MIDI note 69) = 440 Hz\n    return 440 * Math.pow(2, (midiNote - 69) / 12);\n  }\n\n  /**\n   * Set master volume\n   * @param volume - Volume level (0-1)\n   */\n  public setVolume(volume: number): void {\n    if (this.masterGain) {\n      this.masterGain.gain.value = Math.max(0, Math.min(1, volume));\n    }\n  }\n\n  /**\n   * Clean up audio context\n   */\n  public cleanup(): void {\n    if (this.audioContext) {\n      this.audioContext.close();\n      this.audioContext = null;\n    }\n  }\n}\n","export type DifficultyLevel = 'beginner' | 'intermediate' | 'advanced';\n\nconst NOTE_RANGES: Record<string, Record<DifficultyLevel, string>> = {\n  piano: { beginner: 'c4-c5', intermediate: 'c4-g5', advanced: 'a3-c6' },\n  'piano-virtual': { beginner: 'c4-c5', intermediate: 'c4-g5', advanced: 'a3-c6' },\n  guitar: { beginner: 'e2-e4', intermediate: 'e2-a4', advanced: 'e2-e5' },\n  violin: { beginner: 'g3-g4', intermediate: 'g3-c5', advanced: 'g3-g5' },\n};\n\nexport function getNoteRange(instrument: string, difficulty: DifficultyLevel): string {\n  return NOTE_RANGES[instrument]?.[difficulty] ?? NOTE_RANGES.piano[difficulty];\n}\n","import type { ClefType } from '../utils/music-theory';\nimport { midiToVexflow } from '../utils/music-theory';\nimport type { StaffRenderer } from '../notation/staff-renderer';\nimport type { TabRenderer } from '../notation/tab-renderer';\n\ninterface RenderNoteParams {\n  instrument: string;\n  tabDisplayMode: 'staff' | 'tab' | 'both';\n  clef: ClefType;\n  midiNote: number;\n  staffRenderer: StaffRenderer | null;\n  tabRenderer: TabRenderer | null;\n}\n\nexport function renderPracticeNote({\n  instrument,\n  tabDisplayMode,\n  clef,\n  midiNote,\n  staffRenderer,\n  tabRenderer,\n}: RenderNoteParams): void {\n  if (instrument === 'guitar') {\n    if (tabDisplayMode === 'both' && tabRenderer) {\n      tabRenderer.renderStaffAndTab(midiNote);\n      return;\n    }\n    if (tabDisplayMode === 'tab' && tabRenderer) {\n      tabRenderer.renderNote(midiNote);\n      return;\n    }\n  }\n\n  if (!staffRenderer) return;\n  const vexflowNote = midiToVexflow(midiNote, clef);\n  if (vexflowNote) {\n    staffRenderer.renderNote(vexflowNote);\n  }\n}\n","/**\n * Scoring Utilities\n * Game scoring logic for sight reading practice\n */\n\nexport interface RoundConfig {\n  duration: number; // seconds\n  notesPerRound: number;\n  successThreshold: number; // 0-1 (e.g., 0.80 = 80%)\n}\n\nexport const ROUND_CONFIGS: Record<'beginner' | 'intermediate' | 'advanced', RoundConfig> = {\n  beginner: {\n    duration: 45,\n    notesPerRound: 6,\n    successThreshold: 0.75,\n  },\n  intermediate: {\n    duration: 35,\n    notesPerRound: 10,\n    successThreshold: 0.80,\n  },\n  advanced: {\n    duration: 25,\n    notesPerRound: 12,\n    successThreshold: 0.85,\n  },\n};\n\nexport interface ScoreResult {\n  baseScore: number;\n  speedBonus: number;\n  streakMultiplier: number;\n  finalScore: number;\n  rank: ScoreRank;\n}\n\nexport type ScoreRank = 'S' | 'A' | 'B' | 'C' | 'D';\n\nexport interface RankInfo {\n  min: number;\n  label: string;\n  color: string;\n}\n\nexport const SCORE_RANKS: Record<ScoreRank, RankInfo> = {\n  S: { min: 120, label: 'Perfect!', color: 'text-yellow-500' },\n  A: { min: 100, label: 'Excellent', color: 'text-green-500' },\n  B: { min: 80, label: 'Good', color: 'text-blue-500' },\n  C: { min: 60, label: 'Keep Practicing', color: 'text-gray-500' },\n  D: { min: 0, label: 'Try Again', color: 'text-red-500' },\n};\n\n/**\n * Calculate score for a completed round\n * Formula: accuracy  (1 + speedBonus  0.5)  streakMultiplier\n */\nexport function calculateScore(\n  correct: number,\n  total: number,\n  timeLeft: number,\n  maxTime: number,\n  streak: number = 0\n): ScoreResult {\n  // Accuracy percentage\n  const accuracyPercent = total > 0 ? correct / total : 0;\n\n  // Speed bonus (0-1 based on time remaining)\n  const speedBonus = maxTime > 0 ? timeLeft / maxTime : 0;\n\n  // Streak multiplier (1.0 to 2.0)\n  const streakMultiplier = Math.min(1 + streak / 20, 2.0);\n\n  // Base score (0-100)\n  const baseScore = accuracyPercent * 100;\n\n  // Apply speed bonus (up to 50% extra)\n  const scoreWithSpeed = baseScore * (1 + speedBonus * 0.5);\n\n  // Apply streak multiplier\n  const finalScore = Math.round(scoreWithSpeed * streakMultiplier);\n\n  // Determine rank\n  const rank = getScoreRank(finalScore);\n\n  return {\n    baseScore: Math.round(baseScore),\n    speedBonus: Math.round(speedBonus * 100),\n    streakMultiplier,\n    finalScore,\n    rank,\n  };\n}\n\n/**\n * Get rank based on final score\n */\nexport function getScoreRank(score: number): ScoreRank {\n  if (score >= SCORE_RANKS.S.min) return 'S';\n  if (score >= SCORE_RANKS.A.min) return 'A';\n  if (score >= SCORE_RANKS.B.min) return 'B';\n  if (score >= SCORE_RANKS.C.min) return 'C';\n  return 'D';\n}\n\n/**\n * Calculate streak multiplier\n */\nexport function getStreakMultiplier(streak: number): number {\n  return Math.min(1 + streak / 20, 2.0);\n}\n\n/**\n * Check if round is successful\n */\nexport function isRoundSuccessful(\n  correct: number,\n  total: number,\n  threshold: number\n): boolean {\n  if (total === 0) return false;\n  return correct / total >= threshold;\n}\n\n/**\n * Calculate level from total lifetime score and accuracy\n */\nexport function calculateLevel(lifetimeScore: number, avgAccuracy: number): number {\n  if (lifetimeScore >= 2000 && avgAccuracy >= 0.90) return 5;\n  if (lifetimeScore >= 1000 && avgAccuracy >= 0.80) return 4;\n  if (lifetimeScore >= 500 && avgAccuracy >= 0.80) return 3;\n  if (lifetimeScore >= 200) return 2;\n  return 1;\n}\n\n/**\n * Get level name\n */\nexport function getLevelName(level: number): string {\n  const names = ['', 'Beginner', 'Novice', 'Intermediate', 'Advanced', 'Master'];\n  return names[level] || 'Unknown';\n}\n\n/**\n * Calculate points to next level\n */\nexport function getPointsToNextLevel(lifetimeScore: number, currentLevel: number): number {\n  const thresholds = [0, 0, 200, 500, 1000, 2000];\n  const nextLevelThreshold = thresholds[Math.min(currentLevel + 1, 5)];\n  return Math.max(0, nextLevelThreshold - lifetimeScore);\n}\n\n/**\n * Check if streak milestone reached\n */\nexport function isStreakMilestone(streak: number): boolean {\n  return streak > 0 && (streak === 5 || streak === 10 || streak === 20 || streak % 25 === 0);\n}\n\n/**\n * Get streak milestone message\n */\nexport function getStreakMilestoneMessage(streak: number): string {\n  if (streak >= 50) return `Legendary! ${streak} streak! `;\n  if (streak >= 25) return `Unstoppable! ${streak} streak! `;\n  if (streak === 20) return `On fire! ${streak} streak! `;\n  if (streak === 10) return `Great streak! ${streak} in a row! `;\n  if (streak === 5) return `Nice! ${streak} correct! `;\n  return '';\n}\n","/**\n * useGameRound Hook\n * Manages timed round logic for game mode\n */\n\nimport { useState, useEffect, useCallback, useRef } from 'react';\nimport { ROUND_CONFIGS, calculateScore, isRoundSuccessful, type ScoreResult } from '../lib/utils/scoring';\n\nexport type Difficulty = 'beginner' | 'intermediate' | 'advanced';\nexport type GameMode = 'practice' | 'timed';\n\nexport interface GameRoundState {\n  // Round status\n  isActive: boolean;\n  isComplete: boolean;\n  isSuccessful: boolean | null;\n\n  // Time tracking\n  timeLeft: number;\n  maxTime: number;\n\n  // Lives\n  lives: number;\n  maxLives: number;\n\n  // Progress\n  notesCompleted: number;\n  notesRequired: number;\n  correctCount: number;\n  incorrectCount: number;\n\n  // Streak\n  streak: number;\n  consecutiveWrong: number;\n\n  // Score\n  currentScore: ScoreResult | null;\n}\n\nexport interface GameRoundActions {\n  startRound: () => void;\n  endRound: () => void;\n  noteCorrect: () => void;\n  noteIncorrect: () => void;\n  resetRound: () => void;\n}\n\nexport interface UseGameRoundOptions {\n  difficulty: Difficulty;\n  gameMode: GameMode;\n  onRoundComplete?: (state: GameRoundState) => void;\n  onRoundFail?: (state: GameRoundState) => void;\n  onTimeUp?: () => void;\n  onLifeLost?: (livesLeft: number) => void;\n  onStreakMilestone?: (streak: number) => void;\n}\n\nexport function useGameRound(options: UseGameRoundOptions): [GameRoundState, GameRoundActions] {\n  const { difficulty, gameMode, onRoundComplete, onRoundFail, onTimeUp, onLifeLost, onStreakMilestone } = options;\n\n  const config = ROUND_CONFIGS[difficulty];\n  const maxLives = 3;\n\n  // Initial state\n  const [state, setState] = useState<GameRoundState>({\n    isActive: false,\n    isComplete: false,\n    isSuccessful: null,\n    timeLeft: config.duration,\n    maxTime: config.duration,\n    lives: maxLives,\n    maxLives,\n    notesCompleted: 0,\n    notesRequired: config.notesPerRound,\n    correctCount: 0,\n    incorrectCount: 0,\n    streak: 0,\n    consecutiveWrong: 0,\n    currentScore: null,\n  });\n\n  // Refs for callbacks to avoid stale closures\n  const stateRef = useRef(state);\n  stateRef.current = state;\n\n  // Timer\n  useEffect(() => {\n    if (gameMode !== 'timed') return;\n    if (!state.isActive || state.isComplete) return;\n\n    const timer = setInterval(() => {\n      setState((prev) => {\n        const newTimeLeft = Math.max(0, prev.timeLeft - 1);\n\n        // Check if time's up\n        if (newTimeLeft === 0 && prev.timeLeft > 0) {\n          if (onTimeUp) onTimeUp();\n          // End round on time up\n          return {\n            ...prev,\n            timeLeft: 0,\n            isActive: false,\n            isComplete: true,\n            isSuccessful: false,\n          };\n        }\n\n        return { ...prev, timeLeft: newTimeLeft };\n      });\n    }, 1000);\n\n    return () => clearInterval(timer);\n  }, [state.isActive, state.isComplete, gameMode, onTimeUp]);\n\n  // Start round\n  const startRound = useCallback(() => {\n    setState({\n      isActive: true,\n      isComplete: false,\n      isSuccessful: null,\n      timeLeft: config.duration,\n      maxTime: config.duration,\n      lives: maxLives,\n      maxLives,\n      notesCompleted: 0,\n      notesRequired: config.notesPerRound,\n      correctCount: 0,\n      incorrectCount: 0,\n      streak: stateRef.current.streak, // Preserve streak across rounds\n      consecutiveWrong: 0,\n      currentScore: null,\n    });\n  }, [config.duration, config.notesPerRound, maxLives]);\n\n  // End round\n  const endRound = useCallback(() => {\n    setState((prev) => {\n      const isSuccessful = isRoundSuccessful(prev.correctCount, prev.notesRequired, config.successThreshold);\n\n      const score = calculateScore(\n        prev.correctCount,\n        prev.notesRequired,\n        prev.timeLeft,\n        prev.maxTime,\n        prev.streak\n      );\n\n      const newState = {\n        ...prev,\n        isActive: false,\n        isComplete: true,\n        isSuccessful,\n        currentScore: score,\n      };\n\n      // Trigger callbacks\n      if (isSuccessful && onRoundComplete) {\n        onRoundComplete(newState);\n      } else if (!isSuccessful && onRoundFail) {\n        onRoundFail(newState);\n      }\n\n      return newState;\n    });\n  }, [config.successThreshold, onRoundComplete, onRoundFail]);\n\n  // Note correct\n  const noteCorrect = useCallback(() => {\n    setState((prev) => {\n      const newCorrect = prev.correctCount + 1;\n      const newCompleted = prev.notesCompleted + 1;\n      const newStreak = prev.streak + 1;\n      const consecutiveWrong = 0;\n\n      // Check for streak milestones\n      if (onStreakMilestone && (newStreak === 5 || newStreak === 10 || newStreak === 20 || newStreak % 25 === 0)) {\n        onStreakMilestone(newStreak);\n      }\n\n      // Check if round complete\n      const roundComplete = newCompleted >= prev.notesRequired;\n\n      return {\n        ...prev,\n        correctCount: newCorrect,\n        notesCompleted: newCompleted,\n        streak: newStreak,\n        consecutiveWrong,\n        isComplete: roundComplete,\n        isActive: !roundComplete,\n      };\n    });\n  }, [onStreakMilestone]);\n\n  // Note incorrect\n  const noteIncorrect = useCallback(() => {\n    setState((prev) => {\n      const newIncorrect = prev.incorrectCount + 1;\n      const newCompleted = prev.notesCompleted + 1;\n      const newLives = gameMode === 'timed' ? Math.max(0, prev.lives - 1) : prev.lives;\n      const consecutiveWrong = prev.consecutiveWrong + 1;\n      const streak = 0; // Reset streak on wrong note\n\n      // Trigger life lost callback\n      if (gameMode === 'timed' && newLives < prev.lives && onLifeLost) {\n        onLifeLost(newLives);\n      }\n\n      // Check fail conditions (timed mode only)\n      const failedByLives = gameMode === 'timed' && newLives === 0;\n      const failedByConsecutive = gameMode === 'timed' && consecutiveWrong >= 3;\n      const roundFailed = failedByLives || failedByConsecutive;\n\n      // Check if round complete\n      const roundComplete = newCompleted >= prev.notesRequired || roundFailed;\n\n      return {\n        ...prev,\n        incorrectCount: newIncorrect,\n        notesCompleted: newCompleted,\n        lives: newLives,\n        streak,\n        consecutiveWrong,\n        isComplete: roundComplete,\n        isSuccessful: roundFailed ? false : null,\n        isActive: !roundComplete,\n      };\n    });\n  }, [gameMode, onLifeLost]);\n\n  // Reset round\n  const resetRound = useCallback(() => {\n    setState({\n      isActive: false,\n      isComplete: false,\n      isSuccessful: null,\n      timeLeft: config.duration,\n      maxTime: config.duration,\n      lives: maxLives,\n      maxLives,\n      notesCompleted: 0,\n      notesRequired: config.notesPerRound,\n      correctCount: 0,\n      incorrectCount: 0,\n      streak: 0,\n      consecutiveWrong: 0,\n      currentScore: null,\n    });\n  }, [config.duration, config.notesPerRound, maxLives]);\n\n  // Auto-complete round when all notes done\n  useEffect(() => {\n    if (state.isComplete && !state.isSuccessful && state.notesCompleted >= state.notesRequired) {\n      endRound();\n    }\n  }, [state.isComplete, state.isSuccessful, state.notesCompleted, state.notesRequired, endRound]);\n\n  const actions: GameRoundActions = {\n    startRound,\n    endRound,\n    noteCorrect,\n    noteIncorrect,\n    resetRound,\n  };\n\n  return [state, actions];\n}\n","export const version = \"15.1.22\";\n//# sourceMappingURL=version.js.map","export const createExtendedExponentialRampToValueAutomationEvent = (value, endTime, insertTime) => {\n    return { endTime, insertTime, type: 'exponentialRampToValue', value };\n};\n//# sourceMappingURL=create-extended-exponential-ramp-to-value-automation-event.js.map","export const createExtendedLinearRampToValueAutomationEvent = (value, endTime, insertTime) => {\n    return { endTime, insertTime, type: 'linearRampToValue', value };\n};\n//# sourceMappingURL=create-extended-linear-ramp-to-value-automation-event.js.map","export const createSetValueAutomationEvent = (value, startTime) => {\n    return { startTime, type: 'setValue', value };\n};\n//# sourceMappingURL=create-set-value-automation-event.js.map","export const createSetValueCurveAutomationEvent = (values, startTime, duration) => {\n    return { duration, startTime, type: 'setValueCurve', values };\n};\n//# sourceMappingURL=create-set-value-curve-automation-event.js.map","export const getTargetValueAtTime = (time, valueAtStartTime, { startTime, target, timeConstant }) => {\n    return target + (valueAtStartTime - target) * Math.exp((startTime - time) / timeConstant);\n};\n//# sourceMappingURL=get-target-value-at-time.js.map","export const isExponentialRampToValueAutomationEvent = (automationEvent) => {\n    return automationEvent.type === 'exponentialRampToValue';\n};\n//# sourceMappingURL=exponential-ramp-to-value-automation-event.js.map","export const isLinearRampToValueAutomationEvent = (automationEvent) => {\n    return automationEvent.type === 'linearRampToValue';\n};\n//# sourceMappingURL=linear-ramp-to-value-automation-event.js.map","import { isExponentialRampToValueAutomationEvent } from './exponential-ramp-to-value-automation-event';\nimport { isLinearRampToValueAutomationEvent } from './linear-ramp-to-value-automation-event';\nexport const isAnyRampToValueAutomationEvent = (automationEvent) => {\n    return isExponentialRampToValueAutomationEvent(automationEvent) || isLinearRampToValueAutomationEvent(automationEvent);\n};\n//# sourceMappingURL=any-ramp-to-value-automation-event.js.map","export const isSetValueAutomationEvent = (automationEvent) => {\n    return automationEvent.type === 'setValue';\n};\n//# sourceMappingURL=set-value-automation-event.js.map","export const isSetValueCurveAutomationEvent = (automationEvent) => {\n    return automationEvent.type === 'setValueCurve';\n};\n//# sourceMappingURL=set-value-curve-automation-event.js.map","import { getTargetValueAtTime } from '../functions/get-target-value-at-time';\nimport { isAnyRampToValueAutomationEvent } from '../guards/any-ramp-to-value-automation-event';\nimport { isSetValueAutomationEvent } from '../guards/set-value-automation-event';\nimport { isSetValueCurveAutomationEvent } from '../guards/set-value-curve-automation-event';\nexport const getValueOfAutomationEventAtIndexAtTime = (automationEvents, index, time, defaultValue) => {\n    const automationEvent = automationEvents[index];\n    return automationEvent === undefined\n        ? defaultValue\n        : isAnyRampToValueAutomationEvent(automationEvent) || isSetValueAutomationEvent(automationEvent)\n            ? automationEvent.value\n            : isSetValueCurveAutomationEvent(automationEvent)\n                ? automationEvent.values[automationEvent.values.length - 1]\n                : getTargetValueAtTime(time, getValueOfAutomationEventAtIndexAtTime(automationEvents, index - 1, automationEvent.startTime, defaultValue), automationEvent);\n};\n//# sourceMappingURL=get-value-of-automation-event-at-index-at-time.js.map","import { getValueOfAutomationEventAtIndexAtTime } from '../functions/get-value-of-automation-event-at-index-at-time';\nimport { isAnyRampToValueAutomationEvent } from '../guards/any-ramp-to-value-automation-event';\nimport { isSetValueAutomationEvent } from '../guards/set-value-automation-event';\nimport { isSetValueCurveAutomationEvent } from '../guards/set-value-curve-automation-event';\nexport const getEndTimeAndValueOfPreviousAutomationEvent = (automationEvents, index, currentAutomationEvent, nextAutomationEvent, defaultValue) => {\n    return currentAutomationEvent === undefined\n        ? [nextAutomationEvent.insertTime, defaultValue]\n        : isAnyRampToValueAutomationEvent(currentAutomationEvent)\n            ? [currentAutomationEvent.endTime, currentAutomationEvent.value]\n            : isSetValueAutomationEvent(currentAutomationEvent)\n                ? [currentAutomationEvent.startTime, currentAutomationEvent.value]\n                : isSetValueCurveAutomationEvent(currentAutomationEvent)\n                    ? [\n                        currentAutomationEvent.startTime + currentAutomationEvent.duration,\n                        currentAutomationEvent.values[currentAutomationEvent.values.length - 1]\n                    ]\n                    : [\n                        currentAutomationEvent.startTime,\n                        getValueOfAutomationEventAtIndexAtTime(automationEvents, index - 1, currentAutomationEvent.startTime, defaultValue)\n                    ];\n};\n//# sourceMappingURL=get-end-time-and-value-of-previous-automation-event.js.map","export const isCancelAndHoldAutomationEvent = (automationEvent) => {\n    return automationEvent.type === 'cancelAndHold';\n};\n//# sourceMappingURL=cancel-and-hold-automation-event.js.map","export const isCancelScheduledValuesAutomationEvent = (automationEvent) => {\n    return automationEvent.type === 'cancelScheduledValues';\n};\n//# sourceMappingURL=cancel-scheduled-values-automation-event.js.map","import { isCancelAndHoldAutomationEvent } from '../guards/cancel-and-hold-automation-event';\nimport { isCancelScheduledValuesAutomationEvent } from '../guards/cancel-scheduled-values-automation-event';\nimport { isExponentialRampToValueAutomationEvent } from '../guards/exponential-ramp-to-value-automation-event';\nimport { isLinearRampToValueAutomationEvent } from '../guards/linear-ramp-to-value-automation-event';\nexport const getEventTime = (automationEvent) => {\n    if (isCancelAndHoldAutomationEvent(automationEvent) || isCancelScheduledValuesAutomationEvent(automationEvent)) {\n        return automationEvent.cancelTime;\n    }\n    if (isExponentialRampToValueAutomationEvent(automationEvent) || isLinearRampToValueAutomationEvent(automationEvent)) {\n        return automationEvent.endTime;\n    }\n    return automationEvent.startTime;\n};\n//# sourceMappingURL=get-event-time.js.map","export const getExponentialRampValueAtTime = (time, startTime, valueAtStartTime, { endTime, value }) => {\n    if (valueAtStartTime === value) {\n        return value;\n    }\n    if ((0 < valueAtStartTime && 0 < value) || (valueAtStartTime < 0 && value < 0)) {\n        return valueAtStartTime * (value / valueAtStartTime) ** ((time - startTime) / (endTime - startTime));\n    }\n    return 0;\n};\n//# sourceMappingURL=get-exponential-ramp-value-at-time.js.map","export const getLinearRampValueAtTime = (time, startTime, valueAtStartTime, { endTime, value }) => {\n    return valueAtStartTime + ((time - startTime) / (endTime - startTime)) * (value - valueAtStartTime);\n};\n//# sourceMappingURL=get-linear-ramp-value-at-time.js.map","export const interpolateValue = (values, theoreticIndex) => {\n    const lowerIndex = Math.floor(theoreticIndex);\n    const upperIndex = Math.ceil(theoreticIndex);\n    if (lowerIndex === upperIndex) {\n        return values[lowerIndex];\n    }\n    return (1 - (theoreticIndex - lowerIndex)) * values[lowerIndex] + (1 - (upperIndex - theoreticIndex)) * values[upperIndex];\n};\n//# sourceMappingURL=interpolate-value.js.map","import { interpolateValue } from './interpolate-value';\nexport const getValueCurveValueAtTime = (time, { duration, startTime, values }) => {\n    const theoreticIndex = ((time - startTime) / duration) * (values.length - 1);\n    return interpolateValue(values, theoreticIndex);\n};\n//# sourceMappingURL=get-value-curve-value-at-time.js.map","export const isSetTargetAutomationEvent = (automationEvent) => {\n    return automationEvent.type === 'setTarget';\n};\n//# sourceMappingURL=set-target-automation-event.js.map","import { createExtendedExponentialRampToValueAutomationEvent } from '../functions/create-extended-exponential-ramp-to-value-automation-event';\nimport { createExtendedLinearRampToValueAutomationEvent } from '../functions/create-extended-linear-ramp-to-value-automation-event';\nimport { createSetValueAutomationEvent } from '../functions/create-set-value-automation-event';\nimport { createSetValueCurveAutomationEvent } from '../functions/create-set-value-curve-automation-event';\nimport { getEndTimeAndValueOfPreviousAutomationEvent } from '../functions/get-end-time-and-value-of-previous-automation-event';\nimport { getEventTime } from '../functions/get-event-time';\nimport { getExponentialRampValueAtTime } from '../functions/get-exponential-ramp-value-at-time';\nimport { getLinearRampValueAtTime } from '../functions/get-linear-ramp-value-at-time';\nimport { getTargetValueAtTime } from '../functions/get-target-value-at-time';\nimport { getValueCurveValueAtTime } from '../functions/get-value-curve-value-at-time';\nimport { getValueOfAutomationEventAtIndexAtTime } from '../functions/get-value-of-automation-event-at-index-at-time';\nimport { isAnyRampToValueAutomationEvent } from '../guards/any-ramp-to-value-automation-event';\nimport { isCancelAndHoldAutomationEvent } from '../guards/cancel-and-hold-automation-event';\nimport { isCancelScheduledValuesAutomationEvent } from '../guards/cancel-scheduled-values-automation-event';\nimport { isExponentialRampToValueAutomationEvent } from '../guards/exponential-ramp-to-value-automation-event';\nimport { isLinearRampToValueAutomationEvent } from '../guards/linear-ramp-to-value-automation-event';\nimport { isSetTargetAutomationEvent } from '../guards/set-target-automation-event';\nimport { isSetValueAutomationEvent } from '../guards/set-value-automation-event';\nimport { isSetValueCurveAutomationEvent } from '../guards/set-value-curve-automation-event';\nexport class AutomationEventList {\n    constructor(defaultValue) {\n        this._automationEvents = [];\n        this._currenTime = 0;\n        this._defaultValue = defaultValue;\n    }\n    [Symbol.iterator]() {\n        return this._automationEvents[Symbol.iterator]();\n    }\n    add(automationEvent) {\n        const eventTime = getEventTime(automationEvent);\n        if (isCancelAndHoldAutomationEvent(automationEvent) || isCancelScheduledValuesAutomationEvent(automationEvent)) {\n            const index = this._automationEvents.findIndex((currentAutomationEvent) => {\n                if (isCancelScheduledValuesAutomationEvent(automationEvent) && isSetValueCurveAutomationEvent(currentAutomationEvent)) {\n                    return currentAutomationEvent.startTime + currentAutomationEvent.duration >= eventTime;\n                }\n                return getEventTime(currentAutomationEvent) >= eventTime;\n            });\n            const removedAutomationEvent = this._automationEvents[index];\n            if (index !== -1) {\n                this._automationEvents = this._automationEvents.slice(0, index);\n            }\n            if (isCancelAndHoldAutomationEvent(automationEvent)) {\n                const lastAutomationEvent = this._automationEvents[this._automationEvents.length - 1];\n                if (removedAutomationEvent !== undefined && isAnyRampToValueAutomationEvent(removedAutomationEvent)) {\n                    if (lastAutomationEvent !== undefined && isSetTargetAutomationEvent(lastAutomationEvent)) {\n                        throw new Error('The internal list is malformed.');\n                    }\n                    const startTime = lastAutomationEvent === undefined\n                        ? removedAutomationEvent.insertTime\n                        : isSetValueCurveAutomationEvent(lastAutomationEvent)\n                            ? lastAutomationEvent.startTime + lastAutomationEvent.duration\n                            : getEventTime(lastAutomationEvent);\n                    const startValue = lastAutomationEvent === undefined\n                        ? this._defaultValue\n                        : isSetValueCurveAutomationEvent(lastAutomationEvent)\n                            ? lastAutomationEvent.values[lastAutomationEvent.values.length - 1]\n                            : lastAutomationEvent.value;\n                    const value = isExponentialRampToValueAutomationEvent(removedAutomationEvent)\n                        ? getExponentialRampValueAtTime(eventTime, startTime, startValue, removedAutomationEvent)\n                        : getLinearRampValueAtTime(eventTime, startTime, startValue, removedAutomationEvent);\n                    const truncatedAutomationEvent = isExponentialRampToValueAutomationEvent(removedAutomationEvent)\n                        ? createExtendedExponentialRampToValueAutomationEvent(value, eventTime, this._currenTime)\n                        : createExtendedLinearRampToValueAutomationEvent(value, eventTime, this._currenTime);\n                    this._automationEvents.push(truncatedAutomationEvent);\n                }\n                if (lastAutomationEvent !== undefined && isSetTargetAutomationEvent(lastAutomationEvent)) {\n                    this._automationEvents.push(createSetValueAutomationEvent(this.getValue(eventTime), eventTime));\n                }\n                if (lastAutomationEvent !== undefined &&\n                    isSetValueCurveAutomationEvent(lastAutomationEvent) &&\n                    lastAutomationEvent.startTime + lastAutomationEvent.duration > eventTime) {\n                    const duration = eventTime - lastAutomationEvent.startTime;\n                    const ratio = (lastAutomationEvent.values.length - 1) / lastAutomationEvent.duration;\n                    const length = Math.max(2, 1 + Math.ceil(duration * ratio));\n                    const fraction = (duration / (length - 1)) * ratio;\n                    const values = lastAutomationEvent.values.slice(0, length);\n                    if (fraction < 1) {\n                        for (let i = 1; i < length; i += 1) {\n                            const factor = (fraction * i) % 1;\n                            values[i] = lastAutomationEvent.values[i - 1] * (1 - factor) + lastAutomationEvent.values[i] * factor;\n                        }\n                    }\n                    this._automationEvents[this._automationEvents.length - 1] = createSetValueCurveAutomationEvent(values, lastAutomationEvent.startTime, duration);\n                }\n            }\n        }\n        else {\n            const index = this._automationEvents.findIndex((currentAutomationEvent) => getEventTime(currentAutomationEvent) > eventTime);\n            const previousAutomationEvent = index === -1 ? this._automationEvents[this._automationEvents.length - 1] : this._automationEvents[index - 1];\n            if (previousAutomationEvent !== undefined &&\n                isSetValueCurveAutomationEvent(previousAutomationEvent) &&\n                getEventTime(previousAutomationEvent) + previousAutomationEvent.duration > eventTime) {\n                return false;\n            }\n            const persistentAutomationEvent = isExponentialRampToValueAutomationEvent(automationEvent)\n                ? createExtendedExponentialRampToValueAutomationEvent(automationEvent.value, automationEvent.endTime, this._currenTime)\n                : isLinearRampToValueAutomationEvent(automationEvent)\n                    ? createExtendedLinearRampToValueAutomationEvent(automationEvent.value, eventTime, this._currenTime)\n                    : automationEvent;\n            if (index === -1) {\n                this._automationEvents.push(persistentAutomationEvent);\n            }\n            else {\n                if (isSetValueCurveAutomationEvent(automationEvent) &&\n                    eventTime + automationEvent.duration > getEventTime(this._automationEvents[index])) {\n                    return false;\n                }\n                this._automationEvents.splice(index, 0, persistentAutomationEvent);\n            }\n        }\n        return true;\n    }\n    flush(time) {\n        const index = this._automationEvents.findIndex((currentAutomationEvent) => getEventTime(currentAutomationEvent) > time);\n        if (index > 1) {\n            const remainingAutomationEvents = this._automationEvents.slice(index - 1);\n            const firstRemainingAutomationEvent = remainingAutomationEvents[0];\n            if (isSetTargetAutomationEvent(firstRemainingAutomationEvent)) {\n                remainingAutomationEvents.unshift(createSetValueAutomationEvent(getValueOfAutomationEventAtIndexAtTime(this._automationEvents, index - 2, firstRemainingAutomationEvent.startTime, this._defaultValue), firstRemainingAutomationEvent.startTime));\n            }\n            this._automationEvents = remainingAutomationEvents;\n        }\n    }\n    getValue(time) {\n        if (this._automationEvents.length === 0) {\n            return this._defaultValue;\n        }\n        const indexOfNextEvent = this._automationEvents.findIndex((automationEvent) => getEventTime(automationEvent) > time);\n        const nextAutomationEvent = this._automationEvents[indexOfNextEvent];\n        const indexOfCurrentEvent = (indexOfNextEvent === -1 ? this._automationEvents.length : indexOfNextEvent) - 1;\n        const currentAutomationEvent = this._automationEvents[indexOfCurrentEvent];\n        if (currentAutomationEvent !== undefined &&\n            isSetTargetAutomationEvent(currentAutomationEvent) &&\n            (nextAutomationEvent === undefined ||\n                !isAnyRampToValueAutomationEvent(nextAutomationEvent) ||\n                nextAutomationEvent.insertTime > time)) {\n            return getTargetValueAtTime(time, getValueOfAutomationEventAtIndexAtTime(this._automationEvents, indexOfCurrentEvent - 1, currentAutomationEvent.startTime, this._defaultValue), currentAutomationEvent);\n        }\n        if (currentAutomationEvent !== undefined &&\n            isSetValueAutomationEvent(currentAutomationEvent) &&\n            (nextAutomationEvent === undefined || !isAnyRampToValueAutomationEvent(nextAutomationEvent))) {\n            return currentAutomationEvent.value;\n        }\n        if (currentAutomationEvent !== undefined &&\n            isSetValueCurveAutomationEvent(currentAutomationEvent) &&\n            (nextAutomationEvent === undefined ||\n                !isAnyRampToValueAutomationEvent(nextAutomationEvent) ||\n                currentAutomationEvent.startTime + currentAutomationEvent.duration > time)) {\n            if (time < currentAutomationEvent.startTime + currentAutomationEvent.duration) {\n                return getValueCurveValueAtTime(time, currentAutomationEvent);\n            }\n            return currentAutomationEvent.values[currentAutomationEvent.values.length - 1];\n        }\n        if (currentAutomationEvent !== undefined &&\n            isAnyRampToValueAutomationEvent(currentAutomationEvent) &&\n            (nextAutomationEvent === undefined || !isAnyRampToValueAutomationEvent(nextAutomationEvent))) {\n            return currentAutomationEvent.value;\n        }\n        if (nextAutomationEvent !== undefined && isExponentialRampToValueAutomationEvent(nextAutomationEvent)) {\n            const [startTime, value] = getEndTimeAndValueOfPreviousAutomationEvent(this._automationEvents, indexOfCurrentEvent, currentAutomationEvent, nextAutomationEvent, this._defaultValue);\n            return getExponentialRampValueAtTime(time, startTime, value, nextAutomationEvent);\n        }\n        if (nextAutomationEvent !== undefined && isLinearRampToValueAutomationEvent(nextAutomationEvent)) {\n            const [startTime, value] = getEndTimeAndValueOfPreviousAutomationEvent(this._automationEvents, indexOfCurrentEvent, currentAutomationEvent, nextAutomationEvent, this._defaultValue);\n            return getLinearRampValueAtTime(time, startTime, value, nextAutomationEvent);\n        }\n        return this._defaultValue;\n    }\n}\n//# sourceMappingURL=automation-event-list.js.map","export const createCancelAndHoldAutomationEvent = (cancelTime) => {\n    return { cancelTime, type: 'cancelAndHold' };\n};\n//# sourceMappingURL=create-cancel-and-hold-automation-event.js.map","export const createCancelScheduledValuesAutomationEvent = (cancelTime) => {\n    return { cancelTime, type: 'cancelScheduledValues' };\n};\n//# sourceMappingURL=create-cancel-scheduled-values-automation-event.js.map","export const createExponentialRampToValueAutomationEvent = (value, endTime) => {\n    return { endTime, type: 'exponentialRampToValue', value };\n};\n//# sourceMappingURL=create-exponential-ramp-to-value-automation-event.js.map","export const createLinearRampToValueAutomationEvent = (value, endTime) => {\n    return { endTime, type: 'linearRampToValue', value };\n};\n//# sourceMappingURL=create-linear-ramp-to-value-automation-event.js.map","export const createSetTargetAutomationEvent = (target, startTime, timeConstant) => {\n    return { startTime, target, timeConstant, type: 'setTarget' };\n};\n//# sourceMappingURL=create-set-target-automation-event.js.map","export const createAbortError = () => new DOMException('', 'AbortError');\n//# sourceMappingURL=abort-error.js.map","export const createAddActiveInputConnectionToAudioNode = (insertElementInSet) => {\n    return (activeInputs, source, [output, input, eventListener], ignoreDuplicates) => {\n        insertElementInSet(activeInputs[input], [source, output, eventListener], (activeInputConnection) => activeInputConnection[0] === source && activeInputConnection[1] === output, ignoreDuplicates);\n    };\n};\n//# sourceMappingURL=add-active-input-connection-to-audio-node.js.map","export const createAddAudioNodeConnections = (audioNodeConnectionsStore) => {\n    return (audioNode, audioNodeRenderer, nativeAudioNode) => {\n        const activeInputs = [];\n        for (let i = 0; i < nativeAudioNode.numberOfInputs; i += 1) {\n            activeInputs.push(new Set());\n        }\n        audioNodeConnectionsStore.set(audioNode, {\n            activeInputs,\n            outputs: new Set(),\n            passiveInputs: new WeakMap(),\n            renderer: audioNodeRenderer\n        });\n    };\n};\n//# sourceMappingURL=add-audio-node-connections.js.map","export const createAddAudioParamConnections = (audioParamConnectionsStore) => {\n    return (audioParam, audioParamRenderer) => {\n        audioParamConnectionsStore.set(audioParam, { activeInputs: new Set(), passiveInputs: new WeakMap(), renderer: audioParamRenderer });\n    };\n};\n//# sourceMappingURL=add-audio-param-connections.js.map","export const ACTIVE_AUDIO_NODE_STORE = new WeakSet();\nexport const AUDIO_NODE_CONNECTIONS_STORE = new WeakMap();\nexport const AUDIO_NODE_STORE = new WeakMap();\nexport const AUDIO_PARAM_CONNECTIONS_STORE = new WeakMap();\nexport const AUDIO_PARAM_STORE = new WeakMap();\nexport const CONTEXT_STORE = new WeakMap();\nexport const EVENT_LISTENERS = new WeakMap();\nexport const CYCLE_COUNTERS = new WeakMap();\n// This clunky name is borrowed from the spec. :-)\nexport const NODE_NAME_TO_PROCESSOR_CONSTRUCTOR_MAPS = new WeakMap();\nexport const NODE_TO_PROCESSOR_MAPS = new WeakMap();\n//# sourceMappingURL=globals.js.map","const handler = {\n    construct() {\n        return handler;\n    }\n};\nexport const isConstructible = (constructible) => {\n    try {\n        const proxy = new Proxy(constructible, handler);\n        new proxy(); // tslint:disable-line:no-unused-expression\n    }\n    catch {\n        return false;\n    }\n    return true;\n};\n//# sourceMappingURL=is-constructible.js.map","/*\n * This massive regex tries to cover all the following cases.\n *\n * import './path';\n * import defaultImport from './path';\n * import { namedImport } from './path';\n * import { namedImport as renamendImport } from './path';\n * import * as namespaceImport from './path';\n * import defaultImport, { namedImport } from './path';\n * import defaultImport, { namedImport as renamendImport } from './path';\n * import defaultImport, * as namespaceImport from './path';\n */\nconst IMPORT_STATEMENT_REGEX = /^import(?:(?:[\\s]+[\\w]+|(?:[\\s]+[\\w]+[\\s]*,)?[\\s]*\\{[\\s]*[\\w]+(?:[\\s]+as[\\s]+[\\w]+)?(?:[\\s]*,[\\s]*[\\w]+(?:[\\s]+as[\\s]+[\\w]+)?)*[\\s]*}|(?:[\\s]+[\\w]+[\\s]*,)?[\\s]*\\*[\\s]+as[\\s]+[\\w]+)[\\s]+from)?(?:[\\s]*)(\"([^\"\\\\]|\\\\.)+\"|'([^'\\\\]|\\\\.)+')(?:[\\s]*);?/; // tslint:disable-line:max-line-length\nexport const splitImportStatements = (source, url) => {\n    const importStatements = [];\n    let sourceWithoutImportStatements = source.replace(/^[\\s]+/, '');\n    let result = sourceWithoutImportStatements.match(IMPORT_STATEMENT_REGEX);\n    while (result !== null) {\n        const unresolvedUrl = result[1].slice(1, -1);\n        const importStatementWithResolvedUrl = result[0]\n            .replace(/([\\s]+)?;?$/, '')\n            .replace(unresolvedUrl, new URL(unresolvedUrl, url).toString());\n        importStatements.push(importStatementWithResolvedUrl);\n        sourceWithoutImportStatements = sourceWithoutImportStatements.slice(result[0].length).replace(/^[\\s]+/, '');\n        result = sourceWithoutImportStatements.match(IMPORT_STATEMENT_REGEX);\n    }\n    return [importStatements.join(';'), sourceWithoutImportStatements];\n};\n//# sourceMappingURL=split-import-statements.js.map","import { NODE_NAME_TO_PROCESSOR_CONSTRUCTOR_MAPS } from '../globals';\nimport { isConstructible } from '../helpers/is-constructible';\nimport { splitImportStatements } from '../helpers/split-import-statements';\nconst verifyParameterDescriptors = (parameterDescriptors) => {\n    if (parameterDescriptors !== undefined && !Array.isArray(parameterDescriptors)) {\n        throw new TypeError('The parameterDescriptors property of given value for processorCtor is not an array.');\n    }\n};\nconst verifyProcessorCtor = (processorCtor) => {\n    if (!isConstructible(processorCtor)) {\n        throw new TypeError('The given value for processorCtor should be a constructor.');\n    }\n    if (processorCtor.prototype === null || typeof processorCtor.prototype !== 'object') {\n        throw new TypeError('The given value for processorCtor should have a prototype.');\n    }\n};\nexport const createAddAudioWorkletModule = (cacheTestResult, createNotSupportedError, evaluateSource, exposeCurrentFrameAndCurrentTime, fetchSource, getNativeContext, getOrCreateBackupOfflineAudioContext, isNativeOfflineAudioContext, nativeAudioWorkletNodeConstructor, ongoingRequests, resolvedRequests, testAudioWorkletProcessorPostMessageSupport, window) => {\n    let index = 0;\n    return (context, moduleURL, options = { credentials: 'omit' }) => {\n        const resolvedRequestsOfContext = resolvedRequests.get(context);\n        if (resolvedRequestsOfContext !== undefined && resolvedRequestsOfContext.has(moduleURL)) {\n            return Promise.resolve();\n        }\n        const ongoingRequestsOfContext = ongoingRequests.get(context);\n        if (ongoingRequestsOfContext !== undefined) {\n            const promiseOfOngoingRequest = ongoingRequestsOfContext.get(moduleURL);\n            if (promiseOfOngoingRequest !== undefined) {\n                return promiseOfOngoingRequest;\n            }\n        }\n        const nativeContext = getNativeContext(context);\n        // Bug #59: Safari does not implement the audioWorklet property.\n        const promise = nativeContext.audioWorklet === undefined\n            ? fetchSource(moduleURL)\n                .then(([source, absoluteUrl]) => {\n                const [importStatements, sourceWithoutImportStatements] = splitImportStatements(source, absoluteUrl);\n                /*\n                 * This is the unminified version of the code used below:\n                 *\n                 * ```js\n                 * ${ importStatements };\n                 * ((a, b) => {\n                 *     (a[b] = a[b] || [ ]).push(\n                 *         (AudioWorkletProcessor, global, registerProcessor, sampleRate, self, window) => {\n                 *             ${ sourceWithoutImportStatements }\n                 *         }\n                 *     );\n                 * })(window, '_AWGS');\n                 * ```\n                 */\n                // tslint:disable-next-line:max-line-length\n                const wrappedSource = `${importStatements};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${sourceWithoutImportStatements}\n})})(window,'_AWGS')`;\n                // @todo Evaluating the given source code is a possible security problem.\n                return evaluateSource(wrappedSource);\n            })\n                .then(() => {\n                const evaluateAudioWorkletGlobalScope = window._AWGS.pop();\n                if (evaluateAudioWorkletGlobalScope === undefined) {\n                    // Bug #182 Chrome and Edge do throw an instance of a SyntaxError instead of a DOMException.\n                    throw new SyntaxError();\n                }\n                exposeCurrentFrameAndCurrentTime(nativeContext.currentTime, nativeContext.sampleRate, () => evaluateAudioWorkletGlobalScope(class AudioWorkletProcessor {\n                }, undefined, (name, processorCtor) => {\n                    if (name.trim() === '') {\n                        throw createNotSupportedError();\n                    }\n                    const nodeNameToProcessorConstructorMap = NODE_NAME_TO_PROCESSOR_CONSTRUCTOR_MAPS.get(nativeContext);\n                    if (nodeNameToProcessorConstructorMap !== undefined) {\n                        if (nodeNameToProcessorConstructorMap.has(name)) {\n                            throw createNotSupportedError();\n                        }\n                        verifyProcessorCtor(processorCtor);\n                        verifyParameterDescriptors(processorCtor.parameterDescriptors);\n                        nodeNameToProcessorConstructorMap.set(name, processorCtor);\n                    }\n                    else {\n                        verifyProcessorCtor(processorCtor);\n                        verifyParameterDescriptors(processorCtor.parameterDescriptors);\n                        NODE_NAME_TO_PROCESSOR_CONSTRUCTOR_MAPS.set(nativeContext, new Map([[name, processorCtor]]));\n                    }\n                }, nativeContext.sampleRate, undefined, undefined));\n            })\n            : Promise.all([\n                fetchSource(moduleURL),\n                Promise.resolve(cacheTestResult(testAudioWorkletProcessorPostMessageSupport, testAudioWorkletProcessorPostMessageSupport))\n            ]).then(([[source, absoluteUrl], isSupportingPostMessage]) => {\n                const currentIndex = index + 1;\n                index = currentIndex;\n                const [importStatements, sourceWithoutImportStatements] = splitImportStatements(source, absoluteUrl);\n                /*\n                 * Bug #179: Firefox does not allow to transfer any buffer which has been passed to the process() method as an argument.\n                 *\n                 * This is the unminified version of the code used below.\n                 *\n                 * ```js\n                 * class extends AudioWorkletProcessor {\n                 *\n                 *     __buffers = new WeakSet();\n                 *\n                 *     constructor () {\n                 *         super();\n                 *\n                 *         this.port.postMessage = ((postMessage) => {\n                 *             return (message, transferables) => {\n                 *                 const filteredTransferables = (transferables)\n                 *                     ? transferables.filter((transferable) => !this.__buffers.has(transferable))\n                 *                     : transferables;\n                 *\n                 *                 return postMessage.call(this.port, message, filteredTransferables);\n                 *              };\n                 *         })(this.port.postMessage);\n                 *     }\n                 * }\n                 * ```\n                 */\n                const patchedAudioWorkletProcessor = isSupportingPostMessage\n                    ? 'AudioWorkletProcessor'\n                    : 'class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}';\n                /*\n                 * Bug #170: Chrome and Edge do call process() with an array with empty channelData for each input if no input is connected.\n                 *\n                 * Bug #179: Firefox does not allow to transfer any buffer which has been passed to the process() method as an argument.\n                 *\n                 * Bug #190: Safari doesn't throw an error when loading an unparsable module.\n                 *\n                 * This is the unminified version of the code used below:\n                 *\n                 * ```js\n                 * `${ importStatements };\n                 * ((AudioWorkletProcessor, registerProcessor) => {${ sourceWithoutImportStatements }\n                 * })(\n                 *     ${patchedAudioWorkletProcessor },\n                 *     (name, processorCtor) => registerProcessor(name, class extends processorCtor {\n                 *\n                 *         __collectBuffers = (array) => {\n                 *             array.forEach((element) => this.__buffers.add(element.buffer));\n                 *         };\n                 *\n                 *         process (inputs, outputs, parameters) {\n                 *             inputs.forEach(this.__collectBuffers);\n                 *             outputs.forEach(this.__collectBuffers);\n                 *             this.__collectBuffers(Object.values(parameters));\n                 *\n                 *             return super.process(\n                 *                 (inputs.map((input) => input.some((channelData) => channelData.length === 0)) ? [ ] : input),\n                 *                 outputs,\n                 *                 parameters\n                 *             );\n                 *         }\n                 *\n                 *     })\n                 * );\n                 *\n                 * registerProcessor(`__sac${currentIndex}`, class extends AudioWorkletProcessor{\n                 *\n                 *     process () {\n                 *         return false;\n                 *     }\n                 *\n                 * })`\n                 * ```\n                 */\n                const memberDefinition = isSupportingPostMessage ? '' : '__c = (a) => a.forEach(e=>this.__b.add(e.buffer));';\n                const bufferRegistration = isSupportingPostMessage\n                    ? ''\n                    : 'i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));';\n                const wrappedSource = `${importStatements};((AudioWorkletProcessor,registerProcessor)=>{${sourceWithoutImportStatements}\n})(${patchedAudioWorkletProcessor},(n,p)=>registerProcessor(n,class extends p{${memberDefinition}process(i,o,p){${bufferRegistration}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${currentIndex}',class extends AudioWorkletProcessor{process(){return !1}})`;\n                const blob = new Blob([wrappedSource], { type: 'application/javascript; charset=utf-8' });\n                const url = URL.createObjectURL(blob);\n                return nativeContext.audioWorklet\n                    .addModule(url, options)\n                    .then(() => {\n                    if (isNativeOfflineAudioContext(nativeContext)) {\n                        return nativeContext;\n                    }\n                    // Bug #186: Chrome and Edge do not allow to create an AudioWorkletNode on a closed AudioContext.\n                    const backupOfflineAudioContext = getOrCreateBackupOfflineAudioContext(nativeContext);\n                    return backupOfflineAudioContext.audioWorklet.addModule(url, options).then(() => backupOfflineAudioContext);\n                })\n                    .then((nativeContextOrBackupOfflineAudioContext) => {\n                    if (nativeAudioWorkletNodeConstructor === null) {\n                        throw new SyntaxError();\n                    }\n                    try {\n                        // Bug #190: Safari doesn't throw an error when loading an unparsable module.\n                        new nativeAudioWorkletNodeConstructor(nativeContextOrBackupOfflineAudioContext, `__sac${currentIndex}`); // tslint:disable-line:no-unused-expression\n                    }\n                    catch {\n                        throw new SyntaxError();\n                    }\n                })\n                    .finally(() => URL.revokeObjectURL(url));\n            });\n        if (ongoingRequestsOfContext === undefined) {\n            ongoingRequests.set(context, new Map([[moduleURL, promise]]));\n        }\n        else {\n            ongoingRequestsOfContext.set(moduleURL, promise);\n        }\n        promise\n            .then(() => {\n            const updatedResolvedRequestsOfContext = resolvedRequests.get(context);\n            if (updatedResolvedRequestsOfContext === undefined) {\n                resolvedRequests.set(context, new Set([moduleURL]));\n            }\n            else {\n                updatedResolvedRequestsOfContext.add(moduleURL);\n            }\n        })\n            .finally(() => {\n            const updatedOngoingRequestsOfContext = ongoingRequests.get(context);\n            if (updatedOngoingRequestsOfContext !== undefined) {\n                updatedOngoingRequestsOfContext.delete(moduleURL);\n            }\n        });\n        return promise;\n    };\n};\n//# sourceMappingURL=add-audio-worklet-module.js.map","export const getValueForKey = (map, key) => {\n    const value = map.get(key);\n    if (value === undefined) {\n        throw new Error('A value with the given key could not be found.');\n    }\n    return value;\n};\n//# sourceMappingURL=get-value-for-key.js.map","export const pickElementFromSet = (set, predicate) => {\n    const matchingElements = Array.from(set).filter(predicate);\n    if (matchingElements.length > 1) {\n        throw Error('More than one element was found.');\n    }\n    if (matchingElements.length === 0) {\n        throw Error('No element was found.');\n    }\n    const [matchingElement] = matchingElements;\n    set.delete(matchingElement);\n    return matchingElement;\n};\n//# sourceMappingURL=pick-element-from-set.js.map","import { getValueForKey } from './get-value-for-key';\nimport { pickElementFromSet } from './pick-element-from-set';\nexport const deletePassiveInputConnectionToAudioNode = (passiveInputs, source, output, input) => {\n    const passiveInputConnections = getValueForKey(passiveInputs, source);\n    const matchingConnection = pickElementFromSet(passiveInputConnections, (passiveInputConnection) => passiveInputConnection[0] === output && passiveInputConnection[1] === input);\n    if (passiveInputConnections.size === 0) {\n        passiveInputs.delete(source);\n    }\n    return matchingConnection;\n};\n//# sourceMappingURL=delete-passive-input-connection-to-audio-node.js.map","import { EVENT_LISTENERS } from '../globals';\nimport { getValueForKey } from './get-value-for-key';\nexport const getEventListenersOfAudioNode = (audioNode) => {\n    return getValueForKey(EVENT_LISTENERS, audioNode);\n};\n//# sourceMappingURL=get-event-listeners-of-audio-node.js.map","import { ACTIVE_AUDIO_NODE_STORE } from '../globals';\nimport { getEventListenersOfAudioNode } from './get-event-listeners-of-audio-node';\nexport const setInternalStateToActive = (audioNode) => {\n    if (ACTIVE_AUDIO_NODE_STORE.has(audioNode)) {\n        throw new Error('The AudioNode is already stored.');\n    }\n    ACTIVE_AUDIO_NODE_STORE.add(audioNode);\n    getEventListenersOfAudioNode(audioNode).forEach((eventListener) => eventListener(true));\n};\n//# sourceMappingURL=set-internal-state-to-active.js.map","export const isAudioWorkletNode = (audioNode) => {\n    return 'port' in audioNode;\n};\n//# sourceMappingURL=audio-worklet-node.js.map","import { ACTIVE_AUDIO_NODE_STORE } from '../globals';\nimport { getEventListenersOfAudioNode } from './get-event-listeners-of-audio-node';\nexport const setInternalStateToPassive = (audioNode) => {\n    if (!ACTIVE_AUDIO_NODE_STORE.has(audioNode)) {\n        throw new Error('The AudioNode is not stored.');\n    }\n    ACTIVE_AUDIO_NODE_STORE.delete(audioNode);\n    getEventListenersOfAudioNode(audioNode).forEach((eventListener) => eventListener(false));\n};\n//# sourceMappingURL=set-internal-state-to-passive.js.map","import { isAudioWorkletNode } from '../guards/audio-worklet-node';\nimport { setInternalStateToPassive } from './set-internal-state-to-passive';\n// Set the internalState of the audioNode to 'passive' if it is not an AudioWorkletNode and if it has no 'active' input connections.\nexport const setInternalStateToPassiveWhenNecessary = (audioNode, activeInputs) => {\n    if (!isAudioWorkletNode(audioNode) && activeInputs.every((connections) => connections.size === 0)) {\n        setInternalStateToPassive(audioNode);\n    }\n};\n//# sourceMappingURL=set-internal-state-to-passive-when-necessary.js.map","import { deletePassiveInputConnectionToAudioNode } from '../helpers/delete-passive-input-connection-to-audio-node';\nimport { setInternalStateToActive } from '../helpers/set-internal-state-to-active';\nimport { setInternalStateToPassiveWhenNecessary } from '../helpers/set-internal-state-to-passive-when-necessary';\nexport const createAddConnectionToAudioNode = (addActiveInputConnectionToAudioNode, addPassiveInputConnectionToAudioNode, connectNativeAudioNodeToNativeAudioNode, deleteActiveInputConnectionToAudioNode, disconnectNativeAudioNodeFromNativeAudioNode, getAudioNodeConnections, getAudioNodeTailTime, getEventListenersOfAudioNode, getNativeAudioNode, insertElementInSet, isActiveAudioNode, isPartOfACycle, isPassiveAudioNode) => {\n    const tailTimeTimeoutIds = new WeakMap();\n    return (source, destination, output, input, isOffline) => {\n        const { activeInputs, passiveInputs } = getAudioNodeConnections(destination);\n        const { outputs } = getAudioNodeConnections(source);\n        const eventListeners = getEventListenersOfAudioNode(source);\n        const eventListener = (isActive) => {\n            const nativeDestinationAudioNode = getNativeAudioNode(destination);\n            const nativeSourceAudioNode = getNativeAudioNode(source);\n            if (isActive) {\n                const partialConnection = deletePassiveInputConnectionToAudioNode(passiveInputs, source, output, input);\n                addActiveInputConnectionToAudioNode(activeInputs, source, partialConnection, false);\n                if (!isOffline && !isPartOfACycle(source)) {\n                    connectNativeAudioNodeToNativeAudioNode(nativeSourceAudioNode, nativeDestinationAudioNode, output, input);\n                }\n                if (isPassiveAudioNode(destination)) {\n                    setInternalStateToActive(destination);\n                }\n            }\n            else {\n                const partialConnection = deleteActiveInputConnectionToAudioNode(activeInputs, source, output, input);\n                addPassiveInputConnectionToAudioNode(passiveInputs, input, partialConnection, false);\n                if (!isOffline && !isPartOfACycle(source)) {\n                    disconnectNativeAudioNodeFromNativeAudioNode(nativeSourceAudioNode, nativeDestinationAudioNode, output, input);\n                }\n                const tailTime = getAudioNodeTailTime(destination);\n                if (tailTime === 0) {\n                    if (isActiveAudioNode(destination)) {\n                        setInternalStateToPassiveWhenNecessary(destination, activeInputs);\n                    }\n                }\n                else {\n                    const tailTimeTimeoutId = tailTimeTimeoutIds.get(destination);\n                    if (tailTimeTimeoutId !== undefined) {\n                        clearTimeout(tailTimeTimeoutId);\n                    }\n                    tailTimeTimeoutIds.set(destination, setTimeout(() => {\n                        if (isActiveAudioNode(destination)) {\n                            setInternalStateToPassiveWhenNecessary(destination, activeInputs);\n                        }\n                    }, tailTime * 1000));\n                }\n            }\n        };\n        if (insertElementInSet(outputs, [destination, output, input], (outputConnection) => outputConnection[0] === destination && outputConnection[1] === output && outputConnection[2] === input, true)) {\n            eventListeners.add(eventListener);\n            if (isActiveAudioNode(source)) {\n                addActiveInputConnectionToAudioNode(activeInputs, source, [output, input, eventListener], true);\n            }\n            else {\n                addPassiveInputConnectionToAudioNode(passiveInputs, input, [source, output, eventListener], true);\n            }\n            return true;\n        }\n        return false;\n    };\n};\n//# sourceMappingURL=add-connection-to-audio-node.js.map","export const createAddPassiveInputConnectionToAudioNode = (insertElementInSet) => {\n    return (passiveInputs, input, [source, output, eventListener], ignoreDuplicates) => {\n        const passiveInputConnections = passiveInputs.get(source);\n        if (passiveInputConnections === undefined) {\n            passiveInputs.set(source, new Set([[output, input, eventListener]]));\n        }\n        else {\n            insertElementInSet(passiveInputConnections, [output, input, eventListener], (passiveInputConnection) => passiveInputConnection[0] === output && passiveInputConnection[1] === input, ignoreDuplicates);\n        }\n    };\n};\n//# sourceMappingURL=add-passive-input-connection-to-audio-node.js.map","export const createAddSilentConnection = (createNativeGainNode) => {\n    return (nativeContext, nativeAudioScheduledSourceNode) => {\n        const nativeGainNode = createNativeGainNode(nativeContext, {\n            channelCount: 1,\n            channelCountMode: 'explicit',\n            channelInterpretation: 'discrete',\n            gain: 0\n        });\n        nativeAudioScheduledSourceNode.connect(nativeGainNode).connect(nativeContext.destination);\n        const disconnect = () => {\n            nativeAudioScheduledSourceNode.removeEventListener('ended', disconnect);\n            nativeAudioScheduledSourceNode.disconnect(nativeGainNode);\n            nativeGainNode.disconnect();\n        };\n        nativeAudioScheduledSourceNode.addEventListener('ended', disconnect);\n    };\n};\n//# sourceMappingURL=add-silent-connection.js.map","export const createAddUnrenderedAudioWorkletNode = (getUnrenderedAudioWorkletNodes) => {\n    return (nativeContext, audioWorkletNode) => {\n        getUnrenderedAudioWorkletNodes(nativeContext).add(audioWorkletNode);\n    };\n};\n//# sourceMappingURL=add-unrendered-audio-worklet-node.js.map","const DEFAULT_OPTIONS = {\n    channelCount: 2,\n    channelCountMode: 'max',\n    channelInterpretation: 'speakers',\n    fftSize: 2048,\n    maxDecibels: -30,\n    minDecibels: -100,\n    smoothingTimeConstant: 0.8\n};\nexport const createAnalyserNodeConstructor = (audionNodeConstructor, createAnalyserNodeRenderer, createIndexSizeError, createNativeAnalyserNode, getNativeContext, isNativeOfflineAudioContext) => {\n    return class AnalyserNode extends audionNodeConstructor {\n        constructor(context, options) {\n            const nativeContext = getNativeContext(context);\n            const mergedOptions = { ...DEFAULT_OPTIONS, ...options };\n            const nativeAnalyserNode = createNativeAnalyserNode(nativeContext, mergedOptions);\n            const analyserNodeRenderer = ((isNativeOfflineAudioContext(nativeContext) ? createAnalyserNodeRenderer() : null));\n            super(context, false, nativeAnalyserNode, analyserNodeRenderer);\n            this._nativeAnalyserNode = nativeAnalyserNode;\n        }\n        get fftSize() {\n            return this._nativeAnalyserNode.fftSize;\n        }\n        set fftSize(value) {\n            this._nativeAnalyserNode.fftSize = value;\n        }\n        get frequencyBinCount() {\n            return this._nativeAnalyserNode.frequencyBinCount;\n        }\n        get maxDecibels() {\n            return this._nativeAnalyserNode.maxDecibels;\n        }\n        set maxDecibels(value) {\n            // Bug #118: Safari does not throw an error if maxDecibels is not more than minDecibels.\n            const maxDecibels = this._nativeAnalyserNode.maxDecibels;\n            this._nativeAnalyserNode.maxDecibels = value;\n            if (!(value > this._nativeAnalyserNode.minDecibels)) {\n                this._nativeAnalyserNode.maxDecibels = maxDecibels;\n                throw createIndexSizeError();\n            }\n        }\n        get minDecibels() {\n            return this._nativeAnalyserNode.minDecibels;\n        }\n        set minDecibels(value) {\n            // Bug #118: Safari does not throw an error if maxDecibels is not more than minDecibels.\n            const minDecibels = this._nativeAnalyserNode.minDecibels;\n            this._nativeAnalyserNode.minDecibels = value;\n            if (!(this._nativeAnalyserNode.maxDecibels > value)) {\n                this._nativeAnalyserNode.minDecibels = minDecibels;\n                throw createIndexSizeError();\n            }\n        }\n        get smoothingTimeConstant() {\n            return this._nativeAnalyserNode.smoothingTimeConstant;\n        }\n        set smoothingTimeConstant(value) {\n            this._nativeAnalyserNode.smoothingTimeConstant = value;\n        }\n        getByteFrequencyData(array) {\n            this._nativeAnalyserNode.getByteFrequencyData(array);\n        }\n        getByteTimeDomainData(array) {\n            this._nativeAnalyserNode.getByteTimeDomainData(array);\n        }\n        getFloatFrequencyData(array) {\n            this._nativeAnalyserNode.getFloatFrequencyData(array);\n        }\n        getFloatTimeDomainData(array) {\n            this._nativeAnalyserNode.getFloatTimeDomainData(array);\n        }\n    };\n};\n//# sourceMappingURL=analyser-node-constructor.js.map","export const isOwnedByContext = (nativeAudioNode, nativeContext) => {\n    return nativeAudioNode.context === nativeContext;\n};\n//# sourceMappingURL=is-owned-by-context.js.map","import { isOwnedByContext } from '../helpers/is-owned-by-context';\nexport const createAnalyserNodeRendererFactory = (createNativeAnalyserNode, getNativeAudioNode, renderInputsOfAudioNode) => {\n    return () => {\n        const renderedNativeAnalyserNodes = new WeakMap();\n        const createAnalyserNode = async (proxy, nativeOfflineAudioContext) => {\n            let nativeAnalyserNode = getNativeAudioNode(proxy);\n            // If the initially used nativeAnalyserNode was not constructed on the same OfflineAudioContext it needs to be created again.\n            const nativeAnalyserNodeIsOwnedByContext = isOwnedByContext(nativeAnalyserNode, nativeOfflineAudioContext);\n            if (!nativeAnalyserNodeIsOwnedByContext) {\n                const options = {\n                    channelCount: nativeAnalyserNode.channelCount,\n                    channelCountMode: nativeAnalyserNode.channelCountMode,\n                    channelInterpretation: nativeAnalyserNode.channelInterpretation,\n                    fftSize: nativeAnalyserNode.fftSize,\n                    maxDecibels: nativeAnalyserNode.maxDecibels,\n                    minDecibels: nativeAnalyserNode.minDecibels,\n                    smoothingTimeConstant: nativeAnalyserNode.smoothingTimeConstant\n                };\n                nativeAnalyserNode = createNativeAnalyserNode(nativeOfflineAudioContext, options);\n            }\n            renderedNativeAnalyserNodes.set(nativeOfflineAudioContext, nativeAnalyserNode);\n            await renderInputsOfAudioNode(proxy, nativeOfflineAudioContext, nativeAnalyserNode);\n            return nativeAnalyserNode;\n        };\n        return {\n            render(proxy, nativeOfflineAudioContext) {\n                const renderedNativeAnalyserNode = renderedNativeAnalyserNodes.get(nativeOfflineAudioContext);\n                if (renderedNativeAnalyserNode !== undefined) {\n                    return Promise.resolve(renderedNativeAnalyserNode);\n                }\n                return createAnalyserNode(proxy, nativeOfflineAudioContext);\n            }\n        };\n    };\n};\n//# sourceMappingURL=analyser-node-renderer-factory.js.map","export const testAudioBufferCopyChannelMethodsOutOfBoundsSupport = (nativeAudioBuffer) => {\n    try {\n        nativeAudioBuffer.copyToChannel(new Float32Array(1), 0, -1);\n    }\n    catch {\n        return false;\n    }\n    return true;\n};\n//# sourceMappingURL=test-audio-buffer-copy-channel-methods-out-of-bounds-support.js.map","export const createIndexSizeError = () => new DOMException('', 'IndexSizeError');\n//# sourceMappingURL=index-size-error.js.map","import { createIndexSizeError } from '../factories/index-size-error';\nexport const wrapAudioBufferGetChannelDataMethod = (audioBuffer) => {\n    audioBuffer.getChannelData = ((getChannelData) => {\n        return (channel) => {\n            try {\n                return getChannelData.call(audioBuffer, channel);\n            }\n            catch (err) {\n                if (err.code === 12) {\n                    throw createIndexSizeError();\n                }\n                throw err;\n            }\n        };\n    })(audioBuffer.getChannelData);\n};\n//# sourceMappingURL=wrap-audio-buffer-get-channel-data-method.js.map","import { testAudioBufferCopyChannelMethodsOutOfBoundsSupport } from '../helpers/test-audio-buffer-copy-channel-methods-out-of-bounds-support';\nimport { wrapAudioBufferGetChannelDataMethod } from '../helpers/wrap-audio-buffer-get-channel-data-method';\nconst DEFAULT_OPTIONS = {\n    numberOfChannels: 1\n};\nexport const createAudioBufferConstructor = (audioBufferStore, cacheTestResult, createNotSupportedError, nativeAudioBufferConstructor, nativeOfflineAudioContextConstructor, testNativeAudioBufferConstructorSupport, wrapAudioBufferCopyChannelMethods, wrapAudioBufferCopyChannelMethodsOutOfBounds) => {\n    let nativeOfflineAudioContext = null;\n    return class AudioBuffer {\n        constructor(options) {\n            if (nativeOfflineAudioContextConstructor === null) {\n                throw new Error('Missing the native OfflineAudioContext constructor.');\n            }\n            const { length, numberOfChannels, sampleRate } = { ...DEFAULT_OPTIONS, ...options };\n            if (nativeOfflineAudioContext === null) {\n                nativeOfflineAudioContext = new nativeOfflineAudioContextConstructor(1, 1, 44100);\n            }\n            /*\n             * Bug #99: Firefox does not throw a NotSupportedError when the numberOfChannels is zero. But it only does it when using the\n             * factory function. But since Firefox also supports the constructor everything should be fine.\n             */\n            const audioBuffer = nativeAudioBufferConstructor !== null &&\n                cacheTestResult(testNativeAudioBufferConstructorSupport, testNativeAudioBufferConstructorSupport)\n                ? new nativeAudioBufferConstructor({ length, numberOfChannels, sampleRate })\n                : nativeOfflineAudioContext.createBuffer(numberOfChannels, length, sampleRate);\n            // Bug #99: Safari does not throw an error when the numberOfChannels is zero.\n            if (audioBuffer.numberOfChannels === 0) {\n                throw createNotSupportedError();\n            }\n            // Bug #5: Safari does not support copyFromChannel() and copyToChannel().\n            // Bug #100: Safari does throw a wrong error when calling getChannelData() with an out-of-bounds value.\n            if (typeof audioBuffer.copyFromChannel !== 'function') {\n                wrapAudioBufferCopyChannelMethods(audioBuffer);\n                wrapAudioBufferGetChannelDataMethod(audioBuffer);\n                // Bug #157: Firefox does not allow the bufferOffset to be out-of-bounds.\n            }\n            else if (!cacheTestResult(testAudioBufferCopyChannelMethodsOutOfBoundsSupport, () => testAudioBufferCopyChannelMethodsOutOfBoundsSupport(audioBuffer))) {\n                wrapAudioBufferCopyChannelMethodsOutOfBounds(audioBuffer);\n            }\n            audioBufferStore.add(audioBuffer);\n            /*\n             * This does violate all good pratices but it is necessary to allow this AudioBuffer to be used with native\n             * (Offline)AudioContexts.\n             */\n            return audioBuffer;\n        }\n        static [Symbol.hasInstance](instance) {\n            return ((instance !== null && typeof instance === 'object' && Object.getPrototypeOf(instance) === AudioBuffer.prototype) ||\n                audioBufferStore.has(instance));\n        }\n    };\n};\n//# sourceMappingURL=audio-buffer-constructor.js.map","export const MOST_NEGATIVE_SINGLE_FLOAT = -3.4028234663852886e38;\nexport const MOST_POSITIVE_SINGLE_FLOAT = -MOST_NEGATIVE_SINGLE_FLOAT;\n//# sourceMappingURL=constants.js.map","import { ACTIVE_AUDIO_NODE_STORE } from '../globals';\nexport const isActiveAudioNode = (audioNode) => ACTIVE_AUDIO_NODE_STORE.has(audioNode);\n//# sourceMappingURL=is-active-audio-node.js.map","import { MOST_NEGATIVE_SINGLE_FLOAT, MOST_POSITIVE_SINGLE_FLOAT } from '../constants';\nimport { isActiveAudioNode } from '../helpers/is-active-audio-node';\nimport { setInternalStateToActive } from '../helpers/set-internal-state-to-active';\nimport { setInternalStateToPassive } from '../helpers/set-internal-state-to-passive';\nconst DEFAULT_OPTIONS = {\n    buffer: null,\n    channelCount: 2,\n    channelCountMode: 'max',\n    channelInterpretation: 'speakers',\n    // Bug #149: Safari does not yet support the detune AudioParam.\n    loop: false,\n    loopEnd: 0,\n    loopStart: 0,\n    playbackRate: 1\n};\nexport const createAudioBufferSourceNodeConstructor = (audioNodeConstructor, createAudioBufferSourceNodeRenderer, createAudioParam, createInvalidStateError, createNativeAudioBufferSourceNode, getNativeContext, isNativeOfflineAudioContext, wrapEventListener) => {\n    return class AudioBufferSourceNode extends audioNodeConstructor {\n        constructor(context, options) {\n            const nativeContext = getNativeContext(context);\n            const mergedOptions = { ...DEFAULT_OPTIONS, ...options };\n            const nativeAudioBufferSourceNode = createNativeAudioBufferSourceNode(nativeContext, mergedOptions);\n            const isOffline = isNativeOfflineAudioContext(nativeContext);\n            const audioBufferSourceNodeRenderer = ((isOffline ? createAudioBufferSourceNodeRenderer() : null));\n            super(context, false, nativeAudioBufferSourceNode, audioBufferSourceNodeRenderer);\n            this._audioBufferSourceNodeRenderer = audioBufferSourceNodeRenderer;\n            this._isBufferNullified = false;\n            this._isBufferSet = mergedOptions.buffer !== null;\n            this._nativeAudioBufferSourceNode = nativeAudioBufferSourceNode;\n            this._onended = null;\n            // Bug #73: Safari does not export the correct values for maxValue and minValue.\n            this._playbackRate = createAudioParam(this, isOffline, nativeAudioBufferSourceNode.playbackRate, MOST_POSITIVE_SINGLE_FLOAT, MOST_NEGATIVE_SINGLE_FLOAT);\n        }\n        get buffer() {\n            if (this._isBufferNullified) {\n                return null;\n            }\n            return this._nativeAudioBufferSourceNode.buffer;\n        }\n        set buffer(value) {\n            this._nativeAudioBufferSourceNode.buffer = value;\n            // Bug #72: Only Chrome & Edge do not allow to reassign the buffer yet.\n            if (value !== null) {\n                if (this._isBufferSet) {\n                    throw createInvalidStateError();\n                }\n                this._isBufferSet = true;\n            }\n        }\n        get loop() {\n            return this._nativeAudioBufferSourceNode.loop;\n        }\n        set loop(value) {\n            this._nativeAudioBufferSourceNode.loop = value;\n        }\n        get loopEnd() {\n            return this._nativeAudioBufferSourceNode.loopEnd;\n        }\n        set loopEnd(value) {\n            this._nativeAudioBufferSourceNode.loopEnd = value;\n        }\n        get loopStart() {\n            return this._nativeAudioBufferSourceNode.loopStart;\n        }\n        set loopStart(value) {\n            this._nativeAudioBufferSourceNode.loopStart = value;\n        }\n        get onended() {\n            return this._onended;\n        }\n        set onended(value) {\n            const wrappedListener = typeof value === 'function' ? wrapEventListener(this, value) : null;\n            this._nativeAudioBufferSourceNode.onended = wrappedListener;\n            const nativeOnEnded = this._nativeAudioBufferSourceNode.onended;\n            this._onended = nativeOnEnded !== null && nativeOnEnded === wrappedListener ? value : nativeOnEnded;\n        }\n        get playbackRate() {\n            return this._playbackRate;\n        }\n        start(when = 0, offset = 0, duration) {\n            this._nativeAudioBufferSourceNode.start(when, offset, duration);\n            if (this._audioBufferSourceNodeRenderer !== null) {\n                this._audioBufferSourceNodeRenderer.start = duration === undefined ? [when, offset] : [when, offset, duration];\n            }\n            if (this.context.state !== 'closed') {\n                setInternalStateToActive(this);\n                const resetInternalStateToPassive = () => {\n                    this._nativeAudioBufferSourceNode.removeEventListener('ended', resetInternalStateToPassive);\n                    if (isActiveAudioNode(this)) {\n                        setInternalStateToPassive(this);\n                    }\n                };\n                this._nativeAudioBufferSourceNode.addEventListener('ended', resetInternalStateToPassive);\n            }\n        }\n        stop(when = 0) {\n            this._nativeAudioBufferSourceNode.stop(when);\n            if (this._audioBufferSourceNodeRenderer !== null) {\n                this._audioBufferSourceNodeRenderer.stop = when;\n            }\n        }\n    };\n};\n//# sourceMappingURL=audio-buffer-source-node-constructor.js.map","import { isOwnedByContext } from '../helpers/is-owned-by-context';\nexport const createAudioBufferSourceNodeRendererFactory = (connectAudioParam, createNativeAudioBufferSourceNode, getNativeAudioNode, renderAutomation, renderInputsOfAudioNode) => {\n    return () => {\n        const renderedNativeAudioBufferSourceNodes = new WeakMap();\n        let start = null;\n        let stop = null;\n        const createAudioBufferSourceNode = async (proxy, nativeOfflineAudioContext) => {\n            let nativeAudioBufferSourceNode = getNativeAudioNode(proxy);\n            /*\n             * If the initially used nativeAudioBufferSourceNode was not constructed on the same OfflineAudioContext it needs to be created\n             * again.\n             */\n            const nativeAudioBufferSourceNodeIsOwnedByContext = isOwnedByContext(nativeAudioBufferSourceNode, nativeOfflineAudioContext);\n            if (!nativeAudioBufferSourceNodeIsOwnedByContext) {\n                const options = {\n                    buffer: nativeAudioBufferSourceNode.buffer,\n                    channelCount: nativeAudioBufferSourceNode.channelCount,\n                    channelCountMode: nativeAudioBufferSourceNode.channelCountMode,\n                    channelInterpretation: nativeAudioBufferSourceNode.channelInterpretation,\n                    // Bug #149: Safari does not yet support the detune AudioParam.\n                    loop: nativeAudioBufferSourceNode.loop,\n                    loopEnd: nativeAudioBufferSourceNode.loopEnd,\n                    loopStart: nativeAudioBufferSourceNode.loopStart,\n                    playbackRate: nativeAudioBufferSourceNode.playbackRate.value\n                };\n                nativeAudioBufferSourceNode = createNativeAudioBufferSourceNode(nativeOfflineAudioContext, options);\n                if (start !== null) {\n                    nativeAudioBufferSourceNode.start(...start);\n                }\n                if (stop !== null) {\n                    nativeAudioBufferSourceNode.stop(stop);\n                }\n            }\n            renderedNativeAudioBufferSourceNodes.set(nativeOfflineAudioContext, nativeAudioBufferSourceNode);\n            if (!nativeAudioBufferSourceNodeIsOwnedByContext) {\n                // Bug #149: Safari does not yet support the detune AudioParam.\n                await renderAutomation(nativeOfflineAudioContext, proxy.playbackRate, nativeAudioBufferSourceNode.playbackRate);\n            }\n            else {\n                // Bug #149: Safari does not yet support the detune AudioParam.\n                await connectAudioParam(nativeOfflineAudioContext, proxy.playbackRate, nativeAudioBufferSourceNode.playbackRate);\n            }\n            await renderInputsOfAudioNode(proxy, nativeOfflineAudioContext, nativeAudioBufferSourceNode);\n            return nativeAudioBufferSourceNode;\n        };\n        return {\n            set start(value) {\n                start = value;\n            },\n            set stop(value) {\n                stop = value;\n            },\n            render(proxy, nativeOfflineAudioContext) {\n                const renderedNativeAudioBufferSourceNode = renderedNativeAudioBufferSourceNodes.get(nativeOfflineAudioContext);\n                if (renderedNativeAudioBufferSourceNode !== undefined) {\n                    return Promise.resolve(renderedNativeAudioBufferSourceNode);\n                }\n                return createAudioBufferSourceNode(proxy, nativeOfflineAudioContext);\n            }\n        };\n    };\n};\n//# sourceMappingURL=audio-buffer-source-node-renderer-factory.js.map","export const isAudioBufferSourceNode = (audioNode) => {\n    return 'playbackRate' in audioNode;\n};\n//# sourceMappingURL=audio-buffer-source-node.js.map","export const isBiquadFilterNode = (audioNode) => {\n    return 'frequency' in audioNode && 'gain' in audioNode;\n};\n//# sourceMappingURL=biquad-filter-node.js.map","export const isConstantSourceNode = (audioNode) => {\n    return 'offset' in audioNode;\n};\n//# sourceMappingURL=constant-source-node.js.map","export const isGainNode = (audioNode) => {\n    return !('frequency' in audioNode) && 'gain' in audioNode;\n};\n//# sourceMappingURL=gain-node.js.map","export const isOscillatorNode = (audioNode) => {\n    return 'detune' in audioNode && 'frequency' in audioNode && !('gain' in audioNode);\n};\n//# sourceMappingURL=oscillator-node.js.map","export const isStereoPannerNode = (audioNode) => {\n    return 'pan' in audioNode;\n};\n//# sourceMappingURL=stereo-panner-node.js.map","import { AUDIO_NODE_CONNECTIONS_STORE } from '../globals';\nimport { getValueForKey } from './get-value-for-key';\nexport const getAudioNodeConnections = (audioNode) => {\n    return getValueForKey(AUDIO_NODE_CONNECTIONS_STORE, audioNode);\n};\n//# sourceMappingURL=get-audio-node-connections.js.map","import { AUDIO_PARAM_CONNECTIONS_STORE } from '../globals';\nimport { getValueForKey } from './get-value-for-key';\nexport const getAudioParamConnections = (audioParam) => {\n    return getValueForKey(AUDIO_PARAM_CONNECTIONS_STORE, audioParam);\n};\n//# sourceMappingURL=get-audio-param-connections.js.map","import { isAudioBufferSourceNode } from '../guards/audio-buffer-source-node';\nimport { isAudioWorkletNode } from '../guards/audio-worklet-node';\nimport { isBiquadFilterNode } from '../guards/biquad-filter-node';\nimport { isConstantSourceNode } from '../guards/constant-source-node';\nimport { isGainNode } from '../guards/gain-node';\nimport { isOscillatorNode } from '../guards/oscillator-node';\nimport { isStereoPannerNode } from '../guards/stereo-panner-node';\nimport { getAudioNodeConnections } from './get-audio-node-connections';\nimport { getAudioParamConnections } from './get-audio-param-connections';\nimport { isActiveAudioNode } from './is-active-audio-node';\nimport { setInternalStateToPassive } from './set-internal-state-to-passive';\nexport const deactivateActiveAudioNodeInputConnections = (audioNode, trace) => {\n    const { activeInputs } = getAudioNodeConnections(audioNode);\n    activeInputs.forEach((connections) => connections.forEach(([source]) => {\n        if (!trace.includes(audioNode)) {\n            deactivateActiveAudioNodeInputConnections(source, [...trace, audioNode]);\n        }\n    }));\n    const audioParams = isAudioBufferSourceNode(audioNode)\n        ? [\n            // Bug #149: Safari does not yet support the detune AudioParam.\n            audioNode.playbackRate\n        ]\n        : isAudioWorkletNode(audioNode)\n            ? Array.from(audioNode.parameters.values())\n            : isBiquadFilterNode(audioNode)\n                ? [audioNode.Q, audioNode.detune, audioNode.frequency, audioNode.gain]\n                : isConstantSourceNode(audioNode)\n                    ? [audioNode.offset]\n                    : isGainNode(audioNode)\n                        ? [audioNode.gain]\n                        : isOscillatorNode(audioNode)\n                            ? [audioNode.detune, audioNode.frequency]\n                            : isStereoPannerNode(audioNode)\n                                ? [audioNode.pan]\n                                : [];\n    for (const audioParam of audioParams) {\n        const audioParamConnections = getAudioParamConnections(audioParam);\n        if (audioParamConnections !== undefined) {\n            audioParamConnections.activeInputs.forEach(([source]) => deactivateActiveAudioNodeInputConnections(source, trace));\n        }\n    }\n    if (isActiveAudioNode(audioNode)) {\n        setInternalStateToPassive(audioNode);\n    }\n};\n//# sourceMappingURL=deactivate-active-audio-node-input-connections.js.map","import { deactivateActiveAudioNodeInputConnections } from './deactivate-active-audio-node-input-connections';\nexport const deactivateAudioGraph = (context) => {\n    deactivateActiveAudioNodeInputConnections(context.destination, []);\n};\n//# sourceMappingURL=deactivate-audio-graph.js.map","export const isValidLatencyHint = (latencyHint) => {\n    return (latencyHint === undefined ||\n        typeof latencyHint === 'number' ||\n        (typeof latencyHint === 'string' && (latencyHint === 'balanced' || latencyHint === 'interactive' || latencyHint === 'playback')));\n};\n//# sourceMappingURL=is-valid-latency-hint.js.map","import { deactivateAudioGraph } from '../helpers/deactivate-audio-graph';\nimport { isValidLatencyHint } from '../helpers/is-valid-latency-hint';\nexport const createAudioContextConstructor = (baseAudioContextConstructor, createInvalidStateError, createNotSupportedError, createUnknownError, mediaElementAudioSourceNodeConstructor, mediaStreamAudioDestinationNodeConstructor, mediaStreamAudioSourceNodeConstructor, mediaStreamTrackAudioSourceNodeConstructor, nativeAudioContextConstructor) => {\n    return class AudioContext extends baseAudioContextConstructor {\n        constructor(options = {}) {\n            if (nativeAudioContextConstructor === null) {\n                throw new Error('Missing the native AudioContext constructor.');\n            }\n            let nativeAudioContext;\n            try {\n                nativeAudioContext = new nativeAudioContextConstructor(options);\n            }\n            catch (err) {\n                // Bug #192 Safari does throw a SyntaxError if the sampleRate is not supported.\n                if (err.code === 12 && err.message === 'sampleRate is not in range') {\n                    throw createNotSupportedError();\n                }\n                throw err;\n            }\n            // Bug #131 Safari returns null when there are four other AudioContexts running already.\n            if (nativeAudioContext === null) {\n                throw createUnknownError();\n            }\n            // Bug #51 Only Chrome and Edge throw an error if the given latencyHint is invalid.\n            if (!isValidLatencyHint(options.latencyHint)) {\n                throw new TypeError(`The provided value '${options.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);\n            }\n            // Bug #150 Safari does not support setting the sampleRate.\n            if (options.sampleRate !== undefined && nativeAudioContext.sampleRate !== options.sampleRate) {\n                throw createNotSupportedError();\n            }\n            super(nativeAudioContext, 2);\n            const { latencyHint } = options;\n            const { sampleRate } = nativeAudioContext;\n            // @todo The values for 'balanced', 'interactive' and 'playback' are just copied from Chrome's implementation.\n            this._baseLatency =\n                typeof nativeAudioContext.baseLatency === 'number'\n                    ? nativeAudioContext.baseLatency\n                    : latencyHint === 'balanced'\n                        ? 512 / sampleRate\n                        : latencyHint === 'interactive' || latencyHint === undefined\n                            ? 256 / sampleRate\n                            : latencyHint === 'playback'\n                                ? 1024 / sampleRate\n                                : /*\n                                   * @todo The min (256) and max (16384) values are taken from the allowed bufferSize values of a\n                                   * ScriptProcessorNode.\n                                   */\n                                    (Math.max(2, Math.min(128, Math.round((latencyHint * sampleRate) / 128))) * 128) / sampleRate;\n            this._nativeAudioContext = nativeAudioContext;\n            // Bug #188: Safari will set the context's state to 'interrupted' in case the user switches tabs.\n            if (nativeAudioContextConstructor.name === 'webkitAudioContext') {\n                this._nativeGainNode = nativeAudioContext.createGain();\n                this._nativeOscillatorNode = nativeAudioContext.createOscillator();\n                this._nativeGainNode.gain.value = 1e-37;\n                this._nativeOscillatorNode.connect(this._nativeGainNode).connect(nativeAudioContext.destination);\n                this._nativeOscillatorNode.start();\n            }\n            else {\n                this._nativeGainNode = null;\n                this._nativeOscillatorNode = null;\n            }\n            this._state = null;\n            /*\n             * Bug #34: Chrome and Edge pretend to be running right away, but fire an onstatechange event when the state actually changes\n             * to 'running'.\n             */\n            if (nativeAudioContext.state === 'running') {\n                this._state = 'suspended';\n                const revokeState = () => {\n                    if (this._state === 'suspended') {\n                        this._state = null;\n                    }\n                    nativeAudioContext.removeEventListener('statechange', revokeState);\n                };\n                nativeAudioContext.addEventListener('statechange', revokeState);\n            }\n        }\n        get baseLatency() {\n            return this._baseLatency;\n        }\n        get state() {\n            return this._state !== null ? this._state : this._nativeAudioContext.state;\n        }\n        close() {\n            // Bug #35: Firefox does not throw an error if the AudioContext was closed before.\n            if (this.state === 'closed') {\n                return this._nativeAudioContext.close().then(() => {\n                    throw createInvalidStateError();\n                });\n            }\n            // Bug #34: If the state was set to suspended before it should be revoked now.\n            if (this._state === 'suspended') {\n                this._state = null;\n            }\n            return this._nativeAudioContext.close().then(() => {\n                if (this._nativeGainNode !== null && this._nativeOscillatorNode !== null) {\n                    this._nativeOscillatorNode.stop();\n                    this._nativeGainNode.disconnect();\n                    this._nativeOscillatorNode.disconnect();\n                }\n                deactivateAudioGraph(this);\n            });\n        }\n        createMediaElementSource(mediaElement) {\n            return new mediaElementAudioSourceNodeConstructor(this, { mediaElement });\n        }\n        createMediaStreamDestination() {\n            return new mediaStreamAudioDestinationNodeConstructor(this);\n        }\n        createMediaStreamSource(mediaStream) {\n            return new mediaStreamAudioSourceNodeConstructor(this, { mediaStream });\n        }\n        createMediaStreamTrackSource(mediaStreamTrack) {\n            return new mediaStreamTrackAudioSourceNodeConstructor(this, { mediaStreamTrack });\n        }\n        resume() {\n            if (this._state === 'suspended') {\n                return new Promise((resolve, reject) => {\n                    const resolvePromise = () => {\n                        this._nativeAudioContext.removeEventListener('statechange', resolvePromise);\n                        if (this._nativeAudioContext.state === 'running') {\n                            resolve();\n                        }\n                        else {\n                            this.resume().then(resolve, reject);\n                        }\n                    };\n                    this._nativeAudioContext.addEventListener('statechange', resolvePromise);\n                });\n            }\n            return this._nativeAudioContext.resume().catch((err) => {\n                // Bug #55: Chrome and Edge do throw an InvalidAccessError instead of an InvalidStateError.\n                // Bug #56: Safari invokes the catch handler but without an error.\n                if (err === undefined || err.code === 15) {\n                    throw createInvalidStateError();\n                }\n                throw err;\n            });\n        }\n        suspend() {\n            return this._nativeAudioContext.suspend().catch((err) => {\n                // Bug #56: Safari invokes the catch handler but without an error.\n                if (err === undefined) {\n                    throw createInvalidStateError();\n                }\n                throw err;\n            });\n        }\n    };\n};\n//# sourceMappingURL=audio-context-constructor.js.map","export const createAudioDestinationNodeConstructor = (audioNodeConstructor, createAudioDestinationNodeRenderer, createIndexSizeError, createInvalidStateError, createNativeAudioDestinationNode, getNativeContext, isNativeOfflineAudioContext, renderInputsOfAudioNode) => {\n    return class AudioDestinationNode extends audioNodeConstructor {\n        constructor(context, channelCount) {\n            const nativeContext = getNativeContext(context);\n            const isOffline = isNativeOfflineAudioContext(nativeContext);\n            const nativeAudioDestinationNode = createNativeAudioDestinationNode(nativeContext, channelCount, isOffline);\n            const audioDestinationNodeRenderer = ((isOffline ? createAudioDestinationNodeRenderer(renderInputsOfAudioNode) : null));\n            super(context, false, nativeAudioDestinationNode, audioDestinationNodeRenderer);\n            this._isNodeOfNativeOfflineAudioContext = isOffline;\n            this._nativeAudioDestinationNode = nativeAudioDestinationNode;\n        }\n        get channelCount() {\n            return this._nativeAudioDestinationNode.channelCount;\n        }\n        set channelCount(value) {\n            // Bug #52: Chrome, Edge & Safari do not throw an exception at all.\n            // Bug #54: Firefox does throw an IndexSizeError.\n            if (this._isNodeOfNativeOfflineAudioContext) {\n                throw createInvalidStateError();\n            }\n            // Bug #47: The AudioDestinationNode in Safari does not initialize the maxChannelCount property correctly.\n            if (value > this._nativeAudioDestinationNode.maxChannelCount) {\n                throw createIndexSizeError();\n            }\n            this._nativeAudioDestinationNode.channelCount = value;\n        }\n        get channelCountMode() {\n            return this._nativeAudioDestinationNode.channelCountMode;\n        }\n        set channelCountMode(value) {\n            // Bug #53: No browser does throw an exception yet.\n            if (this._isNodeOfNativeOfflineAudioContext) {\n                throw createInvalidStateError();\n            }\n            this._nativeAudioDestinationNode.channelCountMode = value;\n        }\n        get maxChannelCount() {\n            return this._nativeAudioDestinationNode.maxChannelCount;\n        }\n    };\n};\n//# sourceMappingURL=audio-destination-node-constructor.js.map","export const createAudioDestinationNodeRenderer = (renderInputsOfAudioNode) => {\n    const renderedNativeAudioDestinationNodes = new WeakMap();\n    const createAudioDestinationNode = async (proxy, nativeOfflineAudioContext) => {\n        const nativeAudioDestinationNode = nativeOfflineAudioContext.destination;\n        renderedNativeAudioDestinationNodes.set(nativeOfflineAudioContext, nativeAudioDestinationNode);\n        await renderInputsOfAudioNode(proxy, nativeOfflineAudioContext, nativeAudioDestinationNode);\n        return nativeAudioDestinationNode;\n    };\n    return {\n        render(proxy, nativeOfflineAudioContext) {\n            const renderedNativeAudioDestinationNode = renderedNativeAudioDestinationNodes.get(nativeOfflineAudioContext);\n            if (renderedNativeAudioDestinationNode !== undefined) {\n                return Promise.resolve(renderedNativeAudioDestinationNode);\n            }\n            return createAudioDestinationNode(proxy, nativeOfflineAudioContext);\n        }\n    };\n};\n//# sourceMappingURL=audio-destination-node-renderer-factory.js.map","import { MOST_NEGATIVE_SINGLE_FLOAT, MOST_POSITIVE_SINGLE_FLOAT } from '../constants';\nexport const createAudioListenerFactory = (createAudioParam, createNativeChannelMergerNode, createNativeConstantSourceNode, createNativeScriptProcessorNode, createNotSupportedError, getFirstSample, isNativeOfflineAudioContext, overwriteAccessors) => {\n    return (context, nativeContext) => {\n        const nativeListener = nativeContext.listener;\n        // Bug #117: Only Chrome & Edge support the new interface already.\n        const createFakeAudioParams = () => {\n            const buffer = new Float32Array(1);\n            const channelMergerNode = createNativeChannelMergerNode(nativeContext, {\n                channelCount: 1,\n                channelCountMode: 'explicit',\n                channelInterpretation: 'speakers',\n                numberOfInputs: 9\n            });\n            const isOffline = isNativeOfflineAudioContext(nativeContext);\n            let isScriptProcessorNodeCreated = false;\n            let lastOrientation = [0, 0, -1, 0, 1, 0];\n            let lastPosition = [0, 0, 0];\n            const createScriptProcessorNode = () => {\n                if (isScriptProcessorNodeCreated) {\n                    return;\n                }\n                isScriptProcessorNodeCreated = true;\n                const scriptProcessorNode = createNativeScriptProcessorNode(nativeContext, 256, 9, 0);\n                // tslint:disable-next-line:deprecation\n                scriptProcessorNode.onaudioprocess = ({ inputBuffer }) => {\n                    const orientation = [\n                        getFirstSample(inputBuffer, buffer, 0),\n                        getFirstSample(inputBuffer, buffer, 1),\n                        getFirstSample(inputBuffer, buffer, 2),\n                        getFirstSample(inputBuffer, buffer, 3),\n                        getFirstSample(inputBuffer, buffer, 4),\n                        getFirstSample(inputBuffer, buffer, 5)\n                    ];\n                    if (orientation.some((value, index) => value !== lastOrientation[index])) {\n                        nativeListener.setOrientation(...orientation); // tslint:disable-line:deprecation\n                        lastOrientation = orientation;\n                    }\n                    const positon = [\n                        getFirstSample(inputBuffer, buffer, 6),\n                        getFirstSample(inputBuffer, buffer, 7),\n                        getFirstSample(inputBuffer, buffer, 8)\n                    ];\n                    if (positon.some((value, index) => value !== lastPosition[index])) {\n                        nativeListener.setPosition(...positon); // tslint:disable-line:deprecation\n                        lastPosition = positon;\n                    }\n                };\n                channelMergerNode.connect(scriptProcessorNode);\n            };\n            const createSetOrientation = (index) => (value) => {\n                if (value !== lastOrientation[index]) {\n                    lastOrientation[index] = value;\n                    nativeListener.setOrientation(...lastOrientation); // tslint:disable-line:deprecation\n                }\n            };\n            const createSetPosition = (index) => (value) => {\n                if (value !== lastPosition[index]) {\n                    lastPosition[index] = value;\n                    nativeListener.setPosition(...lastPosition); // tslint:disable-line:deprecation\n                }\n            };\n            const createFakeAudioParam = (input, initialValue, setValue) => {\n                const constantSourceNode = createNativeConstantSourceNode(nativeContext, {\n                    channelCount: 1,\n                    channelCountMode: 'explicit',\n                    channelInterpretation: 'discrete',\n                    offset: initialValue\n                });\n                constantSourceNode.connect(channelMergerNode, 0, input);\n                // @todo This should be stopped when the context is closed.\n                constantSourceNode.start();\n                Object.defineProperty(constantSourceNode.offset, 'defaultValue', {\n                    get() {\n                        return initialValue;\n                    }\n                });\n                /*\n                 * Bug #62 & #74: Safari does not support ConstantSourceNodes and does not export the correct values for maxValue and\n                 * minValue for GainNodes.\n                 */\n                const audioParam = createAudioParam({ context }, isOffline, constantSourceNode.offset, MOST_POSITIVE_SINGLE_FLOAT, MOST_NEGATIVE_SINGLE_FLOAT);\n                overwriteAccessors(audioParam, 'value', (get) => () => get.call(audioParam), (set) => (value) => {\n                    try {\n                        set.call(audioParam, value);\n                    }\n                    catch (err) {\n                        if (err.code !== 9) {\n                            throw err;\n                        }\n                    }\n                    createScriptProcessorNode();\n                    if (isOffline) {\n                        // Bug #117: Using setOrientation() and setPosition() doesn't work with an OfflineAudioContext.\n                        setValue(value);\n                    }\n                });\n                audioParam.cancelAndHoldAtTime = ((cancelAndHoldAtTime) => {\n                    if (isOffline) {\n                        return () => {\n                            throw createNotSupportedError();\n                        };\n                    }\n                    return (...args) => {\n                        const value = cancelAndHoldAtTime.apply(audioParam, args);\n                        createScriptProcessorNode();\n                        return value;\n                    };\n                })(audioParam.cancelAndHoldAtTime);\n                audioParam.cancelScheduledValues = ((cancelScheduledValues) => {\n                    if (isOffline) {\n                        return () => {\n                            throw createNotSupportedError();\n                        };\n                    }\n                    return (...args) => {\n                        const value = cancelScheduledValues.apply(audioParam, args);\n                        createScriptProcessorNode();\n                        return value;\n                    };\n                })(audioParam.cancelScheduledValues);\n                audioParam.exponentialRampToValueAtTime = ((exponentialRampToValueAtTime) => {\n                    if (isOffline) {\n                        return () => {\n                            throw createNotSupportedError();\n                        };\n                    }\n                    return (...args) => {\n                        const value = exponentialRampToValueAtTime.apply(audioParam, args);\n                        createScriptProcessorNode();\n                        return value;\n                    };\n                })(audioParam.exponentialRampToValueAtTime);\n                audioParam.linearRampToValueAtTime = ((linearRampToValueAtTime) => {\n                    if (isOffline) {\n                        return () => {\n                            throw createNotSupportedError();\n                        };\n                    }\n                    return (...args) => {\n                        const value = linearRampToValueAtTime.apply(audioParam, args);\n                        createScriptProcessorNode();\n                        return value;\n                    };\n                })(audioParam.linearRampToValueAtTime);\n                audioParam.setTargetAtTime = ((setTargetAtTime) => {\n                    if (isOffline) {\n                        return () => {\n                            throw createNotSupportedError();\n                        };\n                    }\n                    return (...args) => {\n                        const value = setTargetAtTime.apply(audioParam, args);\n                        createScriptProcessorNode();\n                        return value;\n                    };\n                })(audioParam.setTargetAtTime);\n                audioParam.setValueAtTime = ((setValueAtTime) => {\n                    if (isOffline) {\n                        return () => {\n                            throw createNotSupportedError();\n                        };\n                    }\n                    return (...args) => {\n                        const value = setValueAtTime.apply(audioParam, args);\n                        createScriptProcessorNode();\n                        return value;\n                    };\n                })(audioParam.setValueAtTime);\n                audioParam.setValueCurveAtTime = ((setValueCurveAtTime) => {\n                    if (isOffline) {\n                        return () => {\n                            throw createNotSupportedError();\n                        };\n                    }\n                    return (...args) => {\n                        const value = setValueCurveAtTime.apply(audioParam, args);\n                        createScriptProcessorNode();\n                        return value;\n                    };\n                })(audioParam.setValueCurveAtTime);\n                return audioParam;\n            };\n            return {\n                forwardX: createFakeAudioParam(0, 0, createSetOrientation(0)),\n                forwardY: createFakeAudioParam(1, 0, createSetOrientation(1)),\n                forwardZ: createFakeAudioParam(2, -1, createSetOrientation(2)),\n                positionX: createFakeAudioParam(6, 0, createSetPosition(0)),\n                positionY: createFakeAudioParam(7, 0, createSetPosition(1)),\n                positionZ: createFakeAudioParam(8, 0, createSetPosition(2)),\n                upX: createFakeAudioParam(3, 0, createSetOrientation(3)),\n                upY: createFakeAudioParam(4, 1, createSetOrientation(4)),\n                upZ: createFakeAudioParam(5, 0, createSetOrientation(5))\n            };\n        };\n        const { forwardX, forwardY, forwardZ, positionX, positionY, positionZ, upX, upY, upZ } = nativeListener.forwardX === undefined ? createFakeAudioParams() : nativeListener;\n        return {\n            get forwardX() {\n                return forwardX;\n            },\n            get forwardY() {\n                return forwardY;\n            },\n            get forwardZ() {\n                return forwardZ;\n            },\n            get positionX() {\n                return positionX;\n            },\n            get positionY() {\n                return positionY;\n            },\n            get positionZ() {\n                return positionZ;\n            },\n            get upX() {\n                return upX;\n            },\n            get upY() {\n                return upY;\n            },\n            get upZ() {\n                return upZ;\n            }\n        };\n    };\n};\n//# sourceMappingURL=audio-listener-factory.js.map","export const isAudioNode = (audioNodeOrAudioParam) => {\n    return 'context' in audioNodeOrAudioParam;\n};\n//# sourceMappingURL=audio-node.js.map","import { isAudioNode } from './audio-node';\nexport const isAudioNodeOutputConnection = (outputConnection) => {\n    return isAudioNode(outputConnection[0]);\n};\n//# sourceMappingURL=audio-node-output-connection.js.map","export const insertElementInSet = (set, element, predicate, ignoreDuplicates) => {\n    for (const lmnt of set) {\n        if (predicate(lmnt)) {\n            if (ignoreDuplicates) {\n                return false;\n            }\n            throw Error('The set contains at least one similar element.');\n        }\n    }\n    set.add(element);\n    return true;\n};\n//# sourceMappingURL=insert-element-in-set.js.map","import { insertElementInSet } from './insert-element-in-set';\nexport const addActiveInputConnectionToAudioParam = (activeInputs, source, [output, eventListener], ignoreDuplicates) => {\n    insertElementInSet(activeInputs, [source, output, eventListener], (activeInputConnection) => activeInputConnection[0] === source && activeInputConnection[1] === output, ignoreDuplicates);\n};\n//# sourceMappingURL=add-active-input-connection-to-audio-param.js.map","import { insertElementInSet } from './insert-element-in-set';\nexport const addPassiveInputConnectionToAudioParam = (passiveInputs, [source, output, eventListener], ignoreDuplicates) => {\n    const passiveInputConnections = passiveInputs.get(source);\n    if (passiveInputConnections === undefined) {\n        passiveInputs.set(source, new Set([[output, eventListener]]));\n    }\n    else {\n        insertElementInSet(passiveInputConnections, [output, eventListener], (passiveInputConnection) => passiveInputConnection[0] === output, ignoreDuplicates);\n    }\n};\n//# sourceMappingURL=add-passive-input-connection-to-audio-param.js.map","export const isNativeAudioNodeFaker = (nativeAudioNodeOrNativeAudioNodeFaker) => {\n    return 'inputs' in nativeAudioNodeOrNativeAudioNodeFaker;\n};\n//# sourceMappingURL=native-audio-node-faker.js.map","import { isNativeAudioNodeFaker } from '../guards/native-audio-node-faker';\nexport const connectNativeAudioNodeToNativeAudioNode = (nativeSourceAudioNode, nativeDestinationAudioNode, output, input) => {\n    if (isNativeAudioNodeFaker(nativeDestinationAudioNode)) {\n        const fakeNativeDestinationAudioNode = nativeDestinationAudioNode.inputs[input];\n        nativeSourceAudioNode.connect(fakeNativeDestinationAudioNode, output, 0);\n        return [fakeNativeDestinationAudioNode, output, 0];\n    }\n    nativeSourceAudioNode.connect(nativeDestinationAudioNode, output, input);\n    return [nativeDestinationAudioNode, output, input];\n};\n//# sourceMappingURL=connect-native-audio-node-to-native-audio-node.js.map","export const deleteActiveInputConnection = (activeInputConnections, source, output) => {\n    for (const activeInputConnection of activeInputConnections) {\n        if (activeInputConnection[0] === source && activeInputConnection[1] === output) {\n            activeInputConnections.delete(activeInputConnection);\n            return activeInputConnection;\n        }\n    }\n    return null;\n};\n//# sourceMappingURL=delete-active-input-connection.js.map","import { pickElementFromSet } from './pick-element-from-set';\nexport const deleteActiveInputConnectionToAudioParam = (activeInputs, source, output) => {\n    return pickElementFromSet(activeInputs, (activeInputConnection) => activeInputConnection[0] === source && activeInputConnection[1] === output);\n};\n//# sourceMappingURL=delete-active-input-connection-to-audio-param.js.map","import { getEventListenersOfAudioNode } from './get-event-listeners-of-audio-node';\nexport const deleteEventListenerOfAudioNode = (audioNode, eventListener) => {\n    const eventListeners = getEventListenersOfAudioNode(audioNode);\n    if (!eventListeners.delete(eventListener)) {\n        throw new Error('Missing the expected event listener.');\n    }\n};\n//# sourceMappingURL=delete-event-listeners-of-audio-node.js.map","import { getValueForKey } from './get-value-for-key';\nimport { pickElementFromSet } from './pick-element-from-set';\nexport const deletePassiveInputConnectionToAudioParam = (passiveInputs, source, output) => {\n    const passiveInputConnections = getValueForKey(passiveInputs, source);\n    const matchingConnection = pickElementFromSet(passiveInputConnections, (passiveInputConnection) => passiveInputConnection[0] === output);\n    if (passiveInputConnections.size === 0) {\n        passiveInputs.delete(source);\n    }\n    return matchingConnection;\n};\n//# sourceMappingURL=delete-passive-input-connection-to-audio-param.js.map","import { isNativeAudioNodeFaker } from '../guards/native-audio-node-faker';\nexport const disconnectNativeAudioNodeFromNativeAudioNode = (nativeSourceAudioNode, nativeDestinationAudioNode, output, input) => {\n    if (isNativeAudioNodeFaker(nativeDestinationAudioNode)) {\n        nativeSourceAudioNode.disconnect(nativeDestinationAudioNode.inputs[input], output, 0);\n    }\n    else {\n        nativeSourceAudioNode.disconnect(nativeDestinationAudioNode, output, input);\n    }\n};\n//# sourceMappingURL=disconnect-native-audio-node-from-native-audio-node.js.map","import { AUDIO_NODE_STORE } from '../globals';\nimport { getValueForKey } from './get-value-for-key';\nexport const getNativeAudioNode = (audioNode) => {\n    return getValueForKey(AUDIO_NODE_STORE, audioNode);\n};\n//# sourceMappingURL=get-native-audio-node.js.map","import { AUDIO_PARAM_STORE } from '../globals';\nimport { getValueForKey } from './get-value-for-key';\nexport const getNativeAudioParam = (audioParam) => {\n    return getValueForKey(AUDIO_PARAM_STORE, audioParam);\n};\n//# sourceMappingURL=get-native-audio-param.js.map","import { CYCLE_COUNTERS } from '../globals';\nexport const isPartOfACycle = (audioNode) => {\n    return CYCLE_COUNTERS.has(audioNode);\n};\n//# sourceMappingURL=is-part-of-a-cycle.js.map","import { ACTIVE_AUDIO_NODE_STORE } from '../globals';\nexport const isPassiveAudioNode = (audioNode) => {\n    return !ACTIVE_AUDIO_NODE_STORE.has(audioNode);\n};\n//# sourceMappingURL=is-passive-audio-node.js.map","export const testAudioNodeDisconnectMethodSupport = (nativeAudioContext, nativeAudioWorkletNodeConstructor) => {\n    return new Promise((resolve) => {\n        /*\n         * This bug existed in Safari up until v14.0.2. Since AudioWorklets were not supported in Safari until v14.1 the presence of the\n         * constructor for an AudioWorkletNode can be used here to skip the test.\n         */\n        if (nativeAudioWorkletNodeConstructor !== null) {\n            resolve(true);\n        }\n        else {\n            const analyzer = nativeAudioContext.createScriptProcessor(256, 1, 1); // tslint:disable-line deprecation\n            const dummy = nativeAudioContext.createGain();\n            // Bug #95: Safari does not play one sample buffers.\n            const ones = nativeAudioContext.createBuffer(1, 2, 44100);\n            const channelData = ones.getChannelData(0);\n            channelData[0] = 1;\n            channelData[1] = 1;\n            const source = nativeAudioContext.createBufferSource();\n            source.buffer = ones;\n            source.loop = true;\n            source.connect(analyzer).connect(nativeAudioContext.destination);\n            source.connect(dummy);\n            source.disconnect(dummy);\n            // tslint:disable-next-line:deprecation\n            analyzer.onaudioprocess = (event) => {\n                const chnnlDt = event.inputBuffer.getChannelData(0); // tslint:disable-line deprecation\n                if (Array.prototype.some.call(chnnlDt, (sample) => sample === 1)) {\n                    resolve(true);\n                }\n                else {\n                    resolve(false);\n                }\n                source.stop();\n                analyzer.onaudioprocess = null; // tslint:disable-line:deprecation\n                source.disconnect(analyzer);\n                analyzer.disconnect(nativeAudioContext.destination);\n            };\n            source.start();\n        }\n    });\n};\n//# sourceMappingURL=test-audio-node-disconnect-method-support.js.map","export const visitEachAudioNodeOnce = (cycles, visitor) => {\n    const counts = new Map();\n    for (const cycle of cycles) {\n        for (const audioNode of cycle) {\n            const count = counts.get(audioNode);\n            counts.set(audioNode, count === undefined ? 1 : count + 1);\n        }\n    }\n    counts.forEach((count, audioNode) => visitor(audioNode, count));\n};\n//# sourceMappingURL=visit-each-audio-node-once.js.map","export const isNativeAudioNode = (nativeAudioNodeOrAudioParam) => {\n    return 'context' in nativeAudioNodeOrAudioParam;\n};\n//# sourceMappingURL=native-audio-node.js.map","import { isNativeAudioNode } from '../guards/native-audio-node';\nexport const wrapAudioNodeDisconnectMethod = (nativeAudioNode) => {\n    const connections = new Map();\n    nativeAudioNode.connect = ((connect) => {\n        // tslint:disable-next-line:invalid-void no-inferrable-types\n        return (destination, output = 0, input = 0) => {\n            const returnValue = isNativeAudioNode(destination) ? connect(destination, output, input) : connect(destination, output);\n            // Save the new connection only if the calls to connect above didn't throw an error.\n            const connectionsToDestination = connections.get(destination);\n            if (connectionsToDestination === undefined) {\n                connections.set(destination, [{ input, output }]);\n            }\n            else {\n                if (connectionsToDestination.every((connection) => connection.input !== input || connection.output !== output)) {\n                    connectionsToDestination.push({ input, output });\n                }\n            }\n            return returnValue;\n        };\n    })(nativeAudioNode.connect.bind(nativeAudioNode));\n    nativeAudioNode.disconnect = ((disconnect) => {\n        return (destinationOrOutput, output, input) => {\n            disconnect.apply(nativeAudioNode);\n            if (destinationOrOutput === undefined) {\n                connections.clear();\n            }\n            else if (typeof destinationOrOutput === 'number') {\n                for (const [destination, connectionsToDestination] of connections) {\n                    const filteredConnections = connectionsToDestination.filter((connection) => connection.output !== destinationOrOutput);\n                    if (filteredConnections.length === 0) {\n                        connections.delete(destination);\n                    }\n                    else {\n                        connections.set(destination, filteredConnections);\n                    }\n                }\n            }\n            else if (connections.has(destinationOrOutput)) {\n                if (output === undefined) {\n                    connections.delete(destinationOrOutput);\n                }\n                else {\n                    const connectionsToDestination = connections.get(destinationOrOutput);\n                    if (connectionsToDestination !== undefined) {\n                        const filteredConnections = connectionsToDestination.filter((connection) => connection.output !== output && (connection.input !== input || input === undefined));\n                        if (filteredConnections.length === 0) {\n                            connections.delete(destinationOrOutput);\n                        }\n                        else {\n                            connections.set(destinationOrOutput, filteredConnections);\n                        }\n                    }\n                }\n            }\n            for (const [destination, connectionsToDestination] of connections) {\n                connectionsToDestination.forEach((connection) => {\n                    if (isNativeAudioNode(destination)) {\n                        nativeAudioNode.connect(destination, connection.output, connection.input);\n                    }\n                    else {\n                        nativeAudioNode.connect(destination, connection.output);\n                    }\n                });\n            }\n        };\n    })(nativeAudioNode.disconnect);\n};\n//# sourceMappingURL=wrap-audio-node-disconnect-method.js.map","import { AUDIO_NODE_STORE, EVENT_LISTENERS } from '../globals';\nimport { isAudioNode } from '../guards/audio-node';\nimport { isAudioNodeOutputConnection } from '../guards/audio-node-output-connection';\nimport { addActiveInputConnectionToAudioParam } from '../helpers/add-active-input-connection-to-audio-param';\nimport { addPassiveInputConnectionToAudioParam } from '../helpers/add-passive-input-connection-to-audio-param';\nimport { connectNativeAudioNodeToNativeAudioNode } from '../helpers/connect-native-audio-node-to-native-audio-node';\nimport { deleteActiveInputConnection } from '../helpers/delete-active-input-connection';\nimport { deleteActiveInputConnectionToAudioParam } from '../helpers/delete-active-input-connection-to-audio-param';\nimport { deleteEventListenerOfAudioNode } from '../helpers/delete-event-listeners-of-audio-node';\nimport { deletePassiveInputConnectionToAudioNode } from '../helpers/delete-passive-input-connection-to-audio-node';\nimport { deletePassiveInputConnectionToAudioParam } from '../helpers/delete-passive-input-connection-to-audio-param';\nimport { disconnectNativeAudioNodeFromNativeAudioNode } from '../helpers/disconnect-native-audio-node-from-native-audio-node';\nimport { getAudioNodeConnections } from '../helpers/get-audio-node-connections';\nimport { getAudioParamConnections } from '../helpers/get-audio-param-connections';\nimport { getEventListenersOfAudioNode } from '../helpers/get-event-listeners-of-audio-node';\nimport { getNativeAudioNode } from '../helpers/get-native-audio-node';\nimport { getNativeAudioParam } from '../helpers/get-native-audio-param';\nimport { insertElementInSet } from '../helpers/insert-element-in-set';\nimport { isActiveAudioNode } from '../helpers/is-active-audio-node';\nimport { isPartOfACycle } from '../helpers/is-part-of-a-cycle';\nimport { isPassiveAudioNode } from '../helpers/is-passive-audio-node';\nimport { setInternalStateToActive } from '../helpers/set-internal-state-to-active';\nimport { setInternalStateToPassiveWhenNecessary } from '../helpers/set-internal-state-to-passive-when-necessary';\nimport { testAudioNodeDisconnectMethodSupport } from '../helpers/test-audio-node-disconnect-method-support';\nimport { visitEachAudioNodeOnce } from '../helpers/visit-each-audio-node-once';\nimport { wrapAudioNodeDisconnectMethod } from '../helpers/wrap-audio-node-disconnect-method';\nconst addConnectionToAudioParamOfAudioContext = (source, destination, output, isOffline) => {\n    const { activeInputs, passiveInputs } = getAudioParamConnections(destination);\n    const { outputs } = getAudioNodeConnections(source);\n    const eventListeners = getEventListenersOfAudioNode(source);\n    const eventListener = (isActive) => {\n        const nativeAudioNode = getNativeAudioNode(source);\n        const nativeAudioParam = getNativeAudioParam(destination);\n        if (isActive) {\n            const partialConnection = deletePassiveInputConnectionToAudioParam(passiveInputs, source, output);\n            addActiveInputConnectionToAudioParam(activeInputs, source, partialConnection, false);\n            if (!isOffline && !isPartOfACycle(source)) {\n                nativeAudioNode.connect(nativeAudioParam, output);\n            }\n        }\n        else {\n            const partialConnection = deleteActiveInputConnectionToAudioParam(activeInputs, source, output);\n            addPassiveInputConnectionToAudioParam(passiveInputs, partialConnection, false);\n            if (!isOffline && !isPartOfACycle(source)) {\n                nativeAudioNode.disconnect(nativeAudioParam, output);\n            }\n        }\n    };\n    if (insertElementInSet(outputs, [destination, output], (outputConnection) => outputConnection[0] === destination && outputConnection[1] === output, true)) {\n        eventListeners.add(eventListener);\n        if (isActiveAudioNode(source)) {\n            addActiveInputConnectionToAudioParam(activeInputs, source, [output, eventListener], true);\n        }\n        else {\n            addPassiveInputConnectionToAudioParam(passiveInputs, [source, output, eventListener], true);\n        }\n        return true;\n    }\n    return false;\n};\nconst deleteInputConnectionOfAudioNode = (source, destination, output, input) => {\n    const { activeInputs, passiveInputs } = getAudioNodeConnections(destination);\n    const activeInputConnection = deleteActiveInputConnection(activeInputs[input], source, output);\n    if (activeInputConnection === null) {\n        const passiveInputConnection = deletePassiveInputConnectionToAudioNode(passiveInputs, source, output, input);\n        return [passiveInputConnection[2], false];\n    }\n    return [activeInputConnection[2], true];\n};\nconst deleteInputConnectionOfAudioParam = (source, destination, output) => {\n    const { activeInputs, passiveInputs } = getAudioParamConnections(destination);\n    const activeInputConnection = deleteActiveInputConnection(activeInputs, source, output);\n    if (activeInputConnection === null) {\n        const passiveInputConnection = deletePassiveInputConnectionToAudioParam(passiveInputs, source, output);\n        return [passiveInputConnection[1], false];\n    }\n    return [activeInputConnection[2], true];\n};\nconst deleteInputsOfAudioNode = (source, isOffline, destination, output, input) => {\n    const [listener, isActive] = deleteInputConnectionOfAudioNode(source, destination, output, input);\n    if (listener !== null) {\n        deleteEventListenerOfAudioNode(source, listener);\n        if (isActive && !isOffline && !isPartOfACycle(source)) {\n            disconnectNativeAudioNodeFromNativeAudioNode(getNativeAudioNode(source), getNativeAudioNode(destination), output, input);\n        }\n    }\n    if (isActiveAudioNode(destination)) {\n        const { activeInputs } = getAudioNodeConnections(destination);\n        setInternalStateToPassiveWhenNecessary(destination, activeInputs);\n    }\n};\nconst deleteInputsOfAudioParam = (source, isOffline, destination, output) => {\n    const [listener, isActive] = deleteInputConnectionOfAudioParam(source, destination, output);\n    if (listener !== null) {\n        deleteEventListenerOfAudioNode(source, listener);\n        if (isActive && !isOffline && !isPartOfACycle(source)) {\n            getNativeAudioNode(source).disconnect(getNativeAudioParam(destination), output);\n        }\n    }\n};\nconst deleteAnyConnection = (source, isOffline) => {\n    const audioNodeConnectionsOfSource = getAudioNodeConnections(source);\n    const destinations = [];\n    for (const outputConnection of audioNodeConnectionsOfSource.outputs) {\n        if (isAudioNodeOutputConnection(outputConnection)) {\n            deleteInputsOfAudioNode(source, isOffline, ...outputConnection);\n        }\n        else {\n            deleteInputsOfAudioParam(source, isOffline, ...outputConnection);\n        }\n        destinations.push(outputConnection[0]);\n    }\n    audioNodeConnectionsOfSource.outputs.clear();\n    return destinations;\n};\nconst deleteConnectionAtOutput = (source, isOffline, output) => {\n    const audioNodeConnectionsOfSource = getAudioNodeConnections(source);\n    const destinations = [];\n    for (const outputConnection of audioNodeConnectionsOfSource.outputs) {\n        if (outputConnection[1] === output) {\n            if (isAudioNodeOutputConnection(outputConnection)) {\n                deleteInputsOfAudioNode(source, isOffline, ...outputConnection);\n            }\n            else {\n                deleteInputsOfAudioParam(source, isOffline, ...outputConnection);\n            }\n            destinations.push(outputConnection[0]);\n            audioNodeConnectionsOfSource.outputs.delete(outputConnection);\n        }\n    }\n    return destinations;\n};\nconst deleteConnectionToDestination = (source, isOffline, destination, output, input) => {\n    const audioNodeConnectionsOfSource = getAudioNodeConnections(source);\n    return Array.from(audioNodeConnectionsOfSource.outputs)\n        .filter((outputConnection) => outputConnection[0] === destination &&\n        (output === undefined || outputConnection[1] === output) &&\n        (input === undefined || outputConnection[2] === input))\n        .map((outputConnection) => {\n        if (isAudioNodeOutputConnection(outputConnection)) {\n            deleteInputsOfAudioNode(source, isOffline, ...outputConnection);\n        }\n        else {\n            deleteInputsOfAudioParam(source, isOffline, ...outputConnection);\n        }\n        audioNodeConnectionsOfSource.outputs.delete(outputConnection);\n        return outputConnection[0];\n    });\n};\nexport const createAudioNodeConstructor = (addAudioNodeConnections, addConnectionToAudioNode, cacheTestResult, createIncrementCycleCounter, createIndexSizeError, createInvalidAccessError, createNotSupportedError, decrementCycleCounter, detectCycles, eventTargetConstructor, getNativeContext, isNativeAudioContext, isNativeAudioNode, isNativeAudioParam, isNativeOfflineAudioContext, nativeAudioWorkletNodeConstructor) => {\n    return class AudioNode extends eventTargetConstructor {\n        constructor(context, isActive, nativeAudioNode, audioNodeRenderer) {\n            super(nativeAudioNode);\n            this._context = context;\n            this._nativeAudioNode = nativeAudioNode;\n            const nativeContext = getNativeContext(context);\n            // Bug #12: Safari does not support to disconnect a specific destination.\n            if (isNativeAudioContext(nativeContext) &&\n                true !==\n                    cacheTestResult(testAudioNodeDisconnectMethodSupport, () => {\n                        return testAudioNodeDisconnectMethodSupport(nativeContext, nativeAudioWorkletNodeConstructor);\n                    })) {\n                wrapAudioNodeDisconnectMethod(nativeAudioNode);\n            }\n            AUDIO_NODE_STORE.set(this, nativeAudioNode);\n            EVENT_LISTENERS.set(this, new Set());\n            if (context.state !== 'closed' && isActive) {\n                setInternalStateToActive(this);\n            }\n            addAudioNodeConnections(this, audioNodeRenderer, nativeAudioNode);\n        }\n        get channelCount() {\n            return this._nativeAudioNode.channelCount;\n        }\n        set channelCount(value) {\n            this._nativeAudioNode.channelCount = value;\n        }\n        get channelCountMode() {\n            return this._nativeAudioNode.channelCountMode;\n        }\n        set channelCountMode(value) {\n            this._nativeAudioNode.channelCountMode = value;\n        }\n        get channelInterpretation() {\n            return this._nativeAudioNode.channelInterpretation;\n        }\n        set channelInterpretation(value) {\n            this._nativeAudioNode.channelInterpretation = value;\n        }\n        get context() {\n            return this._context;\n        }\n        get numberOfInputs() {\n            return this._nativeAudioNode.numberOfInputs;\n        }\n        get numberOfOutputs() {\n            return this._nativeAudioNode.numberOfOutputs;\n        }\n        // tslint:disable-next-line:invalid-void\n        connect(destination, output = 0, input = 0) {\n            // Bug #174: Safari does expose a wrong numberOfOutputs for MediaStreamAudioDestinationNodes.\n            if (output < 0 || output >= this._nativeAudioNode.numberOfOutputs) {\n                throw createIndexSizeError();\n            }\n            const nativeContext = getNativeContext(this._context);\n            const isOffline = isNativeOfflineAudioContext(nativeContext);\n            if (isNativeAudioNode(destination) || isNativeAudioParam(destination)) {\n                throw createInvalidAccessError();\n            }\n            if (isAudioNode(destination)) {\n                const nativeDestinationAudioNode = getNativeAudioNode(destination);\n                try {\n                    const connection = connectNativeAudioNodeToNativeAudioNode(this._nativeAudioNode, nativeDestinationAudioNode, output, input);\n                    const isPassive = isPassiveAudioNode(this);\n                    if (isOffline || isPassive) {\n                        this._nativeAudioNode.disconnect(...connection);\n                    }\n                    if (this.context.state !== 'closed' && !isPassive && isPassiveAudioNode(destination)) {\n                        setInternalStateToActive(destination);\n                    }\n                }\n                catch (err) {\n                    // Bug #41: Safari does not throw the correct exception so far.\n                    if (err.code === 12) {\n                        throw createInvalidAccessError();\n                    }\n                    throw err;\n                }\n                const isNewConnectionToAudioNode = addConnectionToAudioNode(this, destination, output, input, isOffline);\n                // Bug #164: Only Firefox detects cycles so far.\n                if (isNewConnectionToAudioNode) {\n                    const cycles = detectCycles([this], destination);\n                    visitEachAudioNodeOnce(cycles, createIncrementCycleCounter(isOffline));\n                }\n                return destination;\n            }\n            const nativeAudioParam = getNativeAudioParam(destination);\n            /*\n             * Bug #73, #147 & #153: Safari does not support to connect an input signal to the playbackRate AudioParam of an\n             * AudioBufferSourceNode. This can't be easily detected and that's why the outdated name property is used here to identify\n             * Safari. In addition to that the maxValue property is used to only detect the affected versions below v14.0.2.\n             */\n            if (nativeAudioParam.name === 'playbackRate' && nativeAudioParam.maxValue === 1024) {\n                throw createNotSupportedError();\n            }\n            try {\n                this._nativeAudioNode.connect(nativeAudioParam, output);\n                if (isOffline || isPassiveAudioNode(this)) {\n                    this._nativeAudioNode.disconnect(nativeAudioParam, output);\n                }\n            }\n            catch (err) {\n                // Bug #58: Safari doesn't throw an InvalidAccessError yet.\n                if (err.code === 12) {\n                    throw createInvalidAccessError();\n                }\n                throw err;\n            }\n            const isNewConnectionToAudioParam = addConnectionToAudioParamOfAudioContext(this, destination, output, isOffline);\n            // Bug #164: Only Firefox detects cycles so far.\n            if (isNewConnectionToAudioParam) {\n                const cycles = detectCycles([this], destination);\n                visitEachAudioNodeOnce(cycles, createIncrementCycleCounter(isOffline));\n            }\n        }\n        disconnect(destinationOrOutput, output, input) {\n            let destinations;\n            const nativeContext = getNativeContext(this._context);\n            const isOffline = isNativeOfflineAudioContext(nativeContext);\n            if (destinationOrOutput === undefined) {\n                destinations = deleteAnyConnection(this, isOffline);\n            }\n            else if (typeof destinationOrOutput === 'number') {\n                if (destinationOrOutput < 0 || destinationOrOutput >= this.numberOfOutputs) {\n                    throw createIndexSizeError();\n                }\n                destinations = deleteConnectionAtOutput(this, isOffline, destinationOrOutput);\n            }\n            else {\n                if (output !== undefined && (output < 0 || output >= this.numberOfOutputs)) {\n                    throw createIndexSizeError();\n                }\n                if (isAudioNode(destinationOrOutput) && input !== undefined && (input < 0 || input >= destinationOrOutput.numberOfInputs)) {\n                    throw createIndexSizeError();\n                }\n                destinations = deleteConnectionToDestination(this, isOffline, destinationOrOutput, output, input);\n                if (destinations.length === 0) {\n                    throw createInvalidAccessError();\n                }\n            }\n            // Bug #164: Only Firefox detects cycles so far.\n            for (const destination of destinations) {\n                const cycles = detectCycles([this], destination);\n                visitEachAudioNodeOnce(cycles, decrementCycleCounter);\n            }\n        }\n    };\n};\n//# sourceMappingURL=audio-node-constructor.js.map","import { AutomationEventList } from 'automation-events';\nexport const createAudioParamFactory = (addAudioParamConnections, audioParamAudioNodeStore, audioParamStore, createAudioParamRenderer, createCancelAndHoldAutomationEvent, createCancelScheduledValuesAutomationEvent, createExponentialRampToValueAutomationEvent, createLinearRampToValueAutomationEvent, createSetTargetAutomationEvent, createSetValueAutomationEvent, createSetValueCurveAutomationEvent, nativeAudioContextConstructor, setValueAtTimeUntilPossible) => {\n    return (audioNode, isAudioParamOfOfflineAudioContext, nativeAudioParam, maxValue = null, minValue = null) => {\n        // Bug #196 Only Safari sets the defaultValue to the initial value.\n        const defaultValue = nativeAudioParam.value;\n        const automationEventList = new AutomationEventList(defaultValue);\n        const audioParamRenderer = isAudioParamOfOfflineAudioContext ? createAudioParamRenderer(automationEventList) : null;\n        const audioParam = {\n            get defaultValue() {\n                return defaultValue;\n            },\n            get maxValue() {\n                return maxValue === null ? nativeAudioParam.maxValue : maxValue;\n            },\n            get minValue() {\n                return minValue === null ? nativeAudioParam.minValue : minValue;\n            },\n            get value() {\n                return nativeAudioParam.value;\n            },\n            set value(value) {\n                nativeAudioParam.value = value;\n                // Bug #98: Firefox & Safari do not yet treat the value setter like a call to setValueAtTime().\n                audioParam.setValueAtTime(value, audioNode.context.currentTime);\n            },\n            cancelAndHoldAtTime(cancelTime) {\n                // Bug #28: Firefox & Safari do not yet implement cancelAndHoldAtTime().\n                if (typeof nativeAudioParam.cancelAndHoldAtTime === 'function') {\n                    if (audioParamRenderer === null) {\n                        automationEventList.flush(audioNode.context.currentTime);\n                    }\n                    automationEventList.add(createCancelAndHoldAutomationEvent(cancelTime));\n                    nativeAudioParam.cancelAndHoldAtTime(cancelTime);\n                }\n                else {\n                    const previousLastEvent = Array.from(automationEventList).pop();\n                    if (audioParamRenderer === null) {\n                        automationEventList.flush(audioNode.context.currentTime);\n                    }\n                    automationEventList.add(createCancelAndHoldAutomationEvent(cancelTime));\n                    const currentLastEvent = Array.from(automationEventList).pop();\n                    nativeAudioParam.cancelScheduledValues(cancelTime);\n                    if (previousLastEvent !== currentLastEvent && currentLastEvent !== undefined) {\n                        if (currentLastEvent.type === 'exponentialRampToValue') {\n                            nativeAudioParam.exponentialRampToValueAtTime(currentLastEvent.value, currentLastEvent.endTime);\n                        }\n                        else if (currentLastEvent.type === 'linearRampToValue') {\n                            nativeAudioParam.linearRampToValueAtTime(currentLastEvent.value, currentLastEvent.endTime);\n                        }\n                        else if (currentLastEvent.type === 'setValue') {\n                            nativeAudioParam.setValueAtTime(currentLastEvent.value, currentLastEvent.startTime);\n                        }\n                        else if (currentLastEvent.type === 'setValueCurve') {\n                            nativeAudioParam.setValueCurveAtTime(currentLastEvent.values, currentLastEvent.startTime, currentLastEvent.duration);\n                        }\n                    }\n                }\n                return audioParam;\n            },\n            cancelScheduledValues(cancelTime) {\n                if (audioParamRenderer === null) {\n                    automationEventList.flush(audioNode.context.currentTime);\n                }\n                automationEventList.add(createCancelScheduledValuesAutomationEvent(cancelTime));\n                nativeAudioParam.cancelScheduledValues(cancelTime);\n                return audioParam;\n            },\n            exponentialRampToValueAtTime(value, endTime) {\n                // Bug #45: Safari does not throw an error yet.\n                if (value === 0) {\n                    throw new RangeError();\n                }\n                // Bug #187: Safari does not throw an error yet.\n                if (!Number.isFinite(endTime) || endTime < 0) {\n                    throw new RangeError();\n                }\n                const currentTime = audioNode.context.currentTime;\n                if (audioParamRenderer === null) {\n                    automationEventList.flush(currentTime);\n                }\n                // Bug #194: Firefox does not implicitly call setValueAtTime() if there is no previous event.\n                if (Array.from(automationEventList).length === 0) {\n                    automationEventList.add(createSetValueAutomationEvent(defaultValue, currentTime));\n                    nativeAudioParam.setValueAtTime(defaultValue, currentTime);\n                }\n                automationEventList.add(createExponentialRampToValueAutomationEvent(value, endTime));\n                nativeAudioParam.exponentialRampToValueAtTime(value, endTime);\n                return audioParam;\n            },\n            linearRampToValueAtTime(value, endTime) {\n                const currentTime = audioNode.context.currentTime;\n                if (audioParamRenderer === null) {\n                    automationEventList.flush(currentTime);\n                }\n                // Bug #195: Firefox does not implicitly call setValueAtTime() if there is no previous event.\n                if (Array.from(automationEventList).length === 0) {\n                    automationEventList.add(createSetValueAutomationEvent(defaultValue, currentTime));\n                    nativeAudioParam.setValueAtTime(defaultValue, currentTime);\n                }\n                automationEventList.add(createLinearRampToValueAutomationEvent(value, endTime));\n                nativeAudioParam.linearRampToValueAtTime(value, endTime);\n                return audioParam;\n            },\n            setTargetAtTime(target, startTime, timeConstant) {\n                if (audioParamRenderer === null) {\n                    automationEventList.flush(audioNode.context.currentTime);\n                }\n                automationEventList.add(createSetTargetAutomationEvent(target, startTime, timeConstant));\n                nativeAudioParam.setTargetAtTime(target, startTime, timeConstant);\n                return audioParam;\n            },\n            setValueAtTime(value, startTime) {\n                if (audioParamRenderer === null) {\n                    automationEventList.flush(audioNode.context.currentTime);\n                }\n                automationEventList.add(createSetValueAutomationEvent(value, startTime));\n                nativeAudioParam.setValueAtTime(value, startTime);\n                return audioParam;\n            },\n            setValueCurveAtTime(values, startTime, duration) {\n                // Bug 183: Safari only accepts a Float32Array.\n                const convertedValues = values instanceof Float32Array ? values : new Float32Array(values);\n                /*\n                 * Bug #152: Safari does not correctly interpolate the values of the curve.\n                 * @todo Unfortunately there is no way to test for this behavior in a synchronous fashion which is why testing for the\n                 * existence of the webkitAudioContext is used as a workaround here.\n                 */\n                if (nativeAudioContextConstructor !== null && nativeAudioContextConstructor.name === 'webkitAudioContext') {\n                    const endTime = startTime + duration;\n                    const sampleRate = audioNode.context.sampleRate;\n                    const firstSample = Math.ceil(startTime * sampleRate);\n                    const lastSample = Math.floor(endTime * sampleRate);\n                    const numberOfInterpolatedValues = lastSample - firstSample;\n                    const interpolatedValues = new Float32Array(numberOfInterpolatedValues);\n                    for (let i = 0; i < numberOfInterpolatedValues; i += 1) {\n                        const theoreticIndex = ((convertedValues.length - 1) / duration) * ((firstSample + i) / sampleRate - startTime);\n                        const lowerIndex = Math.floor(theoreticIndex);\n                        const upperIndex = Math.ceil(theoreticIndex);\n                        interpolatedValues[i] =\n                            lowerIndex === upperIndex\n                                ? convertedValues[lowerIndex]\n                                : (1 - (theoreticIndex - lowerIndex)) * convertedValues[lowerIndex] +\n                                    (1 - (upperIndex - theoreticIndex)) * convertedValues[upperIndex];\n                    }\n                    if (audioParamRenderer === null) {\n                        automationEventList.flush(audioNode.context.currentTime);\n                    }\n                    automationEventList.add(createSetValueCurveAutomationEvent(interpolatedValues, startTime, duration));\n                    nativeAudioParam.setValueCurveAtTime(interpolatedValues, startTime, duration);\n                    const timeOfLastSample = lastSample / sampleRate;\n                    if (timeOfLastSample < endTime) {\n                        setValueAtTimeUntilPossible(audioParam, interpolatedValues[interpolatedValues.length - 1], timeOfLastSample);\n                    }\n                    setValueAtTimeUntilPossible(audioParam, convertedValues[convertedValues.length - 1], endTime);\n                }\n                else {\n                    if (audioParamRenderer === null) {\n                        automationEventList.flush(audioNode.context.currentTime);\n                    }\n                    automationEventList.add(createSetValueCurveAutomationEvent(convertedValues, startTime, duration));\n                    nativeAudioParam.setValueCurveAtTime(convertedValues, startTime, duration);\n                }\n                return audioParam;\n            }\n        };\n        audioParamStore.set(audioParam, nativeAudioParam);\n        audioParamAudioNodeStore.set(audioParam, audioNode);\n        addAudioParamConnections(audioParam, audioParamRenderer);\n        return audioParam;\n    };\n};\n//# sourceMappingURL=audio-param-factory.js.map","export const createAudioParamRenderer = (automationEventList) => {\n    return {\n        replay(audioParam) {\n            for (const automationEvent of automationEventList) {\n                if (automationEvent.type === 'exponentialRampToValue') {\n                    const { endTime, value } = automationEvent;\n                    audioParam.exponentialRampToValueAtTime(value, endTime);\n                }\n                else if (automationEvent.type === 'linearRampToValue') {\n                    const { endTime, value } = automationEvent;\n                    audioParam.linearRampToValueAtTime(value, endTime);\n                }\n                else if (automationEvent.type === 'setTarget') {\n                    const { startTime, target, timeConstant } = automationEvent;\n                    audioParam.setTargetAtTime(target, startTime, timeConstant);\n                }\n                else if (automationEvent.type === 'setValue') {\n                    const { startTime, value } = automationEvent;\n                    audioParam.setValueAtTime(value, startTime);\n                }\n                else if (automationEvent.type === 'setValueCurve') {\n                    const { duration, startTime, values } = automationEvent;\n                    audioParam.setValueCurveAtTime(values, startTime, duration);\n                }\n                else {\n                    throw new Error(\"Can't apply an unknown automation.\");\n                }\n            }\n        }\n    };\n};\n//# sourceMappingURL=audio-param-renderer.js.map","export class ReadOnlyMap {\n    constructor(parameters) {\n        this._map = new Map(parameters);\n    }\n    get size() {\n        return this._map.size;\n    }\n    entries() {\n        return this._map.entries();\n    }\n    forEach(callback, thisArg = null) {\n        return this._map.forEach((value, key) => callback.call(thisArg, value, key, this));\n    }\n    get(name) {\n        return this._map.get(name);\n    }\n    has(name) {\n        return this._map.has(name);\n    }\n    keys() {\n        return this._map.keys();\n    }\n    values() {\n        return this._map.values();\n    }\n}\n//# sourceMappingURL=read-only-map.js.map","import { NODE_NAME_TO_PROCESSOR_CONSTRUCTOR_MAPS } from '../globals';\nimport { ReadOnlyMap } from '../read-only-map';\nconst DEFAULT_OPTIONS = {\n    channelCount: 2,\n    // Bug #61: The channelCountMode should be 'max' according to the spec but is set to 'explicit' to achieve consistent behavior.\n    channelCountMode: 'explicit',\n    channelInterpretation: 'speakers',\n    numberOfInputs: 1,\n    numberOfOutputs: 1,\n    parameterData: {},\n    processorOptions: {}\n};\nexport const createAudioWorkletNodeConstructor = (addUnrenderedAudioWorkletNode, audioNodeConstructor, createAudioParam, createAudioWorkletNodeRenderer, createNativeAudioWorkletNode, getAudioNodeConnections, getBackupOfflineAudioContext, getNativeContext, isNativeOfflineAudioContext, nativeAudioWorkletNodeConstructor, sanitizeAudioWorkletNodeOptions, setActiveAudioWorkletNodeInputs, testAudioWorkletNodeOptionsClonability, wrapEventListener) => {\n    return class AudioWorkletNode extends audioNodeConstructor {\n        constructor(context, name, options) {\n            var _a;\n            const nativeContext = getNativeContext(context);\n            const isOffline = isNativeOfflineAudioContext(nativeContext);\n            const mergedOptions = sanitizeAudioWorkletNodeOptions({ ...DEFAULT_OPTIONS, ...options });\n            // Bug #191: Safari doesn't throw an error if the options aren't clonable.\n            testAudioWorkletNodeOptionsClonability(mergedOptions);\n            const nodeNameToProcessorConstructorMap = NODE_NAME_TO_PROCESSOR_CONSTRUCTOR_MAPS.get(nativeContext);\n            const processorConstructor = nodeNameToProcessorConstructorMap === null || nodeNameToProcessorConstructorMap === void 0 ? void 0 : nodeNameToProcessorConstructorMap.get(name);\n            // Bug #186: Chrome and Edge do not allow to create an AudioWorkletNode on a closed AudioContext.\n            const nativeContextOrBackupOfflineAudioContext = isOffline || nativeContext.state !== 'closed'\n                ? nativeContext\n                : (_a = getBackupOfflineAudioContext(nativeContext)) !== null && _a !== void 0 ? _a : nativeContext;\n            const nativeAudioWorkletNode = createNativeAudioWorkletNode(nativeContextOrBackupOfflineAudioContext, isOffline ? null : context.baseLatency, nativeAudioWorkletNodeConstructor, name, processorConstructor, mergedOptions);\n            const audioWorkletNodeRenderer = ((isOffline ? createAudioWorkletNodeRenderer(name, mergedOptions, processorConstructor) : null));\n            /*\n             * @todo Add a mechanism to switch an AudioWorkletNode to passive once the process() function of the AudioWorkletProcessor\n             * returns false.\n             */\n            super(context, true, nativeAudioWorkletNode, audioWorkletNodeRenderer);\n            const parameters = [];\n            nativeAudioWorkletNode.parameters.forEach((nativeAudioParam, nm) => {\n                const audioParam = createAudioParam(this, isOffline, nativeAudioParam);\n                parameters.push([nm, audioParam]);\n            });\n            this._nativeAudioWorkletNode = nativeAudioWorkletNode;\n            this._onprocessorerror = null;\n            this._parameters = new ReadOnlyMap(parameters);\n            /*\n             * Bug #86 & #87: Invoking the renderer of an AudioWorkletNode might be necessary if it has no direct or indirect connection to\n             * the destination.\n             */\n            if (isOffline) {\n                addUnrenderedAudioWorkletNode(nativeContext, this);\n            }\n            const { activeInputs } = getAudioNodeConnections(this);\n            setActiveAudioWorkletNodeInputs(nativeAudioWorkletNode, activeInputs);\n        }\n        get onprocessorerror() {\n            return this._onprocessorerror;\n        }\n        set onprocessorerror(value) {\n            const wrappedListener = typeof value === 'function' ? wrapEventListener(this, value) : null;\n            this._nativeAudioWorkletNode.onprocessorerror = wrappedListener;\n            const nativeOnProcessorError = this._nativeAudioWorkletNode.onprocessorerror;\n            this._onprocessorerror =\n                nativeOnProcessorError !== null && nativeOnProcessorError === wrappedListener\n                    ? value\n                    : nativeOnProcessorError;\n        }\n        get parameters() {\n            if (this._parameters === null) {\n                // @todo The definition that TypeScript uses of the AudioParamMap is lacking many methods.\n                return this._nativeAudioWorkletNode.parameters;\n            }\n            return this._parameters;\n        }\n        get port() {\n            return this._nativeAudioWorkletNode.port;\n        }\n    };\n};\n//# sourceMappingURL=audio-worklet-node-constructor.js.map","export function copyFromChannel(audioBuffer, \n// @todo There is currently no way to define something like { [ key: number | string ]: Float32Array }\nparent, key, channelNumber, bufferOffset) {\n    if (typeof audioBuffer.copyFromChannel === 'function') {\n        // The byteLength will be 0 when the ArrayBuffer was transferred.\n        if (parent[key].byteLength === 0) {\n            parent[key] = new Float32Array(128);\n        }\n        audioBuffer.copyFromChannel(parent[key], channelNumber, bufferOffset);\n        // Bug #5: Safari does not support copyFromChannel().\n    }\n    else {\n        const channelData = audioBuffer.getChannelData(channelNumber);\n        // The byteLength will be 0 when the ArrayBuffer was transferred.\n        if (parent[key].byteLength === 0) {\n            parent[key] = channelData.slice(bufferOffset, bufferOffset + 128);\n        }\n        else {\n            const slicedInput = new Float32Array(channelData.buffer, bufferOffset * Float32Array.BYTES_PER_ELEMENT, 128);\n            parent[key].set(slicedInput);\n        }\n    }\n}\n//# sourceMappingURL=copy-from-channel.js.map","export const copyToChannel = (audioBuffer, parent, key, channelNumber, bufferOffset) => {\n    if (typeof audioBuffer.copyToChannel === 'function') {\n        // The byteLength will be 0 when the ArrayBuffer was transferred.\n        if (parent[key].byteLength !== 0) {\n            audioBuffer.copyToChannel(parent[key], channelNumber, bufferOffset);\n        }\n        // Bug #5: Safari does not support copyToChannel().\n    }\n    else {\n        // The byteLength will be 0 when the ArrayBuffer was transferred.\n        if (parent[key].byteLength !== 0) {\n            audioBuffer.getChannelData(channelNumber).set(parent[key], bufferOffset);\n        }\n    }\n};\n//# sourceMappingURL=copy-to-channel.js.map","export const createNestedArrays = (x, y) => {\n    const arrays = [];\n    for (let i = 0; i < x; i += 1) {\n        const array = [];\n        const length = typeof y === 'number' ? y : y[i];\n        for (let j = 0; j < length; j += 1) {\n            array.push(new Float32Array(128));\n        }\n        arrays.push(array);\n    }\n    return arrays;\n};\n//# sourceMappingURL=create-nested-arrays.js.map","import { NODE_TO_PROCESSOR_MAPS } from '../globals';\nimport { getNativeAudioNode } from './get-native-audio-node';\nimport { getValueForKey } from './get-value-for-key';\nexport const getAudioWorkletProcessor = (nativeOfflineAudioContext, proxy) => {\n    const nodeToProcessorMap = getValueForKey(NODE_TO_PROCESSOR_MAPS, nativeOfflineAudioContext);\n    const nativeAudioWorkletNode = getNativeAudioNode(proxy);\n    return getValueForKey(nodeToProcessorMap, nativeAudioWorkletNode);\n};\n//# sourceMappingURL=get-audio-worklet-processor.js.map","import { copyFromChannel } from '../helpers/copy-from-channel';\nimport { copyToChannel } from '../helpers/copy-to-channel';\nimport { createNestedArrays } from '../helpers/create-nested-arrays';\nimport { getAudioNodeConnections } from '../helpers/get-audio-node-connections';\nimport { getAudioWorkletProcessor } from '../helpers/get-audio-worklet-processor';\nimport { isOwnedByContext } from '../helpers/is-owned-by-context';\nconst processBuffer = async (proxy, renderedBuffer, nativeOfflineAudioContext, options, outputChannelCount, processorConstructor, exposeCurrentFrameAndCurrentTime) => {\n    // Ceil the length to the next full render quantum.\n    // Bug #17: Safari does not yet expose the length.\n    const length = renderedBuffer === null ? Math.ceil(proxy.context.length / 128) * 128 : renderedBuffer.length;\n    const numberOfInputChannels = options.channelCount * options.numberOfInputs;\n    const numberOfOutputChannels = outputChannelCount.reduce((sum, value) => sum + value, 0);\n    const processedBuffer = numberOfOutputChannels === 0\n        ? null\n        : nativeOfflineAudioContext.createBuffer(numberOfOutputChannels, length, nativeOfflineAudioContext.sampleRate);\n    if (processorConstructor === undefined) {\n        throw new Error('Missing the processor constructor.');\n    }\n    const audioNodeConnections = getAudioNodeConnections(proxy);\n    const audioWorkletProcessor = await getAudioWorkletProcessor(nativeOfflineAudioContext, proxy);\n    const inputs = createNestedArrays(options.numberOfInputs, options.channelCount);\n    const outputs = createNestedArrays(options.numberOfOutputs, outputChannelCount);\n    const parameters = Array.from(proxy.parameters.keys()).reduce((prmtrs, name) => ({ ...prmtrs, [name]: new Float32Array(128) }), {});\n    for (let i = 0; i < length; i += 128) {\n        if (options.numberOfInputs > 0 && renderedBuffer !== null) {\n            for (let j = 0; j < options.numberOfInputs; j += 1) {\n                for (let k = 0; k < options.channelCount; k += 1) {\n                    copyFromChannel(renderedBuffer, inputs[j], k, k, i);\n                }\n            }\n        }\n        if (processorConstructor.parameterDescriptors !== undefined && renderedBuffer !== null) {\n            processorConstructor.parameterDescriptors.forEach(({ name }, index) => {\n                copyFromChannel(renderedBuffer, parameters, name, numberOfInputChannels + index, i);\n            });\n        }\n        for (let j = 0; j < options.numberOfInputs; j += 1) {\n            for (let k = 0; k < outputChannelCount[j]; k += 1) {\n                // The byteLength will be 0 when the ArrayBuffer was transferred.\n                if (outputs[j][k].byteLength === 0) {\n                    outputs[j][k] = new Float32Array(128);\n                }\n            }\n        }\n        try {\n            const potentiallyEmptyInputs = inputs.map((input, index) => {\n                if (audioNodeConnections.activeInputs[index].size === 0) {\n                    return [];\n                }\n                return input;\n            });\n            const activeSourceFlag = exposeCurrentFrameAndCurrentTime(i / nativeOfflineAudioContext.sampleRate, nativeOfflineAudioContext.sampleRate, () => audioWorkletProcessor.process(potentiallyEmptyInputs, outputs, parameters));\n            if (processedBuffer !== null) {\n                for (let j = 0, outputChannelSplitterNodeOutput = 0; j < options.numberOfOutputs; j += 1) {\n                    for (let k = 0; k < outputChannelCount[j]; k += 1) {\n                        copyToChannel(processedBuffer, outputs[j], k, outputChannelSplitterNodeOutput + k, i);\n                    }\n                    outputChannelSplitterNodeOutput += outputChannelCount[j];\n                }\n            }\n            if (!activeSourceFlag) {\n                break;\n            }\n        }\n        catch (error) {\n            proxy.dispatchEvent(new ErrorEvent('processorerror', {\n                colno: error.colno,\n                filename: error.filename,\n                lineno: error.lineno,\n                message: error.message\n            }));\n            break;\n        }\n    }\n    return processedBuffer;\n};\nexport const createAudioWorkletNodeRendererFactory = (connectAudioParam, connectMultipleOutputs, createNativeAudioBufferSourceNode, createNativeChannelMergerNode, createNativeChannelSplitterNode, createNativeConstantSourceNode, createNativeGainNode, deleteUnrenderedAudioWorkletNode, disconnectMultipleOutputs, exposeCurrentFrameAndCurrentTime, getNativeAudioNode, nativeAudioWorkletNodeConstructor, nativeOfflineAudioContextConstructor, renderAutomation, renderInputsOfAudioNode, renderNativeOfflineAudioContext) => {\n    return (name, options, processorConstructor) => {\n        const renderedNativeAudioNodes = new WeakMap();\n        let processedBufferPromise = null;\n        const createAudioNode = async (proxy, nativeOfflineAudioContext) => {\n            let nativeAudioWorkletNode = getNativeAudioNode(proxy);\n            let nativeOutputNodes = null;\n            const nativeAudioWorkletNodeIsOwnedByContext = isOwnedByContext(nativeAudioWorkletNode, nativeOfflineAudioContext);\n            const outputChannelCount = Array.isArray(options.outputChannelCount)\n                ? options.outputChannelCount\n                : Array.from(options.outputChannelCount);\n            // Bug #61: Only Chrome, Edge & Firefox have an implementation of the AudioWorkletNode yet.\n            if (nativeAudioWorkletNodeConstructor === null) {\n                const numberOfOutputChannels = outputChannelCount.reduce((sum, value) => sum + value, 0);\n                const outputChannelSplitterNode = createNativeChannelSplitterNode(nativeOfflineAudioContext, {\n                    channelCount: Math.max(1, numberOfOutputChannels),\n                    channelCountMode: 'explicit',\n                    channelInterpretation: 'discrete',\n                    numberOfOutputs: Math.max(1, numberOfOutputChannels)\n                });\n                const outputChannelMergerNodes = [];\n                for (let i = 0; i < proxy.numberOfOutputs; i += 1) {\n                    outputChannelMergerNodes.push(createNativeChannelMergerNode(nativeOfflineAudioContext, {\n                        channelCount: 1,\n                        channelCountMode: 'explicit',\n                        channelInterpretation: 'speakers',\n                        numberOfInputs: outputChannelCount[i]\n                    }));\n                }\n                const outputGainNode = createNativeGainNode(nativeOfflineAudioContext, {\n                    channelCount: options.channelCount,\n                    channelCountMode: options.channelCountMode,\n                    channelInterpretation: options.channelInterpretation,\n                    gain: 1\n                });\n                outputGainNode.connect = connectMultipleOutputs.bind(null, outputChannelMergerNodes);\n                outputGainNode.disconnect = disconnectMultipleOutputs.bind(null, outputChannelMergerNodes);\n                nativeOutputNodes = [outputChannelSplitterNode, outputChannelMergerNodes, outputGainNode];\n            }\n            else if (!nativeAudioWorkletNodeIsOwnedByContext) {\n                nativeAudioWorkletNode = new nativeAudioWorkletNodeConstructor(nativeOfflineAudioContext, name);\n            }\n            renderedNativeAudioNodes.set(nativeOfflineAudioContext, nativeOutputNodes === null ? nativeAudioWorkletNode : nativeOutputNodes[2]);\n            if (nativeOutputNodes !== null) {\n                if (processedBufferPromise === null) {\n                    if (processorConstructor === undefined) {\n                        throw new Error('Missing the processor constructor.');\n                    }\n                    if (nativeOfflineAudioContextConstructor === null) {\n                        throw new Error('Missing the native OfflineAudioContext constructor.');\n                    }\n                    // Bug #47: The AudioDestinationNode in Safari gets not initialized correctly.\n                    const numberOfInputChannels = proxy.channelCount * proxy.numberOfInputs;\n                    const numberOfParameters = processorConstructor.parameterDescriptors === undefined ? 0 : processorConstructor.parameterDescriptors.length;\n                    const numberOfChannels = numberOfInputChannels + numberOfParameters;\n                    const renderBuffer = async () => {\n                        const partialOfflineAudioContext = new nativeOfflineAudioContextConstructor(numberOfChannels, \n                        // Ceil the length to the next full render quantum.\n                        // Bug #17: Safari does not yet expose the length.\n                        Math.ceil(proxy.context.length / 128) * 128, nativeOfflineAudioContext.sampleRate);\n                        const gainNodes = [];\n                        const inputChannelSplitterNodes = [];\n                        for (let i = 0; i < options.numberOfInputs; i += 1) {\n                            gainNodes.push(createNativeGainNode(partialOfflineAudioContext, {\n                                channelCount: options.channelCount,\n                                channelCountMode: options.channelCountMode,\n                                channelInterpretation: options.channelInterpretation,\n                                gain: 1\n                            }));\n                            inputChannelSplitterNodes.push(createNativeChannelSplitterNode(partialOfflineAudioContext, {\n                                channelCount: options.channelCount,\n                                channelCountMode: 'explicit',\n                                channelInterpretation: 'discrete',\n                                numberOfOutputs: options.channelCount\n                            }));\n                        }\n                        const constantSourceNodes = await Promise.all(Array.from(proxy.parameters.values()).map(async (audioParam) => {\n                            const constantSourceNode = createNativeConstantSourceNode(partialOfflineAudioContext, {\n                                channelCount: 1,\n                                channelCountMode: 'explicit',\n                                channelInterpretation: 'discrete',\n                                offset: audioParam.value\n                            });\n                            await renderAutomation(partialOfflineAudioContext, audioParam, constantSourceNode.offset);\n                            return constantSourceNode;\n                        }));\n                        const inputChannelMergerNode = createNativeChannelMergerNode(partialOfflineAudioContext, {\n                            channelCount: 1,\n                            channelCountMode: 'explicit',\n                            channelInterpretation: 'speakers',\n                            numberOfInputs: Math.max(1, numberOfInputChannels + numberOfParameters)\n                        });\n                        for (let i = 0; i < options.numberOfInputs; i += 1) {\n                            gainNodes[i].connect(inputChannelSplitterNodes[i]);\n                            for (let j = 0; j < options.channelCount; j += 1) {\n                                inputChannelSplitterNodes[i].connect(inputChannelMergerNode, j, i * options.channelCount + j);\n                            }\n                        }\n                        for (const [index, constantSourceNode] of constantSourceNodes.entries()) {\n                            constantSourceNode.connect(inputChannelMergerNode, 0, numberOfInputChannels + index);\n                            constantSourceNode.start(0);\n                        }\n                        inputChannelMergerNode.connect(partialOfflineAudioContext.destination);\n                        await Promise.all(gainNodes.map((gainNode) => renderInputsOfAudioNode(proxy, partialOfflineAudioContext, gainNode)));\n                        return renderNativeOfflineAudioContext(partialOfflineAudioContext);\n                    };\n                    processedBufferPromise = processBuffer(proxy, numberOfChannels === 0 ? null : await renderBuffer(), nativeOfflineAudioContext, options, outputChannelCount, processorConstructor, exposeCurrentFrameAndCurrentTime);\n                }\n                const processedBuffer = await processedBufferPromise;\n                const audioBufferSourceNode = createNativeAudioBufferSourceNode(nativeOfflineAudioContext, {\n                    buffer: null,\n                    channelCount: 2,\n                    channelCountMode: 'max',\n                    channelInterpretation: 'speakers',\n                    loop: false,\n                    loopEnd: 0,\n                    loopStart: 0,\n                    playbackRate: 1\n                });\n                const [outputChannelSplitterNode, outputChannelMergerNodes, outputGainNode] = nativeOutputNodes;\n                if (processedBuffer !== null) {\n                    audioBufferSourceNode.buffer = processedBuffer;\n                    audioBufferSourceNode.start(0);\n                }\n                audioBufferSourceNode.connect(outputChannelSplitterNode);\n                for (let i = 0, outputChannelSplitterNodeOutput = 0; i < proxy.numberOfOutputs; i += 1) {\n                    const outputChannelMergerNode = outputChannelMergerNodes[i];\n                    for (let j = 0; j < outputChannelCount[i]; j += 1) {\n                        outputChannelSplitterNode.connect(outputChannelMergerNode, outputChannelSplitterNodeOutput + j, j);\n                    }\n                    outputChannelSplitterNodeOutput += outputChannelCount[i];\n                }\n                return outputGainNode;\n            }\n            if (!nativeAudioWorkletNodeIsOwnedByContext) {\n                for (const [nm, audioParam] of proxy.parameters.entries()) {\n                    await renderAutomation(nativeOfflineAudioContext, audioParam, \n                    // @todo The definition that TypeScript uses of the AudioParamMap is lacking many methods.\n                    nativeAudioWorkletNode.parameters.get(nm));\n                }\n            }\n            else {\n                for (const [nm, audioParam] of proxy.parameters.entries()) {\n                    await connectAudioParam(nativeOfflineAudioContext, audioParam, \n                    // @todo The definition that TypeScript uses of the AudioParamMap is lacking many methods.\n                    nativeAudioWorkletNode.parameters.get(nm));\n                }\n            }\n            await renderInputsOfAudioNode(proxy, nativeOfflineAudioContext, nativeAudioWorkletNode);\n            return nativeAudioWorkletNode;\n        };\n        return {\n            render(proxy, nativeOfflineAudioContext) {\n                deleteUnrenderedAudioWorkletNode(nativeOfflineAudioContext, proxy);\n                const renderedNativeAudioWorkletNodeOrGainNode = renderedNativeAudioNodes.get(nativeOfflineAudioContext);\n                if (renderedNativeAudioWorkletNodeOrGainNode !== undefined) {\n                    return Promise.resolve(renderedNativeAudioWorkletNodeOrGainNode);\n                }\n                return createAudioNode(proxy, nativeOfflineAudioContext);\n            }\n        };\n    };\n};\n//# sourceMappingURL=audio-worklet-node-renderer-factory.js.map","export const createBaseAudioContextConstructor = (addAudioWorkletModule, analyserNodeConstructor, audioBufferConstructor, audioBufferSourceNodeConstructor, biquadFilterNodeConstructor, channelMergerNodeConstructor, channelSplitterNodeConstructor, constantSourceNodeConstructor, convolverNodeConstructor, decodeAudioData, delayNodeConstructor, dynamicsCompressorNodeConstructor, gainNodeConstructor, iIRFilterNodeConstructor, minimalBaseAudioContextConstructor, oscillatorNodeConstructor, pannerNodeConstructor, periodicWaveConstructor, stereoPannerNodeConstructor, waveShaperNodeConstructor) => {\n    return class BaseAudioContext extends minimalBaseAudioContextConstructor {\n        constructor(_nativeContext, numberOfChannels) {\n            super(_nativeContext, numberOfChannels);\n            this._nativeContext = _nativeContext;\n            this._audioWorklet =\n                addAudioWorkletModule === undefined\n                    ? undefined\n                    : {\n                        addModule: (moduleURL, options) => {\n                            return addAudioWorkletModule(this, moduleURL, options);\n                        }\n                    };\n        }\n        get audioWorklet() {\n            return this._audioWorklet;\n        }\n        createAnalyser() {\n            return new analyserNodeConstructor(this);\n        }\n        createBiquadFilter() {\n            return new biquadFilterNodeConstructor(this);\n        }\n        createBuffer(numberOfChannels, length, sampleRate) {\n            return new audioBufferConstructor({ length, numberOfChannels, sampleRate });\n        }\n        createBufferSource() {\n            return new audioBufferSourceNodeConstructor(this);\n        }\n        createChannelMerger(numberOfInputs = 6) {\n            return new channelMergerNodeConstructor(this, { numberOfInputs });\n        }\n        createChannelSplitter(numberOfOutputs = 6) {\n            return new channelSplitterNodeConstructor(this, { numberOfOutputs });\n        }\n        createConstantSource() {\n            return new constantSourceNodeConstructor(this);\n        }\n        createConvolver() {\n            return new convolverNodeConstructor(this);\n        }\n        createDelay(maxDelayTime = 1) {\n            return new delayNodeConstructor(this, { maxDelayTime });\n        }\n        createDynamicsCompressor() {\n            return new dynamicsCompressorNodeConstructor(this);\n        }\n        createGain() {\n            return new gainNodeConstructor(this);\n        }\n        createIIRFilter(feedforward, feedback) {\n            return new iIRFilterNodeConstructor(this, { feedback, feedforward });\n        }\n        createOscillator() {\n            return new oscillatorNodeConstructor(this);\n        }\n        createPanner() {\n            return new pannerNodeConstructor(this);\n        }\n        createPeriodicWave(real, imag, constraints = { disableNormalization: false }) {\n            return new periodicWaveConstructor(this, { ...constraints, imag, real });\n        }\n        createStereoPanner() {\n            return new stereoPannerNodeConstructor(this);\n        }\n        createWaveShaper() {\n            return new waveShaperNodeConstructor(this);\n        }\n        decodeAudioData(audioData, successCallback, errorCallback) {\n            return decodeAudioData(this._nativeContext, audioData).then((audioBuffer) => {\n                if (typeof successCallback === 'function') {\n                    successCallback(audioBuffer);\n                }\n                return audioBuffer;\n            }, (err) => {\n                if (typeof errorCallback === 'function') {\n                    errorCallback(err);\n                }\n                throw err;\n            });\n        }\n    };\n};\n//# sourceMappingURL=base-audio-context-constructor.js.map","import { MOST_NEGATIVE_SINGLE_FLOAT, MOST_POSITIVE_SINGLE_FLOAT } from '../constants';\nconst DEFAULT_OPTIONS = {\n    Q: 1,\n    channelCount: 2,\n    channelCountMode: 'max',\n    channelInterpretation: 'speakers',\n    detune: 0,\n    frequency: 350,\n    gain: 0,\n    type: 'lowpass'\n};\nexport const createBiquadFilterNodeConstructor = (audioNodeConstructor, createAudioParam, createBiquadFilterNodeRenderer, createInvalidAccessError, createNativeBiquadFilterNode, getNativeContext, isNativeOfflineAudioContext, setAudioNodeTailTime) => {\n    return class BiquadFilterNode extends audioNodeConstructor {\n        constructor(context, options) {\n            const nativeContext = getNativeContext(context);\n            const mergedOptions = { ...DEFAULT_OPTIONS, ...options };\n            const nativeBiquadFilterNode = createNativeBiquadFilterNode(nativeContext, mergedOptions);\n            const isOffline = isNativeOfflineAudioContext(nativeContext);\n            const biquadFilterNodeRenderer = (isOffline ? createBiquadFilterNodeRenderer() : null);\n            super(context, false, nativeBiquadFilterNode, biquadFilterNodeRenderer);\n            // Bug #80: Safari does not export the correct values for maxValue and minValue.\n            this._Q = createAudioParam(this, isOffline, nativeBiquadFilterNode.Q, MOST_POSITIVE_SINGLE_FLOAT, MOST_NEGATIVE_SINGLE_FLOAT);\n            // Bug #78: Firefox & Safari do not export the correct values for maxValue and minValue.\n            this._detune = createAudioParam(this, isOffline, nativeBiquadFilterNode.detune, 1200 * Math.log2(MOST_POSITIVE_SINGLE_FLOAT), -1200 * Math.log2(MOST_POSITIVE_SINGLE_FLOAT));\n            // Bug #77: Firefox & Safari do not export the correct value for minValue.\n            this._frequency = createAudioParam(this, isOffline, nativeBiquadFilterNode.frequency, context.sampleRate / 2, 0);\n            // Bug #79: Firefox & Safari do not export the correct values for maxValue and minValue.\n            this._gain = createAudioParam(this, isOffline, nativeBiquadFilterNode.gain, 40 * Math.log10(MOST_POSITIVE_SINGLE_FLOAT), MOST_NEGATIVE_SINGLE_FLOAT);\n            this._nativeBiquadFilterNode = nativeBiquadFilterNode;\n            // @todo Determine a meaningful tail-time instead of just using one second.\n            setAudioNodeTailTime(this, 1);\n        }\n        get detune() {\n            return this._detune;\n        }\n        get frequency() {\n            return this._frequency;\n        }\n        get gain() {\n            return this._gain;\n        }\n        get Q() {\n            return this._Q;\n        }\n        get type() {\n            return this._nativeBiquadFilterNode.type;\n        }\n        set type(value) {\n            this._nativeBiquadFilterNode.type = value;\n        }\n        getFrequencyResponse(frequencyHz, magResponse, phaseResponse) {\n            // Bug #189: Safari does throw an InvalidStateError.\n            try {\n                this._nativeBiquadFilterNode.getFrequencyResponse(frequencyHz, magResponse, phaseResponse);\n            }\n            catch (err) {\n                if (err.code === 11) {\n                    throw createInvalidAccessError();\n                }\n                throw err;\n            }\n            // Bug #68: Safari does not throw an error if the parameters differ in their length.\n            if (frequencyHz.length !== magResponse.length || magResponse.length !== phaseResponse.length) {\n                throw createInvalidAccessError();\n            }\n        }\n    };\n};\n//# sourceMappingURL=biquad-filter-node-constructor.js.map","import { isOwnedByContext } from '../helpers/is-owned-by-context';\nexport const createBiquadFilterNodeRendererFactory = (connectAudioParam, createNativeBiquadFilterNode, getNativeAudioNode, renderAutomation, renderInputsOfAudioNode) => {\n    return () => {\n        const renderedNativeBiquadFilterNodes = new WeakMap();\n        const createBiquadFilterNode = async (proxy, nativeOfflineAudioContext) => {\n            let nativeBiquadFilterNode = getNativeAudioNode(proxy);\n            /*\n             * If the initially used nativeBiquadFilterNode was not constructed on the same OfflineAudioContext it needs to be created\n             * again.\n             */\n            const nativeBiquadFilterNodeIsOwnedByContext = isOwnedByContext(nativeBiquadFilterNode, nativeOfflineAudioContext);\n            if (!nativeBiquadFilterNodeIsOwnedByContext) {\n                const options = {\n                    Q: nativeBiquadFilterNode.Q.value,\n                    channelCount: nativeBiquadFilterNode.channelCount,\n                    channelCountMode: nativeBiquadFilterNode.channelCountMode,\n                    channelInterpretation: nativeBiquadFilterNode.channelInterpretation,\n                    detune: nativeBiquadFilterNode.detune.value,\n                    frequency: nativeBiquadFilterNode.frequency.value,\n                    gain: nativeBiquadFilterNode.gain.value,\n                    type: nativeBiquadFilterNode.type\n                };\n                nativeBiquadFilterNode = createNativeBiquadFilterNode(nativeOfflineAudioContext, options);\n            }\n            renderedNativeBiquadFilterNodes.set(nativeOfflineAudioContext, nativeBiquadFilterNode);\n            if (!nativeBiquadFilterNodeIsOwnedByContext) {\n                await renderAutomation(nativeOfflineAudioContext, proxy.Q, nativeBiquadFilterNode.Q);\n                await renderAutomation(nativeOfflineAudioContext, proxy.detune, nativeBiquadFilterNode.detune);\n                await renderAutomation(nativeOfflineAudioContext, proxy.frequency, nativeBiquadFilterNode.frequency);\n                await renderAutomation(nativeOfflineAudioContext, proxy.gain, nativeBiquadFilterNode.gain);\n            }\n            else {\n                await connectAudioParam(nativeOfflineAudioContext, proxy.Q, nativeBiquadFilterNode.Q);\n                await connectAudioParam(nativeOfflineAudioContext, proxy.detune, nativeBiquadFilterNode.detune);\n                await connectAudioParam(nativeOfflineAudioContext, proxy.frequency, nativeBiquadFilterNode.frequency);\n                await connectAudioParam(nativeOfflineAudioContext, proxy.gain, nativeBiquadFilterNode.gain);\n            }\n            await renderInputsOfAudioNode(proxy, nativeOfflineAudioContext, nativeBiquadFilterNode);\n            return nativeBiquadFilterNode;\n        };\n        return {\n            render(proxy, nativeOfflineAudioContext) {\n                const renderedNativeBiquadFilterNode = renderedNativeBiquadFilterNodes.get(nativeOfflineAudioContext);\n                if (renderedNativeBiquadFilterNode !== undefined) {\n                    return Promise.resolve(renderedNativeBiquadFilterNode);\n                }\n                return createBiquadFilterNode(proxy, nativeOfflineAudioContext);\n            }\n        };\n    };\n};\n//# sourceMappingURL=biquad-filter-node-renderer-factory.js.map","export const createCacheTestResult = (ongoingTests, testResults) => {\n    return (tester, test) => {\n        const cachedTestResult = testResults.get(tester);\n        if (cachedTestResult !== undefined) {\n            return cachedTestResult;\n        }\n        const ongoingTest = ongoingTests.get(tester);\n        if (ongoingTest !== undefined) {\n            return ongoingTest;\n        }\n        try {\n            const synchronousTestResult = test();\n            if (synchronousTestResult instanceof Promise) {\n                ongoingTests.set(tester, synchronousTestResult);\n                return synchronousTestResult\n                    .catch(() => false)\n                    .then((finalTestResult) => {\n                    ongoingTests.delete(tester);\n                    testResults.set(tester, finalTestResult);\n                    return finalTestResult;\n                });\n            }\n            testResults.set(tester, synchronousTestResult);\n            return synchronousTestResult;\n        }\n        catch {\n            testResults.set(tester, false);\n            return false;\n        }\n    };\n};\n//# sourceMappingURL=cache-test-result.js.map","const DEFAULT_OPTIONS = {\n    channelCount: 1,\n    channelCountMode: 'explicit',\n    channelInterpretation: 'speakers',\n    numberOfInputs: 6\n};\nexport const createChannelMergerNodeConstructor = (audioNodeConstructor, createChannelMergerNodeRenderer, createNativeChannelMergerNode, getNativeContext, isNativeOfflineAudioContext) => {\n    return class ChannelMergerNode extends audioNodeConstructor {\n        constructor(context, options) {\n            const nativeContext = getNativeContext(context);\n            const mergedOptions = { ...DEFAULT_OPTIONS, ...options };\n            const nativeChannelMergerNode = createNativeChannelMergerNode(nativeContext, mergedOptions);\n            const channelMergerNodeRenderer = ((isNativeOfflineAudioContext(nativeContext) ? createChannelMergerNodeRenderer() : null));\n            super(context, false, nativeChannelMergerNode, channelMergerNodeRenderer);\n        }\n    };\n};\n//# sourceMappingURL=channel-merger-node-constructor.js.map","import { isOwnedByContext } from '../helpers/is-owned-by-context';\nexport const createChannelMergerNodeRendererFactory = (createNativeChannelMergerNode, getNativeAudioNode, renderInputsOfAudioNode) => {\n    return () => {\n        const renderedNativeAudioNodes = new WeakMap();\n        const createAudioNode = async (proxy, nativeOfflineAudioContext) => {\n            let nativeAudioNode = getNativeAudioNode(proxy);\n            // If the initially used nativeAudioNode was not constructed on the same OfflineAudioContext it needs to be created again.\n            const nativeAudioNodeIsOwnedByContext = isOwnedByContext(nativeAudioNode, nativeOfflineAudioContext);\n            if (!nativeAudioNodeIsOwnedByContext) {\n                const options = {\n                    channelCount: nativeAudioNode.channelCount,\n                    channelCountMode: nativeAudioNode.channelCountMode,\n                    channelInterpretation: nativeAudioNode.channelInterpretation,\n                    numberOfInputs: nativeAudioNode.numberOfInputs\n                };\n                nativeAudioNode = createNativeChannelMergerNode(nativeOfflineAudioContext, options);\n            }\n            renderedNativeAudioNodes.set(nativeOfflineAudioContext, nativeAudioNode);\n            await renderInputsOfAudioNode(proxy, nativeOfflineAudioContext, nativeAudioNode);\n            return nativeAudioNode;\n        };\n        return {\n            render(proxy, nativeOfflineAudioContext) {\n                const renderedNativeAudioNode = renderedNativeAudioNodes.get(nativeOfflineAudioContext);\n                if (renderedNativeAudioNode !== undefined) {\n                    return Promise.resolve(renderedNativeAudioNode);\n                }\n                return createAudioNode(proxy, nativeOfflineAudioContext);\n            }\n        };\n    };\n};\n//# sourceMappingURL=channel-merger-node-renderer-factory.js.map","const DEFAULT_OPTIONS = {\n    channelCount: 6,\n    channelCountMode: 'explicit',\n    channelInterpretation: 'discrete',\n    numberOfOutputs: 6\n};\nexport const createChannelSplitterNodeConstructor = (audioNodeConstructor, createChannelSplitterNodeRenderer, createNativeChannelSplitterNode, getNativeContext, isNativeOfflineAudioContext, sanitizeChannelSplitterOptions) => {\n    return class ChannelSplitterNode extends audioNodeConstructor {\n        constructor(context, options) {\n            const nativeContext = getNativeContext(context);\n            const mergedOptions = sanitizeChannelSplitterOptions({ ...DEFAULT_OPTIONS, ...options });\n            const nativeChannelSplitterNode = createNativeChannelSplitterNode(nativeContext, mergedOptions);\n            const channelSplitterNodeRenderer = ((isNativeOfflineAudioContext(nativeContext) ? createChannelSplitterNodeRenderer() : null));\n            super(context, false, nativeChannelSplitterNode, channelSplitterNodeRenderer);\n        }\n    };\n};\n//# sourceMappingURL=channel-splitter-node-constructor.js.map","import { isOwnedByContext } from '../helpers/is-owned-by-context';\nexport const createChannelSplitterNodeRendererFactory = (createNativeChannelSplitterNode, getNativeAudioNode, renderInputsOfAudioNode) => {\n    return () => {\n        const renderedNativeAudioNodes = new WeakMap();\n        const createAudioNode = async (proxy, nativeOfflineAudioContext) => {\n            let nativeAudioNode = getNativeAudioNode(proxy);\n            // If the initially used nativeAudioNode was not constructed on the same OfflineAudioContext it needs to be created again.\n            const nativeAudioNodeIsOwnedByContext = isOwnedByContext(nativeAudioNode, nativeOfflineAudioContext);\n            if (!nativeAudioNodeIsOwnedByContext) {\n                const options = {\n                    channelCount: nativeAudioNode.channelCount,\n                    channelCountMode: nativeAudioNode.channelCountMode,\n                    channelInterpretation: nativeAudioNode.channelInterpretation,\n                    numberOfOutputs: nativeAudioNode.numberOfOutputs\n                };\n                nativeAudioNode = createNativeChannelSplitterNode(nativeOfflineAudioContext, options);\n            }\n            renderedNativeAudioNodes.set(nativeOfflineAudioContext, nativeAudioNode);\n            await renderInputsOfAudioNode(proxy, nativeOfflineAudioContext, nativeAudioNode);\n            return nativeAudioNode;\n        };\n        return {\n            render(proxy, nativeOfflineAudioContext) {\n                const renderedNativeAudioNode = renderedNativeAudioNodes.get(nativeOfflineAudioContext);\n                if (renderedNativeAudioNode !== undefined) {\n                    return Promise.resolve(renderedNativeAudioNode);\n                }\n                return createAudioNode(proxy, nativeOfflineAudioContext);\n            }\n        };\n    };\n};\n//# sourceMappingURL=channel-splitter-node-renderer-factory.js.map","export const createConnectAudioParam = (renderInputsOfAudioParam) => {\n    return (nativeOfflineAudioContext, audioParam, nativeAudioParam) => {\n        return renderInputsOfAudioParam(audioParam, nativeOfflineAudioContext, nativeAudioParam);\n    };\n};\n//# sourceMappingURL=connect-audio-param.js.map","import { isNativeAudioNode } from '../guards/native-audio-node';\nexport const createConnectMultipleOutputs = (createIndexSizeError) => {\n    return (outputAudioNodes, destination, output = 0, input = 0) => {\n        const outputAudioNode = outputAudioNodes[output];\n        if (outputAudioNode === undefined) {\n            throw createIndexSizeError();\n        }\n        if (isNativeAudioNode(destination)) {\n            return outputAudioNode.connect(destination, 0, input);\n        }\n        return outputAudioNode.connect(destination, 0);\n    };\n};\n//# sourceMappingURL=connect-multiple-outputs.js.map","export const createConnectedNativeAudioBufferSourceNodeFactory = (createNativeAudioBufferSourceNode) => {\n    return (nativeContext, nativeAudioNode) => {\n        const nativeAudioBufferSourceNode = createNativeAudioBufferSourceNode(nativeContext, {\n            buffer: null,\n            channelCount: 2,\n            channelCountMode: 'max',\n            channelInterpretation: 'speakers',\n            loop: false,\n            loopEnd: 0,\n            loopStart: 0,\n            playbackRate: 1\n        });\n        const nativeAudioBuffer = nativeContext.createBuffer(1, 2, 44100);\n        nativeAudioBufferSourceNode.buffer = nativeAudioBuffer;\n        nativeAudioBufferSourceNode.loop = true;\n        nativeAudioBufferSourceNode.connect(nativeAudioNode);\n        nativeAudioBufferSourceNode.start();\n        return () => {\n            nativeAudioBufferSourceNode.stop();\n            nativeAudioBufferSourceNode.disconnect(nativeAudioNode);\n        };\n    };\n};\n//# sourceMappingURL=connected-native-audio-buffer-source-node-factory.js.map","import { MOST_NEGATIVE_SINGLE_FLOAT, MOST_POSITIVE_SINGLE_FLOAT } from '../constants';\nimport { isActiveAudioNode } from '../helpers/is-active-audio-node';\nimport { setInternalStateToActive } from '../helpers/set-internal-state-to-active';\nimport { setInternalStateToPassive } from '../helpers/set-internal-state-to-passive';\nconst DEFAULT_OPTIONS = {\n    channelCount: 2,\n    channelCountMode: 'max',\n    channelInterpretation: 'speakers',\n    offset: 1\n};\nexport const createConstantSourceNodeConstructor = (audioNodeConstructor, createAudioParam, createConstantSourceNodeRendererFactory, createNativeConstantSourceNode, getNativeContext, isNativeOfflineAudioContext, wrapEventListener) => {\n    return class ConstantSourceNode extends audioNodeConstructor {\n        constructor(context, options) {\n            const nativeContext = getNativeContext(context);\n            const mergedOptions = { ...DEFAULT_OPTIONS, ...options };\n            const nativeConstantSourceNode = createNativeConstantSourceNode(nativeContext, mergedOptions);\n            const isOffline = isNativeOfflineAudioContext(nativeContext);\n            const constantSourceNodeRenderer = ((isOffline ? createConstantSourceNodeRendererFactory() : null));\n            super(context, false, nativeConstantSourceNode, constantSourceNodeRenderer);\n            this._constantSourceNodeRenderer = constantSourceNodeRenderer;\n            this._nativeConstantSourceNode = nativeConstantSourceNode;\n            /*\n             * Bug #62 & #74: Safari does not support ConstantSourceNodes and does not export the correct values for maxValue and minValue\n             * for GainNodes.\n             */\n            this._offset = createAudioParam(this, isOffline, nativeConstantSourceNode.offset, MOST_POSITIVE_SINGLE_FLOAT, MOST_NEGATIVE_SINGLE_FLOAT);\n            this._onended = null;\n        }\n        get offset() {\n            return this._offset;\n        }\n        get onended() {\n            return this._onended;\n        }\n        set onended(value) {\n            const wrappedListener = typeof value === 'function' ? wrapEventListener(this, value) : null;\n            this._nativeConstantSourceNode.onended = wrappedListener;\n            const nativeOnEnded = this._nativeConstantSourceNode.onended;\n            this._onended = nativeOnEnded !== null && nativeOnEnded === wrappedListener ? value : nativeOnEnded;\n        }\n        start(when = 0) {\n            this._nativeConstantSourceNode.start(when);\n            if (this._constantSourceNodeRenderer !== null) {\n                this._constantSourceNodeRenderer.start = when;\n            }\n            if (this.context.state !== 'closed') {\n                setInternalStateToActive(this);\n                const resetInternalStateToPassive = () => {\n                    this._nativeConstantSourceNode.removeEventListener('ended', resetInternalStateToPassive);\n                    if (isActiveAudioNode(this)) {\n                        setInternalStateToPassive(this);\n                    }\n                };\n                this._nativeConstantSourceNode.addEventListener('ended', resetInternalStateToPassive);\n            }\n        }\n        stop(when = 0) {\n            this._nativeConstantSourceNode.stop(when);\n            if (this._constantSourceNodeRenderer !== null) {\n                this._constantSourceNodeRenderer.stop = when;\n            }\n        }\n    };\n};\n//# sourceMappingURL=constant-source-node-constructor.js.map","import { isOwnedByContext } from '../helpers/is-owned-by-context';\nexport const createConstantSourceNodeRendererFactory = (connectAudioParam, createNativeConstantSourceNode, getNativeAudioNode, renderAutomation, renderInputsOfAudioNode) => {\n    return () => {\n        const renderedNativeConstantSourceNodes = new WeakMap();\n        let start = null;\n        let stop = null;\n        const createConstantSourceNode = async (proxy, nativeOfflineAudioContext) => {\n            let nativeConstantSourceNode = getNativeAudioNode(proxy);\n            /*\n             * If the initially used nativeConstantSourceNode was not constructed on the same OfflineAudioContext it needs to be created\n             * again.\n             */\n            const nativeConstantSourceNodeIsOwnedByContext = isOwnedByContext(nativeConstantSourceNode, nativeOfflineAudioContext);\n            if (!nativeConstantSourceNodeIsOwnedByContext) {\n                const options = {\n                    channelCount: nativeConstantSourceNode.channelCount,\n                    channelCountMode: nativeConstantSourceNode.channelCountMode,\n                    channelInterpretation: nativeConstantSourceNode.channelInterpretation,\n                    offset: nativeConstantSourceNode.offset.value\n                };\n                nativeConstantSourceNode = createNativeConstantSourceNode(nativeOfflineAudioContext, options);\n                if (start !== null) {\n                    nativeConstantSourceNode.start(start);\n                }\n                if (stop !== null) {\n                    nativeConstantSourceNode.stop(stop);\n                }\n            }\n            renderedNativeConstantSourceNodes.set(nativeOfflineAudioContext, nativeConstantSourceNode);\n            if (!nativeConstantSourceNodeIsOwnedByContext) {\n                await renderAutomation(nativeOfflineAudioContext, proxy.offset, nativeConstantSourceNode.offset);\n            }\n            else {\n                await connectAudioParam(nativeOfflineAudioContext, proxy.offset, nativeConstantSourceNode.offset);\n            }\n            await renderInputsOfAudioNode(proxy, nativeOfflineAudioContext, nativeConstantSourceNode);\n            return nativeConstantSourceNode;\n        };\n        return {\n            set start(value) {\n                start = value;\n            },\n            set stop(value) {\n                stop = value;\n            },\n            render(proxy, nativeOfflineAudioContext) {\n                const renderedNativeConstantSourceNode = renderedNativeConstantSourceNodes.get(nativeOfflineAudioContext);\n                if (renderedNativeConstantSourceNode !== undefined) {\n                    return Promise.resolve(renderedNativeConstantSourceNode);\n                }\n                return createConstantSourceNode(proxy, nativeOfflineAudioContext);\n            }\n        };\n    };\n};\n//# sourceMappingURL=constant-source-node-renderer-factory.js.map","export const createConvertNumberToUnsignedLong = (unit32Array) => {\n    return (value) => {\n        unit32Array[0] = value;\n        return unit32Array[0];\n    };\n};\n//# sourceMappingURL=convert-number-to-unsigned-long.js.map","const DEFAULT_OPTIONS = {\n    buffer: null,\n    channelCount: 2,\n    channelCountMode: 'clamped-max',\n    channelInterpretation: 'speakers',\n    disableNormalization: false\n};\nexport const createConvolverNodeConstructor = (audioNodeConstructor, createConvolverNodeRenderer, createNativeConvolverNode, getNativeContext, isNativeOfflineAudioContext, setAudioNodeTailTime) => {\n    return class ConvolverNode extends audioNodeConstructor {\n        constructor(context, options) {\n            const nativeContext = getNativeContext(context);\n            const mergedOptions = { ...DEFAULT_OPTIONS, ...options };\n            const nativeConvolverNode = createNativeConvolverNode(nativeContext, mergedOptions);\n            const isOffline = isNativeOfflineAudioContext(nativeContext);\n            const convolverNodeRenderer = (isOffline ? createConvolverNodeRenderer() : null);\n            super(context, false, nativeConvolverNode, convolverNodeRenderer);\n            this._isBufferNullified = false;\n            this._nativeConvolverNode = nativeConvolverNode;\n            if (mergedOptions.buffer !== null) {\n                setAudioNodeTailTime(this, mergedOptions.buffer.duration);\n            }\n        }\n        get buffer() {\n            if (this._isBufferNullified) {\n                return null;\n            }\n            return this._nativeConvolverNode.buffer;\n        }\n        set buffer(value) {\n            this._nativeConvolverNode.buffer = value;\n            // Bug #115: Safari does not allow to set the buffer to null.\n            if (value === null && this._nativeConvolverNode.buffer !== null) {\n                const nativeContext = this._nativeConvolverNode.context;\n                this._nativeConvolverNode.buffer = nativeContext.createBuffer(1, 1, nativeContext.sampleRate);\n                this._isBufferNullified = true;\n                setAudioNodeTailTime(this, 0);\n            }\n            else {\n                this._isBufferNullified = false;\n                setAudioNodeTailTime(this, this._nativeConvolverNode.buffer === null ? 0 : this._nativeConvolverNode.buffer.duration);\n            }\n        }\n        get normalize() {\n            return this._nativeConvolverNode.normalize;\n        }\n        set normalize(value) {\n            this._nativeConvolverNode.normalize = value;\n        }\n    };\n};\n//# sourceMappingURL=convolver-node-constructor.js.map","import { isNativeAudioNodeFaker } from '../guards/native-audio-node-faker';\nimport { isOwnedByContext } from '../helpers/is-owned-by-context';\nexport const createConvolverNodeRendererFactory = (createNativeConvolverNode, getNativeAudioNode, renderInputsOfAudioNode) => {\n    return () => {\n        const renderedNativeConvolverNodes = new WeakMap();\n        const createConvolverNode = async (proxy, nativeOfflineAudioContext) => {\n            let nativeConvolverNode = getNativeAudioNode(proxy);\n            // If the initially used nativeConvolverNode was not constructed on the same OfflineAudioContext it needs to be created again.\n            const nativeConvolverNodeIsOwnedByContext = isOwnedByContext(nativeConvolverNode, nativeOfflineAudioContext);\n            if (!nativeConvolverNodeIsOwnedByContext) {\n                const options = {\n                    buffer: nativeConvolverNode.buffer,\n                    channelCount: nativeConvolverNode.channelCount,\n                    channelCountMode: nativeConvolverNode.channelCountMode,\n                    channelInterpretation: nativeConvolverNode.channelInterpretation,\n                    disableNormalization: !nativeConvolverNode.normalize\n                };\n                nativeConvolverNode = createNativeConvolverNode(nativeOfflineAudioContext, options);\n            }\n            renderedNativeConvolverNodes.set(nativeOfflineAudioContext, nativeConvolverNode);\n            if (isNativeAudioNodeFaker(nativeConvolverNode)) {\n                await renderInputsOfAudioNode(proxy, nativeOfflineAudioContext, nativeConvolverNode.inputs[0]);\n            }\n            else {\n                await renderInputsOfAudioNode(proxy, nativeOfflineAudioContext, nativeConvolverNode);\n            }\n            return nativeConvolverNode;\n        };\n        return {\n            render(proxy, nativeOfflineAudioContext) {\n                const renderedNativeConvolverNode = renderedNativeConvolverNodes.get(nativeOfflineAudioContext);\n                if (renderedNativeConvolverNode !== undefined) {\n                    return Promise.resolve(renderedNativeConvolverNode);\n                }\n                return createConvolverNode(proxy, nativeOfflineAudioContext);\n            }\n        };\n    };\n};\n//# sourceMappingURL=convolver-node-renderer-factory.js.map","export const createCreateNativeOfflineAudioContext = (createNotSupportedError, nativeOfflineAudioContextConstructor) => {\n    return (numberOfChannels, length, sampleRate) => {\n        if (nativeOfflineAudioContextConstructor === null) {\n            throw new Error('Missing the native OfflineAudioContext constructor.');\n        }\n        try {\n            return new nativeOfflineAudioContextConstructor(numberOfChannels, length, sampleRate);\n        }\n        catch (err) {\n            // Bug #143, #144 & #146: Safari throws a SyntaxError when numberOfChannels, length or sampleRate are invalid.\n            if (err.name === 'SyntaxError') {\n                throw createNotSupportedError();\n            }\n            throw err;\n        }\n    };\n};\n//# sourceMappingURL=create-native-offline-audio-context.js.map","export const createDataCloneError = () => new DOMException('', 'DataCloneError');\n//# sourceMappingURL=data-clone-error.js.map","export const detachArrayBuffer = (arrayBuffer) => {\n    const { port1, port2 } = new MessageChannel();\n    return new Promise((resolve) => {\n        const closeAndResolve = () => {\n            port2.onmessage = null;\n            port1.close();\n            port2.close();\n            resolve();\n        };\n        port2.onmessage = () => closeAndResolve();\n        try {\n            port1.postMessage(arrayBuffer, [arrayBuffer]);\n        }\n        catch {\n            // Ignore errors.\n        }\n        finally {\n            closeAndResolve();\n        }\n    });\n};\n//# sourceMappingURL=detach-array-buffer.js.map","import { detachArrayBuffer } from '../helpers/detach-array-buffer';\nimport { wrapAudioBufferGetChannelDataMethod } from '../helpers/wrap-audio-buffer-get-channel-data-method';\nexport const createDecodeAudioData = (audioBufferStore, cacheTestResult, createDataCloneError, createEncodingError, detachedArrayBuffers, getNativeContext, isNativeContext, testAudioBufferCopyChannelMethodsOutOfBoundsSupport, testPromiseSupport, wrapAudioBufferCopyChannelMethods, wrapAudioBufferCopyChannelMethodsOutOfBounds) => {\n    return (anyContext, audioData) => {\n        const nativeContext = isNativeContext(anyContext) ? anyContext : getNativeContext(anyContext);\n        // Bug #43: Only Chrome and Edge do throw a DataCloneError.\n        if (detachedArrayBuffers.has(audioData)) {\n            const err = createDataCloneError();\n            return Promise.reject(err);\n        }\n        // The audioData parameter maybe of a type which can't be added to a WeakSet.\n        try {\n            detachedArrayBuffers.add(audioData);\n        }\n        catch {\n            // Ignore errors.\n        }\n        // Bug #21: Safari does not support promises yet.\n        if (cacheTestResult(testPromiseSupport, () => testPromiseSupport(nativeContext))) {\n            return nativeContext.decodeAudioData(audioData).then((audioBuffer) => {\n                // Bug #133: Safari does neuter the ArrayBuffer.\n                detachArrayBuffer(audioData).catch(() => {\n                    // Ignore errors.\n                });\n                // Bug #157: Firefox does not allow the bufferOffset to be out-of-bounds.\n                if (!cacheTestResult(testAudioBufferCopyChannelMethodsOutOfBoundsSupport, () => testAudioBufferCopyChannelMethodsOutOfBoundsSupport(audioBuffer))) {\n                    wrapAudioBufferCopyChannelMethodsOutOfBounds(audioBuffer);\n                }\n                audioBufferStore.add(audioBuffer);\n                return audioBuffer;\n            });\n        }\n        // Bug #21: Safari does not return a Promise yet.\n        return new Promise((resolve, reject) => {\n            const complete = async () => {\n                // Bug #133: Safari does neuter the ArrayBuffer.\n                try {\n                    await detachArrayBuffer(audioData);\n                }\n                catch {\n                    // Ignore errors.\n                }\n            };\n            const fail = (err) => {\n                reject(err);\n                complete();\n            };\n            // Bug #26: Safari throws a synchronous error.\n            try {\n                // Bug #1: Safari requires a successCallback.\n                nativeContext.decodeAudioData(audioData, (audioBuffer) => {\n                    // Bug #5: Safari does not support copyFromChannel() and copyToChannel().\n                    // Bug #100: Safari does throw a wrong error when calling getChannelData() with an out-of-bounds value.\n                    if (typeof audioBuffer.copyFromChannel !== 'function') {\n                        wrapAudioBufferCopyChannelMethods(audioBuffer);\n                        wrapAudioBufferGetChannelDataMethod(audioBuffer);\n                    }\n                    audioBufferStore.add(audioBuffer);\n                    complete().then(() => resolve(audioBuffer));\n                }, (err) => {\n                    // Bug #4: Safari returns null instead of an error.\n                    if (err === null) {\n                        fail(createEncodingError());\n                    }\n                    else {\n                        fail(err);\n                    }\n                });\n            }\n            catch (err) {\n                fail(err);\n            }\n        });\n    };\n};\n//# sourceMappingURL=decode-audio-data.js.map","import { isAudioNodeOutputConnection } from '../guards/audio-node-output-connection';\nexport const createDecrementCycleCounter = (connectNativeAudioNodeToNativeAudioNode, cycleCounters, getAudioNodeConnections, getNativeAudioNode, getNativeAudioParam, getNativeContext, isActiveAudioNode, isNativeOfflineAudioContext) => {\n    return (audioNode, count) => {\n        const cycleCounter = cycleCounters.get(audioNode);\n        if (cycleCounter === undefined) {\n            throw new Error('Missing the expected cycle count.');\n        }\n        const nativeContext = getNativeContext(audioNode.context);\n        const isOffline = isNativeOfflineAudioContext(nativeContext);\n        if (cycleCounter === count) {\n            cycleCounters.delete(audioNode);\n            if (!isOffline && isActiveAudioNode(audioNode)) {\n                const nativeSourceAudioNode = getNativeAudioNode(audioNode);\n                const { outputs } = getAudioNodeConnections(audioNode);\n                for (const output of outputs) {\n                    if (isAudioNodeOutputConnection(output)) {\n                        const nativeDestinationAudioNode = getNativeAudioNode(output[0]);\n                        connectNativeAudioNodeToNativeAudioNode(nativeSourceAudioNode, nativeDestinationAudioNode, output[1], output[2]);\n                    }\n                    else {\n                        const nativeDestinationAudioParam = getNativeAudioParam(output[0]);\n                        nativeSourceAudioNode.connect(nativeDestinationAudioParam, output[1]);\n                    }\n                }\n            }\n        }\n        else {\n            cycleCounters.set(audioNode, cycleCounter - count);\n        }\n    };\n};\n//# sourceMappingURL=decrement-cycle-counter.js.map","const DEFAULT_OPTIONS = {\n    channelCount: 2,\n    channelCountMode: 'max',\n    channelInterpretation: 'speakers',\n    delayTime: 0,\n    maxDelayTime: 1\n};\nexport const createDelayNodeConstructor = (audioNodeConstructor, createAudioParam, createDelayNodeRenderer, createNativeDelayNode, getNativeContext, isNativeOfflineAudioContext, setAudioNodeTailTime) => {\n    return class DelayNode extends audioNodeConstructor {\n        constructor(context, options) {\n            const nativeContext = getNativeContext(context);\n            const mergedOptions = { ...DEFAULT_OPTIONS, ...options };\n            const nativeDelayNode = createNativeDelayNode(nativeContext, mergedOptions);\n            const isOffline = isNativeOfflineAudioContext(nativeContext);\n            const delayNodeRenderer = (isOffline ? createDelayNodeRenderer(mergedOptions.maxDelayTime) : null);\n            super(context, false, nativeDelayNode, delayNodeRenderer);\n            this._delayTime = createAudioParam(this, isOffline, nativeDelayNode.delayTime);\n            setAudioNodeTailTime(this, mergedOptions.maxDelayTime);\n        }\n        get delayTime() {\n            return this._delayTime;\n        }\n    };\n};\n//# sourceMappingURL=delay-node-constructor.js.map","import { isOwnedByContext } from '../helpers/is-owned-by-context';\nexport const createDelayNodeRendererFactory = (connectAudioParam, createNativeDelayNode, getNativeAudioNode, renderAutomation, renderInputsOfAudioNode) => {\n    return (maxDelayTime) => {\n        const renderedNativeDelayNodes = new WeakMap();\n        const createDelayNode = async (proxy, nativeOfflineAudioContext) => {\n            let nativeDelayNode = getNativeAudioNode(proxy);\n            // If the initially used nativeDelayNode was not constructed on the same OfflineAudioContext it needs to be created again.\n            const nativeDelayNodeIsOwnedByContext = isOwnedByContext(nativeDelayNode, nativeOfflineAudioContext);\n            if (!nativeDelayNodeIsOwnedByContext) {\n                const options = {\n                    channelCount: nativeDelayNode.channelCount,\n                    channelCountMode: nativeDelayNode.channelCountMode,\n                    channelInterpretation: nativeDelayNode.channelInterpretation,\n                    delayTime: nativeDelayNode.delayTime.value,\n                    maxDelayTime\n                };\n                nativeDelayNode = createNativeDelayNode(nativeOfflineAudioContext, options);\n            }\n            renderedNativeDelayNodes.set(nativeOfflineAudioContext, nativeDelayNode);\n            if (!nativeDelayNodeIsOwnedByContext) {\n                await renderAutomation(nativeOfflineAudioContext, proxy.delayTime, nativeDelayNode.delayTime);\n            }\n            else {\n                await connectAudioParam(nativeOfflineAudioContext, proxy.delayTime, nativeDelayNode.delayTime);\n            }\n            await renderInputsOfAudioNode(proxy, nativeOfflineAudioContext, nativeDelayNode);\n            return nativeDelayNode;\n        };\n        return {\n            render(proxy, nativeOfflineAudioContext) {\n                const renderedNativeDelayNode = renderedNativeDelayNodes.get(nativeOfflineAudioContext);\n                if (renderedNativeDelayNode !== undefined) {\n                    return Promise.resolve(renderedNativeDelayNode);\n                }\n                return createDelayNode(proxy, nativeOfflineAudioContext);\n            }\n        };\n    };\n};\n//# sourceMappingURL=delay-node-renderer-factory.js.map","export const createDeleteActiveInputConnectionToAudioNode = (pickElementFromSet) => {\n    return (activeInputs, source, output, input) => {\n        return pickElementFromSet(activeInputs[input], (activeInputConnection) => activeInputConnection[0] === source && activeInputConnection[1] === output);\n    };\n};\n//# sourceMappingURL=delete-active-input-connection-to-audio-node.js.map","export const createDeleteUnrenderedAudioWorkletNode = (getUnrenderedAudioWorkletNodes) => {\n    return (nativeContext, audioWorkletNode) => {\n        getUnrenderedAudioWorkletNodes(nativeContext).delete(audioWorkletNode);\n    };\n};\n//# sourceMappingURL=delete-unrendered-audio-worklet-node.js.map","export const isDelayNode = (audioNode) => {\n    return 'delayTime' in audioNode;\n};\n//# sourceMappingURL=delay-node.js.map","import { isAudioNode } from '../guards/audio-node';\nimport { isDelayNode } from '../guards/delay-node';\nexport const createDetectCycles = (audioParamAudioNodeStore, getAudioNodeConnections, getValueForKey) => {\n    return function detectCycles(chain, nextLink) {\n        const audioNode = isAudioNode(nextLink) ? nextLink : getValueForKey(audioParamAudioNodeStore, nextLink);\n        if (isDelayNode(audioNode)) {\n            return [];\n        }\n        if (chain[0] === audioNode) {\n            return [chain];\n        }\n        if (chain.includes(audioNode)) {\n            return [];\n        }\n        const { outputs } = getAudioNodeConnections(audioNode);\n        return Array.from(outputs)\n            .map((outputConnection) => detectCycles([...chain, audioNode], outputConnection[0]))\n            .reduce((mergedCycles, nestedCycles) => mergedCycles.concat(nestedCycles), []);\n    };\n};\n//# sourceMappingURL=detect-cycles.js.map","import { isNativeAudioNode } from '../guards/native-audio-node';\nconst getOutputAudioNodeAtIndex = (createIndexSizeError, outputAudioNodes, output) => {\n    const outputAudioNode = outputAudioNodes[output];\n    if (outputAudioNode === undefined) {\n        throw createIndexSizeError();\n    }\n    return outputAudioNode;\n};\nexport const createDisconnectMultipleOutputs = (createIndexSizeError) => {\n    return (outputAudioNodes, destinationOrOutput = undefined, output = undefined, input = 0) => {\n        if (destinationOrOutput === undefined) {\n            return outputAudioNodes.forEach((outputAudioNode) => outputAudioNode.disconnect());\n        }\n        if (typeof destinationOrOutput === 'number') {\n            return getOutputAudioNodeAtIndex(createIndexSizeError, outputAudioNodes, destinationOrOutput).disconnect();\n        }\n        if (isNativeAudioNode(destinationOrOutput)) {\n            if (output === undefined) {\n                return outputAudioNodes.forEach((outputAudioNode) => outputAudioNode.disconnect(destinationOrOutput));\n            }\n            if (input === undefined) {\n                return getOutputAudioNodeAtIndex(createIndexSizeError, outputAudioNodes, output).disconnect(destinationOrOutput, 0);\n            }\n            return getOutputAudioNodeAtIndex(createIndexSizeError, outputAudioNodes, output).disconnect(destinationOrOutput, 0, input);\n        }\n        if (output === undefined) {\n            return outputAudioNodes.forEach((outputAudioNode) => outputAudioNode.disconnect(destinationOrOutput));\n        }\n        return getOutputAudioNodeAtIndex(createIndexSizeError, outputAudioNodes, output).disconnect(destinationOrOutput, 0);\n    };\n};\n//# sourceMappingURL=disconnect-multiple-outputs.js.map","const DEFAULT_OPTIONS = {\n    attack: 0.003,\n    channelCount: 2,\n    channelCountMode: 'clamped-max',\n    channelInterpretation: 'speakers',\n    knee: 30,\n    ratio: 12,\n    release: 0.25,\n    threshold: -24\n};\nexport const createDynamicsCompressorNodeConstructor = (audioNodeConstructor, createAudioParam, createDynamicsCompressorNodeRenderer, createNativeDynamicsCompressorNode, createNotSupportedError, getNativeContext, isNativeOfflineAudioContext, setAudioNodeTailTime) => {\n    return class DynamicsCompressorNode extends audioNodeConstructor {\n        constructor(context, options) {\n            const nativeContext = getNativeContext(context);\n            const mergedOptions = { ...DEFAULT_OPTIONS, ...options };\n            const nativeDynamicsCompressorNode = createNativeDynamicsCompressorNode(nativeContext, mergedOptions);\n            const isOffline = isNativeOfflineAudioContext(nativeContext);\n            const dynamicsCompressorNodeRenderer = (isOffline ? createDynamicsCompressorNodeRenderer() : null);\n            super(context, false, nativeDynamicsCompressorNode, dynamicsCompressorNodeRenderer);\n            this._attack = createAudioParam(this, isOffline, nativeDynamicsCompressorNode.attack);\n            this._knee = createAudioParam(this, isOffline, nativeDynamicsCompressorNode.knee);\n            this._nativeDynamicsCompressorNode = nativeDynamicsCompressorNode;\n            this._ratio = createAudioParam(this, isOffline, nativeDynamicsCompressorNode.ratio);\n            this._release = createAudioParam(this, isOffline, nativeDynamicsCompressorNode.release);\n            this._threshold = createAudioParam(this, isOffline, nativeDynamicsCompressorNode.threshold);\n            setAudioNodeTailTime(this, 0.006);\n        }\n        get attack() {\n            return this._attack;\n        }\n        // Bug #108: Safari allows a channelCount of three and above which is why the getter and setter needs to be overwritten here.\n        get channelCount() {\n            return this._nativeDynamicsCompressorNode.channelCount;\n        }\n        set channelCount(value) {\n            const previousChannelCount = this._nativeDynamicsCompressorNode.channelCount;\n            this._nativeDynamicsCompressorNode.channelCount = value;\n            if (value > 2) {\n                this._nativeDynamicsCompressorNode.channelCount = previousChannelCount;\n                throw createNotSupportedError();\n            }\n        }\n        /*\n         * Bug #109: Only Chrome and Firefox disallow a channelCountMode of 'max' yet which is why the getter and setter needs to be\n         * overwritten here.\n         */\n        get channelCountMode() {\n            return this._nativeDynamicsCompressorNode.channelCountMode;\n        }\n        set channelCountMode(value) {\n            const previousChannelCount = this._nativeDynamicsCompressorNode.channelCountMode;\n            this._nativeDynamicsCompressorNode.channelCountMode = value;\n            if (value === 'max') {\n                this._nativeDynamicsCompressorNode.channelCountMode = previousChannelCount;\n                throw createNotSupportedError();\n            }\n        }\n        get knee() {\n            return this._knee;\n        }\n        get ratio() {\n            return this._ratio;\n        }\n        get reduction() {\n            // Bug #111: Safari returns an AudioParam instead of a number.\n            if (typeof this._nativeDynamicsCompressorNode.reduction.value === 'number') {\n                return this._nativeDynamicsCompressorNode.reduction.value;\n            }\n            return this._nativeDynamicsCompressorNode.reduction;\n        }\n        get release() {\n            return this._release;\n        }\n        get threshold() {\n            return this._threshold;\n        }\n    };\n};\n//# sourceMappingURL=dynamics-compressor-node-constructor.js.map","import { isOwnedByContext } from '../helpers/is-owned-by-context';\nexport const createDynamicsCompressorNodeRendererFactory = (connectAudioParam, createNativeDynamicsCompressorNode, getNativeAudioNode, renderAutomation, renderInputsOfAudioNode) => {\n    return () => {\n        const renderedNativeDynamicsCompressorNodes = new WeakMap();\n        const createDynamicsCompressorNode = async (proxy, nativeOfflineAudioContext) => {\n            let nativeDynamicsCompressorNode = getNativeAudioNode(proxy);\n            /*\n             * If the initially used nativeDynamicsCompressorNode was not constructed on the same OfflineAudioContext it needs to be\n             * created again.\n             */\n            const nativeDynamicsCompressorNodeIsOwnedByContext = isOwnedByContext(nativeDynamicsCompressorNode, nativeOfflineAudioContext);\n            if (!nativeDynamicsCompressorNodeIsOwnedByContext) {\n                const options = {\n                    attack: nativeDynamicsCompressorNode.attack.value,\n                    channelCount: nativeDynamicsCompressorNode.channelCount,\n                    channelCountMode: nativeDynamicsCompressorNode.channelCountMode,\n                    channelInterpretation: nativeDynamicsCompressorNode.channelInterpretation,\n                    knee: nativeDynamicsCompressorNode.knee.value,\n                    ratio: nativeDynamicsCompressorNode.ratio.value,\n                    release: nativeDynamicsCompressorNode.release.value,\n                    threshold: nativeDynamicsCompressorNode.threshold.value\n                };\n                nativeDynamicsCompressorNode = createNativeDynamicsCompressorNode(nativeOfflineAudioContext, options);\n            }\n            renderedNativeDynamicsCompressorNodes.set(nativeOfflineAudioContext, nativeDynamicsCompressorNode);\n            if (!nativeDynamicsCompressorNodeIsOwnedByContext) {\n                await renderAutomation(nativeOfflineAudioContext, proxy.attack, nativeDynamicsCompressorNode.attack);\n                await renderAutomation(nativeOfflineAudioContext, proxy.knee, nativeDynamicsCompressorNode.knee);\n                await renderAutomation(nativeOfflineAudioContext, proxy.ratio, nativeDynamicsCompressorNode.ratio);\n                await renderAutomation(nativeOfflineAudioContext, proxy.release, nativeDynamicsCompressorNode.release);\n                await renderAutomation(nativeOfflineAudioContext, proxy.threshold, nativeDynamicsCompressorNode.threshold);\n            }\n            else {\n                await connectAudioParam(nativeOfflineAudioContext, proxy.attack, nativeDynamicsCompressorNode.attack);\n                await connectAudioParam(nativeOfflineAudioContext, proxy.knee, nativeDynamicsCompressorNode.knee);\n                await connectAudioParam(nativeOfflineAudioContext, proxy.ratio, nativeDynamicsCompressorNode.ratio);\n                await connectAudioParam(nativeOfflineAudioContext, proxy.release, nativeDynamicsCompressorNode.release);\n                await connectAudioParam(nativeOfflineAudioContext, proxy.threshold, nativeDynamicsCompressorNode.threshold);\n            }\n            await renderInputsOfAudioNode(proxy, nativeOfflineAudioContext, nativeDynamicsCompressorNode);\n            return nativeDynamicsCompressorNode;\n        };\n        return {\n            render(proxy, nativeOfflineAudioContext) {\n                const renderedNativeDynamicsCompressorNode = renderedNativeDynamicsCompressorNodes.get(nativeOfflineAudioContext);\n                if (renderedNativeDynamicsCompressorNode !== undefined) {\n                    return Promise.resolve(renderedNativeDynamicsCompressorNode);\n                }\n                return createDynamicsCompressorNode(proxy, nativeOfflineAudioContext);\n            }\n        };\n    };\n};\n//# sourceMappingURL=dynamics-compressor-node-renderer-factory.js.map","export const createEncodingError = () => new DOMException('', 'EncodingError');\n//# sourceMappingURL=encoding-error.js.map","export const createEvaluateSource = (window) => {\n    return (source) => new Promise((resolve, reject) => {\n        if (window === null) {\n            // Bug #182 Chrome and Edge do throw an instance of a SyntaxError instead of a DOMException.\n            reject(new SyntaxError());\n            return;\n        }\n        const head = window.document.head;\n        if (head === null) {\n            // Bug #182 Chrome and Edge do throw an instance of a SyntaxError instead of a DOMException.\n            reject(new SyntaxError());\n        }\n        else {\n            const script = window.document.createElement('script');\n            // @todo Safari doesn't like URLs with a type of 'application/javascript; charset=utf-8'.\n            const blob = new Blob([source], { type: 'application/javascript' });\n            const url = URL.createObjectURL(blob);\n            const originalOnErrorHandler = window.onerror;\n            const removeErrorEventListenerAndRevokeUrl = () => {\n                window.onerror = originalOnErrorHandler;\n                URL.revokeObjectURL(url);\n            };\n            window.onerror = (message, src, lineno, colno, error) => {\n                // @todo Edge thinks the source is the one of the html document.\n                if (src === url || (src === window.location.href && lineno === 1 && colno === 1)) {\n                    removeErrorEventListenerAndRevokeUrl();\n                    reject(error);\n                    return false;\n                }\n                if (originalOnErrorHandler !== null) {\n                    return originalOnErrorHandler(message, src, lineno, colno, error);\n                }\n            };\n            script.onerror = () => {\n                removeErrorEventListenerAndRevokeUrl();\n                // Bug #182 Chrome and Edge do throw an instance of a SyntaxError instead of a DOMException.\n                reject(new SyntaxError());\n            };\n            script.onload = () => {\n                removeErrorEventListenerAndRevokeUrl();\n                resolve();\n            };\n            script.src = url;\n            script.type = 'module';\n            head.appendChild(script);\n        }\n    });\n};\n//# sourceMappingURL=evaluate-source.js.map","export const createEventTargetConstructor = (wrapEventListener) => {\n    return class EventTarget {\n        constructor(_nativeEventTarget) {\n            this._nativeEventTarget = _nativeEventTarget;\n            this._listeners = new WeakMap();\n        }\n        addEventListener(type, listener, options) {\n            if (listener !== null) {\n                let wrappedEventListener = this._listeners.get(listener);\n                if (wrappedEventListener === undefined) {\n                    wrappedEventListener = wrapEventListener(this, listener);\n                    if (typeof listener === 'function') {\n                        this._listeners.set(listener, wrappedEventListener);\n                    }\n                }\n                this._nativeEventTarget.addEventListener(type, wrappedEventListener, options);\n            }\n        }\n        dispatchEvent(event) {\n            return this._nativeEventTarget.dispatchEvent(event);\n        }\n        removeEventListener(type, listener, options) {\n            const wrappedEventListener = listener === null ? undefined : this._listeners.get(listener);\n            this._nativeEventTarget.removeEventListener(type, wrappedEventListener === undefined ? null : wrappedEventListener, options);\n        }\n    };\n};\n//# sourceMappingURL=event-target-constructor.js.map","export const createExposeCurrentFrameAndCurrentTime = (window) => {\n    return (currentTime, sampleRate, fn) => {\n        Object.defineProperties(window, {\n            currentFrame: {\n                configurable: true,\n                get() {\n                    return Math.round(currentTime * sampleRate);\n                }\n            },\n            currentTime: {\n                configurable: true,\n                get() {\n                    return currentTime;\n                }\n            }\n        });\n        try {\n            return fn();\n        }\n        finally {\n            if (window !== null) {\n                delete window.currentFrame;\n                delete window.currentTime;\n            }\n        }\n    };\n};\n//# sourceMappingURL=expose-current-frame-and-current-time.js.map","export const createFetchSource = (createAbortError) => {\n    return async (url) => {\n        try {\n            const response = await fetch(url);\n            if (response.ok) {\n                return [await response.text(), response.url];\n            }\n        }\n        catch {\n            // Ignore errors.\n        } // tslint:disable-line:no-empty\n        throw createAbortError();\n    };\n};\n//# sourceMappingURL=fetch-source.js.map","import { MOST_NEGATIVE_SINGLE_FLOAT, MOST_POSITIVE_SINGLE_FLOAT } from '../constants';\nconst DEFAULT_OPTIONS = {\n    channelCount: 2,\n    channelCountMode: 'max',\n    channelInterpretation: 'speakers',\n    gain: 1\n};\nexport const createGainNodeConstructor = (audioNodeConstructor, createAudioParam, createGainNodeRenderer, createNativeGainNode, getNativeContext, isNativeOfflineAudioContext) => {\n    return class GainNode extends audioNodeConstructor {\n        constructor(context, options) {\n            const nativeContext = getNativeContext(context);\n            const mergedOptions = { ...DEFAULT_OPTIONS, ...options };\n            const nativeGainNode = createNativeGainNode(nativeContext, mergedOptions);\n            const isOffline = isNativeOfflineAudioContext(nativeContext);\n            const gainNodeRenderer = (isOffline ? createGainNodeRenderer() : null);\n            super(context, false, nativeGainNode, gainNodeRenderer);\n            // Bug #74: Safari does not export the correct values for maxValue and minValue.\n            this._gain = createAudioParam(this, isOffline, nativeGainNode.gain, MOST_POSITIVE_SINGLE_FLOAT, MOST_NEGATIVE_SINGLE_FLOAT);\n        }\n        get gain() {\n            return this._gain;\n        }\n    };\n};\n//# sourceMappingURL=gain-node-constructor.js.map","import { isOwnedByContext } from '../helpers/is-owned-by-context';\nexport const createGainNodeRendererFactory = (connectAudioParam, createNativeGainNode, getNativeAudioNode, renderAutomation, renderInputsOfAudioNode) => {\n    return () => {\n        const renderedNativeGainNodes = new WeakMap();\n        const createGainNode = async (proxy, nativeOfflineAudioContext) => {\n            let nativeGainNode = getNativeAudioNode(proxy);\n            // If the initially used nativeGainNode was not constructed on the same OfflineAudioContext it needs to be created again.\n            const nativeGainNodeIsOwnedByContext = isOwnedByContext(nativeGainNode, nativeOfflineAudioContext);\n            if (!nativeGainNodeIsOwnedByContext) {\n                const options = {\n                    channelCount: nativeGainNode.channelCount,\n                    channelCountMode: nativeGainNode.channelCountMode,\n                    channelInterpretation: nativeGainNode.channelInterpretation,\n                    gain: nativeGainNode.gain.value\n                };\n                nativeGainNode = createNativeGainNode(nativeOfflineAudioContext, options);\n            }\n            renderedNativeGainNodes.set(nativeOfflineAudioContext, nativeGainNode);\n            if (!nativeGainNodeIsOwnedByContext) {\n                await renderAutomation(nativeOfflineAudioContext, proxy.gain, nativeGainNode.gain);\n            }\n            else {\n                await connectAudioParam(nativeOfflineAudioContext, proxy.gain, nativeGainNode.gain);\n            }\n            await renderInputsOfAudioNode(proxy, nativeOfflineAudioContext, nativeGainNode);\n            return nativeGainNode;\n        };\n        return {\n            render(proxy, nativeOfflineAudioContext) {\n                const renderedNativeGainNode = renderedNativeGainNodes.get(nativeOfflineAudioContext);\n                if (renderedNativeGainNode !== undefined) {\n                    return Promise.resolve(renderedNativeGainNode);\n                }\n                return createGainNode(proxy, nativeOfflineAudioContext);\n            }\n        };\n    };\n};\n//# sourceMappingURL=gain-node-renderer-factory.js.map","export const createGetActiveAudioWorkletNodeInputs = (activeAudioWorkletNodeInputsStore, getValueForKey) => {\n    return (nativeAudioWorkletNode) => getValueForKey(activeAudioWorkletNodeInputsStore, nativeAudioWorkletNode);\n};\n//# sourceMappingURL=get-active-audio-worklet-node-inputs.js.map","export const createGetAudioNodeRenderer = (getAudioNodeConnections) => {\n    return (audioNode) => {\n        const audioNodeConnections = getAudioNodeConnections(audioNode);\n        if (audioNodeConnections.renderer === null) {\n            throw new Error('Missing the renderer of the given AudioNode in the audio graph.');\n        }\n        return audioNodeConnections.renderer;\n    };\n};\n//# sourceMappingURL=get-audio-node-renderer.js.map","export const createGetAudioNodeTailTime = (audioNodeTailTimeStore) => {\n    return (audioNode) => { var _a; return (_a = audioNodeTailTimeStore.get(audioNode)) !== null && _a !== void 0 ? _a : 0; };\n};\n//# sourceMappingURL=get-audio-node-tail-time.js.map","export const createGetAudioParamRenderer = (getAudioParamConnections) => {\n    return (audioParam) => {\n        const audioParamConnections = getAudioParamConnections(audioParam);\n        if (audioParamConnections.renderer === null) {\n            throw new Error('Missing the renderer of the given AudioParam in the audio graph.');\n        }\n        return audioParamConnections.renderer;\n    };\n};\n//# sourceMappingURL=get-audio-param-renderer.js.map","export const createGetBackupOfflineAudioContext = (backupOfflineAudioContextStore) => {\n    return (nativeContext) => {\n        return backupOfflineAudioContextStore.get(nativeContext);\n    };\n};\n//# sourceMappingURL=get-backup-offline-audio-context.js.map","export const createInvalidStateError = () => new DOMException('', 'InvalidStateError');\n//# sourceMappingURL=invalid-state-error.js.map","import { createInvalidStateError } from './invalid-state-error';\nexport const createGetNativeContext = (contextStore) => {\n    return (context) => {\n        const nativeContext = contextStore.get(context);\n        if (nativeContext === undefined) {\n            throw createInvalidStateError();\n        }\n        return (nativeContext);\n    };\n};\n//# sourceMappingURL=get-native-context.js.map","export const createGetOrCreateBackupOfflineAudioContext = (backupOfflineAudioContextStore, nativeOfflineAudioContextConstructor) => {\n    return (nativeContext) => {\n        let backupOfflineAudioContext = backupOfflineAudioContextStore.get(nativeContext);\n        if (backupOfflineAudioContext !== undefined) {\n            return backupOfflineAudioContext;\n        }\n        if (nativeOfflineAudioContextConstructor === null) {\n            throw new Error('Missing the native OfflineAudioContext constructor.');\n        }\n        // Bug #141: Safari does not support creating an OfflineAudioContext with less than 44100 Hz.\n        backupOfflineAudioContext = new nativeOfflineAudioContextConstructor(1, 1, 44100);\n        backupOfflineAudioContextStore.set(nativeContext, backupOfflineAudioContext);\n        return backupOfflineAudioContext;\n    };\n};\n//# sourceMappingURL=get-or-create-backup-offline-audio-context.js.map","export const createGetUnrenderedAudioWorkletNodes = (unrenderedAudioWorkletNodeStore) => {\n    return (nativeContext) => {\n        const unrenderedAudioWorkletNodes = unrenderedAudioWorkletNodeStore.get(nativeContext);\n        if (unrenderedAudioWorkletNodes === undefined) {\n            throw new Error('The context has no set of AudioWorkletNodes.');\n        }\n        return unrenderedAudioWorkletNodes;\n    };\n};\n//# sourceMappingURL=get-unrendered-audio-worklet-nodes.js.map","export const createInvalidAccessError = () => new DOMException('', 'InvalidAccessError');\n//# sourceMappingURL=invalid-access-error.js.map","import { createInvalidAccessError } from '../factories/invalid-access-error';\nexport const wrapIIRFilterNodeGetFrequencyResponseMethod = (nativeIIRFilterNode) => {\n    nativeIIRFilterNode.getFrequencyResponse = ((getFrequencyResponse) => {\n        return (frequencyHz, magResponse, phaseResponse) => {\n            if (frequencyHz.length !== magResponse.length || magResponse.length !== phaseResponse.length) {\n                throw createInvalidAccessError();\n            }\n            return getFrequencyResponse.call(nativeIIRFilterNode, frequencyHz, magResponse, phaseResponse);\n        };\n    })(nativeIIRFilterNode.getFrequencyResponse);\n};\n//# sourceMappingURL=wrap-iir-filter-node-get-frequency-response-method.js.map","import { wrapIIRFilterNodeGetFrequencyResponseMethod } from '../helpers/wrap-iir-filter-node-get-frequency-response-method';\nconst DEFAULT_OPTIONS = {\n    channelCount: 2,\n    channelCountMode: 'max',\n    channelInterpretation: 'speakers'\n};\nexport const createIIRFilterNodeConstructor = (audioNodeConstructor, createNativeIIRFilterNode, createIIRFilterNodeRenderer, getNativeContext, isNativeOfflineAudioContext, setAudioNodeTailTime) => {\n    return class IIRFilterNode extends audioNodeConstructor {\n        constructor(context, options) {\n            const nativeContext = getNativeContext(context);\n            const isOffline = isNativeOfflineAudioContext(nativeContext);\n            const mergedOptions = { ...DEFAULT_OPTIONS, ...options };\n            const nativeIIRFilterNode = createNativeIIRFilterNode(nativeContext, isOffline ? null : context.baseLatency, mergedOptions);\n            const iirFilterNodeRenderer = ((isOffline ? createIIRFilterNodeRenderer(mergedOptions.feedback, mergedOptions.feedforward) : null));\n            super(context, false, nativeIIRFilterNode, iirFilterNodeRenderer);\n            // Bug #23 & #24: FirefoxDeveloper does not throw an InvalidAccessError.\n            // @todo Write a test which allows other browsers to remain unpatched.\n            wrapIIRFilterNodeGetFrequencyResponseMethod(nativeIIRFilterNode);\n            this._nativeIIRFilterNode = nativeIIRFilterNode;\n            // @todo Determine a meaningful tail-time instead of just using one second.\n            setAudioNodeTailTime(this, 1);\n        }\n        getFrequencyResponse(frequencyHz, magResponse, phaseResponse) {\n            return this._nativeIIRFilterNode.getFrequencyResponse(frequencyHz, magResponse, phaseResponse);\n        }\n    };\n};\n//# sourceMappingURL=iir-filter-node-constructor.js.map","// This implementation as shamelessly inspired by source code of\n// tslint:disable-next-line:max-line-length\n// {@link https://chromium.googlesource.com/chromium/src.git/+/master/third_party/WebKit/Source/platform/audio/IIRFilter.cpp|Chromium's IIRFilter}.\nexport const filterBuffer = (feedback, feedbackLength, feedforward, feedforwardLength, minLength, xBuffer, yBuffer, bufferIndex, bufferLength, input, output) => {\n    const inputLength = input.length;\n    let i = bufferIndex;\n    for (let j = 0; j < inputLength; j += 1) {\n        let y = feedforward[0] * input[j];\n        for (let k = 1; k < minLength; k += 1) {\n            const x = (i - k) & (bufferLength - 1); // tslint:disable-line:no-bitwise\n            y += feedforward[k] * xBuffer[x];\n            y -= feedback[k] * yBuffer[x];\n        }\n        for (let k = minLength; k < feedforwardLength; k += 1) {\n            y += feedforward[k] * xBuffer[(i - k) & (bufferLength - 1)]; // tslint:disable-line:no-bitwise\n        }\n        for (let k = minLength; k < feedbackLength; k += 1) {\n            y -= feedback[k] * yBuffer[(i - k) & (bufferLength - 1)]; // tslint:disable-line:no-bitwise\n        }\n        xBuffer[i] = input[j];\n        yBuffer[i] = y;\n        i = (i + 1) & (bufferLength - 1); // tslint:disable-line:no-bitwise\n        output[j] = y;\n    }\n    return i;\n};\n//# sourceMappingURL=filter-buffer.js.map","import { filterBuffer } from '../helpers/filter-buffer';\nimport { isOwnedByContext } from '../helpers/is-owned-by-context';\nconst filterFullBuffer = (renderedBuffer, nativeOfflineAudioContext, feedback, feedforward) => {\n    const convertedFeedback = feedback instanceof Float64Array ? feedback : new Float64Array(feedback);\n    const convertedFeedforward = feedforward instanceof Float64Array ? feedforward : new Float64Array(feedforward);\n    const feedbackLength = convertedFeedback.length;\n    const feedforwardLength = convertedFeedforward.length;\n    const minLength = Math.min(feedbackLength, feedforwardLength);\n    if (convertedFeedback[0] !== 1) {\n        for (let i = 0; i < feedbackLength; i += 1) {\n            convertedFeedforward[i] /= convertedFeedback[0];\n        }\n        for (let i = 1; i < feedforwardLength; i += 1) {\n            convertedFeedback[i] /= convertedFeedback[0];\n        }\n    }\n    const bufferLength = 32;\n    const xBuffer = new Float32Array(bufferLength);\n    const yBuffer = new Float32Array(bufferLength);\n    const filteredBuffer = nativeOfflineAudioContext.createBuffer(renderedBuffer.numberOfChannels, renderedBuffer.length, renderedBuffer.sampleRate);\n    const numberOfChannels = renderedBuffer.numberOfChannels;\n    for (let i = 0; i < numberOfChannels; i += 1) {\n        const input = renderedBuffer.getChannelData(i);\n        const output = filteredBuffer.getChannelData(i);\n        xBuffer.fill(0);\n        yBuffer.fill(0);\n        filterBuffer(convertedFeedback, feedbackLength, convertedFeedforward, feedforwardLength, minLength, xBuffer, yBuffer, 0, bufferLength, input, output);\n    }\n    return filteredBuffer;\n};\nexport const createIIRFilterNodeRendererFactory = (createNativeAudioBufferSourceNode, getNativeAudioNode, nativeOfflineAudioContextConstructor, renderInputsOfAudioNode, renderNativeOfflineAudioContext) => {\n    return (feedback, feedforward) => {\n        const renderedNativeAudioNodes = new WeakMap();\n        let filteredBufferPromise = null;\n        const createAudioNode = async (proxy, nativeOfflineAudioContext) => {\n            let nativeAudioBufferSourceNode = null;\n            let nativeIIRFilterNode = getNativeAudioNode(proxy);\n            // If the initially used nativeIIRFilterNode was not constructed on the same OfflineAudioContext it needs to be created again.\n            const nativeIIRFilterNodeIsOwnedByContext = isOwnedByContext(nativeIIRFilterNode, nativeOfflineAudioContext);\n            // Bug #9: Safari does not support IIRFilterNodes.\n            if (nativeOfflineAudioContext.createIIRFilter === undefined) {\n                nativeAudioBufferSourceNode = createNativeAudioBufferSourceNode(nativeOfflineAudioContext, {\n                    buffer: null,\n                    channelCount: 2,\n                    channelCountMode: 'max',\n                    channelInterpretation: 'speakers',\n                    loop: false,\n                    loopEnd: 0,\n                    loopStart: 0,\n                    playbackRate: 1\n                });\n            }\n            else if (!nativeIIRFilterNodeIsOwnedByContext) {\n                // @todo TypeScript defines the parameters of createIIRFilter() as arrays of numbers.\n                nativeIIRFilterNode = nativeOfflineAudioContext.createIIRFilter(feedforward, feedback);\n            }\n            renderedNativeAudioNodes.set(nativeOfflineAudioContext, nativeAudioBufferSourceNode === null ? nativeIIRFilterNode : nativeAudioBufferSourceNode);\n            if (nativeAudioBufferSourceNode !== null) {\n                if (filteredBufferPromise === null) {\n                    if (nativeOfflineAudioContextConstructor === null) {\n                        throw new Error('Missing the native OfflineAudioContext constructor.');\n                    }\n                    const partialOfflineAudioContext = new nativeOfflineAudioContextConstructor(\n                    // Bug #47: The AudioDestinationNode in Safari gets not initialized correctly.\n                    proxy.context.destination.channelCount, \n                    // Bug #17: Safari does not yet expose the length.\n                    proxy.context.length, nativeOfflineAudioContext.sampleRate);\n                    filteredBufferPromise = (async () => {\n                        await renderInputsOfAudioNode(proxy, partialOfflineAudioContext, partialOfflineAudioContext.destination);\n                        const renderedBuffer = await renderNativeOfflineAudioContext(partialOfflineAudioContext);\n                        return filterFullBuffer(renderedBuffer, nativeOfflineAudioContext, feedback, feedforward);\n                    })();\n                }\n                const filteredBuffer = await filteredBufferPromise;\n                nativeAudioBufferSourceNode.buffer = filteredBuffer;\n                nativeAudioBufferSourceNode.start(0);\n                return nativeAudioBufferSourceNode;\n            }\n            await renderInputsOfAudioNode(proxy, nativeOfflineAudioContext, nativeIIRFilterNode);\n            return nativeIIRFilterNode;\n        };\n        return {\n            render(proxy, nativeOfflineAudioContext) {\n                const renderedNativeAudioNode = renderedNativeAudioNodes.get(nativeOfflineAudioContext);\n                if (renderedNativeAudioNode !== undefined) {\n                    return Promise.resolve(renderedNativeAudioNode);\n                }\n                return createAudioNode(proxy, nativeOfflineAudioContext);\n            }\n        };\n    };\n};\n//# sourceMappingURL=iir-filter-node-renderer-factory.js.map","import { isAudioNodeOutputConnection } from '../guards/audio-node-output-connection';\nexport const createIncrementCycleCounterFactory = (cycleCounters, disconnectNativeAudioNodeFromNativeAudioNode, getAudioNodeConnections, getNativeAudioNode, getNativeAudioParam, isActiveAudioNode) => {\n    return (isOffline) => {\n        return (audioNode, count) => {\n            const cycleCounter = cycleCounters.get(audioNode);\n            if (cycleCounter === undefined) {\n                if (!isOffline && isActiveAudioNode(audioNode)) {\n                    const nativeSourceAudioNode = getNativeAudioNode(audioNode);\n                    const { outputs } = getAudioNodeConnections(audioNode);\n                    for (const output of outputs) {\n                        if (isAudioNodeOutputConnection(output)) {\n                            const nativeDestinationAudioNode = getNativeAudioNode(output[0]);\n                            disconnectNativeAudioNodeFromNativeAudioNode(nativeSourceAudioNode, nativeDestinationAudioNode, output[1], output[2]);\n                        }\n                        else {\n                            const nativeDestinationAudioParam = getNativeAudioParam(output[0]);\n                            nativeSourceAudioNode.disconnect(nativeDestinationAudioParam, output[1]);\n                        }\n                    }\n                }\n                cycleCounters.set(audioNode, count);\n            }\n            else {\n                cycleCounters.set(audioNode, cycleCounter + count);\n            }\n        };\n    };\n};\n//# sourceMappingURL=increment-cycle-counter-factory.js.map","export const createIsAnyAudioContext = (contextStore, isNativeAudioContext) => {\n    return (anything) => {\n        const nativeContext = contextStore.get(anything);\n        return isNativeAudioContext(nativeContext) || isNativeAudioContext(anything);\n    };\n};\n//# sourceMappingURL=is-any-audio-context.js.map","export const createIsAnyAudioNode = (audioNodeStore, isNativeAudioNode) => {\n    return (anything) => audioNodeStore.has(anything) || isNativeAudioNode(anything);\n};\n//# sourceMappingURL=is-any-audio-node.js.map","export const createIsAnyAudioParam = (audioParamStore, isNativeAudioParam) => {\n    return (anything) => audioParamStore.has(anything) || isNativeAudioParam(anything);\n};\n//# sourceMappingURL=is-any-audio-param.js.map","export const createIsAnyOfflineAudioContext = (contextStore, isNativeOfflineAudioContext) => {\n    return (anything) => {\n        const nativeContext = contextStore.get(anything);\n        return isNativeOfflineAudioContext(nativeContext) || isNativeOfflineAudioContext(anything);\n    };\n};\n//# sourceMappingURL=is-any-offline-audio-context.js.map","export const createIsNativeAudioContext = (nativeAudioContextConstructor) => {\n    return (anything) => {\n        return nativeAudioContextConstructor !== null && anything instanceof nativeAudioContextConstructor;\n    };\n};\n//# sourceMappingURL=is-native-audio-context.js.map","export const createIsNativeAudioNode = (window) => {\n    return (anything) => {\n        return window !== null && typeof window.AudioNode === 'function' && anything instanceof window.AudioNode;\n    };\n};\n//# sourceMappingURL=is-native-audio-node.js.map","export const createIsNativeAudioParam = (window) => {\n    return (anything) => {\n        return window !== null && typeof window.AudioParam === 'function' && anything instanceof window.AudioParam;\n    };\n};\n//# sourceMappingURL=is-native-audio-param.js.map","export const createIsNativeContext = (isNativeAudioContext, isNativeOfflineAudioContext) => {\n    return (anything) => {\n        return isNativeAudioContext(anything) || isNativeOfflineAudioContext(anything);\n    };\n};\n//# sourceMappingURL=is-native-context.js.map","export const createIsNativeOfflineAudioContext = (nativeOfflineAudioContextConstructor) => {\n    return (anything) => {\n        return nativeOfflineAudioContextConstructor !== null && anything instanceof nativeOfflineAudioContextConstructor;\n    };\n};\n//# sourceMappingURL=is-native-offline-audio-context.js.map","export const createIsSecureContext = (window) => window !== null && window.isSecureContext;\n//# sourceMappingURL=is-secure-context.js.map","export const createMediaElementAudioSourceNodeConstructor = (audioNodeConstructor, createNativeMediaElementAudioSourceNode, getNativeContext, isNativeOfflineAudioContext) => {\n    return class MediaElementAudioSourceNode extends audioNodeConstructor {\n        constructor(context, options) {\n            const nativeContext = getNativeContext(context);\n            const nativeMediaElementAudioSourceNode = createNativeMediaElementAudioSourceNode(nativeContext, options);\n            // Bug #171: Safari allows to create a MediaElementAudioSourceNode with an OfflineAudioContext.\n            if (isNativeOfflineAudioContext(nativeContext)) {\n                throw TypeError();\n            }\n            super(context, true, nativeMediaElementAudioSourceNode, null);\n            this._nativeMediaElementAudioSourceNode = nativeMediaElementAudioSourceNode;\n        }\n        get mediaElement() {\n            return this._nativeMediaElementAudioSourceNode.mediaElement;\n        }\n    };\n};\n//# sourceMappingURL=media-element-audio-source-node-constructor.js.map","const DEFAULT_OPTIONS = {\n    channelCount: 2,\n    channelCountMode: 'explicit',\n    channelInterpretation: 'speakers'\n};\nexport const createMediaStreamAudioDestinationNodeConstructor = (audioNodeConstructor, createNativeMediaStreamAudioDestinationNode, getNativeContext, isNativeOfflineAudioContext) => {\n    return class MediaStreamAudioDestinationNode extends audioNodeConstructor {\n        constructor(context, options) {\n            const nativeContext = getNativeContext(context);\n            // Bug #173: Safari allows to create a MediaStreamAudioDestinationNode with an OfflineAudioContext.\n            if (isNativeOfflineAudioContext(nativeContext)) {\n                throw new TypeError();\n            }\n            const mergedOptions = { ...DEFAULT_OPTIONS, ...options };\n            const nativeMediaStreamAudioDestinationNode = createNativeMediaStreamAudioDestinationNode(nativeContext, mergedOptions);\n            super(context, false, nativeMediaStreamAudioDestinationNode, null);\n            this._nativeMediaStreamAudioDestinationNode = nativeMediaStreamAudioDestinationNode;\n        }\n        get stream() {\n            return this._nativeMediaStreamAudioDestinationNode.stream;\n        }\n    };\n};\n//# sourceMappingURL=media-stream-audio-destination-node-constructor.js.map","export const createMediaStreamAudioSourceNodeConstructor = (audioNodeConstructor, createNativeMediaStreamAudioSourceNode, getNativeContext, isNativeOfflineAudioContext) => {\n    return class MediaStreamAudioSourceNode extends audioNodeConstructor {\n        constructor(context, options) {\n            const nativeContext = getNativeContext(context);\n            const nativeMediaStreamAudioSourceNode = createNativeMediaStreamAudioSourceNode(nativeContext, options);\n            // Bug #172: Safari allows to create a MediaStreamAudioSourceNode with an OfflineAudioContext.\n            if (isNativeOfflineAudioContext(nativeContext)) {\n                throw new TypeError();\n            }\n            super(context, true, nativeMediaStreamAudioSourceNode, null);\n            this._nativeMediaStreamAudioSourceNode = nativeMediaStreamAudioSourceNode;\n        }\n        get mediaStream() {\n            return this._nativeMediaStreamAudioSourceNode.mediaStream;\n        }\n    };\n};\n//# sourceMappingURL=media-stream-audio-source-node-constructor.js.map","export const createMediaStreamTrackAudioSourceNodeConstructor = (audioNodeConstructor, createNativeMediaStreamTrackAudioSourceNode, getNativeContext) => {\n    return class MediaStreamTrackAudioSourceNode extends audioNodeConstructor {\n        constructor(context, options) {\n            const nativeContext = getNativeContext(context);\n            const nativeMediaStreamTrackAudioSourceNode = createNativeMediaStreamTrackAudioSourceNode(nativeContext, options);\n            super(context, true, nativeMediaStreamTrackAudioSourceNode, null);\n        }\n    };\n};\n//# sourceMappingURL=media-stream-track-audio-source-node-constructor.js.map","import { CONTEXT_STORE } from '../globals';\nexport const createMinimalBaseAudioContextConstructor = (audioDestinationNodeConstructor, createAudioListener, eventTargetConstructor, isNativeOfflineAudioContext, unrenderedAudioWorkletNodeStore, wrapEventListener) => {\n    return class MinimalBaseAudioContext extends eventTargetConstructor {\n        constructor(_nativeContext, numberOfChannels) {\n            super(_nativeContext);\n            this._nativeContext = _nativeContext;\n            CONTEXT_STORE.set(this, _nativeContext);\n            if (isNativeOfflineAudioContext(_nativeContext)) {\n                unrenderedAudioWorkletNodeStore.set(_nativeContext, new Set());\n            }\n            this._destination = new audioDestinationNodeConstructor(this, numberOfChannels);\n            this._listener = createAudioListener(this, _nativeContext);\n            this._onstatechange = null;\n        }\n        get currentTime() {\n            return this._nativeContext.currentTime;\n        }\n        get destination() {\n            return this._destination;\n        }\n        get listener() {\n            return this._listener;\n        }\n        get onstatechange() {\n            return this._onstatechange;\n        }\n        set onstatechange(value) {\n            const wrappedListener = typeof value === 'function' ? wrapEventListener(this, value) : null;\n            this._nativeContext.onstatechange = wrappedListener;\n            const nativeOnStateChange = this._nativeContext.onstatechange;\n            this._onstatechange = nativeOnStateChange !== null && nativeOnStateChange === wrappedListener ? value : nativeOnStateChange;\n        }\n        get sampleRate() {\n            return this._nativeContext.sampleRate;\n        }\n        get state() {\n            return this._nativeContext.state;\n        }\n    };\n};\n//# sourceMappingURL=minimal-base-audio-context-constructor.js.map","export const testPromiseSupport = (nativeContext) => {\n    // This 12 numbers represent the 48 bytes of an empty WAVE file with a single sample.\n    const uint32Array = new Uint32Array([1179011410, 40, 1163280727, 544501094, 16, 131073, 44100, 176400, 1048580, 1635017060, 4, 0]);\n    try {\n        // Bug #1: Safari requires a successCallback.\n        const promise = nativeContext.decodeAudioData(uint32Array.buffer, () => {\n            // Ignore the success callback.\n        });\n        if (promise === undefined) {\n            return false;\n        }\n        promise.catch(() => {\n            // Ignore rejected errors.\n        });\n        return true;\n    }\n    catch {\n        // Ignore errors.\n    }\n    return false;\n};\n//# sourceMappingURL=test-promise-support.js.map","export const createMonitorConnections = (insertElementInSet, isNativeAudioNode) => {\n    return (nativeAudioNode, whenConnected, whenDisconnected) => {\n        const connections = new Set();\n        nativeAudioNode.connect = ((connect) => {\n            // tslint:disable-next-line:invalid-void no-inferrable-types\n            return (destination, output = 0, input = 0) => {\n                const wasDisconnected = connections.size === 0;\n                if (isNativeAudioNode(destination)) {\n                    // @todo TypeScript cannot infer the overloaded signature with 3 arguments yet.\n                    connect.call(nativeAudioNode, destination, output, input);\n                    insertElementInSet(connections, [destination, output, input], (connection) => connection[0] === destination && connection[1] === output && connection[2] === input, true);\n                    if (wasDisconnected) {\n                        whenConnected();\n                    }\n                    return destination;\n                }\n                connect.call(nativeAudioNode, destination, output);\n                insertElementInSet(connections, [destination, output], (connection) => connection[0] === destination && connection[1] === output, true);\n                if (wasDisconnected) {\n                    whenConnected();\n                }\n                return;\n            };\n        })(nativeAudioNode.connect);\n        nativeAudioNode.disconnect = ((disconnect) => {\n            return (destinationOrOutput, output, input) => {\n                const wasConnected = connections.size > 0;\n                if (destinationOrOutput === undefined) {\n                    disconnect.apply(nativeAudioNode);\n                    connections.clear();\n                }\n                else if (typeof destinationOrOutput === 'number') {\n                    // @todo TypeScript cannot infer the overloaded signature with 1 argument yet.\n                    disconnect.call(nativeAudioNode, destinationOrOutput);\n                    for (const connection of connections) {\n                        if (connection[1] === destinationOrOutput) {\n                            connections.delete(connection);\n                        }\n                    }\n                }\n                else {\n                    if (isNativeAudioNode(destinationOrOutput)) {\n                        // @todo TypeScript cannot infer the overloaded signature with 3 arguments yet.\n                        disconnect.call(nativeAudioNode, destinationOrOutput, output, input);\n                    }\n                    else {\n                        // @todo TypeScript cannot infer the overloaded signature with 2 arguments yet.\n                        disconnect.call(nativeAudioNode, destinationOrOutput, output);\n                    }\n                    for (const connection of connections) {\n                        if (connection[0] === destinationOrOutput &&\n                            (output === undefined || connection[1] === output) &&\n                            (input === undefined || connection[2] === input)) {\n                            connections.delete(connection);\n                        }\n                    }\n                }\n                const isDisconnected = connections.size === 0;\n                if (wasConnected && isDisconnected) {\n                    whenDisconnected();\n                }\n            };\n        })(nativeAudioNode.disconnect);\n        return nativeAudioNode;\n    };\n};\n//# sourceMappingURL=monitor-connections.js.map","export const assignNativeAudioNodeOption = (nativeAudioNode, options, option) => {\n    const value = options[option];\n    if (value !== undefined && value !== nativeAudioNode[option]) {\n        nativeAudioNode[option] = value;\n    }\n};\n//# sourceMappingURL=assign-native-audio-node-option.js.map","import { assignNativeAudioNodeOption } from './assign-native-audio-node-option';\nexport const assignNativeAudioNodeOptions = (nativeAudioNode, options) => {\n    assignNativeAudioNodeOption(nativeAudioNode, options, 'channelCount');\n    assignNativeAudioNodeOption(nativeAudioNode, options, 'channelCountMode');\n    assignNativeAudioNodeOption(nativeAudioNode, options, 'channelInterpretation');\n};\n//# sourceMappingURL=assign-native-audio-node-options.js.map","export const testAnalyserNodeGetFloatTimeDomainDataMethodSupport = (nativeAnalyserNode) => {\n    return typeof nativeAnalyserNode.getFloatTimeDomainData === 'function';\n};\n//# sourceMappingURL=test-analyser-node-get-float-time-domain-data-method-support.js.map","export const wrapAnalyserNodeGetFloatTimeDomainDataMethod = (nativeAnalyserNode) => {\n    nativeAnalyserNode.getFloatTimeDomainData = (array) => {\n        const byteTimeDomainData = new Uint8Array(array.length);\n        nativeAnalyserNode.getByteTimeDomainData(byteTimeDomainData);\n        const length = Math.max(byteTimeDomainData.length, nativeAnalyserNode.fftSize);\n        for (let i = 0; i < length; i += 1) {\n            array[i] = (byteTimeDomainData[i] - 128) * 0.0078125;\n        }\n        return array;\n    };\n};\n//# sourceMappingURL=wrap-analyser-node-get-float-time-domain-data-method.js.map","import { assignNativeAudioNodeOption } from '../helpers/assign-native-audio-node-option';\nimport { assignNativeAudioNodeOptions } from '../helpers/assign-native-audio-node-options';\nimport { testAnalyserNodeGetFloatTimeDomainDataMethodSupport } from '../helpers/test-analyser-node-get-float-time-domain-data-method-support';\nimport { wrapAnalyserNodeGetFloatTimeDomainDataMethod } from '../helpers/wrap-analyser-node-get-float-time-domain-data-method';\nexport const createNativeAnalyserNodeFactory = (cacheTestResult, createIndexSizeError) => {\n    return (nativeContext, options) => {\n        const nativeAnalyserNode = nativeContext.createAnalyser();\n        // Bug #37: Firefox does not create an AnalyserNode with the default properties.\n        assignNativeAudioNodeOptions(nativeAnalyserNode, options);\n        // Bug #118: Safari does not throw an error if maxDecibels is not more than minDecibels.\n        if (!(options.maxDecibels > options.minDecibels)) {\n            throw createIndexSizeError();\n        }\n        assignNativeAudioNodeOption(nativeAnalyserNode, options, 'fftSize');\n        assignNativeAudioNodeOption(nativeAnalyserNode, options, 'maxDecibels');\n        assignNativeAudioNodeOption(nativeAnalyserNode, options, 'minDecibels');\n        assignNativeAudioNodeOption(nativeAnalyserNode, options, 'smoothingTimeConstant');\n        // Bug #36: Safari does not support getFloatTimeDomainData() yet.\n        if (!cacheTestResult(testAnalyserNodeGetFloatTimeDomainDataMethodSupport, () => testAnalyserNodeGetFloatTimeDomainDataMethodSupport(nativeAnalyserNode))) {\n            wrapAnalyserNodeGetFloatTimeDomainDataMethod(nativeAnalyserNode);\n        }\n        return nativeAnalyserNode;\n    };\n};\n//# sourceMappingURL=native-analyser-node-factory.js.map","export const createNativeAudioBufferConstructor = (window) => {\n    if (window === null) {\n        return null;\n    }\n    if (window.hasOwnProperty('AudioBuffer')) {\n        return window.AudioBuffer;\n    }\n    return null;\n};\n//# sourceMappingURL=native-audio-buffer-constructor.js.map","export const assignNativeAudioNodeAudioParamValue = (nativeAudioNode, options, audioParam) => {\n    const value = options[audioParam];\n    if (value !== undefined && value !== nativeAudioNode[audioParam].value) {\n        nativeAudioNode[audioParam].value = value;\n    }\n};\n//# sourceMappingURL=assign-native-audio-node-audio-param-value.js.map","import { createInvalidStateError } from '../factories/invalid-state-error';\nexport const wrapAudioBufferSourceNodeStartMethodConsecutiveCalls = (nativeAudioBufferSourceNode) => {\n    nativeAudioBufferSourceNode.start = ((start) => {\n        let isScheduled = false;\n        return (when = 0, offset = 0, duration) => {\n            if (isScheduled) {\n                throw createInvalidStateError();\n            }\n            start.call(nativeAudioBufferSourceNode, when, offset, duration);\n            isScheduled = true;\n        };\n    })(nativeAudioBufferSourceNode.start);\n};\n//# sourceMappingURL=wrap-audio-buffer-source-node-start-method-consecutive-calls.js.map","export const wrapAudioScheduledSourceNodeStartMethodNegativeParameters = (nativeAudioScheduledSourceNode) => {\n    nativeAudioScheduledSourceNode.start = ((start) => {\n        return (when = 0, offset = 0, duration) => {\n            if ((typeof duration === 'number' && duration < 0) || offset < 0 || when < 0) {\n                throw new RangeError(\"The parameters can't be negative.\");\n            }\n            // @todo TypeScript cannot infer the overloaded signature with 3 arguments yet.\n            start.call(nativeAudioScheduledSourceNode, when, offset, duration);\n        };\n    })(nativeAudioScheduledSourceNode.start);\n};\n//# sourceMappingURL=wrap-audio-scheduled-source-node-start-method-negative-parameters.js.map","export const wrapAudioScheduledSourceNodeStopMethodNegativeParameters = (nativeAudioScheduledSourceNode) => {\n    nativeAudioScheduledSourceNode.stop = ((stop) => {\n        return (when = 0) => {\n            if (when < 0) {\n                throw new RangeError(\"The parameter can't be negative.\");\n            }\n            stop.call(nativeAudioScheduledSourceNode, when);\n        };\n    })(nativeAudioScheduledSourceNode.stop);\n};\n//# sourceMappingURL=wrap-audio-scheduled-source-node-stop-method-negative-parameters.js.map","import { assignNativeAudioNodeAudioParamValue } from '../helpers/assign-native-audio-node-audio-param-value';\nimport { assignNativeAudioNodeOption } from '../helpers/assign-native-audio-node-option';\nimport { assignNativeAudioNodeOptions } from '../helpers/assign-native-audio-node-options';\nimport { wrapAudioBufferSourceNodeStartMethodConsecutiveCalls } from '../helpers/wrap-audio-buffer-source-node-start-method-consecutive-calls';\nimport { wrapAudioScheduledSourceNodeStartMethodNegativeParameters } from '../helpers/wrap-audio-scheduled-source-node-start-method-negative-parameters';\nimport { wrapAudioScheduledSourceNodeStopMethodNegativeParameters } from '../helpers/wrap-audio-scheduled-source-node-stop-method-negative-parameters';\nexport const createNativeAudioBufferSourceNodeFactory = (addSilentConnection, cacheTestResult, testAudioBufferSourceNodeStartMethodConsecutiveCallsSupport, testAudioBufferSourceNodeStartMethodOffsetClampingSupport, testAudioBufferSourceNodeStopMethodNullifiedBufferSupport, testAudioScheduledSourceNodeStartMethodNegativeParametersSupport, testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport, testAudioScheduledSourceNodeStopMethodNegativeParametersSupport, wrapAudioBufferSourceNodeStartMethodOffsetClampling, wrapAudioBufferSourceNodeStopMethodNullifiedBuffer, wrapAudioScheduledSourceNodeStopMethodConsecutiveCalls) => {\n    return (nativeContext, options) => {\n        const nativeAudioBufferSourceNode = nativeContext.createBufferSource();\n        assignNativeAudioNodeOptions(nativeAudioBufferSourceNode, options);\n        assignNativeAudioNodeAudioParamValue(nativeAudioBufferSourceNode, options, 'playbackRate');\n        assignNativeAudioNodeOption(nativeAudioBufferSourceNode, options, 'buffer');\n        // Bug #149: Safari does not yet support the detune AudioParam.\n        assignNativeAudioNodeOption(nativeAudioBufferSourceNode, options, 'loop');\n        assignNativeAudioNodeOption(nativeAudioBufferSourceNode, options, 'loopEnd');\n        assignNativeAudioNodeOption(nativeAudioBufferSourceNode, options, 'loopStart');\n        // Bug #69: Safari does allow calls to start() of an already scheduled AudioBufferSourceNode.\n        if (!cacheTestResult(testAudioBufferSourceNodeStartMethodConsecutiveCallsSupport, () => testAudioBufferSourceNodeStartMethodConsecutiveCallsSupport(nativeContext))) {\n            wrapAudioBufferSourceNodeStartMethodConsecutiveCalls(nativeAudioBufferSourceNode);\n        }\n        // Bug #154 & #155: Safari does not handle offsets which are equal to or greater than the duration of the buffer.\n        if (!cacheTestResult(testAudioBufferSourceNodeStartMethodOffsetClampingSupport, () => testAudioBufferSourceNodeStartMethodOffsetClampingSupport(nativeContext))) {\n            wrapAudioBufferSourceNodeStartMethodOffsetClampling(nativeAudioBufferSourceNode);\n        }\n        // Bug #162: Safari does throw an error when stop() is called on an AudioBufferSourceNode which has no buffer assigned to it.\n        if (!cacheTestResult(testAudioBufferSourceNodeStopMethodNullifiedBufferSupport, () => testAudioBufferSourceNodeStopMethodNullifiedBufferSupport(nativeContext))) {\n            wrapAudioBufferSourceNodeStopMethodNullifiedBuffer(nativeAudioBufferSourceNode, nativeContext);\n        }\n        // Bug #44: Safari does not throw a RangeError yet.\n        if (!cacheTestResult(testAudioScheduledSourceNodeStartMethodNegativeParametersSupport, () => testAudioScheduledSourceNodeStartMethodNegativeParametersSupport(nativeContext))) {\n            wrapAudioScheduledSourceNodeStartMethodNegativeParameters(nativeAudioBufferSourceNode);\n        }\n        // Bug #19: Safari does not ignore calls to stop() of an already stopped AudioBufferSourceNode.\n        if (!cacheTestResult(testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport, () => testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport(nativeContext))) {\n            wrapAudioScheduledSourceNodeStopMethodConsecutiveCalls(nativeAudioBufferSourceNode, nativeContext);\n        }\n        // Bug #44: Only Firefox does not throw a RangeError yet.\n        if (!cacheTestResult(testAudioScheduledSourceNodeStopMethodNegativeParametersSupport, () => testAudioScheduledSourceNodeStopMethodNegativeParametersSupport(nativeContext))) {\n            wrapAudioScheduledSourceNodeStopMethodNegativeParameters(nativeAudioBufferSourceNode);\n        }\n        // Bug #175: Safari will not fire an ended event if the AudioBufferSourceNode is unconnected.\n        addSilentConnection(nativeContext, nativeAudioBufferSourceNode);\n        return nativeAudioBufferSourceNode;\n    };\n};\n//# sourceMappingURL=native-audio-buffer-source-node-factory.js.map","export const createNativeAudioContextConstructor = (window) => {\n    if (window === null) {\n        return null;\n    }\n    if (window.hasOwnProperty('AudioContext')) {\n        return window.AudioContext;\n    }\n    return window.hasOwnProperty('webkitAudioContext') ? window.webkitAudioContext : null;\n};\n//# sourceMappingURL=native-audio-context-constructor.js.map","export const createNativeAudioDestinationNodeFactory = (createNativeGainNode, overwriteAccessors) => {\n    return (nativeContext, channelCount, isNodeOfNativeOfflineAudioContext) => {\n        const nativeAudioDestinationNode = nativeContext.destination;\n        // Bug #132: Safari does not have the correct channelCount.\n        if (nativeAudioDestinationNode.channelCount !== channelCount) {\n            try {\n                nativeAudioDestinationNode.channelCount = channelCount;\n            }\n            catch {\n                // Bug #169: Safari throws an error on each attempt to change the channelCount.\n            }\n        }\n        // Bug #83: Safari does not have the correct channelCountMode.\n        if (isNodeOfNativeOfflineAudioContext && nativeAudioDestinationNode.channelCountMode !== 'explicit') {\n            nativeAudioDestinationNode.channelCountMode = 'explicit';\n        }\n        // Bug #47: The AudioDestinationNode in Safari does not initialize the maxChannelCount property correctly.\n        if (nativeAudioDestinationNode.maxChannelCount === 0) {\n            Object.defineProperty(nativeAudioDestinationNode, 'maxChannelCount', {\n                value: channelCount\n            });\n        }\n        // Bug #168: No browser does yet have an AudioDestinationNode with an output.\n        const gainNode = createNativeGainNode(nativeContext, {\n            channelCount,\n            channelCountMode: nativeAudioDestinationNode.channelCountMode,\n            channelInterpretation: nativeAudioDestinationNode.channelInterpretation,\n            gain: 1\n        });\n        overwriteAccessors(gainNode, 'channelCount', (get) => () => get.call(gainNode), (set) => (value) => {\n            set.call(gainNode, value);\n            try {\n                nativeAudioDestinationNode.channelCount = value;\n            }\n            catch (err) {\n                // Bug #169: Safari throws an error on each attempt to change the channelCount.\n                if (value > nativeAudioDestinationNode.maxChannelCount) {\n                    throw err;\n                }\n            }\n        });\n        overwriteAccessors(gainNode, 'channelCountMode', (get) => () => get.call(gainNode), (set) => (value) => {\n            set.call(gainNode, value);\n            nativeAudioDestinationNode.channelCountMode = value;\n        });\n        overwriteAccessors(gainNode, 'channelInterpretation', (get) => () => get.call(gainNode), (set) => (value) => {\n            set.call(gainNode, value);\n            nativeAudioDestinationNode.channelInterpretation = value;\n        });\n        Object.defineProperty(gainNode, 'maxChannelCount', {\n            get: () => nativeAudioDestinationNode.maxChannelCount\n        });\n        // @todo This should be disconnected when the context is closed.\n        gainNode.connect(nativeAudioDestinationNode);\n        return gainNode;\n    };\n};\n//# sourceMappingURL=native-audio-destination-node.js.map","export const createNativeAudioWorkletNodeConstructor = (window) => {\n    if (window === null) {\n        return null;\n    }\n    return window.hasOwnProperty('AudioWorkletNode') ? window.AudioWorkletNode : null;\n};\n//# sourceMappingURL=native-audio-worklet-node-constructor.js.map","export const testClonabilityOfAudioWorkletNodeOptions = (audioWorkletNodeOptions) => {\n    const { port1 } = new MessageChannel();\n    try {\n        // This will throw an error if the audioWorkletNodeOptions are not clonable.\n        port1.postMessage(audioWorkletNodeOptions);\n    }\n    finally {\n        port1.close();\n    }\n};\n//# sourceMappingURL=test-clonability-of-audio-worklet-node-options.js.map","import { testClonabilityOfAudioWorkletNodeOptions } from '../helpers/test-clonability-of-audio-worklet-node-options';\nexport const createNativeAudioWorkletNodeFactory = (createInvalidStateError, createNativeAudioWorkletNodeFaker, createNativeGainNode, createNotSupportedError, monitorConnections) => {\n    return (nativeContext, baseLatency, nativeAudioWorkletNodeConstructor, name, processorConstructor, options) => {\n        if (nativeAudioWorkletNodeConstructor !== null) {\n            try {\n                const nativeAudioWorkletNode = new nativeAudioWorkletNodeConstructor(nativeContext, name, options);\n                const patchedEventListeners = new Map();\n                let onprocessorerror = null;\n                Object.defineProperties(nativeAudioWorkletNode, {\n                    /*\n                     * Bug #61: Overwriting the property accessors for channelCount and channelCountMode is necessary as long as some\n                     * browsers have no native implementation to achieve a consistent behavior.\n                     */\n                    channelCount: {\n                        get: () => options.channelCount,\n                        set: () => {\n                            throw createInvalidStateError();\n                        }\n                    },\n                    channelCountMode: {\n                        get: () => 'explicit',\n                        set: () => {\n                            throw createInvalidStateError();\n                        }\n                    },\n                    // Bug #156: Chrome and Edge do not yet fire an ErrorEvent.\n                    onprocessorerror: {\n                        get: () => onprocessorerror,\n                        set: (value) => {\n                            if (typeof onprocessorerror === 'function') {\n                                nativeAudioWorkletNode.removeEventListener('processorerror', onprocessorerror);\n                            }\n                            onprocessorerror = typeof value === 'function' ? value : null;\n                            if (typeof onprocessorerror === 'function') {\n                                nativeAudioWorkletNode.addEventListener('processorerror', onprocessorerror);\n                            }\n                        }\n                    }\n                });\n                nativeAudioWorkletNode.addEventListener = ((addEventListener) => {\n                    return (...args) => {\n                        if (args[0] === 'processorerror') {\n                            const unpatchedEventListener = typeof args[1] === 'function'\n                                ? args[1]\n                                : typeof args[1] === 'object' && args[1] !== null && typeof args[1].handleEvent === 'function'\n                                    ? args[1].handleEvent\n                                    : null;\n                            if (unpatchedEventListener !== null) {\n                                const patchedEventListener = patchedEventListeners.get(args[1]);\n                                if (patchedEventListener !== undefined) {\n                                    args[1] = patchedEventListener;\n                                }\n                                else {\n                                    args[1] = (event) => {\n                                        // Bug #178: Chrome and Edge do fire an event of type error.\n                                        if (event.type === 'error') {\n                                            Object.defineProperties(event, {\n                                                type: { value: 'processorerror' }\n                                            });\n                                            unpatchedEventListener(event);\n                                        }\n                                        else {\n                                            unpatchedEventListener(new ErrorEvent(args[0], { ...event }));\n                                        }\n                                    };\n                                    patchedEventListeners.set(unpatchedEventListener, args[1]);\n                                }\n                            }\n                        }\n                        // Bug #178: Chrome and Edge do fire an event of type error.\n                        addEventListener.call(nativeAudioWorkletNode, 'error', args[1], args[2]);\n                        return addEventListener.call(nativeAudioWorkletNode, ...args);\n                    };\n                })(nativeAudioWorkletNode.addEventListener);\n                nativeAudioWorkletNode.removeEventListener = ((removeEventListener) => {\n                    return (...args) => {\n                        if (args[0] === 'processorerror') {\n                            const patchedEventListener = patchedEventListeners.get(args[1]);\n                            if (patchedEventListener !== undefined) {\n                                patchedEventListeners.delete(args[1]);\n                                args[1] = patchedEventListener;\n                            }\n                        }\n                        // Bug #178: Chrome and Edge do fire an event of type error.\n                        removeEventListener.call(nativeAudioWorkletNode, 'error', args[1], args[2]);\n                        return removeEventListener.call(nativeAudioWorkletNode, args[0], args[1], args[2]);\n                    };\n                })(nativeAudioWorkletNode.removeEventListener);\n                /*\n                 * Bug #86: Chrome and Edge do not invoke the process() function if the corresponding AudioWorkletNode is unconnected but\n                 * has an output.\n                 */\n                if (options.numberOfOutputs !== 0) {\n                    const nativeGainNode = createNativeGainNode(nativeContext, {\n                        channelCount: 1,\n                        channelCountMode: 'explicit',\n                        channelInterpretation: 'discrete',\n                        gain: 0\n                    });\n                    nativeAudioWorkletNode.connect(nativeGainNode).connect(nativeContext.destination);\n                    const whenConnected = () => nativeGainNode.disconnect();\n                    const whenDisconnected = () => nativeGainNode.connect(nativeContext.destination);\n                    // @todo Disconnect the connection when the process() function of the AudioWorkletNode returns false.\n                    return monitorConnections(nativeAudioWorkletNode, whenConnected, whenDisconnected);\n                }\n                return nativeAudioWorkletNode;\n            }\n            catch (err) {\n                // Bug #60: Chrome & Edge throw an InvalidStateError instead of a NotSupportedError.\n                if (err.code === 11) {\n                    throw createNotSupportedError();\n                }\n                throw err;\n            }\n        }\n        // Bug #61: Only Chrome & Edge have an implementation of the AudioWorkletNode yet.\n        if (processorConstructor === undefined) {\n            throw createNotSupportedError();\n        }\n        testClonabilityOfAudioWorkletNodeOptions(options);\n        return createNativeAudioWorkletNodeFaker(nativeContext, baseLatency, processorConstructor, options);\n    };\n};\n//# sourceMappingURL=native-audio-worklet-node-factory.js.map","export const computeBufferSize = (baseLatency, sampleRate) => {\n    if (baseLatency === null) {\n        return 512;\n    }\n    return Math.max(512, Math.min(16384, Math.pow(2, Math.round(Math.log2(baseLatency * sampleRate)))));\n};\n//# sourceMappingURL=compute-buffer-size.js.map","export const cloneAudioWorkletNodeOptions = (audioWorkletNodeOptions) => {\n    return new Promise((resolve, reject) => {\n        const { port1, port2 } = new MessageChannel();\n        port1.onmessage = ({ data }) => {\n            port1.close();\n            port2.close();\n            resolve(data);\n        };\n        port1.onmessageerror = ({ data }) => {\n            port1.close();\n            port2.close();\n            reject(data);\n        };\n        // This will throw an error if the audioWorkletNodeOptions are not clonable.\n        port2.postMessage(audioWorkletNodeOptions);\n    });\n};\n//# sourceMappingURL=clone-audio-worklet-node-options.js.map","import { cloneAudioWorkletNodeOptions } from './clone-audio-worklet-node-options';\nexport const createAudioWorkletProcessorPromise = async (processorConstructor, audioWorkletNodeOptions) => {\n    const clonedAudioWorkletNodeOptions = await cloneAudioWorkletNodeOptions(audioWorkletNodeOptions);\n    return new processorConstructor(clonedAudioWorkletNodeOptions);\n};\n//# sourceMappingURL=create-audio-worklet-processor-promise.js.map","import { NODE_TO_PROCESSOR_MAPS } from '../globals';\nimport { createAudioWorkletProcessorPromise } from './create-audio-worklet-processor-promise';\nexport const createAudioWorkletProcessor = (nativeContext, nativeAudioWorkletNode, processorConstructor, audioWorkletNodeOptions) => {\n    let nodeToProcessorMap = NODE_TO_PROCESSOR_MAPS.get(nativeContext);\n    if (nodeToProcessorMap === undefined) {\n        nodeToProcessorMap = new WeakMap();\n        NODE_TO_PROCESSOR_MAPS.set(nativeContext, nodeToProcessorMap);\n    }\n    const audioWorkletProcessorPromise = createAudioWorkletProcessorPromise(processorConstructor, audioWorkletNodeOptions);\n    nodeToProcessorMap.set(nativeAudioWorkletNode, audioWorkletProcessorPromise);\n    return audioWorkletProcessorPromise;\n};\n//# sourceMappingURL=create-audio-worklet-processor.js.map","import { MOST_NEGATIVE_SINGLE_FLOAT, MOST_POSITIVE_SINGLE_FLOAT } from '../constants';\nimport { computeBufferSize } from '../helpers/compute-buffer-size';\nimport { copyFromChannel } from '../helpers/copy-from-channel';\nimport { copyToChannel } from '../helpers/copy-to-channel';\nimport { createAudioWorkletProcessor } from '../helpers/create-audio-worklet-processor';\nimport { createNestedArrays } from '../helpers/create-nested-arrays';\nimport { ReadOnlyMap } from '../read-only-map';\nexport const createNativeAudioWorkletNodeFakerFactory = (connectMultipleOutputs, createIndexSizeError, createInvalidStateError, createNativeChannelMergerNode, createNativeChannelSplitterNode, createNativeConstantSourceNode, createNativeGainNode, createNativeScriptProcessorNode, createNotSupportedError, disconnectMultipleOutputs, exposeCurrentFrameAndCurrentTime, getActiveAudioWorkletNodeInputs, monitorConnections) => {\n    return (nativeContext, baseLatency, processorConstructor, options) => {\n        if (options.numberOfInputs === 0 && options.numberOfOutputs === 0) {\n            throw createNotSupportedError();\n        }\n        const outputChannelCount = Array.isArray(options.outputChannelCount)\n            ? options.outputChannelCount\n            : Array.from(options.outputChannelCount);\n        // @todo Check if any of the channelCount values is greater than the implementation's maximum number of channels.\n        if (outputChannelCount.some((channelCount) => channelCount < 1)) {\n            throw createNotSupportedError();\n        }\n        if (outputChannelCount.length !== options.numberOfOutputs) {\n            throw createIndexSizeError();\n        }\n        // Bug #61: This is not part of the standard but required for the faker to work.\n        if (options.channelCountMode !== 'explicit') {\n            throw createNotSupportedError();\n        }\n        const numberOfInputChannels = options.channelCount * options.numberOfInputs;\n        const numberOfOutputChannels = outputChannelCount.reduce((sum, value) => sum + value, 0);\n        const numberOfParameters = processorConstructor.parameterDescriptors === undefined ? 0 : processorConstructor.parameterDescriptors.length;\n        // Bug #61: This is not part of the standard but required for the faker to work.\n        if (numberOfInputChannels + numberOfParameters > 6 || numberOfOutputChannels > 6) {\n            throw createNotSupportedError();\n        }\n        const messageChannel = new MessageChannel();\n        const gainNodes = [];\n        const inputChannelSplitterNodes = [];\n        for (let i = 0; i < options.numberOfInputs; i += 1) {\n            gainNodes.push(createNativeGainNode(nativeContext, {\n                channelCount: options.channelCount,\n                channelCountMode: options.channelCountMode,\n                channelInterpretation: options.channelInterpretation,\n                gain: 1\n            }));\n            inputChannelSplitterNodes.push(createNativeChannelSplitterNode(nativeContext, {\n                channelCount: options.channelCount,\n                channelCountMode: 'explicit',\n                channelInterpretation: 'discrete',\n                numberOfOutputs: options.channelCount\n            }));\n        }\n        const constantSourceNodes = [];\n        if (processorConstructor.parameterDescriptors !== undefined) {\n            for (const { defaultValue, maxValue, minValue, name } of processorConstructor.parameterDescriptors) {\n                const constantSourceNode = createNativeConstantSourceNode(nativeContext, {\n                    channelCount: 1,\n                    channelCountMode: 'explicit',\n                    channelInterpretation: 'discrete',\n                    offset: options.parameterData[name] !== undefined\n                        ? options.parameterData[name]\n                        : defaultValue === undefined\n                            ? 0\n                            : defaultValue\n                });\n                Object.defineProperties(constantSourceNode.offset, {\n                    defaultValue: {\n                        get: () => (defaultValue === undefined ? 0 : defaultValue)\n                    },\n                    maxValue: {\n                        get: () => (maxValue === undefined ? MOST_POSITIVE_SINGLE_FLOAT : maxValue)\n                    },\n                    minValue: {\n                        get: () => (minValue === undefined ? MOST_NEGATIVE_SINGLE_FLOAT : minValue)\n                    }\n                });\n                constantSourceNodes.push(constantSourceNode);\n            }\n        }\n        const inputChannelMergerNode = createNativeChannelMergerNode(nativeContext, {\n            channelCount: 1,\n            channelCountMode: 'explicit',\n            channelInterpretation: 'speakers',\n            numberOfInputs: Math.max(1, numberOfInputChannels + numberOfParameters)\n        });\n        const bufferSize = computeBufferSize(baseLatency, nativeContext.sampleRate);\n        const scriptProcessorNode = createNativeScriptProcessorNode(nativeContext, bufferSize, numberOfInputChannels + numberOfParameters, \n        // Bug #87: Only Firefox will fire an AudioProcessingEvent if there is no connected output.\n        Math.max(1, numberOfOutputChannels));\n        const outputChannelSplitterNode = createNativeChannelSplitterNode(nativeContext, {\n            channelCount: Math.max(1, numberOfOutputChannels),\n            channelCountMode: 'explicit',\n            channelInterpretation: 'discrete',\n            numberOfOutputs: Math.max(1, numberOfOutputChannels)\n        });\n        const outputChannelMergerNodes = [];\n        for (let i = 0; i < options.numberOfOutputs; i += 1) {\n            outputChannelMergerNodes.push(createNativeChannelMergerNode(nativeContext, {\n                channelCount: 1,\n                channelCountMode: 'explicit',\n                channelInterpretation: 'speakers',\n                numberOfInputs: outputChannelCount[i]\n            }));\n        }\n        for (let i = 0; i < options.numberOfInputs; i += 1) {\n            gainNodes[i].connect(inputChannelSplitterNodes[i]);\n            for (let j = 0; j < options.channelCount; j += 1) {\n                inputChannelSplitterNodes[i].connect(inputChannelMergerNode, j, i * options.channelCount + j);\n            }\n        }\n        const parameterMap = new ReadOnlyMap(processorConstructor.parameterDescriptors === undefined\n            ? []\n            : processorConstructor.parameterDescriptors.map(({ name }, index) => {\n                const constantSourceNode = constantSourceNodes[index];\n                constantSourceNode.connect(inputChannelMergerNode, 0, numberOfInputChannels + index);\n                constantSourceNode.start(0);\n                return [name, constantSourceNode.offset];\n            }));\n        inputChannelMergerNode.connect(scriptProcessorNode);\n        let channelInterpretation = options.channelInterpretation;\n        let onprocessorerror = null;\n        // Bug #87: Expose at least one output to make this node connectable.\n        const outputAudioNodes = options.numberOfOutputs === 0 ? [scriptProcessorNode] : outputChannelMergerNodes;\n        const nativeAudioWorkletNodeFaker = {\n            get bufferSize() {\n                return bufferSize;\n            },\n            get channelCount() {\n                return options.channelCount;\n            },\n            set channelCount(_) {\n                // Bug #61: This is not part of the standard but required for the faker to work.\n                throw createInvalidStateError();\n            },\n            get channelCountMode() {\n                return options.channelCountMode;\n            },\n            set channelCountMode(_) {\n                // Bug #61: This is not part of the standard but required for the faker to work.\n                throw createInvalidStateError();\n            },\n            get channelInterpretation() {\n                return channelInterpretation;\n            },\n            set channelInterpretation(value) {\n                for (const gainNode of gainNodes) {\n                    gainNode.channelInterpretation = value;\n                }\n                channelInterpretation = value;\n            },\n            get context() {\n                return scriptProcessorNode.context;\n            },\n            get inputs() {\n                return gainNodes;\n            },\n            get numberOfInputs() {\n                return options.numberOfInputs;\n            },\n            get numberOfOutputs() {\n                return options.numberOfOutputs;\n            },\n            get onprocessorerror() {\n                return onprocessorerror;\n            },\n            set onprocessorerror(value) {\n                if (typeof onprocessorerror === 'function') {\n                    nativeAudioWorkletNodeFaker.removeEventListener('processorerror', onprocessorerror);\n                }\n                onprocessorerror = typeof value === 'function' ? value : null;\n                if (typeof onprocessorerror === 'function') {\n                    nativeAudioWorkletNodeFaker.addEventListener('processorerror', onprocessorerror);\n                }\n            },\n            get parameters() {\n                return parameterMap;\n            },\n            get port() {\n                return messageChannel.port2;\n            },\n            addEventListener(...args) {\n                return scriptProcessorNode.addEventListener(args[0], args[1], args[2]);\n            },\n            connect: connectMultipleOutputs.bind(null, outputAudioNodes),\n            disconnect: disconnectMultipleOutputs.bind(null, outputAudioNodes),\n            dispatchEvent(...args) {\n                return scriptProcessorNode.dispatchEvent(args[0]);\n            },\n            removeEventListener(...args) {\n                return scriptProcessorNode.removeEventListener(args[0], args[1], args[2]);\n            }\n        };\n        const patchedEventListeners = new Map();\n        messageChannel.port1.addEventListener = ((addEventListener) => {\n            return (...args) => {\n                if (args[0] === 'message') {\n                    const unpatchedEventListener = typeof args[1] === 'function'\n                        ? args[1]\n                        : typeof args[1] === 'object' && args[1] !== null && typeof args[1].handleEvent === 'function'\n                            ? args[1].handleEvent\n                            : null;\n                    if (unpatchedEventListener !== null) {\n                        const patchedEventListener = patchedEventListeners.get(args[1]);\n                        if (patchedEventListener !== undefined) {\n                            args[1] = patchedEventListener;\n                        }\n                        else {\n                            args[1] = (event) => {\n                                exposeCurrentFrameAndCurrentTime(nativeContext.currentTime, nativeContext.sampleRate, () => unpatchedEventListener(event));\n                            };\n                            patchedEventListeners.set(unpatchedEventListener, args[1]);\n                        }\n                    }\n                }\n                return addEventListener.call(messageChannel.port1, args[0], args[1], args[2]);\n            };\n        })(messageChannel.port1.addEventListener);\n        messageChannel.port1.removeEventListener = ((removeEventListener) => {\n            return (...args) => {\n                if (args[0] === 'message') {\n                    const patchedEventListener = patchedEventListeners.get(args[1]);\n                    if (patchedEventListener !== undefined) {\n                        patchedEventListeners.delete(args[1]);\n                        args[1] = patchedEventListener;\n                    }\n                }\n                return removeEventListener.call(messageChannel.port1, args[0], args[1], args[2]);\n            };\n        })(messageChannel.port1.removeEventListener);\n        let onmessage = null;\n        Object.defineProperty(messageChannel.port1, 'onmessage', {\n            get: () => onmessage,\n            set: (value) => {\n                if (typeof onmessage === 'function') {\n                    messageChannel.port1.removeEventListener('message', onmessage);\n                }\n                onmessage = typeof value === 'function' ? value : null;\n                if (typeof onmessage === 'function') {\n                    messageChannel.port1.addEventListener('message', onmessage);\n                    messageChannel.port1.start();\n                }\n            }\n        });\n        processorConstructor.prototype.port = messageChannel.port1;\n        let audioWorkletProcessor = null;\n        const audioWorkletProcessorPromise = createAudioWorkletProcessor(nativeContext, nativeAudioWorkletNodeFaker, processorConstructor, options);\n        audioWorkletProcessorPromise.then((dWrkltPrcssr) => (audioWorkletProcessor = dWrkltPrcssr));\n        const inputs = createNestedArrays(options.numberOfInputs, options.channelCount);\n        const outputs = createNestedArrays(options.numberOfOutputs, outputChannelCount);\n        const parameters = processorConstructor.parameterDescriptors === undefined\n            ? []\n            : processorConstructor.parameterDescriptors.reduce((prmtrs, { name }) => ({ ...prmtrs, [name]: new Float32Array(128) }), {});\n        let isActive = true;\n        const disconnectOutputsGraph = () => {\n            if (options.numberOfOutputs > 0) {\n                scriptProcessorNode.disconnect(outputChannelSplitterNode);\n            }\n            for (let i = 0, outputChannelSplitterNodeOutput = 0; i < options.numberOfOutputs; i += 1) {\n                const outputChannelMergerNode = outputChannelMergerNodes[i];\n                for (let j = 0; j < outputChannelCount[i]; j += 1) {\n                    outputChannelSplitterNode.disconnect(outputChannelMergerNode, outputChannelSplitterNodeOutput + j, j);\n                }\n                outputChannelSplitterNodeOutput += outputChannelCount[i];\n            }\n        };\n        const activeInputIndexes = new Map();\n        // tslint:disable-next-line:deprecation\n        scriptProcessorNode.onaudioprocess = ({ inputBuffer, outputBuffer }) => {\n            if (audioWorkletProcessor !== null) {\n                const activeInputs = getActiveAudioWorkletNodeInputs(nativeAudioWorkletNodeFaker);\n                for (let i = 0; i < bufferSize; i += 128) {\n                    for (let j = 0; j < options.numberOfInputs; j += 1) {\n                        for (let k = 0; k < options.channelCount; k += 1) {\n                            copyFromChannel(inputBuffer, inputs[j], k, k, i);\n                        }\n                    }\n                    if (processorConstructor.parameterDescriptors !== undefined) {\n                        processorConstructor.parameterDescriptors.forEach(({ name }, index) => {\n                            copyFromChannel(inputBuffer, parameters, name, numberOfInputChannels + index, i);\n                        });\n                    }\n                    for (let j = 0; j < options.numberOfInputs; j += 1) {\n                        for (let k = 0; k < outputChannelCount[j]; k += 1) {\n                            // The byteLength will be 0 when the ArrayBuffer was transferred.\n                            if (outputs[j][k].byteLength === 0) {\n                                outputs[j][k] = new Float32Array(128);\n                            }\n                        }\n                    }\n                    try {\n                        const potentiallyEmptyInputs = inputs.map((input, index) => {\n                            const activeInput = activeInputs[index];\n                            if (activeInput.size > 0) {\n                                activeInputIndexes.set(index, bufferSize / 128);\n                                return input;\n                            }\n                            const count = activeInputIndexes.get(index);\n                            if (count === undefined) {\n                                return [];\n                            }\n                            if (input.every((channelData) => channelData.every((sample) => sample === 0))) {\n                                if (count === 1) {\n                                    activeInputIndexes.delete(index);\n                                }\n                                else {\n                                    activeInputIndexes.set(index, count - 1);\n                                }\n                            }\n                            return input;\n                        });\n                        const activeSourceFlag = exposeCurrentFrameAndCurrentTime(nativeContext.currentTime + i / nativeContext.sampleRate, nativeContext.sampleRate, () => audioWorkletProcessor.process(potentiallyEmptyInputs, outputs, parameters));\n                        isActive = activeSourceFlag;\n                        for (let j = 0, outputChannelSplitterNodeOutput = 0; j < options.numberOfOutputs; j += 1) {\n                            for (let k = 0; k < outputChannelCount[j]; k += 1) {\n                                copyToChannel(outputBuffer, outputs[j], k, outputChannelSplitterNodeOutput + k, i);\n                            }\n                            outputChannelSplitterNodeOutput += outputChannelCount[j];\n                        }\n                    }\n                    catch (error) {\n                        isActive = false;\n                        nativeAudioWorkletNodeFaker.dispatchEvent(new ErrorEvent('processorerror', {\n                            colno: error.colno,\n                            filename: error.filename,\n                            lineno: error.lineno,\n                            message: error.message\n                        }));\n                    }\n                    if (!isActive) {\n                        for (let j = 0; j < options.numberOfInputs; j += 1) {\n                            gainNodes[j].disconnect(inputChannelSplitterNodes[j]);\n                            for (let k = 0; k < options.channelCount; k += 1) {\n                                inputChannelSplitterNodes[i].disconnect(inputChannelMergerNode, k, j * options.channelCount + k);\n                            }\n                        }\n                        if (processorConstructor.parameterDescriptors !== undefined) {\n                            const length = processorConstructor.parameterDescriptors.length;\n                            for (let j = 0; j < length; j += 1) {\n                                const constantSourceNode = constantSourceNodes[j];\n                                constantSourceNode.disconnect(inputChannelMergerNode, 0, numberOfInputChannels + j);\n                                constantSourceNode.stop();\n                            }\n                        }\n                        inputChannelMergerNode.disconnect(scriptProcessorNode);\n                        scriptProcessorNode.onaudioprocess = null; // tslint:disable-line:deprecation\n                        if (isConnected) {\n                            disconnectOutputsGraph();\n                        }\n                        else {\n                            disconnectFakeGraph();\n                        }\n                        break;\n                    }\n                }\n            }\n        };\n        let isConnected = false;\n        // Bug #87: Only Firefox will fire an AudioProcessingEvent if there is no connected output.\n        const nativeGainNode = createNativeGainNode(nativeContext, {\n            channelCount: 1,\n            channelCountMode: 'explicit',\n            channelInterpretation: 'discrete',\n            gain: 0\n        });\n        const connectFakeGraph = () => scriptProcessorNode.connect(nativeGainNode).connect(nativeContext.destination);\n        const disconnectFakeGraph = () => {\n            scriptProcessorNode.disconnect(nativeGainNode);\n            nativeGainNode.disconnect();\n        };\n        const whenConnected = () => {\n            if (isActive) {\n                disconnectFakeGraph();\n                if (options.numberOfOutputs > 0) {\n                    scriptProcessorNode.connect(outputChannelSplitterNode);\n                }\n                for (let i = 0, outputChannelSplitterNodeOutput = 0; i < options.numberOfOutputs; i += 1) {\n                    const outputChannelMergerNode = outputChannelMergerNodes[i];\n                    for (let j = 0; j < outputChannelCount[i]; j += 1) {\n                        outputChannelSplitterNode.connect(outputChannelMergerNode, outputChannelSplitterNodeOutput + j, j);\n                    }\n                    outputChannelSplitterNodeOutput += outputChannelCount[i];\n                }\n            }\n            isConnected = true;\n        };\n        const whenDisconnected = () => {\n            if (isActive) {\n                connectFakeGraph();\n                disconnectOutputsGraph();\n            }\n            isConnected = false;\n        };\n        connectFakeGraph();\n        return monitorConnections(nativeAudioWorkletNodeFaker, whenConnected, whenDisconnected);\n    };\n};\n//# sourceMappingURL=native-audio-worklet-node-faker-factory.js.map","import { assignNativeAudioNodeAudioParamValue } from '../helpers/assign-native-audio-node-audio-param-value';\nimport { assignNativeAudioNodeOption } from '../helpers/assign-native-audio-node-option';\nimport { assignNativeAudioNodeOptions } from '../helpers/assign-native-audio-node-options';\nexport const createNativeBiquadFilterNode = (nativeContext, options) => {\n    const nativeBiquadFilterNode = nativeContext.createBiquadFilter();\n    assignNativeAudioNodeOptions(nativeBiquadFilterNode, options);\n    assignNativeAudioNodeAudioParamValue(nativeBiquadFilterNode, options, 'Q');\n    assignNativeAudioNodeAudioParamValue(nativeBiquadFilterNode, options, 'detune');\n    assignNativeAudioNodeAudioParamValue(nativeBiquadFilterNode, options, 'frequency');\n    assignNativeAudioNodeAudioParamValue(nativeBiquadFilterNode, options, 'gain');\n    assignNativeAudioNodeOption(nativeBiquadFilterNode, options, 'type');\n    return nativeBiquadFilterNode;\n};\n//# sourceMappingURL=native-biquad-filter-node.js.map","import { assignNativeAudioNodeOptions } from '../helpers/assign-native-audio-node-options';\nexport const createNativeChannelMergerNodeFactory = (nativeAudioContextConstructor, wrapChannelMergerNode) => {\n    return (nativeContext, options) => {\n        const nativeChannelMergerNode = nativeContext.createChannelMerger(options.numberOfInputs);\n        /*\n         * Bug #20: Safari requires a connection of any kind to treat the input signal correctly.\n         * @todo Unfortunately there is no way to test for this behavior in a synchronous fashion which is why testing for the existence of\n         * the webkitAudioContext is used as a workaround here.\n         */\n        if (nativeAudioContextConstructor !== null && nativeAudioContextConstructor.name === 'webkitAudioContext') {\n            wrapChannelMergerNode(nativeContext, nativeChannelMergerNode);\n        }\n        assignNativeAudioNodeOptions(nativeChannelMergerNode, options);\n        return nativeChannelMergerNode;\n    };\n};\n//# sourceMappingURL=native-channel-merger-node-factory.js.map","import { createInvalidStateError } from '../factories/invalid-state-error';\nexport const wrapChannelSplitterNode = (channelSplitterNode) => {\n    const channelCount = channelSplitterNode.numberOfOutputs;\n    // Bug #97: Safari does not throw an error when attempting to change the channelCount to something other than its initial value.\n    Object.defineProperty(channelSplitterNode, 'channelCount', {\n        get: () => channelCount,\n        set: (value) => {\n            if (value !== channelCount) {\n                throw createInvalidStateError();\n            }\n        }\n    });\n    // Bug #30: Safari does not throw an error when attempting to change the channelCountMode to something other than explicit.\n    Object.defineProperty(channelSplitterNode, 'channelCountMode', {\n        get: () => 'explicit',\n        set: (value) => {\n            if (value !== 'explicit') {\n                throw createInvalidStateError();\n            }\n        }\n    });\n    // Bug #32: Safari does not throw an error when attempting to change the channelInterpretation to something other than discrete.\n    Object.defineProperty(channelSplitterNode, 'channelInterpretation', {\n        get: () => 'discrete',\n        set: (value) => {\n            if (value !== 'discrete') {\n                throw createInvalidStateError();\n            }\n        }\n    });\n};\n//# sourceMappingURL=wrap-channel-splitter-node.js.map","import { assignNativeAudioNodeOptions } from '../helpers/assign-native-audio-node-options';\nimport { wrapChannelSplitterNode } from '../helpers/wrap-channel-splitter-node';\nexport const createNativeChannelSplitterNode = (nativeContext, options) => {\n    const nativeChannelSplitterNode = nativeContext.createChannelSplitter(options.numberOfOutputs);\n    // Bug #96: Safari does not have the correct channelCount.\n    // Bug #29: Safari does not have the correct channelCountMode.\n    // Bug #31: Safari does not have the correct channelInterpretation.\n    assignNativeAudioNodeOptions(nativeChannelSplitterNode, options);\n    // Bug #29, #30, #31, #32, #96 & #97: Only Chrome, Edge & Firefox partially support the spec yet.\n    wrapChannelSplitterNode(nativeChannelSplitterNode);\n    return nativeChannelSplitterNode;\n};\n//# sourceMappingURL=native-channel-splitter-node.js.map","import { assignNativeAudioNodeAudioParamValue } from '../helpers/assign-native-audio-node-audio-param-value';\nimport { assignNativeAudioNodeOptions } from '../helpers/assign-native-audio-node-options';\nimport { wrapAudioScheduledSourceNodeStartMethodNegativeParameters } from '../helpers/wrap-audio-scheduled-source-node-start-method-negative-parameters';\nimport { wrapAudioScheduledSourceNodeStopMethodNegativeParameters } from '../helpers/wrap-audio-scheduled-source-node-stop-method-negative-parameters';\nexport const createNativeConstantSourceNodeFactory = (addSilentConnection, cacheTestResult, createNativeConstantSourceNodeFaker, testAudioScheduledSourceNodeStartMethodNegativeParametersSupport, testAudioScheduledSourceNodeStopMethodNegativeParametersSupport) => {\n    return (nativeContext, options) => {\n        // Bug #62: Safari does not support ConstantSourceNodes.\n        if (nativeContext.createConstantSource === undefined) {\n            return createNativeConstantSourceNodeFaker(nativeContext, options);\n        }\n        const nativeConstantSourceNode = nativeContext.createConstantSource();\n        assignNativeAudioNodeOptions(nativeConstantSourceNode, options);\n        assignNativeAudioNodeAudioParamValue(nativeConstantSourceNode, options, 'offset');\n        // Bug #44: Safari does not throw a RangeError yet.\n        if (!cacheTestResult(testAudioScheduledSourceNodeStartMethodNegativeParametersSupport, () => testAudioScheduledSourceNodeStartMethodNegativeParametersSupport(nativeContext))) {\n            wrapAudioScheduledSourceNodeStartMethodNegativeParameters(nativeConstantSourceNode);\n        }\n        // Bug #44: Only Firefox does not throw a RangeError yet.\n        if (!cacheTestResult(testAudioScheduledSourceNodeStopMethodNegativeParametersSupport, () => testAudioScheduledSourceNodeStopMethodNegativeParametersSupport(nativeContext))) {\n            wrapAudioScheduledSourceNodeStopMethodNegativeParameters(nativeConstantSourceNode);\n        }\n        // Bug #175: Safari will not fire an ended event if the ConstantSourceNode is unconnected.\n        addSilentConnection(nativeContext, nativeConstantSourceNode);\n        return nativeConstantSourceNode;\n    };\n};\n//# sourceMappingURL=native-constant-source-node-factory.js.map","export const interceptConnections = (original, interceptor) => {\n    original.connect = interceptor.connect.bind(interceptor);\n    original.disconnect = interceptor.disconnect.bind(interceptor);\n    return original;\n};\n//# sourceMappingURL=intercept-connections.js.map","import { interceptConnections } from '../helpers/intercept-connections';\nexport const createNativeConstantSourceNodeFakerFactory = (addSilentConnection, createNativeAudioBufferSourceNode, createNativeGainNode, monitorConnections) => {\n    return (nativeContext, { offset, ...audioNodeOptions }) => {\n        const audioBuffer = nativeContext.createBuffer(1, 2, 44100);\n        const audioBufferSourceNode = createNativeAudioBufferSourceNode(nativeContext, {\n            buffer: null,\n            channelCount: 2,\n            channelCountMode: 'max',\n            channelInterpretation: 'speakers',\n            loop: false,\n            loopEnd: 0,\n            loopStart: 0,\n            playbackRate: 1\n        });\n        const gainNode = createNativeGainNode(nativeContext, { ...audioNodeOptions, gain: offset });\n        // Bug #5: Safari does not support copyFromChannel() and copyToChannel().\n        const channelData = audioBuffer.getChannelData(0);\n        // Bug #95: Safari does not play or loop one sample buffers.\n        channelData[0] = 1;\n        channelData[1] = 1;\n        audioBufferSourceNode.buffer = audioBuffer;\n        audioBufferSourceNode.loop = true;\n        const nativeConstantSourceNodeFaker = {\n            get bufferSize() {\n                return undefined;\n            },\n            get channelCount() {\n                return gainNode.channelCount;\n            },\n            set channelCount(value) {\n                gainNode.channelCount = value;\n            },\n            get channelCountMode() {\n                return gainNode.channelCountMode;\n            },\n            set channelCountMode(value) {\n                gainNode.channelCountMode = value;\n            },\n            get channelInterpretation() {\n                return gainNode.channelInterpretation;\n            },\n            set channelInterpretation(value) {\n                gainNode.channelInterpretation = value;\n            },\n            get context() {\n                return gainNode.context;\n            },\n            get inputs() {\n                return [];\n            },\n            get numberOfInputs() {\n                return audioBufferSourceNode.numberOfInputs;\n            },\n            get numberOfOutputs() {\n                return gainNode.numberOfOutputs;\n            },\n            get offset() {\n                return gainNode.gain;\n            },\n            get onended() {\n                return audioBufferSourceNode.onended;\n            },\n            set onended(value) {\n                audioBufferSourceNode.onended = value;\n            },\n            addEventListener(...args) {\n                return audioBufferSourceNode.addEventListener(args[0], args[1], args[2]);\n            },\n            dispatchEvent(...args) {\n                return audioBufferSourceNode.dispatchEvent(args[0]);\n            },\n            removeEventListener(...args) {\n                return audioBufferSourceNode.removeEventListener(args[0], args[1], args[2]);\n            },\n            start(when = 0) {\n                audioBufferSourceNode.start.call(audioBufferSourceNode, when);\n            },\n            stop(when = 0) {\n                audioBufferSourceNode.stop.call(audioBufferSourceNode, when);\n            }\n        };\n        const whenConnected = () => audioBufferSourceNode.connect(gainNode);\n        const whenDisconnected = () => audioBufferSourceNode.disconnect(gainNode);\n        // Bug #175: Safari will not fire an ended event if the AudioBufferSourceNode is unconnected.\n        addSilentConnection(nativeContext, audioBufferSourceNode);\n        return monitorConnections(interceptConnections(nativeConstantSourceNodeFaker, gainNode), whenConnected, whenDisconnected);\n    };\n};\n//# sourceMappingURL=native-constant-source-node-faker-factory.js.map","import { assignNativeAudioNodeOption } from '../helpers/assign-native-audio-node-option';\nimport { assignNativeAudioNodeOptions } from '../helpers/assign-native-audio-node-options';\nexport const createNativeConvolverNodeFactory = (createNotSupportedError, overwriteAccessors) => {\n    return (nativeContext, options) => {\n        const nativeConvolverNode = nativeContext.createConvolver();\n        assignNativeAudioNodeOptions(nativeConvolverNode, options);\n        // The normalize property needs to be set before setting the buffer.\n        if (options.disableNormalization === nativeConvolverNode.normalize) {\n            nativeConvolverNode.normalize = !options.disableNormalization;\n        }\n        assignNativeAudioNodeOption(nativeConvolverNode, options, 'buffer');\n        // Bug #113: Safari does allow to set the channelCount to a value larger than 2.\n        if (options.channelCount > 2) {\n            throw createNotSupportedError();\n        }\n        overwriteAccessors(nativeConvolverNode, 'channelCount', (get) => () => get.call(nativeConvolverNode), (set) => (value) => {\n            if (value > 2) {\n                throw createNotSupportedError();\n            }\n            return set.call(nativeConvolverNode, value);\n        });\n        // Bug #114: Safari allows to set the channelCountMode to 'max'.\n        if (options.channelCountMode === 'max') {\n            throw createNotSupportedError();\n        }\n        overwriteAccessors(nativeConvolverNode, 'channelCountMode', (get) => () => get.call(nativeConvolverNode), (set) => (value) => {\n            if (value === 'max') {\n                throw createNotSupportedError();\n            }\n            return set.call(nativeConvolverNode, value);\n        });\n        return nativeConvolverNode;\n    };\n};\n//# sourceMappingURL=native-convolver-node-factory.js.map","import { assignNativeAudioNodeAudioParamValue } from '../helpers/assign-native-audio-node-audio-param-value';\nimport { assignNativeAudioNodeOptions } from '../helpers/assign-native-audio-node-options';\nexport const createNativeDelayNode = (nativeContext, options) => {\n    const nativeDelayNode = nativeContext.createDelay(options.maxDelayTime);\n    assignNativeAudioNodeOptions(nativeDelayNode, options);\n    assignNativeAudioNodeAudioParamValue(nativeDelayNode, options, 'delayTime');\n    return nativeDelayNode;\n};\n//# sourceMappingURL=native-delay-node.js.map","import { assignNativeAudioNodeAudioParamValue } from '../helpers/assign-native-audio-node-audio-param-value';\nimport { assignNativeAudioNodeOptions } from '../helpers/assign-native-audio-node-options';\nexport const createNativeDynamicsCompressorNodeFactory = (createNotSupportedError) => {\n    return (nativeContext, options) => {\n        const nativeDynamicsCompressorNode = nativeContext.createDynamicsCompressor();\n        assignNativeAudioNodeOptions(nativeDynamicsCompressorNode, options);\n        // Bug #108: Safari allows a channelCount of three and above.\n        if (options.channelCount > 2) {\n            throw createNotSupportedError();\n        }\n        // Bug #109: Only Chrome and Firefox disallow a channelCountMode of 'max'.\n        if (options.channelCountMode === 'max') {\n            throw createNotSupportedError();\n        }\n        assignNativeAudioNodeAudioParamValue(nativeDynamicsCompressorNode, options, 'attack');\n        assignNativeAudioNodeAudioParamValue(nativeDynamicsCompressorNode, options, 'knee');\n        assignNativeAudioNodeAudioParamValue(nativeDynamicsCompressorNode, options, 'ratio');\n        assignNativeAudioNodeAudioParamValue(nativeDynamicsCompressorNode, options, 'release');\n        assignNativeAudioNodeAudioParamValue(nativeDynamicsCompressorNode, options, 'threshold');\n        return nativeDynamicsCompressorNode;\n    };\n};\n//# sourceMappingURL=native-dynamics-compressor-node-factory.js.map","import { assignNativeAudioNodeAudioParamValue } from '../helpers/assign-native-audio-node-audio-param-value';\nimport { assignNativeAudioNodeOptions } from '../helpers/assign-native-audio-node-options';\nexport const createNativeGainNode = (nativeContext, options) => {\n    const nativeGainNode = nativeContext.createGain();\n    assignNativeAudioNodeOptions(nativeGainNode, options);\n    assignNativeAudioNodeAudioParamValue(nativeGainNode, options, 'gain');\n    return nativeGainNode;\n};\n//# sourceMappingURL=native-gain-node.js.map","import { assignNativeAudioNodeOptions } from '../helpers/assign-native-audio-node-options';\nexport const createNativeIIRFilterNodeFactory = (createNativeIIRFilterNodeFaker) => {\n    return (nativeContext, baseLatency, options) => {\n        // Bug #9: Safari does not support IIRFilterNodes.\n        if (nativeContext.createIIRFilter === undefined) {\n            return createNativeIIRFilterNodeFaker(nativeContext, baseLatency, options);\n        }\n        // @todo TypeScript defines the parameters of createIIRFilter() as arrays of numbers.\n        const nativeIIRFilterNode = nativeContext.createIIRFilter(options.feedforward, options.feedback);\n        assignNativeAudioNodeOptions(nativeIIRFilterNode, options);\n        return nativeIIRFilterNode;\n    };\n};\n//# sourceMappingURL=native-iir-filter-node-factory.js.map","import { computeBufferSize } from '../helpers/compute-buffer-size';\nimport { filterBuffer } from '../helpers/filter-buffer';\nimport { interceptConnections } from '../helpers/intercept-connections';\nfunction divide(a, b) {\n    const denominator = b[0] * b[0] + b[1] * b[1];\n    return [(a[0] * b[0] + a[1] * b[1]) / denominator, (a[1] * b[0] - a[0] * b[1]) / denominator];\n}\nfunction multiply(a, b) {\n    return [a[0] * b[0] - a[1] * b[1], a[0] * b[1] + a[1] * b[0]];\n}\nfunction evaluatePolynomial(coefficient, z) {\n    let result = [0, 0];\n    for (let i = coefficient.length - 1; i >= 0; i -= 1) {\n        result = multiply(result, z);\n        result[0] += coefficient[i];\n    }\n    return result;\n}\nexport const createNativeIIRFilterNodeFakerFactory = (createInvalidAccessError, createInvalidStateError, createNativeScriptProcessorNode, createNotSupportedError) => {\n    return (nativeContext, baseLatency, { channelCount, channelCountMode, channelInterpretation, feedback, feedforward }) => {\n        const bufferSize = computeBufferSize(baseLatency, nativeContext.sampleRate);\n        const convertedFeedback = feedback instanceof Float64Array ? feedback : new Float64Array(feedback);\n        const convertedFeedforward = feedforward instanceof Float64Array ? feedforward : new Float64Array(feedforward);\n        const feedbackLength = convertedFeedback.length;\n        const feedforwardLength = convertedFeedforward.length;\n        const minLength = Math.min(feedbackLength, feedforwardLength);\n        if (feedbackLength === 0 || feedbackLength > 20) {\n            throw createNotSupportedError();\n        }\n        if (convertedFeedback[0] === 0) {\n            throw createInvalidStateError();\n        }\n        if (feedforwardLength === 0 || feedforwardLength > 20) {\n            throw createNotSupportedError();\n        }\n        if (convertedFeedforward[0] === 0) {\n            throw createInvalidStateError();\n        }\n        if (convertedFeedback[0] !== 1) {\n            for (let i = 0; i < feedforwardLength; i += 1) {\n                convertedFeedforward[i] /= convertedFeedback[0];\n            }\n            for (let i = 1; i < feedbackLength; i += 1) {\n                convertedFeedback[i] /= convertedFeedback[0];\n            }\n        }\n        const scriptProcessorNode = createNativeScriptProcessorNode(nativeContext, bufferSize, channelCount, channelCount);\n        scriptProcessorNode.channelCount = channelCount;\n        scriptProcessorNode.channelCountMode = channelCountMode;\n        scriptProcessorNode.channelInterpretation = channelInterpretation;\n        const bufferLength = 32;\n        const bufferIndexes = [];\n        const xBuffers = [];\n        const yBuffers = [];\n        for (let i = 0; i < channelCount; i += 1) {\n            bufferIndexes.push(0);\n            const xBuffer = new Float32Array(bufferLength);\n            const yBuffer = new Float32Array(bufferLength);\n            xBuffer.fill(0);\n            yBuffer.fill(0);\n            xBuffers.push(xBuffer);\n            yBuffers.push(yBuffer);\n        }\n        // tslint:disable-next-line:deprecation\n        scriptProcessorNode.onaudioprocess = (event) => {\n            const inputBuffer = event.inputBuffer;\n            const outputBuffer = event.outputBuffer;\n            const numberOfChannels = inputBuffer.numberOfChannels;\n            for (let i = 0; i < numberOfChannels; i += 1) {\n                const input = inputBuffer.getChannelData(i);\n                const output = outputBuffer.getChannelData(i);\n                bufferIndexes[i] = filterBuffer(convertedFeedback, feedbackLength, convertedFeedforward, feedforwardLength, minLength, xBuffers[i], yBuffers[i], bufferIndexes[i], bufferLength, input, output);\n            }\n        };\n        const nyquist = nativeContext.sampleRate / 2;\n        const nativeIIRFilterNodeFaker = {\n            get bufferSize() {\n                return bufferSize;\n            },\n            get channelCount() {\n                return scriptProcessorNode.channelCount;\n            },\n            set channelCount(value) {\n                scriptProcessorNode.channelCount = value;\n            },\n            get channelCountMode() {\n                return scriptProcessorNode.channelCountMode;\n            },\n            set channelCountMode(value) {\n                scriptProcessorNode.channelCountMode = value;\n            },\n            get channelInterpretation() {\n                return scriptProcessorNode.channelInterpretation;\n            },\n            set channelInterpretation(value) {\n                scriptProcessorNode.channelInterpretation = value;\n            },\n            get context() {\n                return scriptProcessorNode.context;\n            },\n            get inputs() {\n                return [scriptProcessorNode];\n            },\n            get numberOfInputs() {\n                return scriptProcessorNode.numberOfInputs;\n            },\n            get numberOfOutputs() {\n                return scriptProcessorNode.numberOfOutputs;\n            },\n            addEventListener(...args) {\n                // @todo Dissallow adding an audioprocess listener.\n                return scriptProcessorNode.addEventListener(args[0], args[1], args[2]);\n            },\n            dispatchEvent(...args) {\n                return scriptProcessorNode.dispatchEvent(args[0]);\n            },\n            getFrequencyResponse(frequencyHz, magResponse, phaseResponse) {\n                if (frequencyHz.length !== magResponse.length || magResponse.length !== phaseResponse.length) {\n                    throw createInvalidAccessError();\n                }\n                const length = frequencyHz.length;\n                for (let i = 0; i < length; i += 1) {\n                    const omega = -Math.PI * (frequencyHz[i] / nyquist);\n                    const z = [Math.cos(omega), Math.sin(omega)];\n                    const numerator = evaluatePolynomial(convertedFeedforward, z);\n                    const denominator = evaluatePolynomial(convertedFeedback, z);\n                    const response = divide(numerator, denominator);\n                    magResponse[i] = Math.sqrt(response[0] * response[0] + response[1] * response[1]);\n                    phaseResponse[i] = Math.atan2(response[1], response[0]);\n                }\n            },\n            removeEventListener(...args) {\n                return scriptProcessorNode.removeEventListener(args[0], args[1], args[2]);\n            }\n        };\n        return interceptConnections(nativeIIRFilterNodeFaker, scriptProcessorNode);\n    };\n};\n//# sourceMappingURL=native-iir-filter-node-faker-factory.js.map","export const createNativeMediaElementAudioSourceNode = (nativeAudioContext, options) => {\n    return nativeAudioContext.createMediaElementSource(options.mediaElement);\n};\n//# sourceMappingURL=native-media-element-audio-source-node.js.map","import { assignNativeAudioNodeOptions } from '../helpers/assign-native-audio-node-options';\nexport const createNativeMediaStreamAudioDestinationNode = (nativeAudioContext, options) => {\n    const nativeMediaStreamAudioDestinationNode = nativeAudioContext.createMediaStreamDestination();\n    assignNativeAudioNodeOptions(nativeMediaStreamAudioDestinationNode, options);\n    // Bug #174: Safari does expose a wrong numberOfOutputs.\n    if (nativeMediaStreamAudioDestinationNode.numberOfOutputs === 1) {\n        Object.defineProperty(nativeMediaStreamAudioDestinationNode, 'numberOfOutputs', { get: () => 0 });\n    }\n    return nativeMediaStreamAudioDestinationNode;\n};\n//# sourceMappingURL=native-media-stream-audio-destination-node.js.map","export const createNativeMediaStreamAudioSourceNode = (nativeAudioContext, { mediaStream }) => {\n    const audioStreamTracks = mediaStream.getAudioTracks();\n    /*\n     * Bug #151: Safari does not use the audio track as input anymore if it gets removed from the mediaStream after construction.\n     * Bug #159: Safari picks the first audio track if the MediaStream has more than one audio track.\n     */\n    audioStreamTracks.sort((a, b) => (a.id < b.id ? -1 : a.id > b.id ? 1 : 0));\n    const filteredAudioStreamTracks = audioStreamTracks.slice(0, 1);\n    const nativeMediaStreamAudioSourceNode = nativeAudioContext.createMediaStreamSource(new MediaStream(filteredAudioStreamTracks));\n    /*\n     * Bug #151 & #159: The given mediaStream gets reconstructed before it gets passed to the native node which is why the accessor needs\n     * to be overwritten as it would otherwise expose the reconstructed version.\n     */\n    Object.defineProperty(nativeMediaStreamAudioSourceNode, 'mediaStream', { value: mediaStream });\n    return nativeMediaStreamAudioSourceNode;\n};\n//# sourceMappingURL=native-media-stream-audio-source-node.js.map","export const createNativeMediaStreamTrackAudioSourceNodeFactory = (createInvalidStateError, isNativeOfflineAudioContext) => {\n    return (nativeAudioContext, { mediaStreamTrack }) => {\n        // Bug #121: Only Firefox does yet support the MediaStreamTrackAudioSourceNode.\n        if (typeof nativeAudioContext.createMediaStreamTrackSource === 'function') {\n            return nativeAudioContext.createMediaStreamTrackSource(mediaStreamTrack);\n        }\n        const mediaStream = new MediaStream([mediaStreamTrack]);\n        const nativeMediaStreamAudioSourceNode = nativeAudioContext.createMediaStreamSource(mediaStream);\n        // Bug #120: Firefox does not throw an error if the mediaStream has no audio track.\n        if (mediaStreamTrack.kind !== 'audio') {\n            throw createInvalidStateError();\n        }\n        // Bug #172: Safari allows to create a MediaStreamAudioSourceNode with an OfflineAudioContext.\n        if (isNativeOfflineAudioContext(nativeAudioContext)) {\n            throw new TypeError();\n        }\n        return nativeMediaStreamAudioSourceNode;\n    };\n};\n//# sourceMappingURL=native-media-stream-track-audio-source-node-factory.js.map","export const createNativeOfflineAudioContextConstructor = (window) => {\n    if (window === null) {\n        return null;\n    }\n    if (window.hasOwnProperty('OfflineAudioContext')) {\n        return window.OfflineAudioContext;\n    }\n    return window.hasOwnProperty('webkitOfflineAudioContext') ? window.webkitOfflineAudioContext : null;\n};\n//# sourceMappingURL=native-offline-audio-context-constructor.js.map","import { assignNativeAudioNodeAudioParamValue } from '../helpers/assign-native-audio-node-audio-param-value';\nimport { assignNativeAudioNodeOption } from '../helpers/assign-native-audio-node-option';\nimport { assignNativeAudioNodeOptions } from '../helpers/assign-native-audio-node-options';\nimport { wrapAudioScheduledSourceNodeStartMethodNegativeParameters } from '../helpers/wrap-audio-scheduled-source-node-start-method-negative-parameters';\nimport { wrapAudioScheduledSourceNodeStopMethodNegativeParameters } from '../helpers/wrap-audio-scheduled-source-node-stop-method-negative-parameters';\nexport const createNativeOscillatorNodeFactory = (addSilentConnection, cacheTestResult, testAudioScheduledSourceNodeStartMethodNegativeParametersSupport, testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport, testAudioScheduledSourceNodeStopMethodNegativeParametersSupport, wrapAudioScheduledSourceNodeStopMethodConsecutiveCalls) => {\n    return (nativeContext, options) => {\n        const nativeOscillatorNode = nativeContext.createOscillator();\n        assignNativeAudioNodeOptions(nativeOscillatorNode, options);\n        assignNativeAudioNodeAudioParamValue(nativeOscillatorNode, options, 'detune');\n        assignNativeAudioNodeAudioParamValue(nativeOscillatorNode, options, 'frequency');\n        if (options.periodicWave !== undefined) {\n            nativeOscillatorNode.setPeriodicWave(options.periodicWave);\n        }\n        else {\n            assignNativeAudioNodeOption(nativeOscillatorNode, options, 'type');\n        }\n        // Bug #44: Only Chrome & Edge throw a RangeError yet.\n        if (!cacheTestResult(testAudioScheduledSourceNodeStartMethodNegativeParametersSupport, () => testAudioScheduledSourceNodeStartMethodNegativeParametersSupport(nativeContext))) {\n            wrapAudioScheduledSourceNodeStartMethodNegativeParameters(nativeOscillatorNode);\n        }\n        // Bug #19: Safari does not ignore calls to stop() of an already stopped AudioBufferSourceNode.\n        if (!cacheTestResult(testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport, () => testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport(nativeContext))) {\n            wrapAudioScheduledSourceNodeStopMethodConsecutiveCalls(nativeOscillatorNode, nativeContext);\n        }\n        // Bug #44: Only Firefox does not throw a RangeError yet.\n        if (!cacheTestResult(testAudioScheduledSourceNodeStopMethodNegativeParametersSupport, () => testAudioScheduledSourceNodeStopMethodNegativeParametersSupport(nativeContext))) {\n            wrapAudioScheduledSourceNodeStopMethodNegativeParameters(nativeOscillatorNode);\n        }\n        // Bug #175: Safari will not fire an ended event if the OscillatorNode is unconnected.\n        addSilentConnection(nativeContext, nativeOscillatorNode);\n        return nativeOscillatorNode;\n    };\n};\n//# sourceMappingURL=native-oscillator-node-factory.js.map","import { assignNativeAudioNodeAudioParamValue } from '../helpers/assign-native-audio-node-audio-param-value';\nimport { assignNativeAudioNodeOption } from '../helpers/assign-native-audio-node-option';\nimport { assignNativeAudioNodeOptions } from '../helpers/assign-native-audio-node-options';\nexport const createNativePannerNodeFactory = (createNativePannerNodeFaker) => {\n    return (nativeContext, options) => {\n        const nativePannerNode = nativeContext.createPanner();\n        // Bug #124: Safari does not support modifying the orientation and the position with AudioParams.\n        if (nativePannerNode.orientationX === undefined) {\n            return createNativePannerNodeFaker(nativeContext, options);\n        }\n        assignNativeAudioNodeOptions(nativePannerNode, options);\n        assignNativeAudioNodeAudioParamValue(nativePannerNode, options, 'orientationX');\n        assignNativeAudioNodeAudioParamValue(nativePannerNode, options, 'orientationY');\n        assignNativeAudioNodeAudioParamValue(nativePannerNode, options, 'orientationZ');\n        assignNativeAudioNodeAudioParamValue(nativePannerNode, options, 'positionX');\n        assignNativeAudioNodeAudioParamValue(nativePannerNode, options, 'positionY');\n        assignNativeAudioNodeAudioParamValue(nativePannerNode, options, 'positionZ');\n        assignNativeAudioNodeOption(nativePannerNode, options, 'coneInnerAngle');\n        assignNativeAudioNodeOption(nativePannerNode, options, 'coneOuterAngle');\n        assignNativeAudioNodeOption(nativePannerNode, options, 'coneOuterGain');\n        assignNativeAudioNodeOption(nativePannerNode, options, 'distanceModel');\n        assignNativeAudioNodeOption(nativePannerNode, options, 'maxDistance');\n        assignNativeAudioNodeOption(nativePannerNode, options, 'panningModel');\n        assignNativeAudioNodeOption(nativePannerNode, options, 'refDistance');\n        assignNativeAudioNodeOption(nativePannerNode, options, 'rolloffFactor');\n        return nativePannerNode;\n    };\n};\n//# sourceMappingURL=native-panner-node-factory.js.map","import { assignNativeAudioNodeOptions } from '../helpers/assign-native-audio-node-options';\nimport { interceptConnections } from '../helpers/intercept-connections';\nexport const createNativePannerNodeFakerFactory = (connectNativeAudioNodeToNativeAudioNode, createInvalidStateError, createNativeChannelMergerNode, createNativeGainNode, createNativeScriptProcessorNode, createNativeWaveShaperNode, createNotSupportedError, disconnectNativeAudioNodeFromNativeAudioNode, getFirstSample, monitorConnections) => {\n    return (nativeContext, { coneInnerAngle, coneOuterAngle, coneOuterGain, distanceModel, maxDistance, orientationX, orientationY, orientationZ, panningModel, positionX, positionY, positionZ, refDistance, rolloffFactor, ...audioNodeOptions }) => {\n        const pannerNode = nativeContext.createPanner();\n        // Bug #125: Safari does not throw an error yet.\n        if (audioNodeOptions.channelCount > 2) {\n            throw createNotSupportedError();\n        }\n        // Bug #126: Safari does not throw an error yet.\n        if (audioNodeOptions.channelCountMode === 'max') {\n            throw createNotSupportedError();\n        }\n        assignNativeAudioNodeOptions(pannerNode, audioNodeOptions);\n        const SINGLE_CHANNEL_OPTIONS = {\n            channelCount: 1,\n            channelCountMode: 'explicit',\n            channelInterpretation: 'discrete'\n        };\n        const channelMergerNode = createNativeChannelMergerNode(nativeContext, {\n            ...SINGLE_CHANNEL_OPTIONS,\n            channelInterpretation: 'speakers',\n            numberOfInputs: 6\n        });\n        const inputGainNode = createNativeGainNode(nativeContext, { ...audioNodeOptions, gain: 1 });\n        const orientationXGainNode = createNativeGainNode(nativeContext, { ...SINGLE_CHANNEL_OPTIONS, gain: 1 });\n        const orientationYGainNode = createNativeGainNode(nativeContext, { ...SINGLE_CHANNEL_OPTIONS, gain: 0 });\n        const orientationZGainNode = createNativeGainNode(nativeContext, { ...SINGLE_CHANNEL_OPTIONS, gain: 0 });\n        const positionXGainNode = createNativeGainNode(nativeContext, { ...SINGLE_CHANNEL_OPTIONS, gain: 0 });\n        const positionYGainNode = createNativeGainNode(nativeContext, { ...SINGLE_CHANNEL_OPTIONS, gain: 0 });\n        const positionZGainNode = createNativeGainNode(nativeContext, { ...SINGLE_CHANNEL_OPTIONS, gain: 0 });\n        const scriptProcessorNode = createNativeScriptProcessorNode(nativeContext, 256, 6, 1);\n        const waveShaperNode = createNativeWaveShaperNode(nativeContext, {\n            ...SINGLE_CHANNEL_OPTIONS,\n            curve: new Float32Array([1, 1]),\n            oversample: 'none'\n        });\n        let lastOrientation = [orientationX, orientationY, orientationZ];\n        let lastPosition = [positionX, positionY, positionZ];\n        const buffer = new Float32Array(1);\n        // tslint:disable-next-line:deprecation\n        scriptProcessorNode.onaudioprocess = ({ inputBuffer }) => {\n            const orientation = [\n                getFirstSample(inputBuffer, buffer, 0),\n                getFirstSample(inputBuffer, buffer, 1),\n                getFirstSample(inputBuffer, buffer, 2)\n            ];\n            if (orientation.some((value, index) => value !== lastOrientation[index])) {\n                pannerNode.setOrientation(...orientation); // tslint:disable-line:deprecation\n                lastOrientation = orientation;\n            }\n            const positon = [\n                getFirstSample(inputBuffer, buffer, 3),\n                getFirstSample(inputBuffer, buffer, 4),\n                getFirstSample(inputBuffer, buffer, 5)\n            ];\n            if (positon.some((value, index) => value !== lastPosition[index])) {\n                pannerNode.setPosition(...positon); // tslint:disable-line:deprecation\n                lastPosition = positon;\n            }\n        };\n        Object.defineProperty(orientationYGainNode.gain, 'defaultValue', { get: () => 0 });\n        Object.defineProperty(orientationZGainNode.gain, 'defaultValue', { get: () => 0 });\n        Object.defineProperty(positionXGainNode.gain, 'defaultValue', { get: () => 0 });\n        Object.defineProperty(positionYGainNode.gain, 'defaultValue', { get: () => 0 });\n        Object.defineProperty(positionZGainNode.gain, 'defaultValue', { get: () => 0 });\n        const nativePannerNodeFaker = {\n            get bufferSize() {\n                return undefined;\n            },\n            get channelCount() {\n                return pannerNode.channelCount;\n            },\n            set channelCount(value) {\n                // Bug #125: Safari does not throw an error yet.\n                if (value > 2) {\n                    throw createNotSupportedError();\n                }\n                inputGainNode.channelCount = value;\n                pannerNode.channelCount = value;\n            },\n            get channelCountMode() {\n                return pannerNode.channelCountMode;\n            },\n            set channelCountMode(value) {\n                // Bug #126: Safari does not throw an error yet.\n                if (value === 'max') {\n                    throw createNotSupportedError();\n                }\n                inputGainNode.channelCountMode = value;\n                pannerNode.channelCountMode = value;\n            },\n            get channelInterpretation() {\n                return pannerNode.channelInterpretation;\n            },\n            set channelInterpretation(value) {\n                inputGainNode.channelInterpretation = value;\n                pannerNode.channelInterpretation = value;\n            },\n            get coneInnerAngle() {\n                return pannerNode.coneInnerAngle;\n            },\n            set coneInnerAngle(value) {\n                pannerNode.coneInnerAngle = value;\n            },\n            get coneOuterAngle() {\n                return pannerNode.coneOuterAngle;\n            },\n            set coneOuterAngle(value) {\n                pannerNode.coneOuterAngle = value;\n            },\n            get coneOuterGain() {\n                return pannerNode.coneOuterGain;\n            },\n            set coneOuterGain(value) {\n                // Bug #127: Safari does not throw an InvalidStateError yet.\n                if (value < 0 || value > 1) {\n                    throw createInvalidStateError();\n                }\n                pannerNode.coneOuterGain = value;\n            },\n            get context() {\n                return pannerNode.context;\n            },\n            get distanceModel() {\n                return pannerNode.distanceModel;\n            },\n            set distanceModel(value) {\n                pannerNode.distanceModel = value;\n            },\n            get inputs() {\n                return [inputGainNode];\n            },\n            get maxDistance() {\n                return pannerNode.maxDistance;\n            },\n            set maxDistance(value) {\n                // Bug #128: Safari does not throw an error yet.\n                if (value < 0) {\n                    throw new RangeError();\n                }\n                pannerNode.maxDistance = value;\n            },\n            get numberOfInputs() {\n                return pannerNode.numberOfInputs;\n            },\n            get numberOfOutputs() {\n                return pannerNode.numberOfOutputs;\n            },\n            get orientationX() {\n                return orientationXGainNode.gain;\n            },\n            get orientationY() {\n                return orientationYGainNode.gain;\n            },\n            get orientationZ() {\n                return orientationZGainNode.gain;\n            },\n            get panningModel() {\n                return pannerNode.panningModel;\n            },\n            set panningModel(value) {\n                pannerNode.panningModel = value;\n            },\n            get positionX() {\n                return positionXGainNode.gain;\n            },\n            get positionY() {\n                return positionYGainNode.gain;\n            },\n            get positionZ() {\n                return positionZGainNode.gain;\n            },\n            get refDistance() {\n                return pannerNode.refDistance;\n            },\n            set refDistance(value) {\n                // Bug #129: Safari does not throw an error yet.\n                if (value < 0) {\n                    throw new RangeError();\n                }\n                pannerNode.refDistance = value;\n            },\n            get rolloffFactor() {\n                return pannerNode.rolloffFactor;\n            },\n            set rolloffFactor(value) {\n                // Bug #130: Safari does not throw an error yet.\n                if (value < 0) {\n                    throw new RangeError();\n                }\n                pannerNode.rolloffFactor = value;\n            },\n            addEventListener(...args) {\n                return inputGainNode.addEventListener(args[0], args[1], args[2]);\n            },\n            dispatchEvent(...args) {\n                return inputGainNode.dispatchEvent(args[0]);\n            },\n            removeEventListener(...args) {\n                return inputGainNode.removeEventListener(args[0], args[1], args[2]);\n            }\n        };\n        if (coneInnerAngle !== nativePannerNodeFaker.coneInnerAngle) {\n            nativePannerNodeFaker.coneInnerAngle = coneInnerAngle;\n        }\n        if (coneOuterAngle !== nativePannerNodeFaker.coneOuterAngle) {\n            nativePannerNodeFaker.coneOuterAngle = coneOuterAngle;\n        }\n        if (coneOuterGain !== nativePannerNodeFaker.coneOuterGain) {\n            nativePannerNodeFaker.coneOuterGain = coneOuterGain;\n        }\n        if (distanceModel !== nativePannerNodeFaker.distanceModel) {\n            nativePannerNodeFaker.distanceModel = distanceModel;\n        }\n        if (maxDistance !== nativePannerNodeFaker.maxDistance) {\n            nativePannerNodeFaker.maxDistance = maxDistance;\n        }\n        if (orientationX !== nativePannerNodeFaker.orientationX.value) {\n            nativePannerNodeFaker.orientationX.value = orientationX;\n        }\n        if (orientationY !== nativePannerNodeFaker.orientationY.value) {\n            nativePannerNodeFaker.orientationY.value = orientationY;\n        }\n        if (orientationZ !== nativePannerNodeFaker.orientationZ.value) {\n            nativePannerNodeFaker.orientationZ.value = orientationZ;\n        }\n        if (panningModel !== nativePannerNodeFaker.panningModel) {\n            nativePannerNodeFaker.panningModel = panningModel;\n        }\n        if (positionX !== nativePannerNodeFaker.positionX.value) {\n            nativePannerNodeFaker.positionX.value = positionX;\n        }\n        if (positionY !== nativePannerNodeFaker.positionY.value) {\n            nativePannerNodeFaker.positionY.value = positionY;\n        }\n        if (positionZ !== nativePannerNodeFaker.positionZ.value) {\n            nativePannerNodeFaker.positionZ.value = positionZ;\n        }\n        if (refDistance !== nativePannerNodeFaker.refDistance) {\n            nativePannerNodeFaker.refDistance = refDistance;\n        }\n        if (rolloffFactor !== nativePannerNodeFaker.rolloffFactor) {\n            nativePannerNodeFaker.rolloffFactor = rolloffFactor;\n        }\n        if (lastOrientation[0] !== 1 || lastOrientation[1] !== 0 || lastOrientation[2] !== 0) {\n            pannerNode.setOrientation(...lastOrientation); // tslint:disable-line:deprecation\n        }\n        if (lastPosition[0] !== 0 || lastPosition[1] !== 0 || lastPosition[2] !== 0) {\n            pannerNode.setPosition(...lastPosition); // tslint:disable-line:deprecation\n        }\n        const whenConnected = () => {\n            inputGainNode.connect(pannerNode);\n            // Bug #119: Safari does not fully support the WaveShaperNode.\n            connectNativeAudioNodeToNativeAudioNode(inputGainNode, waveShaperNode, 0, 0);\n            waveShaperNode.connect(orientationXGainNode).connect(channelMergerNode, 0, 0);\n            waveShaperNode.connect(orientationYGainNode).connect(channelMergerNode, 0, 1);\n            waveShaperNode.connect(orientationZGainNode).connect(channelMergerNode, 0, 2);\n            waveShaperNode.connect(positionXGainNode).connect(channelMergerNode, 0, 3);\n            waveShaperNode.connect(positionYGainNode).connect(channelMergerNode, 0, 4);\n            waveShaperNode.connect(positionZGainNode).connect(channelMergerNode, 0, 5);\n            channelMergerNode.connect(scriptProcessorNode).connect(nativeContext.destination);\n        };\n        const whenDisconnected = () => {\n            inputGainNode.disconnect(pannerNode);\n            // Bug #119: Safari does not fully support the WaveShaperNode.\n            disconnectNativeAudioNodeFromNativeAudioNode(inputGainNode, waveShaperNode, 0, 0);\n            waveShaperNode.disconnect(orientationXGainNode);\n            orientationXGainNode.disconnect(channelMergerNode);\n            waveShaperNode.disconnect(orientationYGainNode);\n            orientationYGainNode.disconnect(channelMergerNode);\n            waveShaperNode.disconnect(orientationZGainNode);\n            orientationZGainNode.disconnect(channelMergerNode);\n            waveShaperNode.disconnect(positionXGainNode);\n            positionXGainNode.disconnect(channelMergerNode);\n            waveShaperNode.disconnect(positionYGainNode);\n            positionYGainNode.disconnect(channelMergerNode);\n            waveShaperNode.disconnect(positionZGainNode);\n            positionZGainNode.disconnect(channelMergerNode);\n            channelMergerNode.disconnect(scriptProcessorNode);\n            scriptProcessorNode.disconnect(nativeContext.destination);\n        };\n        return monitorConnections(interceptConnections(nativePannerNodeFaker, pannerNode), whenConnected, whenDisconnected);\n    };\n};\n//# sourceMappingURL=native-panner-node-faker-factory.js.map","export const createNativePeriodicWaveFactory = (createIndexSizeError) => {\n    return (nativeContext, { disableNormalization, imag, real }) => {\n        // Bug #180: Safari does not allow to use ordinary arrays.\n        const convertedImag = imag instanceof Float32Array ? imag : new Float32Array(imag);\n        const convertedReal = real instanceof Float32Array ? real : new Float32Array(real);\n        const nativePeriodicWave = nativeContext.createPeriodicWave(convertedReal, convertedImag, { disableNormalization });\n        // Bug #181: Safari does not throw an IndexSizeError so far if the given arrays have less than two values.\n        if (Array.from(imag).length < 2) {\n            throw createIndexSizeError();\n        }\n        return nativePeriodicWave;\n    };\n};\n//# sourceMappingURL=native-periodic-wave-factory.js.map","export const createNativeScriptProcessorNode = (nativeContext, bufferSize, numberOfInputChannels, numberOfOutputChannels) => {\n    return nativeContext.createScriptProcessor(bufferSize, numberOfInputChannels, numberOfOutputChannels); // tslint:disable-line deprecation\n};\n//# sourceMappingURL=native-script-processor-node.js.map","import { assignNativeAudioNodeAudioParamValue } from '../helpers/assign-native-audio-node-audio-param-value';\nimport { assignNativeAudioNodeOptions } from '../helpers/assign-native-audio-node-options';\nexport const createNativeStereoPannerNodeFactory = (createNativeStereoPannerNodeFaker, createNotSupportedError) => {\n    return (nativeContext, options) => {\n        const channelCountMode = options.channelCountMode;\n        /*\n         * Bug #105: The channelCountMode of 'clamped-max' should be supported. However it is not possible to write a polyfill for Safari\n         * which supports it and therefore it can't be supported at all.\n         */\n        if (channelCountMode === 'clamped-max') {\n            throw createNotSupportedError();\n        }\n        // Bug #105: Safari does not support the StereoPannerNode.\n        if (nativeContext.createStereoPanner === undefined) {\n            return createNativeStereoPannerNodeFaker(nativeContext, options);\n        }\n        const nativeStereoPannerNode = nativeContext.createStereoPanner();\n        assignNativeAudioNodeOptions(nativeStereoPannerNode, options);\n        assignNativeAudioNodeAudioParamValue(nativeStereoPannerNode, options, 'pan');\n        /*\n         * Bug #105: The channelCountMode of 'clamped-max' should be supported. However it is not possible to write a polyfill for Safari\n         * which supports it and therefore it can't be supported at all.\n         */\n        Object.defineProperty(nativeStereoPannerNode, 'channelCountMode', {\n            get: () => channelCountMode,\n            set: (value) => {\n                if (value !== channelCountMode) {\n                    throw createNotSupportedError();\n                }\n            }\n        });\n        return nativeStereoPannerNode;\n    };\n};\n//# sourceMappingURL=native-stereo-panner-node-factory.js.map","import { interceptConnections } from '../helpers/intercept-connections';\nexport const createNativeStereoPannerNodeFakerFactory = (createNativeChannelMergerNode, createNativeChannelSplitterNode, createNativeGainNode, createNativeWaveShaperNode, createNotSupportedError, monitorConnections) => {\n    // The curve has a size of 14bit plus 1 value to have an exact representation for zero. This value has been determined experimentally.\n    const CURVE_SIZE = 16385;\n    const DC_CURVE = new Float32Array([1, 1]);\n    const HALF_PI = Math.PI / 2;\n    const SINGLE_CHANNEL_OPTIONS = { channelCount: 1, channelCountMode: 'explicit', channelInterpretation: 'discrete' };\n    const SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS = { ...SINGLE_CHANNEL_OPTIONS, oversample: 'none' };\n    const buildInternalGraphForMono = (nativeContext, inputGainNode, panGainNode, channelMergerNode) => {\n        const leftWaveShaperCurve = new Float32Array(CURVE_SIZE);\n        const rightWaveShaperCurve = new Float32Array(CURVE_SIZE);\n        for (let i = 0; i < CURVE_SIZE; i += 1) {\n            const x = (i / (CURVE_SIZE - 1)) * HALF_PI;\n            leftWaveShaperCurve[i] = Math.cos(x);\n            rightWaveShaperCurve[i] = Math.sin(x);\n        }\n        const leftGainNode = createNativeGainNode(nativeContext, { ...SINGLE_CHANNEL_OPTIONS, gain: 0 });\n        // Bug #119: Safari does not fully support the WaveShaperNode.\n        const leftWaveShaperNode = (createNativeWaveShaperNode(nativeContext, { ...SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS, curve: leftWaveShaperCurve }));\n        // Bug #119: Safari does not fully support the WaveShaperNode.\n        const panWaveShaperNode = (createNativeWaveShaperNode(nativeContext, { ...SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS, curve: DC_CURVE }));\n        const rightGainNode = createNativeGainNode(nativeContext, { ...SINGLE_CHANNEL_OPTIONS, gain: 0 });\n        // Bug #119: Safari does not fully support the WaveShaperNode.\n        const rightWaveShaperNode = (createNativeWaveShaperNode(nativeContext, { ...SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS, curve: rightWaveShaperCurve }));\n        return {\n            connectGraph() {\n                inputGainNode.connect(leftGainNode);\n                inputGainNode.connect(panWaveShaperNode.inputs === undefined ? panWaveShaperNode : panWaveShaperNode.inputs[0]);\n                inputGainNode.connect(rightGainNode);\n                panWaveShaperNode.connect(panGainNode);\n                panGainNode.connect(leftWaveShaperNode.inputs === undefined ? leftWaveShaperNode : leftWaveShaperNode.inputs[0]);\n                panGainNode.connect(rightWaveShaperNode.inputs === undefined ? rightWaveShaperNode : rightWaveShaperNode.inputs[0]);\n                leftWaveShaperNode.connect(leftGainNode.gain);\n                rightWaveShaperNode.connect(rightGainNode.gain);\n                leftGainNode.connect(channelMergerNode, 0, 0);\n                rightGainNode.connect(channelMergerNode, 0, 1);\n            },\n            disconnectGraph() {\n                inputGainNode.disconnect(leftGainNode);\n                inputGainNode.disconnect(panWaveShaperNode.inputs === undefined ? panWaveShaperNode : panWaveShaperNode.inputs[0]);\n                inputGainNode.disconnect(rightGainNode);\n                panWaveShaperNode.disconnect(panGainNode);\n                panGainNode.disconnect(leftWaveShaperNode.inputs === undefined ? leftWaveShaperNode : leftWaveShaperNode.inputs[0]);\n                panGainNode.disconnect(rightWaveShaperNode.inputs === undefined ? rightWaveShaperNode : rightWaveShaperNode.inputs[0]);\n                leftWaveShaperNode.disconnect(leftGainNode.gain);\n                rightWaveShaperNode.disconnect(rightGainNode.gain);\n                leftGainNode.disconnect(channelMergerNode, 0, 0);\n                rightGainNode.disconnect(channelMergerNode, 0, 1);\n            }\n        };\n    };\n    const buildInternalGraphForStereo = (nativeContext, inputGainNode, panGainNode, channelMergerNode) => {\n        const leftInputForLeftOutputWaveShaperCurve = new Float32Array(CURVE_SIZE);\n        const leftInputForRightOutputWaveShaperCurve = new Float32Array(CURVE_SIZE);\n        const rightInputForLeftOutputWaveShaperCurve = new Float32Array(CURVE_SIZE);\n        const rightInputForRightOutputWaveShaperCurve = new Float32Array(CURVE_SIZE);\n        const centerIndex = Math.floor(CURVE_SIZE / 2);\n        for (let i = 0; i < CURVE_SIZE; i += 1) {\n            if (i > centerIndex) {\n                const x = ((i - centerIndex) / (CURVE_SIZE - 1 - centerIndex)) * HALF_PI;\n                leftInputForLeftOutputWaveShaperCurve[i] = Math.cos(x);\n                leftInputForRightOutputWaveShaperCurve[i] = Math.sin(x);\n                rightInputForLeftOutputWaveShaperCurve[i] = 0;\n                rightInputForRightOutputWaveShaperCurve[i] = 1;\n            }\n            else {\n                const x = (i / (CURVE_SIZE - 1 - centerIndex)) * HALF_PI;\n                leftInputForLeftOutputWaveShaperCurve[i] = 1;\n                leftInputForRightOutputWaveShaperCurve[i] = 0;\n                rightInputForLeftOutputWaveShaperCurve[i] = Math.cos(x);\n                rightInputForRightOutputWaveShaperCurve[i] = Math.sin(x);\n            }\n        }\n        const channelSplitterNode = createNativeChannelSplitterNode(nativeContext, {\n            channelCount: 2,\n            channelCountMode: 'explicit',\n            channelInterpretation: 'discrete',\n            numberOfOutputs: 2\n        });\n        const leftInputForLeftOutputGainNode = createNativeGainNode(nativeContext, { ...SINGLE_CHANNEL_OPTIONS, gain: 0 });\n        // Bug #119: Safari does not fully support the WaveShaperNode.\n        const leftInputForLeftOutputWaveShaperNode = createNativeWaveShaperNode(nativeContext, {\n            ...SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS,\n            curve: leftInputForLeftOutputWaveShaperCurve\n        });\n        const leftInputForRightOutputGainNode = createNativeGainNode(nativeContext, { ...SINGLE_CHANNEL_OPTIONS, gain: 0 });\n        // Bug #119: Safari does not fully support the WaveShaperNode.\n        const leftInputForRightOutputWaveShaperNode = createNativeWaveShaperNode(nativeContext, {\n            ...SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS,\n            curve: leftInputForRightOutputWaveShaperCurve\n        });\n        // Bug #119: Safari does not fully support the WaveShaperNode.\n        const panWaveShaperNode = (createNativeWaveShaperNode(nativeContext, { ...SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS, curve: DC_CURVE }));\n        const rightInputForLeftOutputGainNode = createNativeGainNode(nativeContext, { ...SINGLE_CHANNEL_OPTIONS, gain: 0 });\n        // Bug #119: Safari does not fully support the WaveShaperNode.\n        const rightInputForLeftOutputWaveShaperNode = createNativeWaveShaperNode(nativeContext, {\n            ...SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS,\n            curve: rightInputForLeftOutputWaveShaperCurve\n        });\n        const rightInputForRightOutputGainNode = createNativeGainNode(nativeContext, { ...SINGLE_CHANNEL_OPTIONS, gain: 0 });\n        // Bug #119: Safari does not fully support the WaveShaperNode.\n        const rightInputForRightOutputWaveShaperNode = createNativeWaveShaperNode(nativeContext, {\n            ...SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS,\n            curve: rightInputForRightOutputWaveShaperCurve\n        });\n        return {\n            connectGraph() {\n                inputGainNode.connect(channelSplitterNode);\n                inputGainNode.connect(panWaveShaperNode.inputs === undefined ? panWaveShaperNode : panWaveShaperNode.inputs[0]);\n                channelSplitterNode.connect(leftInputForLeftOutputGainNode, 0);\n                channelSplitterNode.connect(leftInputForRightOutputGainNode, 0);\n                channelSplitterNode.connect(rightInputForLeftOutputGainNode, 1);\n                channelSplitterNode.connect(rightInputForRightOutputGainNode, 1);\n                panWaveShaperNode.connect(panGainNode);\n                panGainNode.connect(leftInputForLeftOutputWaveShaperNode.inputs === undefined\n                    ? leftInputForLeftOutputWaveShaperNode\n                    : leftInputForLeftOutputWaveShaperNode.inputs[0]);\n                panGainNode.connect(leftInputForRightOutputWaveShaperNode.inputs === undefined\n                    ? leftInputForRightOutputWaveShaperNode\n                    : leftInputForRightOutputWaveShaperNode.inputs[0]);\n                panGainNode.connect(rightInputForLeftOutputWaveShaperNode.inputs === undefined\n                    ? rightInputForLeftOutputWaveShaperNode\n                    : rightInputForLeftOutputWaveShaperNode.inputs[0]);\n                panGainNode.connect(rightInputForRightOutputWaveShaperNode.inputs === undefined\n                    ? rightInputForRightOutputWaveShaperNode\n                    : rightInputForRightOutputWaveShaperNode.inputs[0]);\n                leftInputForLeftOutputWaveShaperNode.connect(leftInputForLeftOutputGainNode.gain);\n                leftInputForRightOutputWaveShaperNode.connect(leftInputForRightOutputGainNode.gain);\n                rightInputForLeftOutputWaveShaperNode.connect(rightInputForLeftOutputGainNode.gain);\n                rightInputForRightOutputWaveShaperNode.connect(rightInputForRightOutputGainNode.gain);\n                leftInputForLeftOutputGainNode.connect(channelMergerNode, 0, 0);\n                rightInputForLeftOutputGainNode.connect(channelMergerNode, 0, 0);\n                leftInputForRightOutputGainNode.connect(channelMergerNode, 0, 1);\n                rightInputForRightOutputGainNode.connect(channelMergerNode, 0, 1);\n            },\n            disconnectGraph() {\n                inputGainNode.disconnect(channelSplitterNode);\n                inputGainNode.disconnect(panWaveShaperNode.inputs === undefined ? panWaveShaperNode : panWaveShaperNode.inputs[0]);\n                channelSplitterNode.disconnect(leftInputForLeftOutputGainNode, 0);\n                channelSplitterNode.disconnect(leftInputForRightOutputGainNode, 0);\n                channelSplitterNode.disconnect(rightInputForLeftOutputGainNode, 1);\n                channelSplitterNode.disconnect(rightInputForRightOutputGainNode, 1);\n                panWaveShaperNode.disconnect(panGainNode);\n                panGainNode.disconnect(leftInputForLeftOutputWaveShaperNode.inputs === undefined\n                    ? leftInputForLeftOutputWaveShaperNode\n                    : leftInputForLeftOutputWaveShaperNode.inputs[0]);\n                panGainNode.disconnect(leftInputForRightOutputWaveShaperNode.inputs === undefined\n                    ? leftInputForRightOutputWaveShaperNode\n                    : leftInputForRightOutputWaveShaperNode.inputs[0]);\n                panGainNode.disconnect(rightInputForLeftOutputWaveShaperNode.inputs === undefined\n                    ? rightInputForLeftOutputWaveShaperNode\n                    : rightInputForLeftOutputWaveShaperNode.inputs[0]);\n                panGainNode.disconnect(rightInputForRightOutputWaveShaperNode.inputs === undefined\n                    ? rightInputForRightOutputWaveShaperNode\n                    : rightInputForRightOutputWaveShaperNode.inputs[0]);\n                leftInputForLeftOutputWaveShaperNode.disconnect(leftInputForLeftOutputGainNode.gain);\n                leftInputForRightOutputWaveShaperNode.disconnect(leftInputForRightOutputGainNode.gain);\n                rightInputForLeftOutputWaveShaperNode.disconnect(rightInputForLeftOutputGainNode.gain);\n                rightInputForRightOutputWaveShaperNode.disconnect(rightInputForRightOutputGainNode.gain);\n                leftInputForLeftOutputGainNode.disconnect(channelMergerNode, 0, 0);\n                rightInputForLeftOutputGainNode.disconnect(channelMergerNode, 0, 0);\n                leftInputForRightOutputGainNode.disconnect(channelMergerNode, 0, 1);\n                rightInputForRightOutputGainNode.disconnect(channelMergerNode, 0, 1);\n            }\n        };\n    };\n    const buildInternalGraph = (nativeContext, channelCount, inputGainNode, panGainNode, channelMergerNode) => {\n        if (channelCount === 1) {\n            return buildInternalGraphForMono(nativeContext, inputGainNode, panGainNode, channelMergerNode);\n        }\n        if (channelCount === 2) {\n            return buildInternalGraphForStereo(nativeContext, inputGainNode, panGainNode, channelMergerNode);\n        }\n        throw createNotSupportedError();\n    };\n    return (nativeContext, { channelCount, channelCountMode, pan, ...audioNodeOptions }) => {\n        if (channelCountMode === 'max') {\n            throw createNotSupportedError();\n        }\n        const channelMergerNode = createNativeChannelMergerNode(nativeContext, {\n            ...audioNodeOptions,\n            channelCount: 1,\n            channelCountMode,\n            numberOfInputs: 2\n        });\n        const inputGainNode = createNativeGainNode(nativeContext, { ...audioNodeOptions, channelCount, channelCountMode, gain: 1 });\n        const panGainNode = createNativeGainNode(nativeContext, {\n            channelCount: 1,\n            channelCountMode: 'explicit',\n            channelInterpretation: 'discrete',\n            gain: pan\n        });\n        let { connectGraph, disconnectGraph } = buildInternalGraph(nativeContext, channelCount, inputGainNode, panGainNode, channelMergerNode);\n        Object.defineProperty(panGainNode.gain, 'defaultValue', { get: () => 0 });\n        Object.defineProperty(panGainNode.gain, 'maxValue', { get: () => 1 });\n        Object.defineProperty(panGainNode.gain, 'minValue', { get: () => -1 });\n        const nativeStereoPannerNodeFakerFactory = {\n            get bufferSize() {\n                return undefined;\n            },\n            get channelCount() {\n                return inputGainNode.channelCount;\n            },\n            set channelCount(value) {\n                if (inputGainNode.channelCount !== value) {\n                    if (isConnected) {\n                        disconnectGraph();\n                    }\n                    ({ connectGraph, disconnectGraph } = buildInternalGraph(nativeContext, value, inputGainNode, panGainNode, channelMergerNode));\n                    if (isConnected) {\n                        connectGraph();\n                    }\n                }\n                inputGainNode.channelCount = value;\n            },\n            get channelCountMode() {\n                return inputGainNode.channelCountMode;\n            },\n            set channelCountMode(value) {\n                if (value === 'clamped-max' || value === 'max') {\n                    throw createNotSupportedError();\n                }\n                inputGainNode.channelCountMode = value;\n            },\n            get channelInterpretation() {\n                return inputGainNode.channelInterpretation;\n            },\n            set channelInterpretation(value) {\n                inputGainNode.channelInterpretation = value;\n            },\n            get context() {\n                return inputGainNode.context;\n            },\n            get inputs() {\n                return [inputGainNode];\n            },\n            get numberOfInputs() {\n                return inputGainNode.numberOfInputs;\n            },\n            get numberOfOutputs() {\n                return inputGainNode.numberOfOutputs;\n            },\n            get pan() {\n                return panGainNode.gain;\n            },\n            addEventListener(...args) {\n                return inputGainNode.addEventListener(args[0], args[1], args[2]);\n            },\n            dispatchEvent(...args) {\n                return inputGainNode.dispatchEvent(args[0]);\n            },\n            removeEventListener(...args) {\n                return inputGainNode.removeEventListener(args[0], args[1], args[2]);\n            }\n        };\n        let isConnected = false;\n        const whenConnected = () => {\n            connectGraph();\n            isConnected = true;\n        };\n        const whenDisconnected = () => {\n            disconnectGraph();\n            isConnected = false;\n        };\n        return monitorConnections(interceptConnections(nativeStereoPannerNodeFakerFactory, channelMergerNode), whenConnected, whenDisconnected);\n    };\n};\n//# sourceMappingURL=native-stereo-panner-node-faker-factory.js.map","import { assignNativeAudioNodeOption } from '../helpers/assign-native-audio-node-option';\nimport { assignNativeAudioNodeOptions } from '../helpers/assign-native-audio-node-options';\nexport const createNativeWaveShaperNodeFactory = (createConnectedNativeAudioBufferSourceNode, createInvalidStateError, createNativeWaveShaperNodeFaker, isDCCurve, monitorConnections, nativeAudioContextConstructor, overwriteAccessors) => {\n    return (nativeContext, options) => {\n        const nativeWaveShaperNode = nativeContext.createWaveShaper();\n        /*\n         * Bug #119: Safari does not correctly map the values.\n         * @todo Unfortunately there is no way to test for this behavior in a synchronous fashion which is why testing for the existence of\n         * the webkitAudioContext is used as a workaround here. Testing for the automationRate property is necessary because this workaround\n         * isn't necessary anymore since v14.0.2 of Safari.\n         */\n        if (nativeAudioContextConstructor !== null &&\n            nativeAudioContextConstructor.name === 'webkitAudioContext' &&\n            nativeContext.createGain().gain.automationRate === undefined) {\n            return createNativeWaveShaperNodeFaker(nativeContext, options);\n        }\n        assignNativeAudioNodeOptions(nativeWaveShaperNode, options);\n        const curve = options.curve === null || options.curve instanceof Float32Array ? options.curve : new Float32Array(options.curve);\n        // Bug #104: Chrome and Edge will throw an InvalidAccessError when the curve has less than two samples.\n        if (curve !== null && curve.length < 2) {\n            throw createInvalidStateError();\n        }\n        // Only values of type Float32Array can be assigned to the curve property.\n        assignNativeAudioNodeOption(nativeWaveShaperNode, { curve }, 'curve');\n        assignNativeAudioNodeOption(nativeWaveShaperNode, options, 'oversample');\n        let disconnectNativeAudioBufferSourceNode = null;\n        let isConnected = false;\n        overwriteAccessors(nativeWaveShaperNode, 'curve', (get) => () => get.call(nativeWaveShaperNode), (set) => (value) => {\n            set.call(nativeWaveShaperNode, value);\n            if (isConnected) {\n                if (isDCCurve(value) && disconnectNativeAudioBufferSourceNode === null) {\n                    disconnectNativeAudioBufferSourceNode = createConnectedNativeAudioBufferSourceNode(nativeContext, nativeWaveShaperNode);\n                }\n                else if (!isDCCurve(value) && disconnectNativeAudioBufferSourceNode !== null) {\n                    disconnectNativeAudioBufferSourceNode();\n                    disconnectNativeAudioBufferSourceNode = null;\n                }\n            }\n            return value;\n        });\n        const whenConnected = () => {\n            isConnected = true;\n            if (isDCCurve(nativeWaveShaperNode.curve)) {\n                disconnectNativeAudioBufferSourceNode = createConnectedNativeAudioBufferSourceNode(nativeContext, nativeWaveShaperNode);\n            }\n        };\n        const whenDisconnected = () => {\n            isConnected = false;\n            if (disconnectNativeAudioBufferSourceNode !== null) {\n                disconnectNativeAudioBufferSourceNode();\n                disconnectNativeAudioBufferSourceNode = null;\n            }\n        };\n        return monitorConnections(nativeWaveShaperNode, whenConnected, whenDisconnected);\n    };\n};\n//# sourceMappingURL=native-wave-shaper-node-factory.js.map","import { assignNativeAudioNodeOptions } from '../helpers/assign-native-audio-node-options';\nimport { interceptConnections } from '../helpers/intercept-connections';\nexport const createNativeWaveShaperNodeFakerFactory = (createConnectedNativeAudioBufferSourceNode, createInvalidStateError, createNativeGainNode, isDCCurve, monitorConnections) => {\n    return (nativeContext, { curve, oversample, ...audioNodeOptions }) => {\n        const negativeWaveShaperNode = nativeContext.createWaveShaper();\n        const positiveWaveShaperNode = nativeContext.createWaveShaper();\n        assignNativeAudioNodeOptions(negativeWaveShaperNode, audioNodeOptions);\n        assignNativeAudioNodeOptions(positiveWaveShaperNode, audioNodeOptions);\n        const inputGainNode = createNativeGainNode(nativeContext, { ...audioNodeOptions, gain: 1 });\n        const invertGainNode = createNativeGainNode(nativeContext, { ...audioNodeOptions, gain: -1 });\n        const outputGainNode = createNativeGainNode(nativeContext, { ...audioNodeOptions, gain: 1 });\n        const revertGainNode = createNativeGainNode(nativeContext, { ...audioNodeOptions, gain: -1 });\n        let disconnectNativeAudioBufferSourceNode = null;\n        let isConnected = false;\n        let unmodifiedCurve = null;\n        const nativeWaveShaperNodeFaker = {\n            get bufferSize() {\n                return undefined;\n            },\n            get channelCount() {\n                return negativeWaveShaperNode.channelCount;\n            },\n            set channelCount(value) {\n                inputGainNode.channelCount = value;\n                invertGainNode.channelCount = value;\n                negativeWaveShaperNode.channelCount = value;\n                outputGainNode.channelCount = value;\n                positiveWaveShaperNode.channelCount = value;\n                revertGainNode.channelCount = value;\n            },\n            get channelCountMode() {\n                return negativeWaveShaperNode.channelCountMode;\n            },\n            set channelCountMode(value) {\n                inputGainNode.channelCountMode = value;\n                invertGainNode.channelCountMode = value;\n                negativeWaveShaperNode.channelCountMode = value;\n                outputGainNode.channelCountMode = value;\n                positiveWaveShaperNode.channelCountMode = value;\n                revertGainNode.channelCountMode = value;\n            },\n            get channelInterpretation() {\n                return negativeWaveShaperNode.channelInterpretation;\n            },\n            set channelInterpretation(value) {\n                inputGainNode.channelInterpretation = value;\n                invertGainNode.channelInterpretation = value;\n                negativeWaveShaperNode.channelInterpretation = value;\n                outputGainNode.channelInterpretation = value;\n                positiveWaveShaperNode.channelInterpretation = value;\n                revertGainNode.channelInterpretation = value;\n            },\n            get context() {\n                return negativeWaveShaperNode.context;\n            },\n            get curve() {\n                return unmodifiedCurve;\n            },\n            set curve(value) {\n                // Bug #102: Safari does not throw an InvalidStateError when the curve has less than two samples.\n                if (value !== null && value.length < 2) {\n                    throw createInvalidStateError();\n                }\n                if (value === null) {\n                    negativeWaveShaperNode.curve = value;\n                    positiveWaveShaperNode.curve = value;\n                }\n                else {\n                    const curveLength = value.length;\n                    const negativeCurve = new Float32Array(curveLength + 2 - (curveLength % 2));\n                    const positiveCurve = new Float32Array(curveLength + 2 - (curveLength % 2));\n                    negativeCurve[0] = value[0];\n                    positiveCurve[0] = -value[curveLength - 1];\n                    const length = Math.ceil((curveLength + 1) / 2);\n                    const centerIndex = (curveLength + 1) / 2 - 1;\n                    for (let i = 1; i < length; i += 1) {\n                        const theoreticIndex = (i / length) * centerIndex;\n                        const lowerIndex = Math.floor(theoreticIndex);\n                        const upperIndex = Math.ceil(theoreticIndex);\n                        negativeCurve[i] =\n                            lowerIndex === upperIndex\n                                ? value[lowerIndex]\n                                : (1 - (theoreticIndex - lowerIndex)) * value[lowerIndex] +\n                                    (1 - (upperIndex - theoreticIndex)) * value[upperIndex];\n                        positiveCurve[i] =\n                            lowerIndex === upperIndex\n                                ? -value[curveLength - 1 - lowerIndex]\n                                : -((1 - (theoreticIndex - lowerIndex)) * value[curveLength - 1 - lowerIndex]) -\n                                    (1 - (upperIndex - theoreticIndex)) * value[curveLength - 1 - upperIndex];\n                    }\n                    negativeCurve[length] = curveLength % 2 === 1 ? value[length - 1] : (value[length - 2] + value[length - 1]) / 2;\n                    negativeWaveShaperNode.curve = negativeCurve;\n                    positiveWaveShaperNode.curve = positiveCurve;\n                }\n                unmodifiedCurve = value;\n                if (isConnected) {\n                    if (isDCCurve(unmodifiedCurve) && disconnectNativeAudioBufferSourceNode === null) {\n                        disconnectNativeAudioBufferSourceNode = createConnectedNativeAudioBufferSourceNode(nativeContext, inputGainNode);\n                    }\n                    else if (disconnectNativeAudioBufferSourceNode !== null) {\n                        disconnectNativeAudioBufferSourceNode();\n                        disconnectNativeAudioBufferSourceNode = null;\n                    }\n                }\n            },\n            get inputs() {\n                return [inputGainNode];\n            },\n            get numberOfInputs() {\n                return negativeWaveShaperNode.numberOfInputs;\n            },\n            get numberOfOutputs() {\n                return negativeWaveShaperNode.numberOfOutputs;\n            },\n            get oversample() {\n                return negativeWaveShaperNode.oversample;\n            },\n            set oversample(value) {\n                negativeWaveShaperNode.oversample = value;\n                positiveWaveShaperNode.oversample = value;\n            },\n            addEventListener(...args) {\n                return inputGainNode.addEventListener(args[0], args[1], args[2]);\n            },\n            dispatchEvent(...args) {\n                return inputGainNode.dispatchEvent(args[0]);\n            },\n            removeEventListener(...args) {\n                return inputGainNode.removeEventListener(args[0], args[1], args[2]);\n            }\n        };\n        if (curve !== null) {\n            // Only values of type Float32Array can be assigned to the curve property.\n            nativeWaveShaperNodeFaker.curve = curve instanceof Float32Array ? curve : new Float32Array(curve);\n        }\n        if (oversample !== nativeWaveShaperNodeFaker.oversample) {\n            nativeWaveShaperNodeFaker.oversample = oversample;\n        }\n        const whenConnected = () => {\n            inputGainNode.connect(negativeWaveShaperNode).connect(outputGainNode);\n            inputGainNode.connect(invertGainNode).connect(positiveWaveShaperNode).connect(revertGainNode).connect(outputGainNode);\n            isConnected = true;\n            if (isDCCurve(unmodifiedCurve)) {\n                disconnectNativeAudioBufferSourceNode = createConnectedNativeAudioBufferSourceNode(nativeContext, inputGainNode);\n            }\n        };\n        const whenDisconnected = () => {\n            inputGainNode.disconnect(negativeWaveShaperNode);\n            negativeWaveShaperNode.disconnect(outputGainNode);\n            inputGainNode.disconnect(invertGainNode);\n            invertGainNode.disconnect(positiveWaveShaperNode);\n            positiveWaveShaperNode.disconnect(revertGainNode);\n            revertGainNode.disconnect(outputGainNode);\n            isConnected = false;\n            if (disconnectNativeAudioBufferSourceNode !== null) {\n                disconnectNativeAudioBufferSourceNode();\n                disconnectNativeAudioBufferSourceNode = null;\n            }\n        };\n        return monitorConnections(interceptConnections(nativeWaveShaperNodeFaker, outputGainNode), whenConnected, whenDisconnected);\n    };\n};\n//# sourceMappingURL=native-wave-shaper-node-faker-factory.js.map","export const createNotSupportedError = () => new DOMException('', 'NotSupportedError');\n//# sourceMappingURL=not-supported-error.js.map","import { deactivateAudioGraph } from '../helpers/deactivate-audio-graph';\nimport { testPromiseSupport } from '../helpers/test-promise-support';\nconst DEFAULT_OPTIONS = {\n    numberOfChannels: 1\n};\nexport const createOfflineAudioContextConstructor = (baseAudioContextConstructor, cacheTestResult, createInvalidStateError, createNativeOfflineAudioContext, startRendering) => {\n    return class OfflineAudioContext extends baseAudioContextConstructor {\n        constructor(a, b, c) {\n            let options;\n            if (typeof a === 'number' && b !== undefined && c !== undefined) {\n                options = { length: b, numberOfChannels: a, sampleRate: c };\n            }\n            else if (typeof a === 'object') {\n                options = a;\n            }\n            else {\n                throw new Error('The given parameters are not valid.');\n            }\n            const { length, numberOfChannels, sampleRate } = { ...DEFAULT_OPTIONS, ...options };\n            const nativeOfflineAudioContext = createNativeOfflineAudioContext(numberOfChannels, length, sampleRate);\n            // #21 Safari does not support promises and therefore would fire the statechange event before the promise can be resolved.\n            if (!cacheTestResult(testPromiseSupport, () => testPromiseSupport(nativeOfflineAudioContext))) {\n                nativeOfflineAudioContext.addEventListener('statechange', (() => {\n                    let i = 0;\n                    const delayStateChangeEvent = (event) => {\n                        if (this._state === 'running') {\n                            if (i > 0) {\n                                nativeOfflineAudioContext.removeEventListener('statechange', delayStateChangeEvent);\n                                event.stopImmediatePropagation();\n                                this._waitForThePromiseToSettle(event);\n                            }\n                            else {\n                                i += 1;\n                            }\n                        }\n                    };\n                    return delayStateChangeEvent;\n                })());\n            }\n            super(nativeOfflineAudioContext, numberOfChannels);\n            this._length = length;\n            this._nativeOfflineAudioContext = nativeOfflineAudioContext;\n            this._state = null;\n        }\n        get length() {\n            // Bug #17: Safari does not yet expose the length.\n            if (this._nativeOfflineAudioContext.length === undefined) {\n                return this._length;\n            }\n            return this._nativeOfflineAudioContext.length;\n        }\n        get state() {\n            return this._state === null ? this._nativeOfflineAudioContext.state : this._state;\n        }\n        startRendering() {\n            /*\n             * Bug #9 & #59: It is theoretically possible that startRendering() will first render a partialOfflineAudioContext. Therefore\n             * the state of the nativeOfflineAudioContext might no transition to running immediately.\n             */\n            if (this._state === 'running') {\n                return Promise.reject(createInvalidStateError());\n            }\n            this._state = 'running';\n            return startRendering(this.destination, this._nativeOfflineAudioContext).finally(() => {\n                this._state = null;\n                deactivateAudioGraph(this);\n            });\n        }\n        _waitForThePromiseToSettle(event) {\n            if (this._state === null) {\n                this._nativeOfflineAudioContext.dispatchEvent(event);\n            }\n            else {\n                setTimeout(() => this._waitForThePromiseToSettle(event));\n            }\n        }\n    };\n};\n//# sourceMappingURL=offline-audio-context-constructor.js.map","import { isActiveAudioNode } from '../helpers/is-active-audio-node';\nimport { setInternalStateToActive } from '../helpers/set-internal-state-to-active';\nimport { setInternalStateToPassive } from '../helpers/set-internal-state-to-passive';\nconst DEFAULT_OPTIONS = {\n    channelCount: 2,\n    channelCountMode: 'max', // This attribute has no effect for nodes with no inputs.\n    channelInterpretation: 'speakers', // This attribute has no effect for nodes with no inputs.\n    detune: 0,\n    frequency: 440,\n    periodicWave: undefined,\n    type: 'sine'\n};\nexport const createOscillatorNodeConstructor = (audioNodeConstructor, createAudioParam, createNativeOscillatorNode, createOscillatorNodeRenderer, getNativeContext, isNativeOfflineAudioContext, wrapEventListener) => {\n    return class OscillatorNode extends audioNodeConstructor {\n        constructor(context, options) {\n            const nativeContext = getNativeContext(context);\n            const mergedOptions = { ...DEFAULT_OPTIONS, ...options };\n            const nativeOscillatorNode = createNativeOscillatorNode(nativeContext, mergedOptions);\n            const isOffline = isNativeOfflineAudioContext(nativeContext);\n            const oscillatorNodeRenderer = (isOffline ? createOscillatorNodeRenderer() : null);\n            const nyquist = context.sampleRate / 2;\n            super(context, false, nativeOscillatorNode, oscillatorNodeRenderer);\n            // Bug #81: Firefox & Safari do not export the correct values for maxValue and minValue.\n            this._detune = createAudioParam(this, isOffline, nativeOscillatorNode.detune, 153600, -153600);\n            // Bug #76: Safari does not export the correct values for maxValue and minValue.\n            this._frequency = createAudioParam(this, isOffline, nativeOscillatorNode.frequency, nyquist, -nyquist);\n            this._nativeOscillatorNode = nativeOscillatorNode;\n            this._onended = null;\n            this._oscillatorNodeRenderer = oscillatorNodeRenderer;\n            if (this._oscillatorNodeRenderer !== null && mergedOptions.periodicWave !== undefined) {\n                this._oscillatorNodeRenderer.periodicWave =\n                    mergedOptions.periodicWave;\n            }\n        }\n        get detune() {\n            return this._detune;\n        }\n        get frequency() {\n            return this._frequency;\n        }\n        get onended() {\n            return this._onended;\n        }\n        set onended(value) {\n            const wrappedListener = typeof value === 'function' ? wrapEventListener(this, value) : null;\n            this._nativeOscillatorNode.onended = wrappedListener;\n            const nativeOnEnded = this._nativeOscillatorNode.onended;\n            this._onended = nativeOnEnded !== null && nativeOnEnded === wrappedListener ? value : nativeOnEnded;\n        }\n        get type() {\n            return this._nativeOscillatorNode.type;\n        }\n        set type(value) {\n            this._nativeOscillatorNode.type = value;\n            if (this._oscillatorNodeRenderer !== null) {\n                this._oscillatorNodeRenderer.periodicWave = null;\n            }\n        }\n        setPeriodicWave(periodicWave) {\n            this._nativeOscillatorNode.setPeriodicWave(periodicWave);\n            if (this._oscillatorNodeRenderer !== null) {\n                this._oscillatorNodeRenderer.periodicWave = periodicWave;\n            }\n        }\n        start(when = 0) {\n            this._nativeOscillatorNode.start(when);\n            if (this._oscillatorNodeRenderer !== null) {\n                this._oscillatorNodeRenderer.start = when;\n            }\n            if (this.context.state !== 'closed') {\n                setInternalStateToActive(this);\n                const resetInternalStateToPassive = () => {\n                    this._nativeOscillatorNode.removeEventListener('ended', resetInternalStateToPassive);\n                    if (isActiveAudioNode(this)) {\n                        setInternalStateToPassive(this);\n                    }\n                };\n                this._nativeOscillatorNode.addEventListener('ended', resetInternalStateToPassive);\n            }\n        }\n        stop(when = 0) {\n            this._nativeOscillatorNode.stop(when);\n            if (this._oscillatorNodeRenderer !== null) {\n                this._oscillatorNodeRenderer.stop = when;\n            }\n        }\n    };\n};\n//# sourceMappingURL=oscillator-node-constructor.js.map","import { isOwnedByContext } from '../helpers/is-owned-by-context';\nexport const createOscillatorNodeRendererFactory = (connectAudioParam, createNativeOscillatorNode, getNativeAudioNode, renderAutomation, renderInputsOfAudioNode) => {\n    return () => {\n        const renderedNativeOscillatorNodes = new WeakMap();\n        let periodicWave = null;\n        let start = null;\n        let stop = null;\n        const createOscillatorNode = async (proxy, nativeOfflineAudioContext) => {\n            let nativeOscillatorNode = getNativeAudioNode(proxy);\n            // If the initially used nativeOscillatorNode was not constructed on the same OfflineAudioContext it needs to be created again.\n            const nativeOscillatorNodeIsOwnedByContext = isOwnedByContext(nativeOscillatorNode, nativeOfflineAudioContext);\n            if (!nativeOscillatorNodeIsOwnedByContext) {\n                const options = {\n                    channelCount: nativeOscillatorNode.channelCount,\n                    channelCountMode: nativeOscillatorNode.channelCountMode,\n                    channelInterpretation: nativeOscillatorNode.channelInterpretation,\n                    detune: nativeOscillatorNode.detune.value,\n                    frequency: nativeOscillatorNode.frequency.value,\n                    periodicWave: periodicWave === null ? undefined : periodicWave,\n                    type: nativeOscillatorNode.type\n                };\n                nativeOscillatorNode = createNativeOscillatorNode(nativeOfflineAudioContext, options);\n                if (start !== null) {\n                    nativeOscillatorNode.start(start);\n                }\n                if (stop !== null) {\n                    nativeOscillatorNode.stop(stop);\n                }\n            }\n            renderedNativeOscillatorNodes.set(nativeOfflineAudioContext, nativeOscillatorNode);\n            if (!nativeOscillatorNodeIsOwnedByContext) {\n                await renderAutomation(nativeOfflineAudioContext, proxy.detune, nativeOscillatorNode.detune);\n                await renderAutomation(nativeOfflineAudioContext, proxy.frequency, nativeOscillatorNode.frequency);\n            }\n            else {\n                await connectAudioParam(nativeOfflineAudioContext, proxy.detune, nativeOscillatorNode.detune);\n                await connectAudioParam(nativeOfflineAudioContext, proxy.frequency, nativeOscillatorNode.frequency);\n            }\n            await renderInputsOfAudioNode(proxy, nativeOfflineAudioContext, nativeOscillatorNode);\n            return nativeOscillatorNode;\n        };\n        return {\n            set periodicWave(value) {\n                periodicWave = value;\n            },\n            set start(value) {\n                start = value;\n            },\n            set stop(value) {\n                stop = value;\n            },\n            render(proxy, nativeOfflineAudioContext) {\n                const renderedNativeOscillatorNode = renderedNativeOscillatorNodes.get(nativeOfflineAudioContext);\n                if (renderedNativeOscillatorNode !== undefined) {\n                    return Promise.resolve(renderedNativeOscillatorNode);\n                }\n                return createOscillatorNode(proxy, nativeOfflineAudioContext);\n            }\n        };\n    };\n};\n//# sourceMappingURL=oscillator-node-renderer-factory.js.map","import { MOST_NEGATIVE_SINGLE_FLOAT, MOST_POSITIVE_SINGLE_FLOAT } from '../constants';\nconst DEFAULT_OPTIONS = {\n    channelCount: 2,\n    channelCountMode: 'clamped-max',\n    channelInterpretation: 'speakers',\n    coneInnerAngle: 360,\n    coneOuterAngle: 360,\n    coneOuterGain: 0,\n    distanceModel: 'inverse',\n    maxDistance: 10000,\n    orientationX: 1,\n    orientationY: 0,\n    orientationZ: 0,\n    panningModel: 'equalpower',\n    positionX: 0,\n    positionY: 0,\n    positionZ: 0,\n    refDistance: 1,\n    rolloffFactor: 1\n};\nexport const createPannerNodeConstructor = (audioNodeConstructor, createAudioParam, createNativePannerNode, createPannerNodeRenderer, getNativeContext, isNativeOfflineAudioContext, setAudioNodeTailTime) => {\n    return class PannerNode extends audioNodeConstructor {\n        constructor(context, options) {\n            const nativeContext = getNativeContext(context);\n            const mergedOptions = { ...DEFAULT_OPTIONS, ...options };\n            const nativePannerNode = createNativePannerNode(nativeContext, mergedOptions);\n            const isOffline = isNativeOfflineAudioContext(nativeContext);\n            const pannerNodeRenderer = (isOffline ? createPannerNodeRenderer() : null);\n            super(context, false, nativePannerNode, pannerNodeRenderer);\n            this._nativePannerNode = nativePannerNode;\n            // Bug #74: Safari does not export the correct values for maxValue and minValue.\n            this._orientationX = createAudioParam(this, isOffline, nativePannerNode.orientationX, MOST_POSITIVE_SINGLE_FLOAT, MOST_NEGATIVE_SINGLE_FLOAT);\n            this._orientationY = createAudioParam(this, isOffline, nativePannerNode.orientationY, MOST_POSITIVE_SINGLE_FLOAT, MOST_NEGATIVE_SINGLE_FLOAT);\n            this._orientationZ = createAudioParam(this, isOffline, nativePannerNode.orientationZ, MOST_POSITIVE_SINGLE_FLOAT, MOST_NEGATIVE_SINGLE_FLOAT);\n            this._positionX = createAudioParam(this, isOffline, nativePannerNode.positionX, MOST_POSITIVE_SINGLE_FLOAT, MOST_NEGATIVE_SINGLE_FLOAT);\n            this._positionY = createAudioParam(this, isOffline, nativePannerNode.positionY, MOST_POSITIVE_SINGLE_FLOAT, MOST_NEGATIVE_SINGLE_FLOAT);\n            this._positionZ = createAudioParam(this, isOffline, nativePannerNode.positionZ, MOST_POSITIVE_SINGLE_FLOAT, MOST_NEGATIVE_SINGLE_FLOAT);\n            // @todo Determine a meaningful tail-time instead of just using one second.\n            setAudioNodeTailTime(this, 1);\n        }\n        get coneInnerAngle() {\n            return this._nativePannerNode.coneInnerAngle;\n        }\n        set coneInnerAngle(value) {\n            this._nativePannerNode.coneInnerAngle = value;\n        }\n        get coneOuterAngle() {\n            return this._nativePannerNode.coneOuterAngle;\n        }\n        set coneOuterAngle(value) {\n            this._nativePannerNode.coneOuterAngle = value;\n        }\n        get coneOuterGain() {\n            return this._nativePannerNode.coneOuterGain;\n        }\n        set coneOuterGain(value) {\n            this._nativePannerNode.coneOuterGain = value;\n        }\n        get distanceModel() {\n            return this._nativePannerNode.distanceModel;\n        }\n        set distanceModel(value) {\n            this._nativePannerNode.distanceModel = value;\n        }\n        get maxDistance() {\n            return this._nativePannerNode.maxDistance;\n        }\n        set maxDistance(value) {\n            this._nativePannerNode.maxDistance = value;\n        }\n        get orientationX() {\n            return this._orientationX;\n        }\n        get orientationY() {\n            return this._orientationY;\n        }\n        get orientationZ() {\n            return this._orientationZ;\n        }\n        get panningModel() {\n            return this._nativePannerNode.panningModel;\n        }\n        set panningModel(value) {\n            this._nativePannerNode.panningModel = value;\n        }\n        get positionX() {\n            return this._positionX;\n        }\n        get positionY() {\n            return this._positionY;\n        }\n        get positionZ() {\n            return this._positionZ;\n        }\n        get refDistance() {\n            return this._nativePannerNode.refDistance;\n        }\n        set refDistance(value) {\n            this._nativePannerNode.refDistance = value;\n        }\n        get rolloffFactor() {\n            return this._nativePannerNode.rolloffFactor;\n        }\n        set rolloffFactor(value) {\n            this._nativePannerNode.rolloffFactor = value;\n        }\n    };\n};\n//# sourceMappingURL=panner-node-constructor.js.map","import { isNativeAudioNodeFaker } from '../guards/native-audio-node-faker';\nimport { isOwnedByContext } from '../helpers/is-owned-by-context';\nexport const createPannerNodeRendererFactory = (connectAudioParam, createNativeChannelMergerNode, createNativeConstantSourceNode, createNativeGainNode, createNativePannerNode, getNativeAudioNode, nativeOfflineAudioContextConstructor, renderAutomation, renderInputsOfAudioNode, renderNativeOfflineAudioContext) => {\n    return () => {\n        const renderedNativeAudioNodes = new WeakMap();\n        let renderedBufferPromise = null;\n        const createAudioNode = async (proxy, nativeOfflineAudioContext) => {\n            let nativeGainNode = null;\n            let nativePannerNode = getNativeAudioNode(proxy);\n            const commonAudioNodeOptions = {\n                channelCount: nativePannerNode.channelCount,\n                channelCountMode: nativePannerNode.channelCountMode,\n                channelInterpretation: nativePannerNode.channelInterpretation\n            };\n            const commonNativePannerNodeOptions = {\n                ...commonAudioNodeOptions,\n                coneInnerAngle: nativePannerNode.coneInnerAngle,\n                coneOuterAngle: nativePannerNode.coneOuterAngle,\n                coneOuterGain: nativePannerNode.coneOuterGain,\n                distanceModel: nativePannerNode.distanceModel,\n                maxDistance: nativePannerNode.maxDistance,\n                panningModel: nativePannerNode.panningModel,\n                refDistance: nativePannerNode.refDistance,\n                rolloffFactor: nativePannerNode.rolloffFactor\n            };\n            // If the initially used nativePannerNode was not constructed on the same OfflineAudioContext it needs to be created again.\n            const nativePannerNodeIsOwnedByContext = isOwnedByContext(nativePannerNode, nativeOfflineAudioContext);\n            // Bug #124: Safari does not support modifying the orientation and the position with AudioParams.\n            if ('bufferSize' in nativePannerNode) {\n                nativeGainNode = createNativeGainNode(nativeOfflineAudioContext, { ...commonAudioNodeOptions, gain: 1 });\n            }\n            else if (!nativePannerNodeIsOwnedByContext) {\n                const options = {\n                    ...commonNativePannerNodeOptions,\n                    orientationX: nativePannerNode.orientationX.value,\n                    orientationY: nativePannerNode.orientationY.value,\n                    orientationZ: nativePannerNode.orientationZ.value,\n                    positionX: nativePannerNode.positionX.value,\n                    positionY: nativePannerNode.positionY.value,\n                    positionZ: nativePannerNode.positionZ.value\n                };\n                nativePannerNode = createNativePannerNode(nativeOfflineAudioContext, options);\n            }\n            renderedNativeAudioNodes.set(nativeOfflineAudioContext, nativeGainNode === null ? nativePannerNode : nativeGainNode);\n            if (nativeGainNode !== null) {\n                if (renderedBufferPromise === null) {\n                    if (nativeOfflineAudioContextConstructor === null) {\n                        throw new Error('Missing the native OfflineAudioContext constructor.');\n                    }\n                    const partialOfflineAudioContext = new nativeOfflineAudioContextConstructor(6, \n                    // Bug #17: Safari does not yet expose the length.\n                    proxy.context.length, nativeOfflineAudioContext.sampleRate);\n                    const nativeChannelMergerNode = createNativeChannelMergerNode(partialOfflineAudioContext, {\n                        channelCount: 1,\n                        channelCountMode: 'explicit',\n                        channelInterpretation: 'speakers',\n                        numberOfInputs: 6\n                    });\n                    nativeChannelMergerNode.connect(partialOfflineAudioContext.destination);\n                    renderedBufferPromise = (async () => {\n                        const nativeConstantSourceNodes = await Promise.all([\n                            proxy.orientationX,\n                            proxy.orientationY,\n                            proxy.orientationZ,\n                            proxy.positionX,\n                            proxy.positionY,\n                            proxy.positionZ\n                        ].map(async (audioParam, index) => {\n                            const nativeConstantSourceNode = createNativeConstantSourceNode(partialOfflineAudioContext, {\n                                channelCount: 1,\n                                channelCountMode: 'explicit',\n                                channelInterpretation: 'discrete',\n                                offset: index === 0 ? 1 : 0\n                            });\n                            await renderAutomation(partialOfflineAudioContext, audioParam, nativeConstantSourceNode.offset);\n                            return nativeConstantSourceNode;\n                        }));\n                        for (let i = 0; i < 6; i += 1) {\n                            nativeConstantSourceNodes[i].connect(nativeChannelMergerNode, 0, i);\n                            nativeConstantSourceNodes[i].start(0);\n                        }\n                        return renderNativeOfflineAudioContext(partialOfflineAudioContext);\n                    })();\n                }\n                const renderedBuffer = await renderedBufferPromise;\n                const inputGainNode = createNativeGainNode(nativeOfflineAudioContext, { ...commonAudioNodeOptions, gain: 1 });\n                await renderInputsOfAudioNode(proxy, nativeOfflineAudioContext, inputGainNode);\n                const channelDatas = [];\n                for (let i = 0; i < renderedBuffer.numberOfChannels; i += 1) {\n                    channelDatas.push(renderedBuffer.getChannelData(i));\n                }\n                let lastOrientation = [channelDatas[0][0], channelDatas[1][0], channelDatas[2][0]];\n                let lastPosition = [channelDatas[3][0], channelDatas[4][0], channelDatas[5][0]];\n                let gateGainNode = createNativeGainNode(nativeOfflineAudioContext, { ...commonAudioNodeOptions, gain: 1 });\n                let partialPannerNode = createNativePannerNode(nativeOfflineAudioContext, {\n                    ...commonNativePannerNodeOptions,\n                    orientationX: lastOrientation[0],\n                    orientationY: lastOrientation[1],\n                    orientationZ: lastOrientation[2],\n                    positionX: lastPosition[0],\n                    positionY: lastPosition[1],\n                    positionZ: lastPosition[2]\n                });\n                inputGainNode.connect(gateGainNode).connect(partialPannerNode.inputs[0]);\n                partialPannerNode.connect(nativeGainNode);\n                for (let i = 128; i < renderedBuffer.length; i += 128) {\n                    const orientation = [channelDatas[0][i], channelDatas[1][i], channelDatas[2][i]];\n                    const positon = [channelDatas[3][i], channelDatas[4][i], channelDatas[5][i]];\n                    if (orientation.some((value, index) => value !== lastOrientation[index]) ||\n                        positon.some((value, index) => value !== lastPosition[index])) {\n                        lastOrientation = orientation;\n                        lastPosition = positon;\n                        const currentTime = i / nativeOfflineAudioContext.sampleRate;\n                        gateGainNode.gain.setValueAtTime(0, currentTime);\n                        gateGainNode = createNativeGainNode(nativeOfflineAudioContext, { ...commonAudioNodeOptions, gain: 0 });\n                        partialPannerNode = createNativePannerNode(nativeOfflineAudioContext, {\n                            ...commonNativePannerNodeOptions,\n                            orientationX: lastOrientation[0],\n                            orientationY: lastOrientation[1],\n                            orientationZ: lastOrientation[2],\n                            positionX: lastPosition[0],\n                            positionY: lastPosition[1],\n                            positionZ: lastPosition[2]\n                        });\n                        gateGainNode.gain.setValueAtTime(1, currentTime);\n                        inputGainNode.connect(gateGainNode).connect(partialPannerNode.inputs[0]);\n                        partialPannerNode.connect(nativeGainNode);\n                    }\n                }\n                return nativeGainNode;\n            }\n            if (!nativePannerNodeIsOwnedByContext) {\n                await renderAutomation(nativeOfflineAudioContext, proxy.orientationX, nativePannerNode.orientationX);\n                await renderAutomation(nativeOfflineAudioContext, proxy.orientationY, nativePannerNode.orientationY);\n                await renderAutomation(nativeOfflineAudioContext, proxy.orientationZ, nativePannerNode.orientationZ);\n                await renderAutomation(nativeOfflineAudioContext, proxy.positionX, nativePannerNode.positionX);\n                await renderAutomation(nativeOfflineAudioContext, proxy.positionY, nativePannerNode.positionY);\n                await renderAutomation(nativeOfflineAudioContext, proxy.positionZ, nativePannerNode.positionZ);\n            }\n            else {\n                await connectAudioParam(nativeOfflineAudioContext, proxy.orientationX, nativePannerNode.orientationX);\n                await connectAudioParam(nativeOfflineAudioContext, proxy.orientationY, nativePannerNode.orientationY);\n                await connectAudioParam(nativeOfflineAudioContext, proxy.orientationZ, nativePannerNode.orientationZ);\n                await connectAudioParam(nativeOfflineAudioContext, proxy.positionX, nativePannerNode.positionX);\n                await connectAudioParam(nativeOfflineAudioContext, proxy.positionY, nativePannerNode.positionY);\n                await connectAudioParam(nativeOfflineAudioContext, proxy.positionZ, nativePannerNode.positionZ);\n            }\n            if (isNativeAudioNodeFaker(nativePannerNode)) {\n                await renderInputsOfAudioNode(proxy, nativeOfflineAudioContext, nativePannerNode.inputs[0]);\n            }\n            else {\n                await renderInputsOfAudioNode(proxy, nativeOfflineAudioContext, nativePannerNode);\n            }\n            return nativePannerNode;\n        };\n        return {\n            render(proxy, nativeOfflineAudioContext) {\n                const renderedNativeGainNodeOrNativePannerNode = renderedNativeAudioNodes.get(nativeOfflineAudioContext);\n                if (renderedNativeGainNodeOrNativePannerNode !== undefined) {\n                    return Promise.resolve(renderedNativeGainNodeOrNativePannerNode);\n                }\n                return createAudioNode(proxy, nativeOfflineAudioContext);\n            }\n        };\n    };\n};\n//# sourceMappingURL=panner-node-renderer-factory.js.map","const DEFAULT_OPTIONS = {\n    disableNormalization: false\n};\nexport const createPeriodicWaveConstructor = (createNativePeriodicWave, getNativeContext, periodicWaveStore, sanitizePeriodicWaveOptions) => {\n    return class PeriodicWave {\n        constructor(context, options) {\n            const nativeContext = getNativeContext(context);\n            const mergedOptions = sanitizePeriodicWaveOptions({ ...DEFAULT_OPTIONS, ...options });\n            const periodicWave = createNativePeriodicWave(nativeContext, mergedOptions);\n            periodicWaveStore.add(periodicWave);\n            // This does violate all good pratices but it is used here to simplify the handling of periodic waves.\n            return periodicWave;\n        }\n        static [Symbol.hasInstance](instance) {\n            return ((instance !== null && typeof instance === 'object' && Object.getPrototypeOf(instance) === PeriodicWave.prototype) ||\n                periodicWaveStore.has(instance));\n        }\n    };\n};\n//# sourceMappingURL=periodic-wave-constructor.js.map","export const createRenderAutomation = (getAudioParamRenderer, renderInputsOfAudioParam) => {\n    return (nativeOfflineAudioContext, audioParam, nativeAudioParam) => {\n        const audioParamRenderer = getAudioParamRenderer(audioParam);\n        audioParamRenderer.replay(nativeAudioParam);\n        return renderInputsOfAudioParam(audioParam, nativeOfflineAudioContext, nativeAudioParam);\n    };\n};\n//# sourceMappingURL=render-automation.js.map","export const createRenderInputsOfAudioNode = (getAudioNodeConnections, getAudioNodeRenderer, isPartOfACycle) => {\n    return async (audioNode, nativeOfflineAudioContext, nativeAudioNode) => {\n        const audioNodeConnections = getAudioNodeConnections(audioNode);\n        await Promise.all(audioNodeConnections.activeInputs\n            .map((connections, input) => Array.from(connections).map(async ([source, output]) => {\n            const audioNodeRenderer = getAudioNodeRenderer(source);\n            const renderedNativeAudioNode = await audioNodeRenderer.render(source, nativeOfflineAudioContext);\n            const destination = audioNode.context.destination;\n            if (!isPartOfACycle(source) && (audioNode !== destination || !isPartOfACycle(audioNode))) {\n                renderedNativeAudioNode.connect(nativeAudioNode, output, input);\n            }\n        }))\n            .reduce((allRenderingPromises, renderingPromises) => [...allRenderingPromises, ...renderingPromises], []));\n    };\n};\n//# sourceMappingURL=render-inputs-of-audio-node.js.map","export const createRenderInputsOfAudioParam = (getAudioNodeRenderer, getAudioParamConnections, isPartOfACycle) => {\n    return async (audioParam, nativeOfflineAudioContext, nativeAudioParam) => {\n        const audioParamConnections = getAudioParamConnections(audioParam);\n        await Promise.all(Array.from(audioParamConnections.activeInputs).map(async ([source, output]) => {\n            const audioNodeRenderer = getAudioNodeRenderer(source);\n            const renderedNativeAudioNode = await audioNodeRenderer.render(source, nativeOfflineAudioContext);\n            if (!isPartOfACycle(source)) {\n                renderedNativeAudioNode.connect(nativeAudioParam, output);\n            }\n        }));\n    };\n};\n//# sourceMappingURL=render-inputs-of-audio-param.js.map","import { testPromiseSupport } from '../helpers/test-promise-support';\nexport const createRenderNativeOfflineAudioContext = (cacheTestResult, createNativeGainNode, createNativeScriptProcessorNode, testOfflineAudioContextCurrentTimeSupport) => {\n    return (nativeOfflineAudioContext) => {\n        // Bug #21: Safari does not support promises yet.\n        if (cacheTestResult(testPromiseSupport, () => testPromiseSupport(nativeOfflineAudioContext))) {\n            // Bug #158: Chrome and Edge do not advance currentTime if it is not accessed while rendering the audio.\n            return Promise.resolve(cacheTestResult(testOfflineAudioContextCurrentTimeSupport, testOfflineAudioContextCurrentTimeSupport)).then((isOfflineAudioContextCurrentTimeSupported) => {\n                if (!isOfflineAudioContextCurrentTimeSupported) {\n                    const scriptProcessorNode = createNativeScriptProcessorNode(nativeOfflineAudioContext, 512, 0, 1);\n                    nativeOfflineAudioContext.oncomplete = () => {\n                        scriptProcessorNode.onaudioprocess = null; // tslint:disable-line:deprecation\n                        scriptProcessorNode.disconnect();\n                    };\n                    scriptProcessorNode.onaudioprocess = () => nativeOfflineAudioContext.currentTime; // tslint:disable-line:deprecation\n                    scriptProcessorNode.connect(nativeOfflineAudioContext.destination);\n                }\n                return nativeOfflineAudioContext.startRendering();\n            });\n        }\n        return new Promise((resolve) => {\n            // Bug #48: Safari does not render an OfflineAudioContext without any connected node.\n            const gainNode = createNativeGainNode(nativeOfflineAudioContext, {\n                channelCount: 1,\n                channelCountMode: 'explicit',\n                channelInterpretation: 'discrete',\n                gain: 0\n            });\n            nativeOfflineAudioContext.oncomplete = (event) => {\n                gainNode.disconnect();\n                resolve(event.renderedBuffer);\n            };\n            gainNode.connect(nativeOfflineAudioContext.destination);\n            nativeOfflineAudioContext.startRendering();\n        });\n    };\n};\n//# sourceMappingURL=render-native-offline-audio-context.js.map","export const createSetActiveAudioWorkletNodeInputs = (activeAudioWorkletNodeInputsStore) => {\n    return (nativeAudioWorkletNode, activeInputs) => {\n        activeAudioWorkletNodeInputsStore.set(nativeAudioWorkletNode, activeInputs);\n    };\n};\n//# sourceMappingURL=set-active-audio-worklet-node-inputs.js.map","export const createSetAudioNodeTailTime = (audioNodeTailTimeStore) => {\n    return (audioNode, tailTime) => audioNodeTailTimeStore.set(audioNode, tailTime);\n};\n//# sourceMappingURL=set-audio-node-tail-time.js.map","import { wrapAudioBufferGetChannelDataMethod } from '../helpers/wrap-audio-buffer-get-channel-data-method';\nexport const createStartRendering = (audioBufferStore, cacheTestResult, getAudioNodeRenderer, getUnrenderedAudioWorkletNodes, renderNativeOfflineAudioContext, testAudioBufferCopyChannelMethodsOutOfBoundsSupport, wrapAudioBufferCopyChannelMethods, wrapAudioBufferCopyChannelMethodsOutOfBounds) => {\n    return (destination, nativeOfflineAudioContext) => getAudioNodeRenderer(destination)\n        .render(destination, nativeOfflineAudioContext)\n        /*\n         * Bug #86 & #87: Invoking the renderer of an AudioWorkletNode might be necessary if it has no direct or indirect connection to the\n         * destination.\n         */\n        .then(() => Promise.all(Array.from(getUnrenderedAudioWorkletNodes(nativeOfflineAudioContext)).map((audioWorkletNode) => getAudioNodeRenderer(audioWorkletNode).render(audioWorkletNode, nativeOfflineAudioContext))))\n        .then(() => renderNativeOfflineAudioContext(nativeOfflineAudioContext))\n        .then((audioBuffer) => {\n        // Bug #5: Safari does not support copyFromChannel() and copyToChannel().\n        // Bug #100: Safari does throw a wrong error when calling getChannelData() with an out-of-bounds value.\n        if (typeof audioBuffer.copyFromChannel !== 'function') {\n            wrapAudioBufferCopyChannelMethods(audioBuffer);\n            wrapAudioBufferGetChannelDataMethod(audioBuffer);\n            // Bug #157: Firefox does not allow the bufferOffset to be out-of-bounds.\n        }\n        else if (!cacheTestResult(testAudioBufferCopyChannelMethodsOutOfBoundsSupport, () => testAudioBufferCopyChannelMethodsOutOfBoundsSupport(audioBuffer))) {\n            wrapAudioBufferCopyChannelMethodsOutOfBounds(audioBuffer);\n        }\n        audioBufferStore.add(audioBuffer);\n        return audioBuffer;\n    });\n};\n//# sourceMappingURL=start-rendering.js.map","const DEFAULT_OPTIONS = {\n    channelCount: 2,\n    /*\n     * Bug #105: The channelCountMode should be 'clamped-max' according to the spec but is set to 'explicit' to achieve consistent\n     * behavior.\n     */\n    channelCountMode: 'explicit',\n    channelInterpretation: 'speakers',\n    pan: 0\n};\nexport const createStereoPannerNodeConstructor = (audioNodeConstructor, createAudioParam, createNativeStereoPannerNode, createStereoPannerNodeRenderer, getNativeContext, isNativeOfflineAudioContext) => {\n    return class StereoPannerNode extends audioNodeConstructor {\n        constructor(context, options) {\n            const nativeContext = getNativeContext(context);\n            const mergedOptions = { ...DEFAULT_OPTIONS, ...options };\n            const nativeStereoPannerNode = createNativeStereoPannerNode(nativeContext, mergedOptions);\n            const isOffline = isNativeOfflineAudioContext(nativeContext);\n            const stereoPannerNodeRenderer = (isOffline ? createStereoPannerNodeRenderer() : null);\n            super(context, false, nativeStereoPannerNode, stereoPannerNodeRenderer);\n            this._pan = createAudioParam(this, isOffline, nativeStereoPannerNode.pan);\n        }\n        get pan() {\n            return this._pan;\n        }\n    };\n};\n//# sourceMappingURL=stereo-panner-node-constructor.js.map","import { isNativeAudioNodeFaker } from '../guards/native-audio-node-faker';\nimport { isOwnedByContext } from '../helpers/is-owned-by-context';\nexport const createStereoPannerNodeRendererFactory = (connectAudioParam, createNativeStereoPannerNode, getNativeAudioNode, renderAutomation, renderInputsOfAudioNode) => {\n    return () => {\n        const renderedNativeStereoPannerNodes = new WeakMap();\n        const createStereoPannerNode = async (proxy, nativeOfflineAudioContext) => {\n            let nativeStereoPannerNode = getNativeAudioNode(proxy);\n            /*\n             * If the initially used nativeStereoPannerNode was not constructed on the same OfflineAudioContext it needs to be created\n             * again.\n             */\n            const nativeStereoPannerNodeIsOwnedByContext = isOwnedByContext(nativeStereoPannerNode, nativeOfflineAudioContext);\n            if (!nativeStereoPannerNodeIsOwnedByContext) {\n                const options = {\n                    channelCount: nativeStereoPannerNode.channelCount,\n                    channelCountMode: nativeStereoPannerNode.channelCountMode,\n                    channelInterpretation: nativeStereoPannerNode.channelInterpretation,\n                    pan: nativeStereoPannerNode.pan.value\n                };\n                nativeStereoPannerNode = createNativeStereoPannerNode(nativeOfflineAudioContext, options);\n            }\n            renderedNativeStereoPannerNodes.set(nativeOfflineAudioContext, nativeStereoPannerNode);\n            if (!nativeStereoPannerNodeIsOwnedByContext) {\n                await renderAutomation(nativeOfflineAudioContext, proxy.pan, nativeStereoPannerNode.pan);\n            }\n            else {\n                await connectAudioParam(nativeOfflineAudioContext, proxy.pan, nativeStereoPannerNode.pan);\n            }\n            if (isNativeAudioNodeFaker(nativeStereoPannerNode)) {\n                await renderInputsOfAudioNode(proxy, nativeOfflineAudioContext, nativeStereoPannerNode.inputs[0]);\n            }\n            else {\n                await renderInputsOfAudioNode(proxy, nativeOfflineAudioContext, nativeStereoPannerNode);\n            }\n            return nativeStereoPannerNode;\n        };\n        return {\n            render(proxy, nativeOfflineAudioContext) {\n                const renderedNativeStereoPannerNode = renderedNativeStereoPannerNodes.get(nativeOfflineAudioContext);\n                if (renderedNativeStereoPannerNode !== undefined) {\n                    return Promise.resolve(renderedNativeStereoPannerNode);\n                }\n                return createStereoPannerNode(proxy, nativeOfflineAudioContext);\n            }\n        };\n    };\n};\n//# sourceMappingURL=stereo-panner-node-renderer-factory.js.map","// Bug #33: Safari exposes an AudioBuffer but it can't be used as a constructor.\nexport const createTestAudioBufferConstructorSupport = (nativeAudioBufferConstructor) => {\n    return () => {\n        if (nativeAudioBufferConstructor === null) {\n            return false;\n        }\n        try {\n            new nativeAudioBufferConstructor({ length: 1, sampleRate: 44100 }); // tslint:disable-line:no-unused-expression\n        }\n        catch {\n            return false;\n        }\n        return true;\n    };\n};\n//# sourceMappingURL=test-audio-buffer-constructor-support.js.map","// Bug #179: Firefox does not allow to transfer any buffer which has been passed to the process() method as an argument.\nexport const createTestAudioWorkletProcessorPostMessageSupport = (nativeAudioWorkletNodeConstructor, nativeOfflineAudioContextConstructor) => {\n    return async () => {\n        // Bug #61: If there is no native AudioWorkletNode it gets faked and therefore it is no problem if the it doesn't exist.\n        if (nativeAudioWorkletNodeConstructor === null) {\n            return true;\n        }\n        if (nativeOfflineAudioContextConstructor === null) {\n            return false;\n        }\n        const blob = new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor(\"a\",A)'], {\n            type: 'application/javascript; charset=utf-8'\n        });\n        // Bug #141: Safari does not support creating an OfflineAudioContext with less than 44100 Hz.\n        const offlineAudioContext = new nativeOfflineAudioContextConstructor(1, 128, 44100);\n        const url = URL.createObjectURL(blob);\n        let isEmittingMessageEvents = false;\n        let isEmittingProcessorErrorEvents = false;\n        try {\n            await offlineAudioContext.audioWorklet.addModule(url);\n            const audioWorkletNode = new nativeAudioWorkletNodeConstructor(offlineAudioContext, 'a', { numberOfOutputs: 0 });\n            const oscillator = offlineAudioContext.createOscillator();\n            audioWorkletNode.port.onmessage = () => (isEmittingMessageEvents = true);\n            audioWorkletNode.onprocessorerror = () => (isEmittingProcessorErrorEvents = true);\n            oscillator.connect(audioWorkletNode);\n            oscillator.start(0);\n            await offlineAudioContext.startRendering();\n            // Bug #197: Safari does not deliver the messages before the promise returned by startRendering() resolves.\n            await new Promise((resolve) => setTimeout(resolve));\n        }\n        catch {\n            // Ignore errors.\n        }\n        finally {\n            URL.revokeObjectURL(url);\n        }\n        return isEmittingMessageEvents && !isEmittingProcessorErrorEvents;\n    };\n};\n//# sourceMappingURL=test-audio-worklet-processor-post-message-support.js.map","export const createTestOfflineAudioContextCurrentTimeSupport = (createNativeGainNode, nativeOfflineAudioContextConstructor) => {\n    return () => {\n        if (nativeOfflineAudioContextConstructor === null) {\n            return Promise.resolve(false);\n        }\n        const nativeOfflineAudioContext = new nativeOfflineAudioContextConstructor(1, 1, 44100);\n        // Bug #48: Safari does not render an OfflineAudioContext without any connected node.\n        const gainNode = createNativeGainNode(nativeOfflineAudioContext, {\n            channelCount: 1,\n            channelCountMode: 'explicit',\n            channelInterpretation: 'discrete',\n            gain: 0\n        });\n        // Bug #21: Safari does not support promises yet.\n        return new Promise((resolve) => {\n            nativeOfflineAudioContext.oncomplete = () => {\n                gainNode.disconnect();\n                resolve(nativeOfflineAudioContext.currentTime !== 0);\n            };\n            nativeOfflineAudioContext.startRendering();\n        });\n    };\n};\n//# sourceMappingURL=test-offline-audio-context-current-time-support.js.map","export const createUnknownError = () => new DOMException('', 'UnknownError');\n//# sourceMappingURL=unknown-error.js.map","const DEFAULT_OPTIONS = {\n    channelCount: 2,\n    channelCountMode: 'max',\n    channelInterpretation: 'speakers',\n    curve: null,\n    oversample: 'none'\n};\nexport const createWaveShaperNodeConstructor = (audioNodeConstructor, createInvalidStateError, createNativeWaveShaperNode, createWaveShaperNodeRenderer, getNativeContext, isNativeOfflineAudioContext, setAudioNodeTailTime) => {\n    return class WaveShaperNode extends audioNodeConstructor {\n        constructor(context, options) {\n            const nativeContext = getNativeContext(context);\n            const mergedOptions = { ...DEFAULT_OPTIONS, ...options };\n            const nativeWaveShaperNode = createNativeWaveShaperNode(nativeContext, mergedOptions);\n            const isOffline = isNativeOfflineAudioContext(nativeContext);\n            const waveShaperNodeRenderer = (isOffline ? createWaveShaperNodeRenderer() : null);\n            // @todo Add a mechanism to only switch a WaveShaperNode to active while it is connected.\n            super(context, true, nativeWaveShaperNode, waveShaperNodeRenderer);\n            this._isCurveNullified = false;\n            this._nativeWaveShaperNode = nativeWaveShaperNode;\n            // @todo Determine a meaningful tail-time instead of just using one second.\n            setAudioNodeTailTime(this, 1);\n        }\n        get curve() {\n            if (this._isCurveNullified) {\n                return null;\n            }\n            return this._nativeWaveShaperNode.curve;\n        }\n        set curve(value) {\n            // Bug #103: Safari does not allow to set the curve to null.\n            if (value === null) {\n                this._isCurveNullified = true;\n                this._nativeWaveShaperNode.curve = new Float32Array([0, 0]);\n            }\n            else {\n                // Bug #102: Safari does not throw an InvalidStateError when the curve has less than two samples.\n                // Bug #104: Chrome and Edge will throw an InvalidAccessError when the curve has less than two samples.\n                if (value.length < 2) {\n                    throw createInvalidStateError();\n                }\n                this._isCurveNullified = false;\n                this._nativeWaveShaperNode.curve = value;\n            }\n        }\n        get oversample() {\n            return this._nativeWaveShaperNode.oversample;\n        }\n        set oversample(value) {\n            this._nativeWaveShaperNode.oversample = value;\n        }\n    };\n};\n//# sourceMappingURL=wave-shaper-node-constructor.js.map","import { isNativeAudioNodeFaker } from '../guards/native-audio-node-faker';\nimport { isOwnedByContext } from '../helpers/is-owned-by-context';\nexport const createWaveShaperNodeRendererFactory = (createNativeWaveShaperNode, getNativeAudioNode, renderInputsOfAudioNode) => {\n    return () => {\n        const renderedNativeWaveShaperNodes = new WeakMap();\n        const createWaveShaperNode = async (proxy, nativeOfflineAudioContext) => {\n            let nativeWaveShaperNode = getNativeAudioNode(proxy);\n            // If the initially used nativeWaveShaperNode was not constructed on the same OfflineAudioContext it needs to be created again.\n            const nativeWaveShaperNodeIsOwnedByContext = isOwnedByContext(nativeWaveShaperNode, nativeOfflineAudioContext);\n            if (!nativeWaveShaperNodeIsOwnedByContext) {\n                const options = {\n                    channelCount: nativeWaveShaperNode.channelCount,\n                    channelCountMode: nativeWaveShaperNode.channelCountMode,\n                    channelInterpretation: nativeWaveShaperNode.channelInterpretation,\n                    curve: nativeWaveShaperNode.curve,\n                    oversample: nativeWaveShaperNode.oversample\n                };\n                nativeWaveShaperNode = createNativeWaveShaperNode(nativeOfflineAudioContext, options);\n            }\n            renderedNativeWaveShaperNodes.set(nativeOfflineAudioContext, nativeWaveShaperNode);\n            if (isNativeAudioNodeFaker(nativeWaveShaperNode)) {\n                await renderInputsOfAudioNode(proxy, nativeOfflineAudioContext, nativeWaveShaperNode.inputs[0]);\n            }\n            else {\n                await renderInputsOfAudioNode(proxy, nativeOfflineAudioContext, nativeWaveShaperNode);\n            }\n            return nativeWaveShaperNode;\n        };\n        return {\n            render(proxy, nativeOfflineAudioContext) {\n                const renderedNativeWaveShaperNode = renderedNativeWaveShaperNodes.get(nativeOfflineAudioContext);\n                if (renderedNativeWaveShaperNode !== undefined) {\n                    return Promise.resolve(renderedNativeWaveShaperNode);\n                }\n                return createWaveShaperNode(proxy, nativeOfflineAudioContext);\n            }\n        };\n    };\n};\n//# sourceMappingURL=wave-shaper-node-renderer-factory.js.map","export const createWindow = () => (typeof window === 'undefined' ? null : window);\n//# sourceMappingURL=window.js.map","export const createWrapAudioBufferCopyChannelMethods = (convertNumberToUnsignedLong, createIndexSizeError) => {\n    return (audioBuffer) => {\n        audioBuffer.copyFromChannel = (destination, channelNumberAsNumber, bufferOffsetAsNumber = 0) => {\n            const bufferOffset = convertNumberToUnsignedLong(bufferOffsetAsNumber);\n            const channelNumber = convertNumberToUnsignedLong(channelNumberAsNumber);\n            if (channelNumber >= audioBuffer.numberOfChannels) {\n                throw createIndexSizeError();\n            }\n            const audioBufferLength = audioBuffer.length;\n            const channelData = audioBuffer.getChannelData(channelNumber);\n            const destinationLength = destination.length;\n            for (let i = bufferOffset < 0 ? -bufferOffset : 0; i + bufferOffset < audioBufferLength && i < destinationLength; i += 1) {\n                destination[i] = channelData[i + bufferOffset];\n            }\n        };\n        audioBuffer.copyToChannel = (source, channelNumberAsNumber, bufferOffsetAsNumber = 0) => {\n            const bufferOffset = convertNumberToUnsignedLong(bufferOffsetAsNumber);\n            const channelNumber = convertNumberToUnsignedLong(channelNumberAsNumber);\n            if (channelNumber >= audioBuffer.numberOfChannels) {\n                throw createIndexSizeError();\n            }\n            const audioBufferLength = audioBuffer.length;\n            const channelData = audioBuffer.getChannelData(channelNumber);\n            const sourceLength = source.length;\n            for (let i = bufferOffset < 0 ? -bufferOffset : 0; i + bufferOffset < audioBufferLength && i < sourceLength; i += 1) {\n                channelData[i + bufferOffset] = source[i];\n            }\n        };\n    };\n};\n//# sourceMappingURL=wrap-audio-buffer-copy-channel-methods.js.map","export const createWrapAudioBufferCopyChannelMethodsOutOfBounds = (convertNumberToUnsignedLong) => {\n    return (audioBuffer) => {\n        audioBuffer.copyFromChannel = ((copyFromChannel) => {\n            return (destination, channelNumberAsNumber, bufferOffsetAsNumber = 0) => {\n                const bufferOffset = convertNumberToUnsignedLong(bufferOffsetAsNumber);\n                const channelNumber = convertNumberToUnsignedLong(channelNumberAsNumber);\n                if (bufferOffset < audioBuffer.length) {\n                    return copyFromChannel.call(audioBuffer, destination, channelNumber, bufferOffset);\n                }\n            };\n        })(audioBuffer.copyFromChannel);\n        audioBuffer.copyToChannel = ((copyToChannel) => {\n            return (source, channelNumberAsNumber, bufferOffsetAsNumber = 0) => {\n                const bufferOffset = convertNumberToUnsignedLong(bufferOffsetAsNumber);\n                const channelNumber = convertNumberToUnsignedLong(channelNumberAsNumber);\n                if (bufferOffset < audioBuffer.length) {\n                    return copyToChannel.call(audioBuffer, source, channelNumber, bufferOffset);\n                }\n            };\n        })(audioBuffer.copyToChannel);\n    };\n};\n//# sourceMappingURL=wrap-audio-buffer-copy-channel-methods-out-of-bounds.js.map","export const createWrapAudioBufferSourceNodeStopMethodNullifiedBuffer = (overwriteAccessors) => {\n    return (nativeAudioBufferSourceNode, nativeContext) => {\n        const nullifiedBuffer = nativeContext.createBuffer(1, 1, 44100);\n        if (nativeAudioBufferSourceNode.buffer === null) {\n            nativeAudioBufferSourceNode.buffer = nullifiedBuffer;\n        }\n        overwriteAccessors(nativeAudioBufferSourceNode, 'buffer', (get) => () => {\n            const value = get.call(nativeAudioBufferSourceNode);\n            return value === nullifiedBuffer ? null : value;\n        }, (set) => (value) => {\n            return set.call(nativeAudioBufferSourceNode, value === null ? nullifiedBuffer : value);\n        });\n    };\n};\n//# sourceMappingURL=wrap-audio-buffer-source-node-stop-method-nullified-buffer.js.map","export const createWrapChannelMergerNode = (createInvalidStateError, monitorConnections) => {\n    return (nativeContext, channelMergerNode) => {\n        // Bug #15: Safari does not return the default properties.\n        channelMergerNode.channelCount = 1;\n        channelMergerNode.channelCountMode = 'explicit';\n        // Bug #16: Safari does not throw an error when setting a different channelCount or channelCountMode.\n        Object.defineProperty(channelMergerNode, 'channelCount', {\n            get: () => 1,\n            set: () => {\n                throw createInvalidStateError();\n            }\n        });\n        Object.defineProperty(channelMergerNode, 'channelCountMode', {\n            get: () => 'explicit',\n            set: () => {\n                throw createInvalidStateError();\n            }\n        });\n        // Bug #20: Safari requires a connection of any kind to treat the input signal correctly.\n        const audioBufferSourceNode = nativeContext.createBufferSource();\n        const whenConnected = () => {\n            const length = channelMergerNode.numberOfInputs;\n            for (let i = 0; i < length; i += 1) {\n                audioBufferSourceNode.connect(channelMergerNode, 0, i);\n            }\n        };\n        const whenDisconnected = () => audioBufferSourceNode.disconnect(channelMergerNode);\n        monitorConnections(channelMergerNode, whenConnected, whenDisconnected);\n    };\n};\n//# sourceMappingURL=wrap-channel-merger-node.js.map","export const getFirstSample = (audioBuffer, buffer, channelNumber) => {\n    // Bug #5: Safari does not support copyFromChannel() and copyToChannel().\n    if (audioBuffer.copyFromChannel === undefined) {\n        return audioBuffer.getChannelData(channelNumber)[0];\n    }\n    audioBuffer.copyFromChannel(buffer, channelNumber);\n    return buffer[0];\n};\n//# sourceMappingURL=get-first-sample.js.map","export const isDCCurve = (curve) => {\n    if (curve === null) {\n        return false;\n    }\n    const length = curve.length;\n    if (length % 2 !== 0) {\n        return curve[Math.floor(length / 2)] !== 0;\n    }\n    return curve[length / 2 - 1] + curve[length / 2] !== 0;\n};\n//# sourceMappingURL=is-dc-curve.js.map","export const overwriteAccessors = (object, property, createGetter, createSetter) => {\n    let prototype = object;\n    while (!prototype.hasOwnProperty(property)) {\n        prototype = Object.getPrototypeOf(prototype);\n    }\n    const { get, set } = Object.getOwnPropertyDescriptor(prototype, property);\n    Object.defineProperty(object, property, { get: createGetter(get), set: createSetter(set) });\n};\n//# sourceMappingURL=overwrite-accessors.js.map","export const sanitizeAudioWorkletNodeOptions = (options) => {\n    return {\n        ...options,\n        outputChannelCount: options.outputChannelCount !== undefined\n            ? options.outputChannelCount\n            : options.numberOfInputs === 1 && options.numberOfOutputs === 1\n                ? /*\n                   * Bug #61: This should be the computedNumberOfChannels, but unfortunately that is almost impossible to fake. That's why\n                   * the channelCountMode is required to be 'explicit' as long as there is not a native implementation in every browser. That\n                   * makes sure the computedNumberOfChannels is equivilant to the channelCount which makes it much easier to compute.\n                   */\n                    [options.channelCount]\n                : Array.from({ length: options.numberOfOutputs }, () => 1)\n    };\n};\n//# sourceMappingURL=sanitize-audio-worklet-node-options.js.map","export const sanitizeChannelSplitterOptions = (options) => {\n    return { ...options, channelCount: options.numberOfOutputs };\n};\n//# sourceMappingURL=sanitize-channel-splitter-options.js.map","export const sanitizePeriodicWaveOptions = (options) => {\n    const { imag, real } = options;\n    if (imag === undefined) {\n        if (real === undefined) {\n            return { ...options, imag: [0, 0], real: [0, 0] };\n        }\n        return { ...options, imag: Array.from(real, () => 0), real };\n    }\n    if (real === undefined) {\n        return { ...options, imag, real: Array.from(imag, () => 0) };\n    }\n    return { ...options, imag, real };\n};\n//# sourceMappingURL=sanitize-periodic-wave-options.js.map","export const setValueAtTimeUntilPossible = (audioParam, value, startTime) => {\n    try {\n        audioParam.setValueAtTime(value, startTime);\n    }\n    catch (err) {\n        if (err.code !== 9) {\n            throw err;\n        }\n        setValueAtTimeUntilPossible(audioParam, value, startTime + 1e-7);\n    }\n};\n//# sourceMappingURL=set-value-at-time-until-possible.js.map","export const testAudioBufferSourceNodeStartMethodConsecutiveCallsSupport = (nativeContext) => {\n    const nativeAudioBufferSourceNode = nativeContext.createBufferSource();\n    nativeAudioBufferSourceNode.start();\n    try {\n        nativeAudioBufferSourceNode.start();\n    }\n    catch {\n        return true;\n    }\n    return false;\n};\n//# sourceMappingURL=test-audio-buffer-source-node-start-method-consecutive-calls-support.js.map","export const testAudioBufferSourceNodeStartMethodOffsetClampingSupport = (nativeContext) => {\n    const nativeAudioBufferSourceNode = nativeContext.createBufferSource();\n    const nativeAudioBuffer = nativeContext.createBuffer(1, 1, 44100);\n    nativeAudioBufferSourceNode.buffer = nativeAudioBuffer;\n    try {\n        nativeAudioBufferSourceNode.start(0, 1);\n    }\n    catch {\n        return false;\n    }\n    return true;\n};\n//# sourceMappingURL=test-audio-buffer-source-node-start-method-offset-clamping-support.js.map","export const testAudioBufferSourceNodeStopMethodNullifiedBufferSupport = (nativeContext) => {\n    const nativeAudioBufferSourceNode = nativeContext.createBufferSource();\n    nativeAudioBufferSourceNode.start();\n    try {\n        nativeAudioBufferSourceNode.stop();\n    }\n    catch {\n        return false;\n    }\n    return true;\n};\n//# sourceMappingURL=test-audio-buffer-source-node-stop-method-nullified-buffer-support.js.map","export const testAudioScheduledSourceNodeStartMethodNegativeParametersSupport = (nativeContext) => {\n    const nativeAudioBufferSourceNode = nativeContext.createOscillator();\n    try {\n        nativeAudioBufferSourceNode.start(-1);\n    }\n    catch (err) {\n        return err instanceof RangeError;\n    }\n    return false;\n};\n//# sourceMappingURL=test-audio-scheduled-source-node-start-method-negative-parameters-support.js.map","export const testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport = (nativeContext) => {\n    const nativeAudioBuffer = nativeContext.createBuffer(1, 1, 44100);\n    const nativeAudioBufferSourceNode = nativeContext.createBufferSource();\n    nativeAudioBufferSourceNode.buffer = nativeAudioBuffer;\n    nativeAudioBufferSourceNode.start();\n    nativeAudioBufferSourceNode.stop();\n    try {\n        nativeAudioBufferSourceNode.stop();\n        return true;\n    }\n    catch {\n        return false;\n    }\n};\n//# sourceMappingURL=test-audio-scheduled-source-node-stop-method-consecutive-calls-support.js.map","export const testAudioScheduledSourceNodeStopMethodNegativeParametersSupport = (nativeContext) => {\n    const nativeAudioBufferSourceNode = nativeContext.createOscillator();\n    try {\n        nativeAudioBufferSourceNode.stop(-1);\n    }\n    catch (err) {\n        return err instanceof RangeError;\n    }\n    return false;\n};\n//# sourceMappingURL=test-audio-scheduled-source-node-stop-method-negative-parameters-support.js.map","export const testAudioWorkletNodeOptionsClonability = (audioWorkletNodeOptions) => {\n    const { port1, port2 } = new MessageChannel();\n    try {\n        // This will throw an error if the audioWorkletNodeOptions are not clonable.\n        port1.postMessage(audioWorkletNodeOptions);\n    }\n    finally {\n        port1.close();\n        port2.close();\n    }\n};\n//# sourceMappingURL=test-audio-worklet-node-options-clonability.js.map","export const wrapAudioBufferSourceNodeStartMethodOffsetClamping = (nativeAudioBufferSourceNode) => {\n    nativeAudioBufferSourceNode.start = ((start) => {\n        return (when = 0, offset = 0, duration) => {\n            const buffer = nativeAudioBufferSourceNode.buffer;\n            // Bug #154: Safari does not clamp the offset if it is equal to or greater than the duration of the buffer.\n            const clampedOffset = buffer === null ? offset : Math.min(buffer.duration, offset);\n            // Bug #155: Safari does not handle the offset correctly if it would cause the buffer to be not be played at all.\n            if (buffer !== null && clampedOffset > buffer.duration - 0.5 / nativeAudioBufferSourceNode.context.sampleRate) {\n                start.call(nativeAudioBufferSourceNode, when, 0, 0);\n            }\n            else {\n                start.call(nativeAudioBufferSourceNode, when, clampedOffset, duration);\n            }\n        };\n    })(nativeAudioBufferSourceNode.start);\n};\n//# sourceMappingURL=wrap-audio-buffer-source-node-start-method-offset-clamping.js.map","import { interceptConnections } from './intercept-connections';\nexport const wrapAudioScheduledSourceNodeStopMethodConsecutiveCalls = (nativeAudioScheduledSourceNode, nativeContext) => {\n    const nativeGainNode = nativeContext.createGain();\n    nativeAudioScheduledSourceNode.connect(nativeGainNode);\n    const disconnectGainNode = ((disconnect) => {\n        return () => {\n            // @todo TypeScript cannot infer the overloaded signature with 1 argument yet.\n            disconnect.call(nativeAudioScheduledSourceNode, nativeGainNode);\n            nativeAudioScheduledSourceNode.removeEventListener('ended', disconnectGainNode);\n        };\n    })(nativeAudioScheduledSourceNode.disconnect);\n    nativeAudioScheduledSourceNode.addEventListener('ended', disconnectGainNode);\n    interceptConnections(nativeAudioScheduledSourceNode, nativeGainNode);\n    nativeAudioScheduledSourceNode.stop = ((stop) => {\n        let isStopped = false;\n        return (when = 0) => {\n            if (isStopped) {\n                try {\n                    stop.call(nativeAudioScheduledSourceNode, when);\n                }\n                catch {\n                    nativeGainNode.gain.setValueAtTime(0, when);\n                }\n            }\n            else {\n                stop.call(nativeAudioScheduledSourceNode, when);\n                isStopped = true;\n            }\n        };\n    })(nativeAudioScheduledSourceNode.stop);\n};\n//# sourceMappingURL=wrap-audio-scheduled-source-node-stop-method-consecutive-calls.js.map","export const wrapEventListener = (target, eventListener) => {\n    return (event) => {\n        const descriptor = { value: target };\n        Object.defineProperties(event, {\n            currentTarget: descriptor,\n            target: descriptor\n        });\n        if (typeof eventListener === 'function') {\n            return eventListener.call(target, event);\n        }\n        return eventListener.handleEvent.call(target, event);\n    };\n};\n//# sourceMappingURL=wrap-event-listener.js.map","import { createCancelAndHoldAutomationEvent, createCancelScheduledValuesAutomationEvent, createExponentialRampToValueAutomationEvent, createLinearRampToValueAutomationEvent, createSetTargetAutomationEvent, createSetValueAutomationEvent, createSetValueCurveAutomationEvent } from 'automation-events';\nimport { createAbortError } from './factories/abort-error';\nimport { createAddActiveInputConnectionToAudioNode } from './factories/add-active-input-connection-to-audio-node';\nimport { createAddAudioNodeConnections } from './factories/add-audio-node-connections';\nimport { createAddAudioParamConnections } from './factories/add-audio-param-connections';\nimport { createAddAudioWorkletModule } from './factories/add-audio-worklet-module';\nimport { createAddConnectionToAudioNode } from './factories/add-connection-to-audio-node';\nimport { createAddPassiveInputConnectionToAudioNode } from './factories/add-passive-input-connection-to-audio-node';\nimport { createAddSilentConnection } from './factories/add-silent-connection';\nimport { createAddUnrenderedAudioWorkletNode } from './factories/add-unrendered-audio-worklet-node';\nimport { createAnalyserNodeConstructor } from './factories/analyser-node-constructor';\nimport { createAnalyserNodeRendererFactory } from './factories/analyser-node-renderer-factory';\nimport { createAudioBufferConstructor } from './factories/audio-buffer-constructor';\nimport { createAudioBufferSourceNodeConstructor } from './factories/audio-buffer-source-node-constructor';\nimport { createAudioBufferSourceNodeRendererFactory } from './factories/audio-buffer-source-node-renderer-factory';\nimport { createAudioContextConstructor } from './factories/audio-context-constructor';\nimport { createAudioDestinationNodeConstructor } from './factories/audio-destination-node-constructor';\nimport { createAudioDestinationNodeRenderer } from './factories/audio-destination-node-renderer-factory';\nimport { createAudioListenerFactory } from './factories/audio-listener-factory';\nimport { createAudioNodeConstructor } from './factories/audio-node-constructor';\nimport { createAudioParamFactory } from './factories/audio-param-factory';\nimport { createAudioParamRenderer } from './factories/audio-param-renderer';\nimport { createAudioWorkletNodeConstructor } from './factories/audio-worklet-node-constructor';\nimport { createAudioWorkletNodeRendererFactory } from './factories/audio-worklet-node-renderer-factory';\nimport { createBaseAudioContextConstructor } from './factories/base-audio-context-constructor';\nimport { createBiquadFilterNodeConstructor } from './factories/biquad-filter-node-constructor';\nimport { createBiquadFilterNodeRendererFactory } from './factories/biquad-filter-node-renderer-factory';\nimport { createCacheTestResult } from './factories/cache-test-result';\nimport { createChannelMergerNodeConstructor } from './factories/channel-merger-node-constructor';\nimport { createChannelMergerNodeRendererFactory } from './factories/channel-merger-node-renderer-factory';\nimport { createChannelSplitterNodeConstructor } from './factories/channel-splitter-node-constructor';\nimport { createChannelSplitterNodeRendererFactory } from './factories/channel-splitter-node-renderer-factory';\nimport { createConnectAudioParam } from './factories/connect-audio-param';\nimport { createConnectMultipleOutputs } from './factories/connect-multiple-outputs';\nimport { createConnectedNativeAudioBufferSourceNodeFactory } from './factories/connected-native-audio-buffer-source-node-factory';\nimport { createConstantSourceNodeConstructor } from './factories/constant-source-node-constructor';\nimport { createConstantSourceNodeRendererFactory } from './factories/constant-source-node-renderer-factory';\nimport { createConvertNumberToUnsignedLong } from './factories/convert-number-to-unsigned-long';\nimport { createConvolverNodeConstructor } from './factories/convolver-node-constructor';\nimport { createConvolverNodeRendererFactory } from './factories/convolver-node-renderer-factory';\nimport { createCreateNativeOfflineAudioContext } from './factories/create-native-offline-audio-context';\nimport { createDataCloneError } from './factories/data-clone-error';\nimport { createDecodeAudioData } from './factories/decode-audio-data';\nimport { createDecrementCycleCounter } from './factories/decrement-cycle-counter';\nimport { createDelayNodeConstructor } from './factories/delay-node-constructor';\nimport { createDelayNodeRendererFactory } from './factories/delay-node-renderer-factory';\nimport { createDeleteActiveInputConnectionToAudioNode } from './factories/delete-active-input-connection-to-audio-node';\nimport { createDeleteUnrenderedAudioWorkletNode } from './factories/delete-unrendered-audio-worklet-node';\nimport { createDetectCycles } from './factories/detect-cycles';\nimport { createDisconnectMultipleOutputs } from './factories/disconnect-multiple-outputs';\nimport { createDynamicsCompressorNodeConstructor } from './factories/dynamics-compressor-node-constructor';\nimport { createDynamicsCompressorNodeRendererFactory } from './factories/dynamics-compressor-node-renderer-factory';\nimport { createEncodingError } from './factories/encoding-error';\nimport { createEvaluateSource } from './factories/evaluate-source';\nimport { createEventTargetConstructor } from './factories/event-target-constructor';\nimport { createExposeCurrentFrameAndCurrentTime } from './factories/expose-current-frame-and-current-time';\nimport { createFetchSource } from './factories/fetch-source';\nimport { createGainNodeConstructor } from './factories/gain-node-constructor';\nimport { createGainNodeRendererFactory } from './factories/gain-node-renderer-factory';\nimport { createGetActiveAudioWorkletNodeInputs } from './factories/get-active-audio-worklet-node-inputs';\nimport { createGetAudioNodeRenderer } from './factories/get-audio-node-renderer';\nimport { createGetAudioNodeTailTime } from './factories/get-audio-node-tail-time';\nimport { createGetAudioParamRenderer } from './factories/get-audio-param-renderer';\nimport { createGetBackupOfflineAudioContext } from './factories/get-backup-offline-audio-context';\nimport { createGetNativeContext } from './factories/get-native-context';\nimport { createGetOrCreateBackupOfflineAudioContext } from './factories/get-or-create-backup-offline-audio-context';\nimport { createGetUnrenderedAudioWorkletNodes } from './factories/get-unrendered-audio-worklet-nodes';\nimport { createIIRFilterNodeConstructor } from './factories/iir-filter-node-constructor';\nimport { createIIRFilterNodeRendererFactory } from './factories/iir-filter-node-renderer-factory';\nimport { createIncrementCycleCounterFactory } from './factories/increment-cycle-counter-factory';\nimport { createIndexSizeError } from './factories/index-size-error';\nimport { createInvalidAccessError } from './factories/invalid-access-error';\nimport { createInvalidStateError } from './factories/invalid-state-error';\nimport { createIsAnyAudioContext } from './factories/is-any-audio-context';\nimport { createIsAnyAudioNode } from './factories/is-any-audio-node';\nimport { createIsAnyAudioParam } from './factories/is-any-audio-param';\nimport { createIsAnyOfflineAudioContext } from './factories/is-any-offline-audio-context';\nimport { createIsNativeAudioContext } from './factories/is-native-audio-context';\nimport { createIsNativeAudioNode } from './factories/is-native-audio-node';\nimport { createIsNativeAudioParam } from './factories/is-native-audio-param';\nimport { createIsNativeContext } from './factories/is-native-context';\nimport { createIsNativeOfflineAudioContext } from './factories/is-native-offline-audio-context';\nimport { createIsSecureContext } from './factories/is-secure-context';\nimport { createIsSupportedPromise } from './factories/is-supported-promise';\nimport { createMediaElementAudioSourceNodeConstructor } from './factories/media-element-audio-source-node-constructor';\nimport { createMediaStreamAudioDestinationNodeConstructor } from './factories/media-stream-audio-destination-node-constructor';\nimport { createMediaStreamAudioSourceNodeConstructor } from './factories/media-stream-audio-source-node-constructor';\nimport { createMediaStreamTrackAudioSourceNodeConstructor } from './factories/media-stream-track-audio-source-node-constructor';\nimport { createMinimalAudioContextConstructor } from './factories/minimal-audio-context-constructor';\nimport { createMinimalBaseAudioContextConstructor } from './factories/minimal-base-audio-context-constructor';\nimport { createMinimalOfflineAudioContextConstructor } from './factories/minimal-offline-audio-context-constructor';\nimport { createMonitorConnections } from './factories/monitor-connections';\nimport { createNativeAnalyserNodeFactory } from './factories/native-analyser-node-factory';\nimport { createNativeAudioBufferConstructor } from './factories/native-audio-buffer-constructor';\nimport { createNativeAudioBufferSourceNodeFactory } from './factories/native-audio-buffer-source-node-factory';\nimport { createNativeAudioContextConstructor } from './factories/native-audio-context-constructor';\nimport { createNativeAudioDestinationNodeFactory } from './factories/native-audio-destination-node';\nimport { createNativeAudioWorkletNodeConstructor } from './factories/native-audio-worklet-node-constructor';\nimport { createNativeAudioWorkletNodeFactory } from './factories/native-audio-worklet-node-factory';\nimport { createNativeAudioWorkletNodeFakerFactory } from './factories/native-audio-worklet-node-faker-factory';\nimport { createNativeBiquadFilterNode } from './factories/native-biquad-filter-node';\nimport { createNativeChannelMergerNodeFactory } from './factories/native-channel-merger-node-factory';\nimport { createNativeChannelSplitterNode } from './factories/native-channel-splitter-node';\nimport { createNativeConstantSourceNodeFactory } from './factories/native-constant-source-node-factory';\nimport { createNativeConstantSourceNodeFakerFactory } from './factories/native-constant-source-node-faker-factory';\nimport { createNativeConvolverNodeFactory } from './factories/native-convolver-node-factory';\nimport { createNativeDelayNode } from './factories/native-delay-node';\nimport { createNativeDynamicsCompressorNodeFactory } from './factories/native-dynamics-compressor-node-factory';\nimport { createNativeGainNode } from './factories/native-gain-node';\nimport { createNativeIIRFilterNodeFactory } from './factories/native-iir-filter-node-factory';\nimport { createNativeIIRFilterNodeFakerFactory } from './factories/native-iir-filter-node-faker-factory';\nimport { createNativeMediaElementAudioSourceNode } from './factories/native-media-element-audio-source-node';\nimport { createNativeMediaStreamAudioDestinationNode } from './factories/native-media-stream-audio-destination-node';\nimport { createNativeMediaStreamAudioSourceNode } from './factories/native-media-stream-audio-source-node';\nimport { createNativeMediaStreamTrackAudioSourceNodeFactory } from './factories/native-media-stream-track-audio-source-node-factory';\nimport { createNativeOfflineAudioContextConstructor } from './factories/native-offline-audio-context-constructor';\nimport { createNativeOscillatorNodeFactory } from './factories/native-oscillator-node-factory';\nimport { createNativePannerNodeFactory } from './factories/native-panner-node-factory';\nimport { createNativePannerNodeFakerFactory } from './factories/native-panner-node-faker-factory';\nimport { createNativePeriodicWaveFactory } from './factories/native-periodic-wave-factory';\nimport { createNativeScriptProcessorNode } from './factories/native-script-processor-node';\nimport { createNativeStereoPannerNodeFactory } from './factories/native-stereo-panner-node-factory';\nimport { createNativeStereoPannerNodeFakerFactory } from './factories/native-stereo-panner-node-faker-factory';\nimport { createNativeWaveShaperNodeFactory } from './factories/native-wave-shaper-node-factory';\nimport { createNativeWaveShaperNodeFakerFactory } from './factories/native-wave-shaper-node-faker-factory';\nimport { createNotSupportedError } from './factories/not-supported-error';\nimport { createOfflineAudioContextConstructor } from './factories/offline-audio-context-constructor';\nimport { createOscillatorNodeConstructor } from './factories/oscillator-node-constructor';\nimport { createOscillatorNodeRendererFactory } from './factories/oscillator-node-renderer-factory';\nimport { createPannerNodeConstructor } from './factories/panner-node-constructor';\nimport { createPannerNodeRendererFactory } from './factories/panner-node-renderer-factory';\nimport { createPeriodicWaveConstructor } from './factories/periodic-wave-constructor';\nimport { createRenderAutomation } from './factories/render-automation';\nimport { createRenderInputsOfAudioNode } from './factories/render-inputs-of-audio-node';\nimport { createRenderInputsOfAudioParam } from './factories/render-inputs-of-audio-param';\nimport { createRenderNativeOfflineAudioContext } from './factories/render-native-offline-audio-context';\nimport { createSetActiveAudioWorkletNodeInputs } from './factories/set-active-audio-worklet-node-inputs';\nimport { createSetAudioNodeTailTime } from './factories/set-audio-node-tail-time';\nimport { createStartRendering } from './factories/start-rendering';\nimport { createStereoPannerNodeConstructor } from './factories/stereo-panner-node-constructor';\nimport { createStereoPannerNodeRendererFactory } from './factories/stereo-panner-node-renderer-factory';\nimport { createTestAudioBufferConstructorSupport } from './factories/test-audio-buffer-constructor-support';\nimport { createTestAudioBufferCopyChannelMethodsSubarraySupport } from './factories/test-audio-buffer-copy-channel-methods-subarray-support';\nimport { createTestAudioContextCloseMethodSupport } from './factories/test-audio-context-close-method-support';\nimport { createTestAudioContextDecodeAudioDataMethodTypeErrorSupport } from './factories/test-audio-context-decode-audio-data-method-type-error-support';\nimport { createTestAudioContextOptionsSupport } from './factories/test-audio-context-options-support';\nimport { createTestAudioNodeConnectMethodSupport } from './factories/test-audio-node-connect-method-support';\nimport { createTestAudioWorkletProcessorNoOutputsSupport } from './factories/test-audio-worklet-processor-no-outputs-support';\nimport { createTestAudioWorkletProcessorPostMessageSupport } from './factories/test-audio-worklet-processor-post-message-support';\nimport { createTestChannelMergerNodeChannelCountSupport } from './factories/test-channel-merger-node-channel-count-support';\nimport { createTestConstantSourceNodeAccurateSchedulingSupport } from './factories/test-constant-source-node-accurate-scheduling-support';\nimport { createTestConvolverNodeBufferReassignabilitySupport } from './factories/test-convolver-node-buffer-reassignability-support';\nimport { createTestConvolverNodeChannelCountSupport } from './factories/test-convolver-node-channel-count-support';\nimport { createTestIsSecureContextSupport } from './factories/test-is-secure-context-support';\nimport { createTestMediaStreamAudioSourceNodeMediaStreamWithoutAudioTrackSupport } from './factories/test-media-stream-audio-source-node-media-stream-without-audio-track-support';\nimport { createTestOfflineAudioContextCurrentTimeSupport } from './factories/test-offline-audio-context-current-time-support';\nimport { createTestStereoPannerNodeDefaultValueSupport } from './factories/test-stereo-panner-node-default-value-support';\nimport { createUnknownError } from './factories/unknown-error';\nimport { createWaveShaperNodeConstructor } from './factories/wave-shaper-node-constructor';\nimport { createWaveShaperNodeRendererFactory } from './factories/wave-shaper-node-renderer-factory';\nimport { createWindow } from './factories/window';\nimport { createWrapAudioBufferCopyChannelMethods } from './factories/wrap-audio-buffer-copy-channel-methods';\nimport { createWrapAudioBufferCopyChannelMethodsOutOfBounds } from './factories/wrap-audio-buffer-copy-channel-methods-out-of-bounds';\nimport { createWrapAudioBufferSourceNodeStopMethodNullifiedBuffer } from './factories/wrap-audio-buffer-source-node-stop-method-nullified-buffer';\nimport { createWrapChannelMergerNode } from './factories/wrap-channel-merger-node';\nimport { AUDIO_NODE_CONNECTIONS_STORE, AUDIO_NODE_STORE, AUDIO_PARAM_CONNECTIONS_STORE, AUDIO_PARAM_STORE, CONTEXT_STORE, CYCLE_COUNTERS } from './globals';\nimport { connectNativeAudioNodeToNativeAudioNode } from './helpers/connect-native-audio-node-to-native-audio-node';\nimport { disconnectNativeAudioNodeFromNativeAudioNode } from './helpers/disconnect-native-audio-node-from-native-audio-node';\nimport { getAudioNodeConnections } from './helpers/get-audio-node-connections';\nimport { getAudioParamConnections } from './helpers/get-audio-param-connections';\nimport { getEventListenersOfAudioNode } from './helpers/get-event-listeners-of-audio-node';\nimport { getFirstSample } from './helpers/get-first-sample';\nimport { getNativeAudioNode } from './helpers/get-native-audio-node';\nimport { getNativeAudioParam } from './helpers/get-native-audio-param';\nimport { getValueForKey } from './helpers/get-value-for-key';\nimport { insertElementInSet } from './helpers/insert-element-in-set';\nimport { isActiveAudioNode } from './helpers/is-active-audio-node';\nimport { isDCCurve } from './helpers/is-dc-curve';\nimport { isPartOfACycle } from './helpers/is-part-of-a-cycle';\nimport { isPassiveAudioNode } from './helpers/is-passive-audio-node';\nimport { overwriteAccessors } from './helpers/overwrite-accessors';\nimport { pickElementFromSet } from './helpers/pick-element-from-set';\nimport { sanitizeAudioWorkletNodeOptions } from './helpers/sanitize-audio-worklet-node-options';\nimport { sanitizeChannelSplitterOptions } from './helpers/sanitize-channel-splitter-options';\nimport { sanitizePeriodicWaveOptions } from './helpers/sanitize-periodic-wave-options';\nimport { setValueAtTimeUntilPossible } from './helpers/set-value-at-time-until-possible';\nimport { testAudioBufferCopyChannelMethodsOutOfBoundsSupport } from './helpers/test-audio-buffer-copy-channel-methods-out-of-bounds-support';\nimport { testAudioBufferSourceNodeStartMethodConsecutiveCallsSupport } from './helpers/test-audio-buffer-source-node-start-method-consecutive-calls-support';\nimport { testAudioBufferSourceNodeStartMethodOffsetClampingSupport } from './helpers/test-audio-buffer-source-node-start-method-offset-clamping-support';\nimport { testAudioBufferSourceNodeStopMethodNullifiedBufferSupport } from './helpers/test-audio-buffer-source-node-stop-method-nullified-buffer-support';\nimport { testAudioScheduledSourceNodeStartMethodNegativeParametersSupport } from './helpers/test-audio-scheduled-source-node-start-method-negative-parameters-support';\nimport { testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport } from './helpers/test-audio-scheduled-source-node-stop-method-consecutive-calls-support';\nimport { testAudioScheduledSourceNodeStopMethodNegativeParametersSupport } from './helpers/test-audio-scheduled-source-node-stop-method-negative-parameters-support';\nimport { testAudioWorkletNodeOptionsClonability } from './helpers/test-audio-worklet-node-options-clonability';\nimport { testDomExceptionConstructorSupport } from './helpers/test-dom-exception-constructor-support';\nimport { testPromiseSupport } from './helpers/test-promise-support';\nimport { testTransferablesSupport } from './helpers/test-transferables-support';\nimport { wrapAudioBufferSourceNodeStartMethodOffsetClamping } from './helpers/wrap-audio-buffer-source-node-start-method-offset-clamping';\nimport { wrapAudioScheduledSourceNodeStopMethodConsecutiveCalls } from './helpers/wrap-audio-scheduled-source-node-stop-method-consecutive-calls';\nimport { wrapEventListener } from './helpers/wrap-event-listener';\n/*\n * @todo Explicitly referencing the barrel file seems to be necessary when enabling the\n * isolatedModules compiler option.\n */\nexport * from './interfaces/index';\nexport * from './types/index';\nconst addActiveInputConnectionToAudioNode = createAddActiveInputConnectionToAudioNode(insertElementInSet);\nconst addPassiveInputConnectionToAudioNode = createAddPassiveInputConnectionToAudioNode(insertElementInSet);\nconst deleteActiveInputConnectionToAudioNode = createDeleteActiveInputConnectionToAudioNode(pickElementFromSet);\nconst audioNodeTailTimeStore = new WeakMap();\nconst getAudioNodeTailTime = createGetAudioNodeTailTime(audioNodeTailTimeStore);\nconst cacheTestResult = createCacheTestResult(new Map(), new WeakMap());\nconst window = createWindow();\nconst createNativeAnalyserNode = createNativeAnalyserNodeFactory(cacheTestResult, createIndexSizeError);\nconst getAudioNodeRenderer = createGetAudioNodeRenderer(getAudioNodeConnections);\nconst renderInputsOfAudioNode = createRenderInputsOfAudioNode(getAudioNodeConnections, getAudioNodeRenderer, isPartOfACycle);\nconst createAnalyserNodeRenderer = createAnalyserNodeRendererFactory(createNativeAnalyserNode, getNativeAudioNode, renderInputsOfAudioNode);\nconst getNativeContext = createGetNativeContext(CONTEXT_STORE);\nconst nativeOfflineAudioContextConstructor = createNativeOfflineAudioContextConstructor(window);\nconst isNativeOfflineAudioContext = createIsNativeOfflineAudioContext(nativeOfflineAudioContextConstructor);\nconst audioParamAudioNodeStore = new WeakMap();\nconst eventTargetConstructor = createEventTargetConstructor(wrapEventListener);\nconst nativeAudioContextConstructor = createNativeAudioContextConstructor(window);\nconst isNativeAudioContext = createIsNativeAudioContext(nativeAudioContextConstructor);\nconst isNativeAudioNode = createIsNativeAudioNode(window);\nconst isNativeAudioParam = createIsNativeAudioParam(window);\nconst nativeAudioWorkletNodeConstructor = createNativeAudioWorkletNodeConstructor(window);\nconst audioNodeConstructor = createAudioNodeConstructor(createAddAudioNodeConnections(AUDIO_NODE_CONNECTIONS_STORE), createAddConnectionToAudioNode(addActiveInputConnectionToAudioNode, addPassiveInputConnectionToAudioNode, connectNativeAudioNodeToNativeAudioNode, deleteActiveInputConnectionToAudioNode, disconnectNativeAudioNodeFromNativeAudioNode, getAudioNodeConnections, getAudioNodeTailTime, getEventListenersOfAudioNode, getNativeAudioNode, insertElementInSet, isActiveAudioNode, isPartOfACycle, isPassiveAudioNode), cacheTestResult, createIncrementCycleCounterFactory(CYCLE_COUNTERS, disconnectNativeAudioNodeFromNativeAudioNode, getAudioNodeConnections, getNativeAudioNode, getNativeAudioParam, isActiveAudioNode), createIndexSizeError, createInvalidAccessError, createNotSupportedError, createDecrementCycleCounter(connectNativeAudioNodeToNativeAudioNode, CYCLE_COUNTERS, getAudioNodeConnections, getNativeAudioNode, getNativeAudioParam, getNativeContext, isActiveAudioNode, isNativeOfflineAudioContext), createDetectCycles(audioParamAudioNodeStore, getAudioNodeConnections, getValueForKey), eventTargetConstructor, getNativeContext, isNativeAudioContext, isNativeAudioNode, isNativeAudioParam, isNativeOfflineAudioContext, nativeAudioWorkletNodeConstructor);\nconst analyserNodeConstructor = createAnalyserNodeConstructor(audioNodeConstructor, createAnalyserNodeRenderer, createIndexSizeError, createNativeAnalyserNode, getNativeContext, isNativeOfflineAudioContext);\nexport { analyserNodeConstructor as AnalyserNode };\nconst audioBufferStore = new WeakSet();\nconst nativeAudioBufferConstructor = createNativeAudioBufferConstructor(window);\nconst convertNumberToUnsignedLong = createConvertNumberToUnsignedLong(new Uint32Array(1));\nconst wrapAudioBufferCopyChannelMethods = createWrapAudioBufferCopyChannelMethods(convertNumberToUnsignedLong, createIndexSizeError);\nconst wrapAudioBufferCopyChannelMethodsOutOfBounds = createWrapAudioBufferCopyChannelMethodsOutOfBounds(convertNumberToUnsignedLong);\nconst audioBufferConstructor = createAudioBufferConstructor(audioBufferStore, cacheTestResult, createNotSupportedError, nativeAudioBufferConstructor, nativeOfflineAudioContextConstructor, createTestAudioBufferConstructorSupport(nativeAudioBufferConstructor), wrapAudioBufferCopyChannelMethods, wrapAudioBufferCopyChannelMethodsOutOfBounds);\nexport { audioBufferConstructor as AudioBuffer };\nconst addSilentConnection = createAddSilentConnection(createNativeGainNode);\nconst renderInputsOfAudioParam = createRenderInputsOfAudioParam(getAudioNodeRenderer, getAudioParamConnections, isPartOfACycle);\nconst connectAudioParam = createConnectAudioParam(renderInputsOfAudioParam);\nconst createNativeAudioBufferSourceNode = createNativeAudioBufferSourceNodeFactory(addSilentConnection, cacheTestResult, testAudioBufferSourceNodeStartMethodConsecutiveCallsSupport, testAudioBufferSourceNodeStartMethodOffsetClampingSupport, testAudioBufferSourceNodeStopMethodNullifiedBufferSupport, testAudioScheduledSourceNodeStartMethodNegativeParametersSupport, testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport, testAudioScheduledSourceNodeStopMethodNegativeParametersSupport, wrapAudioBufferSourceNodeStartMethodOffsetClamping, createWrapAudioBufferSourceNodeStopMethodNullifiedBuffer(overwriteAccessors), wrapAudioScheduledSourceNodeStopMethodConsecutiveCalls);\nconst renderAutomation = createRenderAutomation(createGetAudioParamRenderer(getAudioParamConnections), renderInputsOfAudioParam);\nconst createAudioBufferSourceNodeRenderer = createAudioBufferSourceNodeRendererFactory(connectAudioParam, createNativeAudioBufferSourceNode, getNativeAudioNode, renderAutomation, renderInputsOfAudioNode);\nconst createAudioParam = createAudioParamFactory(createAddAudioParamConnections(AUDIO_PARAM_CONNECTIONS_STORE), audioParamAudioNodeStore, AUDIO_PARAM_STORE, createAudioParamRenderer, createCancelAndHoldAutomationEvent, createCancelScheduledValuesAutomationEvent, createExponentialRampToValueAutomationEvent, createLinearRampToValueAutomationEvent, createSetTargetAutomationEvent, createSetValueAutomationEvent, createSetValueCurveAutomationEvent, nativeAudioContextConstructor, setValueAtTimeUntilPossible);\nconst audioBufferSourceNodeConstructor = createAudioBufferSourceNodeConstructor(audioNodeConstructor, createAudioBufferSourceNodeRenderer, createAudioParam, createInvalidStateError, createNativeAudioBufferSourceNode, getNativeContext, isNativeOfflineAudioContext, wrapEventListener);\nexport { audioBufferSourceNodeConstructor as AudioBufferSourceNode };\nconst audioDestinationNodeConstructor = createAudioDestinationNodeConstructor(audioNodeConstructor, createAudioDestinationNodeRenderer, createIndexSizeError, createInvalidStateError, createNativeAudioDestinationNodeFactory(createNativeGainNode, overwriteAccessors), getNativeContext, isNativeOfflineAudioContext, renderInputsOfAudioNode);\nconst createBiquadFilterNodeRenderer = createBiquadFilterNodeRendererFactory(connectAudioParam, createNativeBiquadFilterNode, getNativeAudioNode, renderAutomation, renderInputsOfAudioNode);\nconst setAudioNodeTailTime = createSetAudioNodeTailTime(audioNodeTailTimeStore);\nconst biquadFilterNodeConstructor = createBiquadFilterNodeConstructor(audioNodeConstructor, createAudioParam, createBiquadFilterNodeRenderer, createInvalidAccessError, createNativeBiquadFilterNode, getNativeContext, isNativeOfflineAudioContext, setAudioNodeTailTime);\nconst monitorConnections = createMonitorConnections(insertElementInSet, isNativeAudioNode);\nconst wrapChannelMergerNode = createWrapChannelMergerNode(createInvalidStateError, monitorConnections);\nconst createNativeChannelMergerNode = createNativeChannelMergerNodeFactory(nativeAudioContextConstructor, wrapChannelMergerNode);\nconst createChannelMergerNodeRenderer = createChannelMergerNodeRendererFactory(createNativeChannelMergerNode, getNativeAudioNode, renderInputsOfAudioNode);\nconst channelMergerNodeConstructor = createChannelMergerNodeConstructor(audioNodeConstructor, createChannelMergerNodeRenderer, createNativeChannelMergerNode, getNativeContext, isNativeOfflineAudioContext);\nconst createChannelSplitterNodeRenderer = createChannelSplitterNodeRendererFactory(createNativeChannelSplitterNode, getNativeAudioNode, renderInputsOfAudioNode);\nconst channelSplitterNodeConstructor = createChannelSplitterNodeConstructor(audioNodeConstructor, createChannelSplitterNodeRenderer, createNativeChannelSplitterNode, getNativeContext, isNativeOfflineAudioContext, sanitizeChannelSplitterOptions);\nconst createNativeConstantSourceNodeFaker = createNativeConstantSourceNodeFakerFactory(addSilentConnection, createNativeAudioBufferSourceNode, createNativeGainNode, monitorConnections);\nconst createNativeConstantSourceNode = createNativeConstantSourceNodeFactory(addSilentConnection, cacheTestResult, createNativeConstantSourceNodeFaker, testAudioScheduledSourceNodeStartMethodNegativeParametersSupport, testAudioScheduledSourceNodeStopMethodNegativeParametersSupport);\nconst createConstantSourceNodeRenderer = createConstantSourceNodeRendererFactory(connectAudioParam, createNativeConstantSourceNode, getNativeAudioNode, renderAutomation, renderInputsOfAudioNode);\nconst constantSourceNodeConstructor = createConstantSourceNodeConstructor(audioNodeConstructor, createAudioParam, createConstantSourceNodeRenderer, createNativeConstantSourceNode, getNativeContext, isNativeOfflineAudioContext, wrapEventListener);\nconst createNativeConvolverNode = createNativeConvolverNodeFactory(createNotSupportedError, overwriteAccessors);\nconst createConvolverNodeRenderer = createConvolverNodeRendererFactory(createNativeConvolverNode, getNativeAudioNode, renderInputsOfAudioNode);\nconst convolverNodeConstructor = createConvolverNodeConstructor(audioNodeConstructor, createConvolverNodeRenderer, createNativeConvolverNode, getNativeContext, isNativeOfflineAudioContext, setAudioNodeTailTime);\nconst createDelayNodeRenderer = createDelayNodeRendererFactory(connectAudioParam, createNativeDelayNode, getNativeAudioNode, renderAutomation, renderInputsOfAudioNode);\nconst delayNodeConstructor = createDelayNodeConstructor(audioNodeConstructor, createAudioParam, createDelayNodeRenderer, createNativeDelayNode, getNativeContext, isNativeOfflineAudioContext, setAudioNodeTailTime);\nconst createNativeDynamicsCompressorNode = createNativeDynamicsCompressorNodeFactory(createNotSupportedError);\nconst createDynamicsCompressorNodeRenderer = createDynamicsCompressorNodeRendererFactory(connectAudioParam, createNativeDynamicsCompressorNode, getNativeAudioNode, renderAutomation, renderInputsOfAudioNode);\nconst dynamicsCompressorNodeConstructor = createDynamicsCompressorNodeConstructor(audioNodeConstructor, createAudioParam, createDynamicsCompressorNodeRenderer, createNativeDynamicsCompressorNode, createNotSupportedError, getNativeContext, isNativeOfflineAudioContext, setAudioNodeTailTime);\nconst createGainNodeRenderer = createGainNodeRendererFactory(connectAudioParam, createNativeGainNode, getNativeAudioNode, renderAutomation, renderInputsOfAudioNode);\nconst gainNodeConstructor = createGainNodeConstructor(audioNodeConstructor, createAudioParam, createGainNodeRenderer, createNativeGainNode, getNativeContext, isNativeOfflineAudioContext);\nconst createNativeIIRFilterNodeFaker = createNativeIIRFilterNodeFakerFactory(createInvalidAccessError, createInvalidStateError, createNativeScriptProcessorNode, createNotSupportedError);\nconst renderNativeOfflineAudioContext = createRenderNativeOfflineAudioContext(cacheTestResult, createNativeGainNode, createNativeScriptProcessorNode, createTestOfflineAudioContextCurrentTimeSupport(createNativeGainNode, nativeOfflineAudioContextConstructor));\nconst createIIRFilterNodeRenderer = createIIRFilterNodeRendererFactory(createNativeAudioBufferSourceNode, getNativeAudioNode, nativeOfflineAudioContextConstructor, renderInputsOfAudioNode, renderNativeOfflineAudioContext);\nconst createNativeIIRFilterNode = createNativeIIRFilterNodeFactory(createNativeIIRFilterNodeFaker);\nconst iIRFilterNodeConstructor = createIIRFilterNodeConstructor(audioNodeConstructor, createNativeIIRFilterNode, createIIRFilterNodeRenderer, getNativeContext, isNativeOfflineAudioContext, setAudioNodeTailTime);\nconst createAudioListener = createAudioListenerFactory(createAudioParam, createNativeChannelMergerNode, createNativeConstantSourceNode, createNativeScriptProcessorNode, createNotSupportedError, getFirstSample, isNativeOfflineAudioContext, overwriteAccessors);\nconst unrenderedAudioWorkletNodeStore = new WeakMap();\nconst minimalBaseAudioContextConstructor = createMinimalBaseAudioContextConstructor(audioDestinationNodeConstructor, createAudioListener, eventTargetConstructor, isNativeOfflineAudioContext, unrenderedAudioWorkletNodeStore, wrapEventListener);\nconst createNativeOscillatorNode = createNativeOscillatorNodeFactory(addSilentConnection, cacheTestResult, testAudioScheduledSourceNodeStartMethodNegativeParametersSupport, testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport, testAudioScheduledSourceNodeStopMethodNegativeParametersSupport, wrapAudioScheduledSourceNodeStopMethodConsecutiveCalls);\nconst createOscillatorNodeRenderer = createOscillatorNodeRendererFactory(connectAudioParam, createNativeOscillatorNode, getNativeAudioNode, renderAutomation, renderInputsOfAudioNode);\nconst oscillatorNodeConstructor = createOscillatorNodeConstructor(audioNodeConstructor, createAudioParam, createNativeOscillatorNode, createOscillatorNodeRenderer, getNativeContext, isNativeOfflineAudioContext, wrapEventListener);\nconst createConnectedNativeAudioBufferSourceNode = createConnectedNativeAudioBufferSourceNodeFactory(createNativeAudioBufferSourceNode);\nconst createNativeWaveShaperNodeFaker = createNativeWaveShaperNodeFakerFactory(createConnectedNativeAudioBufferSourceNode, createInvalidStateError, createNativeGainNode, isDCCurve, monitorConnections);\nconst createNativeWaveShaperNode = createNativeWaveShaperNodeFactory(createConnectedNativeAudioBufferSourceNode, createInvalidStateError, createNativeWaveShaperNodeFaker, isDCCurve, monitorConnections, nativeAudioContextConstructor, overwriteAccessors);\nconst createNativePannerNodeFaker = createNativePannerNodeFakerFactory(connectNativeAudioNodeToNativeAudioNode, createInvalidStateError, createNativeChannelMergerNode, createNativeGainNode, createNativeScriptProcessorNode, createNativeWaveShaperNode, createNotSupportedError, disconnectNativeAudioNodeFromNativeAudioNode, getFirstSample, monitorConnections);\nconst createNativePannerNode = createNativePannerNodeFactory(createNativePannerNodeFaker);\nconst createPannerNodeRenderer = createPannerNodeRendererFactory(connectAudioParam, createNativeChannelMergerNode, createNativeConstantSourceNode, createNativeGainNode, createNativePannerNode, getNativeAudioNode, nativeOfflineAudioContextConstructor, renderAutomation, renderInputsOfAudioNode, renderNativeOfflineAudioContext);\nconst pannerNodeConstructor = createPannerNodeConstructor(audioNodeConstructor, createAudioParam, createNativePannerNode, createPannerNodeRenderer, getNativeContext, isNativeOfflineAudioContext, setAudioNodeTailTime);\nconst createNativePeriodicWave = createNativePeriodicWaveFactory(createIndexSizeError);\nconst periodicWaveConstructor = createPeriodicWaveConstructor(createNativePeriodicWave, getNativeContext, new WeakSet(), sanitizePeriodicWaveOptions);\nconst nativeStereoPannerNodeFakerFactory = createNativeStereoPannerNodeFakerFactory(createNativeChannelMergerNode, createNativeChannelSplitterNode, createNativeGainNode, createNativeWaveShaperNode, createNotSupportedError, monitorConnections);\nconst createNativeStereoPannerNode = createNativeStereoPannerNodeFactory(nativeStereoPannerNodeFakerFactory, createNotSupportedError);\nconst createStereoPannerNodeRenderer = createStereoPannerNodeRendererFactory(connectAudioParam, createNativeStereoPannerNode, getNativeAudioNode, renderAutomation, renderInputsOfAudioNode);\nconst stereoPannerNodeConstructor = createStereoPannerNodeConstructor(audioNodeConstructor, createAudioParam, createNativeStereoPannerNode, createStereoPannerNodeRenderer, getNativeContext, isNativeOfflineAudioContext);\nconst createWaveShaperNodeRenderer = createWaveShaperNodeRendererFactory(createNativeWaveShaperNode, getNativeAudioNode, renderInputsOfAudioNode);\nconst waveShaperNodeConstructor = createWaveShaperNodeConstructor(audioNodeConstructor, createInvalidStateError, createNativeWaveShaperNode, createWaveShaperNodeRenderer, getNativeContext, isNativeOfflineAudioContext, setAudioNodeTailTime);\nconst isSecureContext = createIsSecureContext(window);\nconst exposeCurrentFrameAndCurrentTime = createExposeCurrentFrameAndCurrentTime(window);\nconst backupOfflineAudioContextStore = new WeakMap();\nconst getOrCreateBackupOfflineAudioContext = createGetOrCreateBackupOfflineAudioContext(backupOfflineAudioContextStore, nativeOfflineAudioContextConstructor);\n// The addAudioWorkletModule() function is only available in a SecureContext.\nexport const addAudioWorkletModule = isSecureContext\n    ? createAddAudioWorkletModule(cacheTestResult, createNotSupportedError, createEvaluateSource(window), exposeCurrentFrameAndCurrentTime, createFetchSource(createAbortError), getNativeContext, getOrCreateBackupOfflineAudioContext, isNativeOfflineAudioContext, nativeAudioWorkletNodeConstructor, new WeakMap(), new WeakMap(), createTestAudioWorkletProcessorPostMessageSupport(nativeAudioWorkletNodeConstructor, nativeOfflineAudioContextConstructor), \n    // @todo window is guaranteed to be defined because isSecureContext checks that as well.\n    window)\n    : undefined;\nconst isNativeContext = createIsNativeContext(isNativeAudioContext, isNativeOfflineAudioContext);\nexport const decodeAudioData = createDecodeAudioData(audioBufferStore, cacheTestResult, createDataCloneError, createEncodingError, new WeakSet(), getNativeContext, isNativeContext, testAudioBufferCopyChannelMethodsOutOfBoundsSupport, testPromiseSupport, wrapAudioBufferCopyChannelMethods, wrapAudioBufferCopyChannelMethodsOutOfBounds);\nconst baseAudioContextConstructor = createBaseAudioContextConstructor(addAudioWorkletModule, analyserNodeConstructor, audioBufferConstructor, audioBufferSourceNodeConstructor, biquadFilterNodeConstructor, channelMergerNodeConstructor, channelSplitterNodeConstructor, constantSourceNodeConstructor, convolverNodeConstructor, decodeAudioData, delayNodeConstructor, dynamicsCompressorNodeConstructor, gainNodeConstructor, iIRFilterNodeConstructor, minimalBaseAudioContextConstructor, oscillatorNodeConstructor, pannerNodeConstructor, periodicWaveConstructor, stereoPannerNodeConstructor, waveShaperNodeConstructor);\nconst mediaElementAudioSourceNodeConstructor = createMediaElementAudioSourceNodeConstructor(audioNodeConstructor, createNativeMediaElementAudioSourceNode, getNativeContext, isNativeOfflineAudioContext);\nconst mediaStreamAudioDestinationNodeConstructor = createMediaStreamAudioDestinationNodeConstructor(audioNodeConstructor, createNativeMediaStreamAudioDestinationNode, getNativeContext, isNativeOfflineAudioContext);\nconst mediaStreamAudioSourceNodeConstructor = createMediaStreamAudioSourceNodeConstructor(audioNodeConstructor, createNativeMediaStreamAudioSourceNode, getNativeContext, isNativeOfflineAudioContext);\nconst createNativeMediaStreamTrackAudioSourceNode = createNativeMediaStreamTrackAudioSourceNodeFactory(createInvalidStateError, isNativeOfflineAudioContext);\nconst mediaStreamTrackAudioSourceNodeConstructor = createMediaStreamTrackAudioSourceNodeConstructor(audioNodeConstructor, createNativeMediaStreamTrackAudioSourceNode, getNativeContext);\nconst audioContextConstructor = createAudioContextConstructor(baseAudioContextConstructor, createInvalidStateError, createNotSupportedError, createUnknownError, mediaElementAudioSourceNodeConstructor, mediaStreamAudioDestinationNodeConstructor, mediaStreamAudioSourceNodeConstructor, mediaStreamTrackAudioSourceNodeConstructor, nativeAudioContextConstructor);\nexport { audioContextConstructor as AudioContext };\nconst getUnrenderedAudioWorkletNodes = createGetUnrenderedAudioWorkletNodes(unrenderedAudioWorkletNodeStore);\nconst addUnrenderedAudioWorkletNode = createAddUnrenderedAudioWorkletNode(getUnrenderedAudioWorkletNodes);\nconst connectMultipleOutputs = createConnectMultipleOutputs(createIndexSizeError);\nconst deleteUnrenderedAudioWorkletNode = createDeleteUnrenderedAudioWorkletNode(getUnrenderedAudioWorkletNodes);\nconst disconnectMultipleOutputs = createDisconnectMultipleOutputs(createIndexSizeError);\nconst activeAudioWorkletNodeInputsStore = new WeakMap();\nconst getActiveAudioWorkletNodeInputs = createGetActiveAudioWorkletNodeInputs(activeAudioWorkletNodeInputsStore, getValueForKey);\nconst createNativeAudioWorkletNodeFaker = createNativeAudioWorkletNodeFakerFactory(connectMultipleOutputs, createIndexSizeError, createInvalidStateError, createNativeChannelMergerNode, createNativeChannelSplitterNode, createNativeConstantSourceNode, createNativeGainNode, createNativeScriptProcessorNode, createNotSupportedError, disconnectMultipleOutputs, exposeCurrentFrameAndCurrentTime, getActiveAudioWorkletNodeInputs, monitorConnections);\nconst createNativeAudioWorkletNode = createNativeAudioWorkletNodeFactory(createInvalidStateError, createNativeAudioWorkletNodeFaker, createNativeGainNode, createNotSupportedError, monitorConnections);\nconst createAudioWorkletNodeRenderer = createAudioWorkletNodeRendererFactory(connectAudioParam, connectMultipleOutputs, createNativeAudioBufferSourceNode, createNativeChannelMergerNode, createNativeChannelSplitterNode, createNativeConstantSourceNode, createNativeGainNode, deleteUnrenderedAudioWorkletNode, disconnectMultipleOutputs, exposeCurrentFrameAndCurrentTime, getNativeAudioNode, nativeAudioWorkletNodeConstructor, nativeOfflineAudioContextConstructor, renderAutomation, renderInputsOfAudioNode, renderNativeOfflineAudioContext);\nconst getBackupOfflineAudioContext = createGetBackupOfflineAudioContext(backupOfflineAudioContextStore);\nconst setActiveAudioWorkletNodeInputs = createSetActiveAudioWorkletNodeInputs(activeAudioWorkletNodeInputsStore);\n// The AudioWorkletNode constructor is only available in a SecureContext.\nconst audioWorkletNodeConstructor = isSecureContext\n    ? createAudioWorkletNodeConstructor(addUnrenderedAudioWorkletNode, audioNodeConstructor, createAudioParam, createAudioWorkletNodeRenderer, createNativeAudioWorkletNode, getAudioNodeConnections, getBackupOfflineAudioContext, getNativeContext, isNativeOfflineAudioContext, nativeAudioWorkletNodeConstructor, sanitizeAudioWorkletNodeOptions, setActiveAudioWorkletNodeInputs, testAudioWorkletNodeOptionsClonability, wrapEventListener)\n    : undefined;\nexport { audioWorkletNodeConstructor as AudioWorkletNode };\nexport { biquadFilterNodeConstructor as BiquadFilterNode };\nexport { channelMergerNodeConstructor as ChannelMergerNode };\nexport { channelSplitterNodeConstructor as ChannelSplitterNode };\nexport { convolverNodeConstructor as ConvolverNode };\nexport { constantSourceNodeConstructor as ConstantSourceNode };\nexport { delayNodeConstructor as DelayNode };\nexport { dynamicsCompressorNodeConstructor as DynamicsCompressorNode };\nexport { gainNodeConstructor as GainNode };\nexport { iIRFilterNodeConstructor as IIRFilterNode };\nexport { mediaElementAudioSourceNodeConstructor as MediaElementAudioSourceNode };\nexport { mediaStreamAudioDestinationNodeConstructor as MediaStreamAudioDestinationNode };\nexport { mediaStreamAudioSourceNodeConstructor as MediaStreamAudioSourceNode };\nexport { mediaStreamTrackAudioSourceNodeConstructor as MediaStreamTrackAudioSourceNode };\nconst minimalAudioContextConstructor = createMinimalAudioContextConstructor(createInvalidStateError, createNotSupportedError, createUnknownError, minimalBaseAudioContextConstructor, nativeAudioContextConstructor);\nexport { minimalAudioContextConstructor as MinimalAudioContext };\nconst createNativeOfflineAudioContext = createCreateNativeOfflineAudioContext(createNotSupportedError, nativeOfflineAudioContextConstructor);\nconst startRendering = createStartRendering(audioBufferStore, cacheTestResult, getAudioNodeRenderer, getUnrenderedAudioWorkletNodes, renderNativeOfflineAudioContext, testAudioBufferCopyChannelMethodsOutOfBoundsSupport, wrapAudioBufferCopyChannelMethods, wrapAudioBufferCopyChannelMethodsOutOfBounds);\nconst minimalOfflineAudioContextConstructor = createMinimalOfflineAudioContextConstructor(cacheTestResult, createInvalidStateError, createNativeOfflineAudioContext, minimalBaseAudioContextConstructor, startRendering);\nexport { minimalOfflineAudioContextConstructor as MinimalOfflineAudioContext };\nconst offlineAudioContextConstructor = createOfflineAudioContextConstructor(baseAudioContextConstructor, cacheTestResult, createInvalidStateError, createNativeOfflineAudioContext, startRendering);\nexport { offlineAudioContextConstructor as OfflineAudioContext };\nexport { oscillatorNodeConstructor as OscillatorNode };\nexport { pannerNodeConstructor as PannerNode };\nexport { periodicWaveConstructor as PeriodicWave };\nexport { stereoPannerNodeConstructor as StereoPannerNode };\nexport { waveShaperNodeConstructor as WaveShaperNode };\nexport const isAnyAudioContext = createIsAnyAudioContext(CONTEXT_STORE, isNativeAudioContext);\nexport const isAnyAudioNode = createIsAnyAudioNode(AUDIO_NODE_STORE, isNativeAudioNode);\nexport const isAnyAudioParam = createIsAnyAudioParam(AUDIO_PARAM_STORE, isNativeAudioParam);\nexport const isAnyOfflineAudioContext = createIsAnyOfflineAudioContext(CONTEXT_STORE, isNativeOfflineAudioContext);\nexport const isSupported = () => createIsSupportedPromise(cacheTestResult, createTestAudioBufferCopyChannelMethodsSubarraySupport(nativeOfflineAudioContextConstructor), createTestAudioContextCloseMethodSupport(nativeAudioContextConstructor), createTestAudioContextDecodeAudioDataMethodTypeErrorSupport(nativeOfflineAudioContextConstructor), createTestAudioContextOptionsSupport(nativeAudioContextConstructor), createTestAudioNodeConnectMethodSupport(nativeOfflineAudioContextConstructor), createTestAudioWorkletProcessorNoOutputsSupport(nativeAudioWorkletNodeConstructor, nativeOfflineAudioContextConstructor), createTestChannelMergerNodeChannelCountSupport(nativeOfflineAudioContextConstructor), createTestConstantSourceNodeAccurateSchedulingSupport(nativeOfflineAudioContextConstructor), createTestConvolverNodeBufferReassignabilitySupport(nativeOfflineAudioContextConstructor), createTestConvolverNodeChannelCountSupport(nativeOfflineAudioContextConstructor), testDomExceptionConstructorSupport, createTestIsSecureContextSupport(window), createTestMediaStreamAudioSourceNodeMediaStreamWithoutAudioTrackSupport(nativeAudioContextConstructor), createTestStereoPannerNodeDefaultValueSupport(nativeOfflineAudioContextConstructor), testTransferablesSupport);\n//# sourceMappingURL=module.js.map","/**\n * Test if the arg is undefined\n */\nexport function isUndef(arg) {\n    return arg === undefined;\n}\n/**\n * Test if the arg is not undefined\n */\nexport function isDefined(arg) {\n    return arg !== undefined;\n}\n/**\n * Test if the arg is a function\n */\nexport function isFunction(arg) {\n    return typeof arg === \"function\";\n}\n/**\n * Test if the argument is a number.\n */\nexport function isNumber(arg) {\n    return typeof arg === \"number\";\n}\n/**\n * Test if the given argument is an object literal (i.e. `{}`);\n */\nexport function isObject(arg) {\n    return (Object.prototype.toString.call(arg) === \"[object Object]\" &&\n        arg.constructor === Object);\n}\n/**\n * Test if the argument is a boolean.\n */\nexport function isBoolean(arg) {\n    return typeof arg === \"boolean\";\n}\n/**\n * Test if the argument is an Array\n */\nexport function isArray(arg) {\n    return Array.isArray(arg);\n}\n/**\n * Test if the argument is a string.\n */\nexport function isString(arg) {\n    return typeof arg === \"string\";\n}\n/**\n * Test if the argument is in the form of a note in scientific pitch notation.\n * e.g. \"C4\"\n */\nexport function isNote(arg) {\n    return isString(arg) && /^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(arg);\n}\n//# sourceMappingURL=TypeCheck.js.map","import { isUndef } from \"./TypeCheck.js\";\n/**\n * Assert that the statement is true, otherwise invoke the error.\n * @param statement\n * @param error The message which is passed into an Error\n */\nexport function assert(statement, error) {\n    if (!statement) {\n        throw new Error(error);\n    }\n}\n/**\n * Make sure that the given value is within the range\n */\nexport function assertRange(value, gte, lte = Infinity) {\n    if (!(gte <= value && value <= lte)) {\n        throw new RangeError(`Value must be within [${gte}, ${lte}], got: ${value}`);\n    }\n}\n/**\n * Warn if the context is not running.\n */\nexport function assertContextRunning(context) {\n    // add a warning if the context is not started\n    if (!context.isOffline && context.state !== \"running\") {\n        warn('The AudioContext is \"suspended\". Invoke Tone.start() from a user action to start the audio.');\n    }\n}\n/**\n * If it is currently inside a scheduled callback\n */\nlet isInsideScheduledCallback = false;\nlet printedScheduledWarning = false;\n/**\n * Notify that the following block of code is occurring inside a Transport callback.\n */\nexport function enterScheduledCallback(insideCallback) {\n    isInsideScheduledCallback = insideCallback;\n}\n/**\n * Make sure that a time was passed into\n */\nexport function assertUsedScheduleTime(time) {\n    if (isUndef(time) &&\n        isInsideScheduledCallback &&\n        !printedScheduledWarning) {\n        printedScheduledWarning = true;\n        warn(\"Events scheduled inside of scheduled callbacks should use the passed in scheduling time. See https://github.com/Tonejs/Tone.js/wiki/Accurate-Timing\");\n    }\n}\n/**\n * The default logger is the console\n */\nlet defaultLogger = console;\n/**\n * Set the logging interface\n */\nexport function setLogger(logger) {\n    defaultLogger = logger;\n}\n/**\n * Log anything\n */\nexport function log(...args) {\n    defaultLogger.log(...args);\n}\n/**\n * Warn anything\n */\nexport function warn(...args) {\n    defaultLogger.warn(...args);\n}\n//# sourceMappingURL=Debug.js.map","import { AudioContext as stdAudioContext, AudioWorkletNode as stdAudioWorkletNode, OfflineAudioContext as stdOfflineAudioContext, } from \"standardized-audio-context\";\nimport { assert } from \"../util/Debug.js\";\nimport { isDefined } from \"../util/TypeCheck.js\";\n/**\n * Create a new AudioContext\n */\nexport function createAudioContext(options) {\n    return new stdAudioContext(options);\n}\n/**\n * Create a new OfflineAudioContext\n */\nexport function createOfflineAudioContext(channels, length, sampleRate) {\n    return new stdOfflineAudioContext(channels, length, sampleRate);\n}\n/**\n * A reference to the window object\n * @hidden\n */\nexport const theWindow = typeof self === \"object\" ? self : null;\n/**\n * If the browser has a window object which has an AudioContext\n * @hidden\n */\nexport const hasAudioContext = theWindow &&\n    (theWindow.hasOwnProperty(\"AudioContext\") ||\n        theWindow.hasOwnProperty(\"webkitAudioContext\"));\nexport function createAudioWorkletNode(context, name, options) {\n    assert(isDefined(stdAudioWorkletNode), \"AudioWorkletNode only works in a secure context (https or localhost)\");\n    return new (context instanceof (theWindow === null || theWindow === void 0 ? void 0 : theWindow.BaseAudioContext)\n        ? theWindow === null || theWindow === void 0 ? void 0 : theWindow.AudioWorkletNode\n        : stdAudioWorkletNode)(context, name, options);\n}\n/**\n * This promise resolves to a boolean which indicates if the\n * functionality is supported within the currently used browse.\n * Taken from [standardized-audio-context](https://github.com/chrisguttandin/standardized-audio-context#issupported)\n */\nexport { isSupported as supported } from \"standardized-audio-context\";\n//# sourceMappingURL=AudioContext.js.map","/**\n * A class which provides a reliable callback using either\n * a Web Worker, or if that isn't supported, falls back to setTimeout.\n */\nexport class Ticker {\n    constructor(callback, type, updateInterval, contextSampleRate) {\n        this._callback = callback;\n        this._type = type;\n        this._minimumUpdateInterval = Math.max(128 / (contextSampleRate || 44100), 0.001);\n        this.updateInterval = updateInterval;\n        // create the clock source for the first time\n        this._createClock();\n    }\n    /**\n     * Generate a web worker\n     */\n    _createWorker() {\n        const blob = new Blob([\n            /* javascript */ `\n\t\t\t// the initial timeout time\n\t\t\tlet timeoutTime =  ${(this._updateInterval * 1000).toFixed(1)};\n\t\t\t// onmessage callback\n\t\t\tself.onmessage = function(msg){\n\t\t\t\ttimeoutTime = parseInt(msg.data);\n\t\t\t};\n\t\t\t// the tick function which posts a message\n\t\t\t// and schedules a new tick\n\t\t\tfunction tick(){\n\t\t\t\tsetTimeout(tick, timeoutTime);\n\t\t\t\tself.postMessage('tick');\n\t\t\t}\n\t\t\t// call tick initially\n\t\t\ttick();\n\t\t\t`,\n        ], { type: \"text/javascript\" });\n        const blobUrl = URL.createObjectURL(blob);\n        const worker = new Worker(blobUrl);\n        worker.onmessage = this._callback.bind(this);\n        this._worker = worker;\n    }\n    /**\n     * Create a timeout loop\n     */\n    _createTimeout() {\n        this._timeout = setTimeout(() => {\n            this._createTimeout();\n            this._callback();\n        }, this._updateInterval * 1000);\n    }\n    /**\n     * Create the clock source.\n     */\n    _createClock() {\n        if (this._type === \"worker\") {\n            try {\n                this._createWorker();\n            }\n            catch (e) {\n                // workers not supported, fallback to timeout\n                this._type = \"timeout\";\n                this._createClock();\n            }\n        }\n        else if (this._type === \"timeout\") {\n            this._createTimeout();\n        }\n    }\n    /**\n     * Clean up the current clock source\n     */\n    _disposeClock() {\n        if (this._timeout) {\n            clearTimeout(this._timeout);\n        }\n        if (this._worker) {\n            this._worker.terminate();\n            this._worker.onmessage = null;\n        }\n    }\n    /**\n     * The rate in seconds the ticker will update\n     */\n    get updateInterval() {\n        return this._updateInterval;\n    }\n    set updateInterval(interval) {\n        var _a;\n        this._updateInterval = Math.max(interval, this._minimumUpdateInterval);\n        if (this._type === \"worker\") {\n            (_a = this._worker) === null || _a === void 0 ? void 0 : _a.postMessage(this._updateInterval * 1000);\n        }\n    }\n    /**\n     * The type of the ticker, either a worker or a timeout\n     */\n    get type() {\n        return this._type;\n    }\n    set type(type) {\n        this._disposeClock();\n        this._type = type;\n        this._createClock();\n    }\n    /**\n     * Clean up\n     */\n    dispose() {\n        this._disposeClock();\n    }\n}\n//# sourceMappingURL=Ticker.js.map","import { AudioBuffer, isAnyAudioContext, isAnyAudioNode, isAnyAudioParam, isAnyOfflineAudioContext, } from \"standardized-audio-context\";\n/**\n * Test if the given value is an instanceof AudioParam\n */\nexport function isAudioParam(arg) {\n    return isAnyAudioParam(arg);\n}\n/**\n * Test if the given value is an instanceof AudioNode\n */\nexport function isAudioNode(arg) {\n    return isAnyAudioNode(arg);\n}\n/**\n * Test if the arg is instanceof an OfflineAudioContext\n */\nexport function isOfflineAudioContext(arg) {\n    return isAnyOfflineAudioContext(arg);\n}\n/**\n * Test if the arg is an instanceof AudioContext\n */\nexport function isAudioContext(arg) {\n    return isAnyAudioContext(arg);\n}\n/**\n * Test if the arg is instanceof an AudioBuffer\n */\nexport function isAudioBuffer(arg) {\n    return arg instanceof AudioBuffer;\n}\n//# sourceMappingURL=AdvancedTypeCheck.js.map","import { isAudioBuffer, isAudioNode, isAudioParam, } from \"./AdvancedTypeCheck.js\";\nimport { isDefined, isObject, isUndef } from \"./TypeCheck.js\";\n/**\n * Some objects should not be merged\n */\nfunction noCopy(key, arg) {\n    return (key === \"value\" ||\n        isAudioParam(arg) ||\n        isAudioNode(arg) ||\n        isAudioBuffer(arg));\n}\n/**\n * Recursively merge an object\n * @param target the object to merge into\n * @param sources the source objects to merge\n */\nexport function deepMerge(target, ...sources) {\n    if (!sources.length) {\n        return target;\n    }\n    const source = sources.shift();\n    if (isObject(target) && isObject(source)) {\n        for (const key in source) {\n            if (noCopy(key, source[key])) {\n                target[key] = source[key];\n            }\n            else if (isObject(source[key])) {\n                if (!target[key]) {\n                    Object.assign(target, { [key]: {} });\n                }\n                deepMerge(target[key], source[key]);\n            }\n            else {\n                Object.assign(target, { [key]: source[key] });\n            }\n        }\n    }\n    // @ts-ignore\n    return deepMerge(target, ...sources);\n}\n/**\n * Returns true if the two arrays have the same value for each of the elements\n */\nexport function deepEquals(arrayA, arrayB) {\n    return (arrayA.length === arrayB.length &&\n        arrayA.every((element, index) => arrayB[index] === element));\n}\n/**\n * Convert an args array into an object.\n * @internal\n */\nexport function optionsFromArguments(defaults, argsArray, keys = [], objKey) {\n    const opts = {};\n    const args = Array.from(argsArray);\n    // if the first argument is an object and has an object key\n    if (isObject(args[0]) && objKey && !Reflect.has(args[0], objKey)) {\n        // if it's not part of the defaults\n        const partOfDefaults = Object.keys(args[0]).some((key) => Reflect.has(defaults, key));\n        if (!partOfDefaults) {\n            // merge that key\n            deepMerge(opts, { [objKey]: args[0] });\n            // remove the obj key from the keys\n            keys.splice(keys.indexOf(objKey), 1);\n            // shift the first argument off\n            args.shift();\n        }\n    }\n    if (args.length === 1 && isObject(args[0])) {\n        deepMerge(opts, args[0]);\n    }\n    else {\n        for (let i = 0; i < keys.length; i++) {\n            if (isDefined(args[i])) {\n                opts[keys[i]] = args[i];\n            }\n        }\n    }\n    return deepMerge(defaults, opts);\n}\n/**\n * Return this instances default values by calling Constructor.getDefaults()\n */\nexport function getDefaultsFromInstance(instance) {\n    return instance.constructor.getDefaults();\n}\n/**\n * Returns the fallback if the given object is undefined.\n * Take an array of arguments and return a formatted options object.\n * @internal\n */\nexport function defaultArg(given, fallback) {\n    if (isUndef(given)) {\n        return fallback;\n    }\n    else {\n        return given;\n    }\n}\n/**\n * Remove all of the properties belonging to omit from obj.\n */\nexport function omitFromObject(obj, omit) {\n    omit.forEach((prop) => {\n        if (Reflect.has(obj, prop)) {\n            delete obj[prop];\n        }\n    });\n    return obj;\n}\n//# sourceMappingURL=Defaults.js.map","/**\n * Tone.js\n * @author Yotam Mann\n * @license http://opensource.org/licenses/MIT MIT License\n * @copyright 2014-2024 Yotam Mann\n */\nimport { version } from \"../version.js\";\nimport { theWindow } from \"./context/AudioContext.js\";\nimport { log } from \"./util/Debug.js\";\n/**\n * Tone is the base class of all other classes.\n *\n * @category Core\n * @constructor\n */\nexport class Tone {\n    constructor() {\n        //-------------------------------------\n        // \tDEBUGGING\n        //-------------------------------------\n        /**\n         * Set this debug flag to log all events that happen in this class.\n         */\n        this.debug = false;\n        //-------------------------------------\n        // \tDISPOSING\n        //-------------------------------------\n        /**\n         * Indicates if the instance was disposed\n         */\n        this._wasDisposed = false;\n    }\n    /**\n     * Returns all of the default options belonging to the class.\n     */\n    static getDefaults() {\n        return {};\n    }\n    /**\n     * Prints the outputs to the console log for debugging purposes.\n     * Prints the contents only if either the object has a property\n     * called `debug` set to true, or a variable called TONE_DEBUG_CLASS\n     * is set to the name of the class.\n     * @example\n     * const osc = new Tone.Oscillator();\n     * // prints all logs originating from this oscillator\n     * osc.debug = true;\n     * // calls to start/stop will print in the console\n     * osc.start();\n     */\n    log(...args) {\n        // if the object is either set to debug = true\n        // or if there is a string on the Tone.global.with the class name\n        if (this.debug ||\n            (theWindow && this.toString() === theWindow.TONE_DEBUG_CLASS)) {\n            log(this, ...args);\n        }\n    }\n    /**\n     * disconnect and dispose.\n     */\n    dispose() {\n        this._wasDisposed = true;\n        return this;\n    }\n    /**\n     * Indicates if the instance was disposed. 'Disposing' an\n     * instance means that all of the Web Audio nodes that were\n     * created for the instance are disconnected and freed for garbage collection.\n     */\n    get disposed() {\n        return this._wasDisposed;\n    }\n    /**\n     * Convert the class to a string\n     * @example\n     * const osc = new Tone.Oscillator();\n     * console.log(osc.toString());\n     */\n    toString() {\n        return this.name;\n    }\n}\n/**\n * The version number semver\n */\nTone.version = version;\n//# sourceMappingURL=Tone.js.map","/**\n * The threshold for correctness for operators. Less than one sample even\n * at very high sampling rates (e.g. `1e-6 < 1 / 192000`).\n */\nconst EPSILON = 1e-6;\n/**\n * Test if A is greater than B\n */\nexport function GT(a, b) {\n    return a > b + EPSILON;\n}\n/**\n * Test if A is greater than or equal to B\n */\nexport function GTE(a, b) {\n    return GT(a, b) || EQ(a, b);\n}\n/**\n * Test if A is less than B\n */\nexport function LT(a, b) {\n    return a + EPSILON < b;\n}\n/**\n * Test if A is less than B\n */\nexport function EQ(a, b) {\n    return Math.abs(a - b) < EPSILON;\n}\n/**\n * Clamp the value within the given range\n */\nexport function clamp(value, min, max) {\n    return Math.max(Math.min(value, max), min);\n}\n//# sourceMappingURL=Math.js.map","import { Tone } from \"../Tone.js\";\nimport { optionsFromArguments } from \"./Defaults.js\";\nimport { assert } from \"./Debug.js\";\nimport { EQ, GT, GTE, LT } from \"./Math.js\";\n/**\n * A Timeline class for scheduling and maintaining state\n * along a timeline. All events must have a \"time\" property.\n * Internally, events are stored in time order for fast\n * retrieval.\n * @internal\n */\nexport class Timeline extends Tone {\n    constructor() {\n        super();\n        this.name = \"Timeline\";\n        /**\n         * The array of scheduled timeline events\n         */\n        this._timeline = [];\n        const options = optionsFromArguments(Timeline.getDefaults(), arguments, [\"memory\"]);\n        this.memory = options.memory;\n        this.increasing = options.increasing;\n    }\n    static getDefaults() {\n        return {\n            memory: Infinity,\n            increasing: false,\n        };\n    }\n    /**\n     * The number of items in the timeline.\n     */\n    get length() {\n        return this._timeline.length;\n    }\n    /**\n     * Insert an event object onto the timeline. Events must have a \"time\" attribute.\n     * @param event  The event object to insert into the timeline.\n     */\n    add(event) {\n        // the event needs to have a time attribute\n        assert(Reflect.has(event, \"time\"), \"Timeline: events must have a time attribute\");\n        event.time = event.time.valueOf();\n        if (this.increasing && this.length) {\n            const lastValue = this._timeline[this.length - 1];\n            assert(GTE(event.time, lastValue.time), \"The time must be greater than or equal to the last scheduled time\");\n            this._timeline.push(event);\n        }\n        else {\n            const index = this._search(event.time);\n            this._timeline.splice(index + 1, 0, event);\n        }\n        // if the length is more than the memory, remove the previous ones\n        if (this.length > this.memory) {\n            const diff = this.length - this.memory;\n            this._timeline.splice(0, diff);\n        }\n        return this;\n    }\n    /**\n     * Remove an event from the timeline.\n     * @param  {Object}  event  The event object to remove from the list.\n     * @returns {Timeline} this\n     */\n    remove(event) {\n        const index = this._timeline.indexOf(event);\n        if (index !== -1) {\n            this._timeline.splice(index, 1);\n        }\n        return this;\n    }\n    /**\n     * Get the nearest event whose time is less than or equal to the given time.\n     * @param  time  The time to query.\n     */\n    get(time, param = \"time\") {\n        const index = this._search(time, param);\n        if (index !== -1) {\n            return this._timeline[index];\n        }\n        else {\n            return null;\n        }\n    }\n    /**\n     * Return the first event in the timeline without removing it\n     * @returns {Object} The first event object\n     * @deprecated\n     */\n    peek() {\n        return this._timeline[0];\n    }\n    /**\n     * Return the first event in the timeline and remove it\n     * @deprecated\n     */\n    shift() {\n        return this._timeline.shift();\n    }\n    /**\n     * Get the event which is scheduled after the given time.\n     * @param  time  The time to query.\n     */\n    getAfter(time, param = \"time\") {\n        const index = this._search(time, param);\n        if (index + 1 < this._timeline.length) {\n            return this._timeline[index + 1];\n        }\n        else {\n            return null;\n        }\n    }\n    /**\n     * Get the event before the event at the given time.\n     * @param  time  The time to query.\n     */\n    getBefore(time) {\n        const len = this._timeline.length;\n        // if it's after the last item, return the last item\n        if (len > 0 && this._timeline[len - 1].time < time) {\n            return this._timeline[len - 1];\n        }\n        const index = this._search(time);\n        if (index - 1 >= 0) {\n            return this._timeline[index - 1];\n        }\n        else {\n            return null;\n        }\n    }\n    /**\n     * Cancel events at and after the given time\n     * @param  after  The time to query.\n     */\n    cancel(after) {\n        if (this._timeline.length > 1) {\n            let index = this._search(after);\n            if (index >= 0) {\n                if (EQ(this._timeline[index].time, after)) {\n                    // get the first item with that time\n                    for (let i = index; i >= 0; i--) {\n                        if (EQ(this._timeline[i].time, after)) {\n                            index = i;\n                        }\n                        else {\n                            break;\n                        }\n                    }\n                    this._timeline = this._timeline.slice(0, index);\n                }\n                else {\n                    this._timeline = this._timeline.slice(0, index + 1);\n                }\n            }\n            else {\n                this._timeline = [];\n            }\n        }\n        else if (this._timeline.length === 1) {\n            // the first item's time\n            if (GTE(this._timeline[0].time, after)) {\n                this._timeline = [];\n            }\n        }\n        return this;\n    }\n    /**\n     * Cancel events before or equal to the given time.\n     * @param  time  The time to cancel before.\n     */\n    cancelBefore(time) {\n        const index = this._search(time);\n        if (index >= 0) {\n            this._timeline = this._timeline.slice(index + 1);\n        }\n        return this;\n    }\n    /**\n     * Returns the previous event if there is one. null otherwise\n     * @param  event The event to find the previous one of\n     * @return The event right before the given event\n     */\n    previousEvent(event) {\n        const index = this._timeline.indexOf(event);\n        if (index > 0) {\n            return this._timeline[index - 1];\n        }\n        else {\n            return null;\n        }\n    }\n    /**\n     * Does a binary search on the timeline array and returns the\n     * nearest event index whose time is after or equal to the given time.\n     * If a time is searched before the first index in the timeline, -1 is returned.\n     * If the time is after the end, the index of the last item is returned.\n     */\n    _search(time, param = \"time\") {\n        if (this._timeline.length === 0) {\n            return -1;\n        }\n        let beginning = 0;\n        const len = this._timeline.length;\n        let end = len;\n        if (len > 0 && this._timeline[len - 1][param] <= time) {\n            return len - 1;\n        }\n        while (beginning < end) {\n            // calculate the midpoint for roughly equal partition\n            let midPoint = Math.floor(beginning + (end - beginning) / 2);\n            const event = this._timeline[midPoint];\n            const nextEvent = this._timeline[midPoint + 1];\n            if (EQ(event[param], time)) {\n                // choose the last one that has the same time\n                for (let i = midPoint; i < this._timeline.length; i++) {\n                    const testEvent = this._timeline[i];\n                    if (EQ(testEvent[param], time)) {\n                        midPoint = i;\n                    }\n                    else {\n                        break;\n                    }\n                }\n                return midPoint;\n            }\n            else if (LT(event[param], time) && GT(nextEvent[param], time)) {\n                return midPoint;\n            }\n            else if (GT(event[param], time)) {\n                // search lower\n                end = midPoint;\n            }\n            else {\n                // search upper\n                beginning = midPoint + 1;\n            }\n        }\n        return -1;\n    }\n    /**\n     * Internal iterator. Applies extra safety checks for\n     * removing items from the array.\n     */\n    _iterate(callback, lowerBound = 0, upperBound = this._timeline.length - 1) {\n        this._timeline.slice(lowerBound, upperBound + 1).forEach(callback);\n    }\n    /**\n     * Iterate over everything in the array\n     * @param  callback The callback to invoke with every item\n     */\n    forEach(callback) {\n        this._iterate(callback);\n        return this;\n    }\n    /**\n     * Iterate over everything in the array at or before the given time.\n     * @param  time The time to check if items are before\n     * @param  callback The callback to invoke with every item\n     */\n    forEachBefore(time, callback) {\n        // iterate over the items in reverse so that removing an item doesn't break things\n        const upperBound = this._search(time);\n        if (upperBound !== -1) {\n            this._iterate(callback, 0, upperBound);\n        }\n        return this;\n    }\n    /**\n     * Iterate over everything in the array after the given time.\n     * @param  time The time to check if items are before\n     * @param  callback The callback to invoke with every item\n     */\n    forEachAfter(time, callback) {\n        // iterate over the items in reverse so that removing an item doesn't break things\n        const lowerBound = this._search(time);\n        this._iterate(callback, lowerBound + 1);\n        return this;\n    }\n    /**\n     * Iterate over everything in the array between the startTime and endTime.\n     * The timerange is inclusive of the startTime, but exclusive of the endTime.\n     * range = [startTime, endTime).\n     * @param  startTime The time to check if items are before\n     * @param  endTime The end of the test interval.\n     * @param  callback The callback to invoke with every item\n     */\n    forEachBetween(startTime, endTime, callback) {\n        let lowerBound = this._search(startTime);\n        let upperBound = this._search(endTime);\n        if (lowerBound !== -1 && upperBound !== -1) {\n            if (this._timeline[lowerBound].time !== startTime) {\n                lowerBound += 1;\n            }\n            // exclusive of the end time\n            if (this._timeline[upperBound].time === endTime) {\n                upperBound -= 1;\n            }\n            this._iterate(callback, lowerBound, upperBound);\n        }\n        else if (lowerBound === -1) {\n            this._iterate(callback, 0, upperBound);\n        }\n        return this;\n    }\n    /**\n     * Iterate over everything in the array at or after the given time. Similar to\n     * forEachAfter, but includes the item(s) at the given time.\n     * @param  time The time to check if items are before\n     * @param  callback The callback to invoke with every item\n     */\n    forEachFrom(time, callback) {\n        // iterate over the items in reverse so that removing an item doesn't break things\n        let lowerBound = this._search(time);\n        // work backwards until the event time is less than time\n        while (lowerBound >= 0 && this._timeline[lowerBound].time >= time) {\n            lowerBound--;\n        }\n        this._iterate(callback, lowerBound + 1);\n        return this;\n    }\n    /**\n     * Iterate over everything in the array at the given time\n     * @param  time The time to check if items are before\n     * @param  callback The callback to invoke with every item\n     */\n    forEachAtTime(time, callback) {\n        // iterate over the items in reverse so that removing an item doesn't break things\n        const upperBound = this._search(time);\n        if (upperBound !== -1 && EQ(this._timeline[upperBound].time, time)) {\n            let lowerBound = upperBound;\n            for (let i = upperBound; i >= 0; i--) {\n                if (EQ(this._timeline[i].time, time)) {\n                    lowerBound = i;\n                }\n                else {\n                    break;\n                }\n            }\n            this._iterate((event) => {\n                callback(event);\n            }, lowerBound, upperBound);\n        }\n        return this;\n    }\n    /**\n     * Clean up.\n     */\n    dispose() {\n        super.dispose();\n        this._timeline = [];\n        return this;\n    }\n}\n//# sourceMappingURL=Timeline.js.map","/**\n * Array of callbacks to invoke when a new context is created\n */\nconst notifyNewContext = [];\n/**\n * Used internally to setup a new Context\n */\nexport function onContextInit(cb) {\n    notifyNewContext.push(cb);\n}\n/**\n * Invoke any classes which need to also be initialized when a new context is created.\n */\nexport function initializeContext(ctx) {\n    // add any additional modules\n    notifyNewContext.forEach((cb) => cb(ctx));\n}\n/**\n * Array of callbacks to invoke when a new context is closed\n */\nconst notifyCloseContext = [];\n/**\n * Used internally to tear down a Context\n */\nexport function onContextClose(cb) {\n    notifyCloseContext.push(cb);\n}\nexport function closeContext(ctx) {\n    // remove any additional modules\n    notifyCloseContext.forEach((cb) => cb(ctx));\n}\n//# sourceMappingURL=ContextInitialization.js.map","import { Tone } from \"../Tone.js\";\nimport { isUndef } from \"./TypeCheck.js\";\n/**\n * Emitter gives classes which extend it\n * the ability to listen for and emit events.\n * Inspiration and reference from Jerome Etienne's [MicroEvent](https://github.com/jeromeetienne/microevent.js).\n * MIT (c) 2011 Jerome Etienne.\n * @category Core\n */\nexport class Emitter extends Tone {\n    constructor() {\n        super(...arguments);\n        this.name = \"Emitter\";\n    }\n    /**\n     * Bind a callback to a specific event.\n     * @param  event     The name of the event to listen for.\n     * @param  callback  The callback to invoke when the event is emitted\n     */\n    on(event, callback) {\n        // split the event\n        const events = event.split(/\\W+/);\n        events.forEach((eventName) => {\n            if (isUndef(this._events)) {\n                this._events = {};\n            }\n            if (!this._events.hasOwnProperty(eventName)) {\n                this._events[eventName] = [];\n            }\n            this._events[eventName].push(callback);\n        });\n        return this;\n    }\n    /**\n     * Bind a callback which is only invoked once\n     * @param  event     The name of the event to listen for.\n     * @param  callback  The callback to invoke when the event is emitted\n     */\n    once(event, callback) {\n        const boundCallback = (...args) => {\n            // invoke the callback\n            callback(...args);\n            // remove the event\n            this.off(event, boundCallback);\n        };\n        this.on(event, boundCallback);\n        return this;\n    }\n    /**\n     * Remove the event listener.\n     * @param  event     The event to stop listening to.\n     * @param  callback  The callback which was bound to the event with Emitter.on.\n     *                   If no callback is given, all callbacks events are removed.\n     */\n    off(event, callback) {\n        const events = event.split(/\\W+/);\n        events.forEach((eventName) => {\n            if (isUndef(this._events)) {\n                this._events = {};\n            }\n            if (this._events.hasOwnProperty(eventName)) {\n                if (isUndef(callback)) {\n                    this._events[eventName] = [];\n                }\n                else {\n                    const eventList = this._events[eventName];\n                    for (let i = eventList.length - 1; i >= 0; i--) {\n                        if (eventList[i] === callback) {\n                            eventList.splice(i, 1);\n                        }\n                    }\n                }\n            }\n        });\n        return this;\n    }\n    /**\n     * Invoke all of the callbacks bound to the event\n     * with any arguments passed in.\n     * @param  event  The name of the event.\n     * @param args The arguments to pass to the functions listening.\n     */\n    emit(event, ...args) {\n        if (this._events) {\n            if (this._events.hasOwnProperty(event)) {\n                const eventList = this._events[event].slice(0);\n                for (let i = 0, len = eventList.length; i < len; i++) {\n                    eventList[i].apply(this, args);\n                }\n            }\n        }\n        return this;\n    }\n    /**\n     * Add Emitter functions (on/off/emit) to the object\n     */\n    static mixin(constr) {\n        // instance._events = {};\n        [\"on\", \"once\", \"off\", \"emit\"].forEach((name) => {\n            const property = Object.getOwnPropertyDescriptor(Emitter.prototype, name);\n            Object.defineProperty(constr.prototype, name, property);\n        });\n    }\n    /**\n     * Clean up\n     */\n    dispose() {\n        super.dispose();\n        this._events = undefined;\n        return this;\n    }\n}\n//# sourceMappingURL=Emitter.js.map","import { Emitter } from \"../util/Emitter.js\";\nexport class BaseContext extends Emitter {\n    constructor() {\n        super(...arguments);\n        this.isOffline = false;\n    }\n    /*\n     * This is a placeholder so that JSON.stringify does not throw an error\n     * This matches what JSON.stringify(audioContext) returns on a native\n     * audioContext instance.\n     */\n    toJSON() {\n        return {};\n    }\n}\n//# sourceMappingURL=BaseContext.js.map","import { __awaiter } from \"tslib\";\nimport { Ticker } from \"../clock/Ticker.js\";\nimport { isAudioContext } from \"../util/AdvancedTypeCheck.js\";\nimport { optionsFromArguments } from \"../util/Defaults.js\";\nimport { Timeline } from \"../util/Timeline.js\";\nimport { isDefined } from \"../util/TypeCheck.js\";\nimport { createAudioContext, createAudioWorkletNode, } from \"./AudioContext.js\";\nimport { closeContext, initializeContext } from \"./ContextInitialization.js\";\nimport { BaseContext } from \"./BaseContext.js\";\nimport { assert } from \"../util/Debug.js\";\n/**\n * Wrapper around the native AudioContext.\n * @category Core\n */\nexport class Context extends BaseContext {\n    constructor() {\n        var _a, _b;\n        super();\n        this.name = \"Context\";\n        /**\n         * An object containing all of the constants AudioBufferSourceNodes\n         */\n        this._constants = new Map();\n        /**\n         * All of the setTimeout events.\n         */\n        this._timeouts = new Timeline();\n        /**\n         * The timeout id counter\n         */\n        this._timeoutIds = 0;\n        /**\n         * Private indicator if the context has been initialized\n         */\n        this._initialized = false;\n        /**\n         * Private indicator if a close() has been called on the context, since close is async\n         */\n        this._closeStarted = false;\n        /**\n         * Indicates if the context is an OfflineAudioContext or an AudioContext\n         */\n        this.isOffline = false;\n        //--------------------------------------------\n        // AUDIO WORKLET\n        //--------------------------------------------\n        /**\n         * Maps a module name to promise of the addModule method\n         */\n        this._workletPromise = null;\n        const options = optionsFromArguments(Context.getDefaults(), arguments, [\n            \"context\",\n        ]);\n        if (options.context) {\n            this._context = options.context;\n            // custom context provided, latencyHint unknown (unless explicitly provided in options)\n            this._latencyHint = ((_a = arguments[0]) === null || _a === void 0 ? void 0 : _a.latencyHint) || \"\";\n        }\n        else {\n            this._context = createAudioContext({\n                latencyHint: options.latencyHint,\n            });\n            this._latencyHint = options.latencyHint;\n        }\n        this._ticker = new Ticker(this.emit.bind(this, \"tick\"), options.clockSource, options.updateInterval, this._context.sampleRate);\n        this.on(\"tick\", this._timeoutLoop.bind(this));\n        // fwd events from the context\n        this._context.onstatechange = () => {\n            this.emit(\"statechange\", this.state);\n        };\n        // if no custom updateInterval provided, updateInterval will be derived by lookAhead setter\n        this[((_b = arguments[0]) === null || _b === void 0 ? void 0 : _b.hasOwnProperty(\"updateInterval\"))\n            ? \"_lookAhead\"\n            : \"lookAhead\"] = options.lookAhead;\n    }\n    static getDefaults() {\n        return {\n            clockSource: \"worker\",\n            latencyHint: \"interactive\",\n            lookAhead: 0.1,\n            updateInterval: 0.05,\n        };\n    }\n    /**\n     * Finish setting up the context. **You usually do not need to do this manually.**\n     */\n    initialize() {\n        if (!this._initialized) {\n            // add any additional modules\n            initializeContext(this);\n            this._initialized = true;\n        }\n        return this;\n    }\n    //---------------------------\n    // BASE AUDIO CONTEXT METHODS\n    //---------------------------\n    createAnalyser() {\n        return this._context.createAnalyser();\n    }\n    createOscillator() {\n        return this._context.createOscillator();\n    }\n    createBufferSource() {\n        return this._context.createBufferSource();\n    }\n    createBiquadFilter() {\n        return this._context.createBiquadFilter();\n    }\n    createBuffer(numberOfChannels, length, sampleRate) {\n        return this._context.createBuffer(numberOfChannels, length, sampleRate);\n    }\n    createChannelMerger(numberOfInputs) {\n        return this._context.createChannelMerger(numberOfInputs);\n    }\n    createChannelSplitter(numberOfOutputs) {\n        return this._context.createChannelSplitter(numberOfOutputs);\n    }\n    createConstantSource() {\n        return this._context.createConstantSource();\n    }\n    createConvolver() {\n        return this._context.createConvolver();\n    }\n    createDelay(maxDelayTime) {\n        return this._context.createDelay(maxDelayTime);\n    }\n    createDynamicsCompressor() {\n        return this._context.createDynamicsCompressor();\n    }\n    createGain() {\n        return this._context.createGain();\n    }\n    createIIRFilter(feedForward, feedback) {\n        // @ts-ignore\n        return this._context.createIIRFilter(feedForward, feedback);\n    }\n    createPanner() {\n        return this._context.createPanner();\n    }\n    createPeriodicWave(real, imag, constraints) {\n        return this._context.createPeriodicWave(real, imag, constraints);\n    }\n    createStereoPanner() {\n        return this._context.createStereoPanner();\n    }\n    createWaveShaper() {\n        return this._context.createWaveShaper();\n    }\n    createMediaStreamSource(stream) {\n        assert(isAudioContext(this._context), \"Not available if OfflineAudioContext\");\n        const context = this._context;\n        return context.createMediaStreamSource(stream);\n    }\n    createMediaElementSource(element) {\n        assert(isAudioContext(this._context), \"Not available if OfflineAudioContext\");\n        const context = this._context;\n        return context.createMediaElementSource(element);\n    }\n    createMediaStreamDestination() {\n        assert(isAudioContext(this._context), \"Not available if OfflineAudioContext\");\n        const context = this._context;\n        return context.createMediaStreamDestination();\n    }\n    decodeAudioData(audioData) {\n        return this._context.decodeAudioData(audioData);\n    }\n    /**\n     * The current time in seconds of the AudioContext.\n     */\n    get currentTime() {\n        return this._context.currentTime;\n    }\n    /**\n     * The current time in seconds of the AudioContext.\n     */\n    get state() {\n        return this._context.state;\n    }\n    /**\n     * The current time in seconds of the AudioContext.\n     */\n    get sampleRate() {\n        return this._context.sampleRate;\n    }\n    /**\n     * The listener\n     */\n    get listener() {\n        this.initialize();\n        return this._listener;\n    }\n    set listener(l) {\n        assert(!this._initialized, \"The listener cannot be set after initialization.\");\n        this._listener = l;\n    }\n    /**\n     * There is only one Transport per Context. It is created on initialization.\n     */\n    get transport() {\n        this.initialize();\n        return this._transport;\n    }\n    set transport(t) {\n        assert(!this._initialized, \"The transport cannot be set after initialization.\");\n        this._transport = t;\n    }\n    /**\n     * This is the Draw object for the context which is useful for synchronizing the draw frame with the Tone.js clock.\n     */\n    get draw() {\n        this.initialize();\n        return this._draw;\n    }\n    set draw(d) {\n        assert(!this._initialized, \"Draw cannot be set after initialization.\");\n        this._draw = d;\n    }\n    /**\n     * A reference to the Context's destination node.\n     */\n    get destination() {\n        this.initialize();\n        return this._destination;\n    }\n    set destination(d) {\n        assert(!this._initialized, \"The destination cannot be set after initialization.\");\n        this._destination = d;\n    }\n    /**\n     * Create an audio worklet node from a name and options. The module\n     * must first be loaded using {@link addAudioWorkletModule}.\n     */\n    createAudioWorkletNode(name, options) {\n        return createAudioWorkletNode(this.rawContext, name, options);\n    }\n    /**\n     * Add an AudioWorkletProcessor module\n     * @param url The url of the module\n     */\n    addAudioWorkletModule(url) {\n        return __awaiter(this, void 0, void 0, function* () {\n            assert(isDefined(this.rawContext.audioWorklet), \"AudioWorkletNode is only available in a secure context (https or localhost)\");\n            if (!this._workletPromise) {\n                this._workletPromise = this.rawContext.audioWorklet.addModule(url);\n            }\n            yield this._workletPromise;\n        });\n    }\n    /**\n     * Returns a promise which resolves when all of the worklets have been loaded on this context\n     */\n    workletsAreReady() {\n        return __awaiter(this, void 0, void 0, function* () {\n            (yield this._workletPromise) ? this._workletPromise : Promise.resolve();\n        });\n    }\n    //---------------------------\n    // TICKER\n    //---------------------------\n    /**\n     * How often the interval callback is invoked.\n     * This number corresponds to how responsive the scheduling\n     * can be. Setting to 0 will result in the lowest practial interval\n     * based on context properties. context.updateInterval + context.lookAhead\n     * gives you the total latency between scheduling an event and hearing it.\n     */\n    get updateInterval() {\n        return this._ticker.updateInterval;\n    }\n    set updateInterval(interval) {\n        this._ticker.updateInterval = interval;\n    }\n    /**\n     * What the source of the clock is, either \"worker\" (default),\n     * \"timeout\", or \"offline\" (none).\n     */\n    get clockSource() {\n        return this._ticker.type;\n    }\n    set clockSource(type) {\n        this._ticker.type = type;\n    }\n    /**\n     * The amount of time into the future events are scheduled. Giving Web Audio\n     * a short amount of time into the future to schedule events can reduce clicks and\n     * improve performance. This value can be set to 0 to get the lowest latency.\n     * Adjusting this value also affects the {@link updateInterval}.\n     */\n    get lookAhead() {\n        return this._lookAhead;\n    }\n    set lookAhead(time) {\n        this._lookAhead = time;\n        // if lookAhead is 0, default to .01 updateInterval\n        this.updateInterval = time ? time / 2 : 0.01;\n    }\n    /**\n     * The type of playback, which affects tradeoffs between audio\n     * output latency and responsiveness.\n     * In addition to setting the value in seconds, the latencyHint also\n     * accepts the strings \"interactive\" (prioritizes low latency),\n     * \"playback\" (prioritizes sustained playback), \"balanced\" (balances\n     * latency and performance).\n     * @example\n     * // prioritize sustained playback\n     * const context = new Tone.Context({ latencyHint: \"playback\" });\n     * // set this context as the global Context\n     * Tone.setContext(context);\n     * // the global context is gettable with Tone.getContext()\n     * console.log(Tone.getContext().latencyHint);\n     */\n    get latencyHint() {\n        return this._latencyHint;\n    }\n    /**\n     * The unwrapped AudioContext or OfflineAudioContext\n     */\n    get rawContext() {\n        return this._context;\n    }\n    /**\n     * The current audio context time plus a short {@link lookAhead}.\n     * @example\n     * setInterval(() => {\n     * \tconsole.log(\"now\", Tone.now());\n     * }, 100);\n     */\n    now() {\n        return this._context.currentTime + this._lookAhead;\n    }\n    /**\n     * The current audio context time without the {@link lookAhead}.\n     * In most cases it is better to use {@link now} instead of {@link immediate} since\n     * with {@link now} the {@link lookAhead} is applied equally to _all_ components including internal components,\n     * to making sure that everything is scheduled in sync. Mixing {@link now} and {@link immediate}\n     * can cause some timing issues. If no lookAhead is desired, you can set the {@link lookAhead} to `0`.\n     */\n    immediate() {\n        return this._context.currentTime;\n    }\n    /**\n     * Starts the audio context from a suspended state. This is required\n     * to initially start the AudioContext.\n     * @see {@link start}\n     */\n    resume() {\n        if (isAudioContext(this._context)) {\n            return this._context.resume();\n        }\n        else {\n            return Promise.resolve();\n        }\n    }\n    /**\n     * Close the context. Once closed, the context can no longer be used and\n     * any AudioNodes created from the context will be silent.\n     */\n    close() {\n        return __awaiter(this, void 0, void 0, function* () {\n            if (isAudioContext(this._context) &&\n                this.state !== \"closed\" &&\n                !this._closeStarted) {\n                this._closeStarted = true;\n                yield this._context.close();\n            }\n            if (this._initialized) {\n                closeContext(this);\n            }\n        });\n    }\n    /**\n     * **Internal** Generate a looped buffer at some constant value.\n     */\n    getConstant(val) {\n        if (this._constants.has(val)) {\n            return this._constants.get(val);\n        }\n        else {\n            const buffer = this._context.createBuffer(1, 128, this._context.sampleRate);\n            const arr = buffer.getChannelData(0);\n            for (let i = 0; i < arr.length; i++) {\n                arr[i] = val;\n            }\n            const constant = this._context.createBufferSource();\n            constant.channelCount = 1;\n            constant.channelCountMode = \"explicit\";\n            constant.buffer = buffer;\n            constant.loop = true;\n            constant.start(0);\n            this._constants.set(val, constant);\n            return constant;\n        }\n    }\n    /**\n     * Clean up. Also closes the audio context.\n     */\n    dispose() {\n        super.dispose();\n        this._ticker.dispose();\n        this._timeouts.dispose();\n        Object.keys(this._constants).map((val) => this._constants[val].disconnect());\n        this.close();\n        return this;\n    }\n    //---------------------------\n    // TIMEOUTS\n    //---------------------------\n    /**\n     * The private loop which keeps track of the context scheduled timeouts\n     * Is invoked from the clock source\n     */\n    _timeoutLoop() {\n        const now = this.now();\n        this._timeouts.forEachBefore(now, (event) => {\n            // invoke the callback\n            event.callback();\n            this._timeouts.remove(event);\n        });\n    }\n    /**\n     * A setTimeout which is guaranteed by the clock source.\n     * Also runs in the offline context.\n     * @param  fn       The callback to invoke\n     * @param  timeout  The timeout in seconds\n     * @returns ID to use when invoking Context.clearTimeout\n     */\n    setTimeout(fn, timeout) {\n        this._timeoutIds++;\n        const now = this.now();\n        this._timeouts.add({\n            callback: fn,\n            id: this._timeoutIds,\n            time: now + timeout,\n        });\n        return this._timeoutIds;\n    }\n    /**\n     * Clears a previously scheduled timeout with Tone.context.setTimeout\n     * @param  id  The ID returned from setTimeout\n     */\n    clearTimeout(id) {\n        this._timeouts.forEach((event) => {\n            if (event.id === id) {\n                this._timeouts.remove(event);\n            }\n        });\n        return this;\n    }\n    /**\n     * Clear the function scheduled by {@link setInterval}\n     */\n    clearInterval(id) {\n        return this.clearTimeout(id);\n    }\n    /**\n     * Adds a repeating event to the context's callback clock\n     */\n    setInterval(fn, interval) {\n        const id = ++this._timeoutIds;\n        const intervalFn = () => {\n            const now = this.now();\n            this._timeouts.add({\n                callback: () => {\n                    // invoke the callback\n                    fn();\n                    // invoke the event to repeat it\n                    intervalFn();\n                },\n                id,\n                time: now + interval,\n            });\n        };\n        // kick it off\n        intervalFn();\n        return id;\n    }\n}\n//# sourceMappingURL=Context.js.map","import { __awaiter } from \"tslib\";\nimport { BaseContext } from \"./BaseContext.js\";\nexport class DummyContext extends BaseContext {\n    constructor() {\n        super(...arguments);\n        this.lookAhead = 0;\n        this.latencyHint = 0;\n        this.isOffline = false;\n    }\n    //---------------------------\n    // BASE AUDIO CONTEXT METHODS\n    //---------------------------\n    createAnalyser() {\n        return {};\n    }\n    createOscillator() {\n        return {};\n    }\n    createBufferSource() {\n        return {};\n    }\n    createBiquadFilter() {\n        return {};\n    }\n    createBuffer(_numberOfChannels, _length, _sampleRate) {\n        return {};\n    }\n    createChannelMerger(_numberOfInputs) {\n        return {};\n    }\n    createChannelSplitter(_numberOfOutputs) {\n        return {};\n    }\n    createConstantSource() {\n        return {};\n    }\n    createConvolver() {\n        return {};\n    }\n    createDelay(_maxDelayTime) {\n        return {};\n    }\n    createDynamicsCompressor() {\n        return {};\n    }\n    createGain() {\n        return {};\n    }\n    createIIRFilter(_feedForward, _feedback) {\n        return {};\n    }\n    createPanner() {\n        return {};\n    }\n    createPeriodicWave(_real, _imag, _constraints) {\n        return {};\n    }\n    createStereoPanner() {\n        return {};\n    }\n    createWaveShaper() {\n        return {};\n    }\n    createMediaStreamSource(_stream) {\n        return {};\n    }\n    createMediaElementSource(_element) {\n        return {};\n    }\n    createMediaStreamDestination() {\n        return {};\n    }\n    decodeAudioData(_audioData) {\n        return Promise.resolve({});\n    }\n    //---------------------------\n    // TONE AUDIO CONTEXT METHODS\n    //---------------------------\n    createAudioWorkletNode(_name, _options) {\n        return {};\n    }\n    get rawContext() {\n        return {};\n    }\n    addAudioWorkletModule(_url) {\n        return __awaiter(this, void 0, void 0, function* () {\n            return Promise.resolve();\n        });\n    }\n    resume() {\n        return Promise.resolve();\n    }\n    setTimeout(_fn, _timeout) {\n        return 0;\n    }\n    clearTimeout(_id) {\n        return this;\n    }\n    setInterval(_fn, _interval) {\n        return 0;\n    }\n    clearInterval(_id) {\n        return this;\n    }\n    getConstant(_val) {\n        return {};\n    }\n    get currentTime() {\n        return 0;\n    }\n    get state() {\n        return {};\n    }\n    get sampleRate() {\n        return 0;\n    }\n    get listener() {\n        return {};\n    }\n    get transport() {\n        return {};\n    }\n    get draw() {\n        return {};\n    }\n    set draw(_d) { }\n    get destination() {\n        return {};\n    }\n    set destination(_d) { }\n    now() {\n        return 0;\n    }\n    immediate() {\n        return 0;\n    }\n}\n//# sourceMappingURL=DummyContext.js.map","import { isArray } from \"./TypeCheck.js\";\n/**\n * Make the property not writable using `defineProperty`. Internal use only.\n */\nexport function readOnly(target, property) {\n    if (isArray(property)) {\n        property.forEach((str) => readOnly(target, str));\n    }\n    else {\n        Object.defineProperty(target, property, {\n            enumerable: true,\n            writable: false,\n        });\n    }\n}\n/**\n * Make an attribute writeable. Internal use only.\n */\nexport function writable(target, property) {\n    if (isArray(property)) {\n        property.forEach((str) => writable(target, str));\n    }\n    else {\n        Object.defineProperty(target, property, {\n            writable: true,\n        });\n    }\n}\nexport const noOp = () => {\n    // no operation here!\n};\n//# sourceMappingURL=Interface.js.map","import { __awaiter } from \"tslib\";\nimport { getContext } from \"../Global.js\";\nimport { Tone } from \"../Tone.js\";\nimport { optionsFromArguments } from \"../util/Defaults.js\";\nimport { noOp } from \"../util/Interface.js\";\nimport { isArray, isNumber, isString } from \"../util/TypeCheck.js\";\nimport { assert } from \"../util/Debug.js\";\n/**\n * AudioBuffer loading and storage. ToneAudioBuffer is used internally by all\n * classes that make requests for audio files such as Tone.Player,\n * Tone.Sampler and Tone.Convolver.\n * @example\n * const buffer = new Tone.ToneAudioBuffer(\"https://tonejs.github.io/audio/casio/A1.mp3\", () => {\n * \tconsole.log(\"loaded\");\n * });\n * @category Core\n */\nexport class ToneAudioBuffer extends Tone {\n    constructor() {\n        super();\n        this.name = \"ToneAudioBuffer\";\n        /**\n         * Callback when the buffer is loaded.\n         */\n        this.onload = noOp;\n        const options = optionsFromArguments(ToneAudioBuffer.getDefaults(), arguments, [\"url\", \"onload\", \"onerror\"]);\n        this.reverse = options.reverse;\n        this.onload = options.onload;\n        if (isString(options.url)) {\n            // initiate the download\n            this.load(options.url).catch(options.onerror);\n        }\n        else if (options.url) {\n            this.set(options.url);\n        }\n    }\n    static getDefaults() {\n        return {\n            onerror: noOp,\n            onload: noOp,\n            reverse: false,\n        };\n    }\n    /**\n     * The sample rate of the AudioBuffer\n     */\n    get sampleRate() {\n        if (this._buffer) {\n            return this._buffer.sampleRate;\n        }\n        else {\n            return getContext().sampleRate;\n        }\n    }\n    /**\n     * Pass in an AudioBuffer or ToneAudioBuffer to set the value of this buffer.\n     */\n    set(buffer) {\n        if (buffer instanceof ToneAudioBuffer) {\n            // if it's loaded, set it\n            if (buffer.loaded) {\n                this._buffer = buffer.get();\n            }\n            else {\n                // otherwise when it's loaded, invoke it's callback\n                buffer.onload = () => {\n                    this.set(buffer);\n                    this.onload(this);\n                };\n            }\n        }\n        else {\n            this._buffer = buffer;\n        }\n        // reverse it initially\n        if (this._reversed) {\n            this._reverse();\n        }\n        return this;\n    }\n    /**\n     * The audio buffer stored in the object.\n     */\n    get() {\n        return this._buffer;\n    }\n    /**\n     * Makes an fetch request for the selected url then decodes the file as an audio buffer.\n     * Invokes the callback once the audio buffer loads.\n     * @param url The url of the buffer to load. filetype support depends on the browser.\n     * @returns A Promise which resolves with this ToneAudioBuffer\n     */\n    load(url) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const doneLoading = ToneAudioBuffer.load(url).then((audioBuffer) => {\n                this.set(audioBuffer);\n                // invoke the onload method\n                this.onload(this);\n            });\n            ToneAudioBuffer.downloads.push(doneLoading);\n            try {\n                yield doneLoading;\n            }\n            finally {\n                // remove the downloaded file\n                const index = ToneAudioBuffer.downloads.indexOf(doneLoading);\n                ToneAudioBuffer.downloads.splice(index, 1);\n            }\n            return this;\n        });\n    }\n    /**\n     * clean up\n     */\n    dispose() {\n        super.dispose();\n        this._buffer = undefined;\n        return this;\n    }\n    /**\n     * Set the audio buffer from the array.\n     * To create a multichannel AudioBuffer, pass in a multidimensional array.\n     * @param array The array to fill the audio buffer\n     */\n    fromArray(array) {\n        const isMultidimensional = isArray(array) && array[0].length > 0;\n        const channels = isMultidimensional ? array.length : 1;\n        const len = isMultidimensional\n            ? array[0].length\n            : array.length;\n        const context = getContext();\n        const buffer = context.createBuffer(channels, len, context.sampleRate);\n        const multiChannelArray = !isMultidimensional && channels === 1\n            ? [array]\n            : array;\n        for (let c = 0; c < channels; c++) {\n            buffer.copyToChannel(multiChannelArray[c], c);\n        }\n        this._buffer = buffer;\n        return this;\n    }\n    /**\n     * Sums multiple channels into 1 channel\n     * @param chanNum Optionally only copy a single channel from the array.\n     */\n    toMono(chanNum) {\n        if (isNumber(chanNum)) {\n            this.fromArray(this.toArray(chanNum));\n        }\n        else {\n            let outputArray = new Float32Array(this.length);\n            const numChannels = this.numberOfChannels;\n            for (let channel = 0; channel < numChannels; channel++) {\n                const channelArray = this.toArray(channel);\n                for (let i = 0; i < channelArray.length; i++) {\n                    outputArray[i] += channelArray[i];\n                }\n            }\n            // divide by the number of channels\n            outputArray = outputArray.map((sample) => sample / numChannels);\n            this.fromArray(outputArray);\n        }\n        return this;\n    }\n    /**\n     * Get the buffer as an array. Single channel buffers will return a 1-dimensional\n     * Float32Array, and multichannel buffers will return multidimensional arrays.\n     * @param channel Optionally only copy a single channel from the array.\n     */\n    toArray(channel) {\n        if (isNumber(channel)) {\n            return this.getChannelData(channel);\n        }\n        else if (this.numberOfChannels === 1) {\n            return this.toArray(0);\n        }\n        else {\n            const ret = [];\n            for (let c = 0; c < this.numberOfChannels; c++) {\n                ret[c] = this.getChannelData(c);\n            }\n            return ret;\n        }\n    }\n    /**\n     * Returns the Float32Array representing the PCM audio data for the specific channel.\n     * @param  channel  The channel number to return\n     * @return The audio as a TypedArray\n     */\n    getChannelData(channel) {\n        if (this._buffer) {\n            return this._buffer.getChannelData(channel);\n        }\n        else {\n            return new Float32Array(0);\n        }\n    }\n    /**\n     * Cut a subsection of the array and return a buffer of the\n     * subsection. Does not modify the original buffer\n     * @param start The time to start the slice\n     * @param end The end time to slice. If none is given will default to the end of the buffer\n     */\n    slice(start, end = this.duration) {\n        assert(this.loaded, \"Buffer is not loaded\");\n        const startSamples = Math.floor(start * this.sampleRate);\n        const endSamples = Math.floor(end * this.sampleRate);\n        assert(startSamples < endSamples, \"The start time must be less than the end time\");\n        const length = endSamples - startSamples;\n        const retBuffer = getContext().createBuffer(this.numberOfChannels, length, this.sampleRate);\n        for (let channel = 0; channel < this.numberOfChannels; channel++) {\n            retBuffer.copyToChannel(this.getChannelData(channel).subarray(startSamples, endSamples), channel);\n        }\n        return new ToneAudioBuffer(retBuffer);\n    }\n    /**\n     * Reverse the buffer.\n     */\n    _reverse() {\n        if (this.loaded) {\n            for (let i = 0; i < this.numberOfChannels; i++) {\n                this.getChannelData(i).reverse();\n            }\n        }\n        return this;\n    }\n    /**\n     * If the buffer is loaded or not\n     */\n    get loaded() {\n        return this.length > 0;\n    }\n    /**\n     * The duration of the buffer in seconds.\n     */\n    get duration() {\n        if (this._buffer) {\n            return this._buffer.duration;\n        }\n        else {\n            return 0;\n        }\n    }\n    /**\n     * The length of the buffer in samples\n     */\n    get length() {\n        if (this._buffer) {\n            return this._buffer.length;\n        }\n        else {\n            return 0;\n        }\n    }\n    /**\n     * The number of discrete audio channels. Returns 0 if no buffer is loaded.\n     */\n    get numberOfChannels() {\n        if (this._buffer) {\n            return this._buffer.numberOfChannels;\n        }\n        else {\n            return 0;\n        }\n    }\n    /**\n     * Reverse the buffer.\n     */\n    get reverse() {\n        return this._reversed;\n    }\n    set reverse(rev) {\n        if (this._reversed !== rev) {\n            this._reversed = rev;\n            this._reverse();\n        }\n    }\n    /**\n     * Create a ToneAudioBuffer from the array. To create a multichannel AudioBuffer,\n     * pass in a multidimensional array.\n     * @param array The array to fill the audio buffer\n     * @return A ToneAudioBuffer created from the array\n     */\n    static fromArray(array) {\n        return new ToneAudioBuffer().fromArray(array);\n    }\n    /**\n     * Creates a ToneAudioBuffer from a URL, returns a promise which resolves to a ToneAudioBuffer\n     * @param  url The url to load.\n     * @return A promise which resolves to a ToneAudioBuffer\n     */\n    static fromUrl(url) {\n        return __awaiter(this, void 0, void 0, function* () {\n            const buffer = new ToneAudioBuffer();\n            return yield buffer.load(url);\n        });\n    }\n    /**\n     * Loads a url using fetch and returns the AudioBuffer.\n     */\n    static load(url) {\n        return __awaiter(this, void 0, void 0, function* () {\n            // make sure there is a slash between the baseUrl and the url\n            const baseUrl = ToneAudioBuffer.baseUrl === \"\" ||\n                ToneAudioBuffer.baseUrl.endsWith(\"/\")\n                ? ToneAudioBuffer.baseUrl\n                : ToneAudioBuffer.baseUrl + \"/\";\n            const response = yield fetch(baseUrl + url);\n            if (!response.ok) {\n                throw new Error(`could not load url: ${url}`);\n            }\n            const arrayBuffer = yield response.arrayBuffer();\n            const audioBuffer = yield getContext().decodeAudioData(arrayBuffer);\n            return audioBuffer;\n        });\n    }\n    /**\n     * Checks a url's extension to see if the current browser can play that file type.\n     * @param url The url/extension to test\n     * @return If the file extension can be played\n     * @static\n     * @example\n     * Tone.ToneAudioBuffer.supportsType(\"wav\"); // returns true\n     * Tone.ToneAudioBuffer.supportsType(\"path/to/file.wav\"); // returns true\n     */\n    static supportsType(url) {\n        const extensions = url.split(\".\");\n        const extension = extensions[extensions.length - 1];\n        const response = document\n            .createElement(\"audio\")\n            .canPlayType(\"audio/\" + extension);\n        return response !== \"\";\n    }\n    /**\n     * Returns a Promise which resolves when all of the buffers have loaded\n     */\n    static loaded() {\n        return __awaiter(this, void 0, void 0, function* () {\n            // this makes sure that the function is always async\n            yield Promise.resolve();\n            while (ToneAudioBuffer.downloads.length) {\n                yield ToneAudioBuffer.downloads[0];\n            }\n        });\n    }\n}\n//-------------------------------------\n// STATIC METHODS\n//-------------------------------------\n/**\n * A path which is prefixed before every url.\n */\nToneAudioBuffer.baseUrl = \"\";\n/**\n * All of the downloads\n */\nToneAudioBuffer.downloads = [];\n//# sourceMappingURL=ToneAudioBuffer.js.map","import { __awaiter } from \"tslib\";\nimport { createOfflineAudioContext } from \"../context/AudioContext.js\";\nimport { Context } from \"../context/Context.js\";\nimport { isOfflineAudioContext } from \"../util/AdvancedTypeCheck.js\";\nimport { ToneAudioBuffer } from \"./ToneAudioBuffer.js\";\n/**\n * Wrapper around the OfflineAudioContext\n * @category Core\n * @example\n * // generate a single channel, 0.5 second buffer\n * const context = new Tone.OfflineContext(1, 0.5, 44100);\n * const osc = new Tone.Oscillator({ context });\n * context.render().then(buffer => {\n * \tconsole.log(buffer.numberOfChannels, buffer.duration);\n * });\n */\nexport class OfflineContext extends Context {\n    constructor() {\n        super({\n            clockSource: \"offline\",\n            context: isOfflineAudioContext(arguments[0])\n                ? arguments[0]\n                : createOfflineAudioContext(arguments[0], arguments[1] * arguments[2], arguments[2]),\n            lookAhead: 0,\n            updateInterval: isOfflineAudioContext(arguments[0])\n                ? 128 / arguments[0].sampleRate\n                : 128 / arguments[2],\n        });\n        this.name = \"OfflineContext\";\n        /**\n         * An artificial clock source\n         */\n        this._currentTime = 0;\n        this.isOffline = true;\n        this._duration = isOfflineAudioContext(arguments[0])\n            ? arguments[0].length / arguments[0].sampleRate\n            : arguments[1];\n    }\n    /**\n     * Override the now method to point to the internal clock time\n     */\n    now() {\n        return this._currentTime;\n    }\n    /**\n     * Same as this.now()\n     */\n    get currentTime() {\n        return this._currentTime;\n    }\n    /**\n     * Render just the clock portion of the audio context.\n     */\n    _renderClock(asynchronous) {\n        return __awaiter(this, void 0, void 0, function* () {\n            let index = 0;\n            while (this._duration - this._currentTime >= 0) {\n                // invoke all the callbacks on that time\n                this.emit(\"tick\");\n                // increment the clock in block-sized chunks\n                this._currentTime += 128 / this.sampleRate;\n                // yield once a second of audio\n                index++;\n                const yieldEvery = Math.floor(this.sampleRate / 128);\n                if (asynchronous && index % yieldEvery === 0) {\n                    yield new Promise((done) => setTimeout(done, 1));\n                }\n            }\n        });\n    }\n    /**\n     * Render the output of the OfflineContext\n     * @param asynchronous If the clock should be rendered asynchronously, which will not block the main thread, but be slightly slower.\n     */\n    render() {\n        return __awaiter(this, arguments, void 0, function* (asynchronous = true) {\n            yield this.workletsAreReady();\n            yield this._renderClock(asynchronous);\n            const buffer = yield this._context.startRendering();\n            return new ToneAudioBuffer(buffer);\n        });\n    }\n    /**\n     * Close the context\n     */\n    close() {\n        return Promise.resolve();\n    }\n}\n//# sourceMappingURL=OfflineContext.js.map","import { version } from \"../version.js\";\nimport { hasAudioContext, theWindow, } from \"./context/AudioContext.js\";\nimport { Context } from \"./context/Context.js\";\nimport { DummyContext } from \"./context/DummyContext.js\";\nimport { OfflineContext } from \"./context/OfflineContext.js\";\nimport { isAudioContext, isOfflineAudioContext, } from \"./util/AdvancedTypeCheck.js\";\n/**\n * This dummy context is used to avoid throwing immediate errors when importing in Node.js\n */\nconst dummyContext = new DummyContext();\n/**\n * The global audio context which is getable and assignable through\n * getContext and setContext\n */\nlet globalContext = dummyContext;\n/**\n * Returns the default system-wide {@link Context}\n * @category Core\n */\nexport function getContext() {\n    if (globalContext === dummyContext && hasAudioContext) {\n        setContext(new Context());\n    }\n    return globalContext;\n}\n/**\n * Set the default audio context\n * @param context\n * @param disposeOld Pass `true` if you don't need the old context to dispose it.\n * @category Core\n */\nexport function setContext(context, disposeOld = false) {\n    if (disposeOld) {\n        globalContext.dispose();\n    }\n    if (isAudioContext(context)) {\n        globalContext = new Context(context);\n    }\n    else if (isOfflineAudioContext(context)) {\n        globalContext = new OfflineContext(context);\n    }\n    else {\n        globalContext = context;\n    }\n}\n/**\n * Most browsers will not play _any_ audio until a user\n * clicks something (like a play button). Invoke this method\n * on a click or keypress event handler to start the audio context.\n * More about the Autoplay policy\n * [here](https://developers.google.com/web/updates/2017/09/autoplay-policy-changes#webaudio)\n * @example\n * document.querySelector(\"button\").addEventListener(\"click\", async () => {\n * \tawait Tone.start();\n * \tconsole.log(\"context started\");\n * });\n * @category Core\n */\nexport function start() {\n    return globalContext.resume();\n}\n/**\n * Log Tone.js + version in the console.\n */\nif (theWindow && !theWindow.TONE_SILENCE_LOGGING) {\n    let prefix = \"v\";\n    if (version === \"dev\") {\n        prefix = \"\";\n    }\n    const printString = ` * Tone.js ${prefix}${version} * `;\n    // eslint-disable-next-line no-console\n    console.log(`%c${printString}`, \"background: #000; color: #fff\");\n}\n//# sourceMappingURL=Global.js.map","/**\n * Equal power gain scale. Good for cross-fading.\n * @param  percent (0-1)\n */\nexport function equalPowerScale(percent) {\n    const piFactor = 0.5 * Math.PI;\n    return Math.sin(percent * piFactor);\n}\n/**\n * Convert decibels into gain.\n */\nexport function dbToGain(db) {\n    return Math.pow(10, db / 20);\n}\n/**\n * Convert gain to decibels.\n */\nexport function gainToDb(gain) {\n    return 20 * (Math.log(gain) / Math.LN10);\n}\n/**\n * Convert an interval (in semitones) to a frequency ratio.\n * @param interval the number of semitones above the base note\n * @example\n * Tone.intervalToFrequencyRatio(0); // 1\n * Tone.intervalToFrequencyRatio(12); // 2\n * Tone.intervalToFrequencyRatio(-12); // 0.5\n */\nexport function intervalToFrequencyRatio(interval) {\n    return Math.pow(2, interval / 12);\n}\n/**\n * The Global [concert tuning pitch](https://en.wikipedia.org/wiki/Concert_pitch) which is used\n * to generate all the other pitch values from notes. A4's values in Hertz.\n */\nlet A4 = 440;\nexport function getA4() {\n    return A4;\n}\nexport function setA4(freq) {\n    A4 = freq;\n}\n/**\n * Convert a frequency value to a MIDI note.\n * @param frequency The value to frequency value to convert.\n * @example\n * Tone.ftom(440); // returns 69\n */\nexport function ftom(frequency) {\n    return Math.round(ftomf(frequency));\n}\n/**\n * Convert a frequency to a floating point midi value\n */\nexport function ftomf(frequency) {\n    return 69 + 12 * Math.log2(frequency / A4);\n}\n/**\n * Convert a MIDI note to frequency value.\n * @param  midi The midi number to convert.\n * @return The corresponding frequency value\n * @example\n * Tone.mtof(69); // 440\n */\nexport function mtof(midi) {\n    return A4 * Math.pow(2, (midi - 69) / 12);\n}\n//# sourceMappingURL=Conversions.js.map","import { Tone } from \"../Tone.js\";\nimport { isDefined, isObject, isString, isUndef } from \"../util/TypeCheck.js\";\n/**\n * TimeBase is a flexible encoding of time which can be evaluated to and from a string.\n */\nexport class TimeBaseClass extends Tone {\n    /**\n     * @param context The context associated with the time value. Used to compute\n     * Transport and context-relative timing.\n     * @param  value  The time value as a number, string or object\n     * @param  units  Unit values\n     */\n    constructor(context, value, units) {\n        super();\n        /**\n         * The default units\n         */\n        this.defaultUnits = \"s\";\n        this._val = value;\n        this._units = units;\n        this.context = context;\n        this._expressions = this._getExpressions();\n    }\n    /**\n     * All of the time encoding expressions\n     */\n    _getExpressions() {\n        return {\n            hz: {\n                method: (value) => {\n                    return this._frequencyToUnits(parseFloat(value));\n                },\n                regexp: /^(\\d+(?:\\.\\d+)?)hz$/i,\n            },\n            i: {\n                method: (value) => {\n                    return this._ticksToUnits(parseInt(value, 10));\n                },\n                regexp: /^(\\d+)i$/i,\n            },\n            m: {\n                method: (value) => {\n                    return this._beatsToUnits(parseInt(value, 10) * this._getTimeSignature());\n                },\n                regexp: /^(\\d+)m$/i,\n            },\n            n: {\n                method: (value, dot) => {\n                    const numericValue = parseInt(value, 10);\n                    const scalar = dot === \".\" ? 1.5 : 1;\n                    if (numericValue === 1) {\n                        return (this._beatsToUnits(this._getTimeSignature()) *\n                            scalar);\n                    }\n                    else {\n                        return (this._beatsToUnits(4 / numericValue) *\n                            scalar);\n                    }\n                },\n                regexp: /^(\\d+)n(\\.?)$/i,\n            },\n            number: {\n                method: (value) => {\n                    return this._expressions[this.defaultUnits].method.call(this, value);\n                },\n                regexp: /^(\\d+(?:\\.\\d+)?)$/,\n            },\n            s: {\n                method: (value) => {\n                    return this._secondsToUnits(parseFloat(value));\n                },\n                regexp: /^(\\d+(?:\\.\\d+)?)s$/,\n            },\n            samples: {\n                method: (value) => {\n                    return (parseInt(value, 10) /\n                        this.context.sampleRate);\n                },\n                regexp: /^(\\d+)samples$/,\n            },\n            t: {\n                method: (value) => {\n                    const numericValue = parseInt(value, 10);\n                    return this._beatsToUnits(8 / (Math.floor(numericValue) * 3));\n                },\n                regexp: /^(\\d+)t$/i,\n            },\n            tr: {\n                method: (m, q, s) => {\n                    let total = 0;\n                    if (m && m !== \"0\") {\n                        total += this._beatsToUnits(this._getTimeSignature() * parseFloat(m));\n                    }\n                    if (q && q !== \"0\") {\n                        total += this._beatsToUnits(parseFloat(q));\n                    }\n                    if (s && s !== \"0\") {\n                        total += this._beatsToUnits(parseFloat(s) / 4);\n                    }\n                    return total;\n                },\n                regexp: /^(\\d+(?:\\.\\d+)?):(\\d+(?:\\.\\d+)?):?(\\d+(?:\\.\\d+)?)?$/,\n            },\n        };\n    }\n    //-------------------------------------\n    // \tVALUE OF\n    //-------------------------------------\n    /**\n     * Evaluate the time value. Returns the time in seconds.\n     */\n    valueOf() {\n        if (this._val instanceof TimeBaseClass) {\n            this.fromType(this._val);\n        }\n        if (isUndef(this._val)) {\n            return this._noArg();\n        }\n        else if (isString(this._val) && isUndef(this._units)) {\n            for (const units in this._expressions) {\n                if (this._expressions[units].regexp.test(this._val.trim())) {\n                    this._units = units;\n                    break;\n                }\n            }\n        }\n        else if (isObject(this._val)) {\n            let total = 0;\n            for (const typeName in this._val) {\n                if (isDefined(this._val[typeName])) {\n                    const quantity = this._val[typeName];\n                    const time = \n                    // @ts-ignore\n                    new this.constructor(this.context, typeName).valueOf() *\n                        quantity;\n                    total += time;\n                }\n            }\n            return total;\n        }\n        if (isDefined(this._units)) {\n            const expr = this._expressions[this._units];\n            const matching = this._val.toString().trim().match(expr.regexp);\n            if (matching) {\n                return expr.method.apply(this, matching.slice(1));\n            }\n            else {\n                return expr.method.call(this, this._val);\n            }\n        }\n        else if (isString(this._val)) {\n            return parseFloat(this._val);\n        }\n        else {\n            return this._val;\n        }\n    }\n    //-------------------------------------\n    // \tUNIT CONVERSIONS\n    //-------------------------------------\n    /**\n     * Returns the value of a frequency in the current units\n     */\n    _frequencyToUnits(freq) {\n        return (1 / freq);\n    }\n    /**\n     * Return the value of the beats in the current units\n     */\n    _beatsToUnits(beats) {\n        return ((60 / this._getBpm()) * beats);\n    }\n    /**\n     * Returns the value of a second in the current units\n     */\n    _secondsToUnits(seconds) {\n        return seconds;\n    }\n    /**\n     * Returns the value of a tick in the current time units\n     */\n    _ticksToUnits(ticks) {\n        return ((ticks * this._beatsToUnits(1)) / this._getPPQ());\n    }\n    /**\n     * With no arguments, return 'now'\n     */\n    _noArg() {\n        return this._now();\n    }\n    //-------------------------------------\n    // \tTEMPO CONVERSIONS\n    //-------------------------------------\n    /**\n     * Return the bpm\n     */\n    _getBpm() {\n        return this.context.transport.bpm.value;\n    }\n    /**\n     * Return the timeSignature\n     */\n    _getTimeSignature() {\n        return this.context.transport.timeSignature;\n    }\n    /**\n     * Return the PPQ or 192 if Transport is not available\n     */\n    _getPPQ() {\n        return this.context.transport.PPQ;\n    }\n    //-------------------------------------\n    // \tCONVERSION INTERFACE\n    //-------------------------------------\n    /**\n     * Coerce a time type into this units type.\n     * @param type Any time type units\n     */\n    fromType(type) {\n        this._units = undefined;\n        switch (this.defaultUnits) {\n            case \"s\":\n                this._val = type.toSeconds();\n                break;\n            case \"i\":\n                this._val = type.toTicks();\n                break;\n            case \"hz\":\n                this._val = type.toFrequency();\n                break;\n            case \"midi\":\n                this._val = type.toMidi();\n                break;\n        }\n        return this;\n    }\n    /**\n     * Return the value in hertz\n     */\n    toFrequency() {\n        return 1 / this.toSeconds();\n    }\n    /**\n     * Return the time in samples\n     */\n    toSamples() {\n        return this.toSeconds() * this.context.sampleRate;\n    }\n    /**\n     * Return the time in milliseconds.\n     */\n    toMilliseconds() {\n        return this.toSeconds() * 1000;\n    }\n}\n//# sourceMappingURL=TimeBase.js.map","import { getContext } from \"../Global.js\";\nimport { ftom } from \"./Conversions.js\";\nimport { TimeBaseClass, } from \"./TimeBase.js\";\n/**\n * TimeClass is a primitive type for encoding and decoding Time values.\n * TimeClass can be passed into the parameter of any method which takes time as an argument.\n * @param  val    The time value.\n * @param  units  The units of the value.\n * @example\n * const time = Tone.Time(\"4n\"); // a quarter note\n * @category Unit\n */\nexport class TimeClass extends TimeBaseClass {\n    constructor() {\n        super(...arguments);\n        this.name = \"TimeClass\";\n    }\n    _getExpressions() {\n        return Object.assign(super._getExpressions(), {\n            now: {\n                method: (capture) => {\n                    return (this._now() +\n                        new this.constructor(this.context, capture).valueOf());\n                },\n                regexp: /^\\+(.+)/,\n            },\n            quantize: {\n                method: (capture) => {\n                    const quantTo = new TimeClass(this.context, capture).valueOf();\n                    return this._secondsToUnits(this.context.transport.nextSubdivision(quantTo));\n                },\n                regexp: /^@(.+)/,\n            },\n        });\n    }\n    /**\n     * Quantize the time by the given subdivision. Optionally add a\n     * percentage which will move the time value towards the ideal\n     * quantized value by that percentage.\n     * @param  subdiv    The subdivision to quantize to\n     * @param  percent  Move the time value towards the quantized value by a percentage.\n     * @example\n     * Tone.Time(21).quantize(2); // returns 22\n     * Tone.Time(0.6).quantize(\"4n\", 0.5); // returns 0.55\n     */\n    quantize(subdiv, percent = 1) {\n        const subdivision = new this.constructor(this.context, subdiv).valueOf();\n        const value = this.valueOf();\n        const multiple = Math.round(value / subdivision);\n        const ideal = multiple * subdivision;\n        const diff = ideal - value;\n        return (value + diff * percent);\n    }\n    //-------------------------------------\n    // CONVERSIONS\n    //-------------------------------------\n    /**\n     * Convert a Time to Notation. The notation values are will be the\n     * closest representation between 1m to 128th note.\n     * @return {Notation}\n     * @example\n     * // if the Transport is at 120bpm:\n     * Tone.Time(2).toNotation(); // returns \"1m\"\n     */\n    toNotation() {\n        const time = this.toSeconds();\n        const testNotations = [\"1m\"];\n        for (let power = 1; power < 9; power++) {\n            const subdiv = Math.pow(2, power);\n            testNotations.push((subdiv + \"n.\"));\n            testNotations.push((subdiv + \"n\"));\n            testNotations.push((subdiv + \"t\"));\n        }\n        testNotations.push(\"0\");\n        // find the closets notation representation\n        let closest = testNotations[0];\n        let closestSeconds = new TimeClass(this.context, testNotations[0]).toSeconds();\n        testNotations.forEach((notation) => {\n            const notationSeconds = new TimeClass(this.context, notation).toSeconds();\n            if (Math.abs(notationSeconds - time) <\n                Math.abs(closestSeconds - time)) {\n                closest = notation;\n                closestSeconds = notationSeconds;\n            }\n        });\n        return closest;\n    }\n    /**\n     * Return the time encoded as Bars:Beats:Sixteenths.\n     */\n    toBarsBeatsSixteenths() {\n        const quarterTime = this._beatsToUnits(1);\n        let quarters = this.valueOf() / quarterTime;\n        quarters = parseFloat(quarters.toFixed(4));\n        const measures = Math.floor(quarters / this._getTimeSignature());\n        let sixteenths = (quarters % 1) * 4;\n        quarters = Math.floor(quarters) % this._getTimeSignature();\n        const sixteenthString = sixteenths.toString();\n        if (sixteenthString.length > 3) {\n            // the additional parseFloat removes insignificant trailing zeroes\n            sixteenths = parseFloat(parseFloat(sixteenthString).toFixed(3));\n        }\n        const progress = [measures, quarters, sixteenths];\n        return progress.join(\":\");\n    }\n    /**\n     * Return the time in ticks.\n     */\n    toTicks() {\n        const quarterTime = this._beatsToUnits(1);\n        const quarters = this.valueOf() / quarterTime;\n        return quarters * this._getPPQ();\n    }\n    /**\n     * Return the time in seconds.\n     */\n    toSeconds() {\n        return this.valueOf();\n    }\n    /**\n     * Return the value as a midi note.\n     */\n    toMidi() {\n        return ftom(this.toFrequency());\n    }\n    _now() {\n        return this.context.now();\n    }\n}\n/**\n * Create a TimeClass from a time string or number. The time is computed against the\n * global Tone.Context. To use a specific context, use {@link TimeClass}\n * @param value A value which represents time\n * @param units The value's units if they can't be inferred by the value.\n * @category Unit\n * @example\n * const time = Tone.Time(\"4n\").toSeconds();\n * console.log(time);\n * @example\n * const note = Tone.Time(1).toNotation();\n * console.log(note);\n * @example\n * const freq = Tone.Time(0.5).toFrequency();\n * console.log(freq);\n */\nexport function Time(value, units) {\n    return new TimeClass(getContext(), value, units);\n}\n//# sourceMappingURL=Time.js.map","/* eslint-disable key-spacing */\nimport { getContext } from \"../Global.js\";\nimport { intervalToFrequencyRatio, mtof } from \"./Conversions.js\";\nimport { ftom, getA4, setA4 } from \"./Conversions.js\";\nimport { TimeClass } from \"./Time.js\";\n/**\n * Frequency is a primitive type for encoding Frequency values.\n * Eventually all time values are evaluated to hertz using the `valueOf` method.\n * @example\n * Tone.Frequency(\"C3\"); // 261\n * Tone.Frequency(38, \"midi\");\n * Tone.Frequency(\"C3\").transpose(4);\n * @category Unit\n */\nexport class FrequencyClass extends TimeClass {\n    constructor() {\n        super(...arguments);\n        this.name = \"Frequency\";\n        this.defaultUnits = \"hz\";\n    }\n    /**\n     * The [concert tuning pitch](https://en.wikipedia.org/wiki/Concert_pitch) which is used\n     * to generate all the other pitch values from notes. A4's values in Hertz.\n     */\n    static get A4() {\n        return getA4();\n    }\n    static set A4(freq) {\n        setA4(freq);\n    }\n    //-------------------------------------\n    // \tAUGMENT BASE EXPRESSIONS\n    //-------------------------------------\n    _getExpressions() {\n        return Object.assign({}, super._getExpressions(), {\n            midi: {\n                regexp: /^(\\d+(?:\\.\\d+)?midi)/,\n                method(value) {\n                    if (this.defaultUnits === \"midi\") {\n                        return value;\n                    }\n                    else {\n                        return FrequencyClass.mtof(value);\n                    }\n                },\n            },\n            note: {\n                regexp: /^([a-g]{1}(?:b|#|##|x|bb|###|#x|x#|bbb)?)(-?[0-9]+)/i,\n                method(pitch, octave) {\n                    const index = noteToScaleIndex[pitch.toLowerCase()];\n                    const noteNumber = index + (parseInt(octave, 10) + 1) * 12;\n                    if (this.defaultUnits === \"midi\") {\n                        return noteNumber;\n                    }\n                    else {\n                        return FrequencyClass.mtof(noteNumber);\n                    }\n                },\n            },\n            tr: {\n                regexp: /^(\\d+(?:\\.\\d+)?):(\\d+(?:\\.\\d+)?):?(\\d+(?:\\.\\d+)?)?/,\n                method(m, q, s) {\n                    let total = 1;\n                    if (m && m !== \"0\") {\n                        total *= this._beatsToUnits(this._getTimeSignature() * parseFloat(m));\n                    }\n                    if (q && q !== \"0\") {\n                        total *= this._beatsToUnits(parseFloat(q));\n                    }\n                    if (s && s !== \"0\") {\n                        total *= this._beatsToUnits(parseFloat(s) / 4);\n                    }\n                    return total;\n                },\n            },\n        });\n    }\n    //-------------------------------------\n    // \tEXPRESSIONS\n    //-------------------------------------\n    /**\n     * Transposes the frequency by the given number of semitones.\n     * @return  A new transposed frequency\n     * @example\n     * Tone.Frequency(\"A4\").transpose(3); // \"C5\"\n     */\n    transpose(interval) {\n        return new FrequencyClass(this.context, this.valueOf() * intervalToFrequencyRatio(interval));\n    }\n    /**\n     * Takes an array of semitone intervals and returns\n     * an array of frequencies transposed by those intervals.\n     * @return  Returns an array of Frequencies\n     * @example\n     * Tone.Frequency(\"A4\").harmonize([0, 3, 7]); // [\"A4\", \"C5\", \"E5\"]\n     */\n    harmonize(intervals) {\n        return intervals.map((interval) => {\n            return this.transpose(interval);\n        });\n    }\n    //-------------------------------------\n    // \tUNIT CONVERSIONS\n    //-------------------------------------\n    /**\n     * Return the value of the frequency as a MIDI note\n     * @example\n     * Tone.Frequency(\"C4\").toMidi(); // 60\n     */\n    toMidi() {\n        return ftom(this.valueOf());\n    }\n    /**\n     * Return the value of the frequency in Scientific Pitch Notation\n     * @example\n     * Tone.Frequency(69, \"midi\").toNote(); // \"A4\"\n     */\n    toNote() {\n        const freq = this.toFrequency();\n        const log = Math.log2(freq / FrequencyClass.A4);\n        let noteNumber = Math.round(12 * log) + 57;\n        const octave = Math.floor(noteNumber / 12);\n        if (octave < 0) {\n            noteNumber += -12 * octave;\n        }\n        const noteName = scaleIndexToNote[noteNumber % 12];\n        return (noteName + octave.toString());\n    }\n    /**\n     * Return the duration of one cycle in seconds.\n     */\n    toSeconds() {\n        return 1 / super.toSeconds();\n    }\n    /**\n     * Return the duration of one cycle in ticks\n     */\n    toTicks() {\n        const quarterTime = this._beatsToUnits(1);\n        const quarters = this.valueOf() / quarterTime;\n        return Math.floor(quarters * this._getPPQ());\n    }\n    //-------------------------------------\n    // \tUNIT CONVERSIONS HELPERS\n    //-------------------------------------\n    /**\n     * With no arguments, return 0\n     */\n    _noArg() {\n        return 0;\n    }\n    /**\n     * Returns the value of a frequency in the current units\n     */\n    _frequencyToUnits(freq) {\n        return freq;\n    }\n    /**\n     * Returns the value of a tick in the current time units\n     */\n    _ticksToUnits(ticks) {\n        return (1 / ((ticks * 60) / (this._getBpm() * this._getPPQ())));\n    }\n    /**\n     * Return the value of the beats in the current units\n     */\n    _beatsToUnits(beats) {\n        return (1 / super._beatsToUnits(beats));\n    }\n    /**\n     * Returns the value of a second in the current units\n     */\n    _secondsToUnits(seconds) {\n        return (1 / seconds);\n    }\n    /**\n     * Convert a MIDI note to frequency value.\n     * @param  midi The midi number to convert.\n     * @return The corresponding frequency value\n     */\n    static mtof(midi) {\n        return mtof(midi);\n    }\n    /**\n     * Convert a frequency value to a MIDI note.\n     * @param frequency The value to frequency value to convert.\n     */\n    static ftom(frequency) {\n        return ftom(frequency);\n    }\n}\n//-------------------------------------\n// \tFREQUENCY CONVERSIONS\n//-------------------------------------\n/**\n * Note to scale index.\n * @hidden\n */\nconst noteToScaleIndex = {\n    cbbb: -3,\n    cbb: -2,\n    cb: -1,\n    c: 0,\n    \"c#\": 1,\n    cx: 2,\n    \"c##\": 2,\n    \"c###\": 3,\n    \"cx#\": 3,\n    \"c#x\": 3,\n    dbbb: -1,\n    dbb: 0,\n    db: 1,\n    d: 2,\n    \"d#\": 3,\n    dx: 4,\n    \"d##\": 4,\n    \"d###\": 5,\n    \"dx#\": 5,\n    \"d#x\": 5,\n    ebbb: 1,\n    ebb: 2,\n    eb: 3,\n    e: 4,\n    \"e#\": 5,\n    ex: 6,\n    \"e##\": 6,\n    \"e###\": 7,\n    \"ex#\": 7,\n    \"e#x\": 7,\n    fbbb: 2,\n    fbb: 3,\n    fb: 4,\n    f: 5,\n    \"f#\": 6,\n    fx: 7,\n    \"f##\": 7,\n    \"f###\": 8,\n    \"fx#\": 8,\n    \"f#x\": 8,\n    gbbb: 4,\n    gbb: 5,\n    gb: 6,\n    g: 7,\n    \"g#\": 8,\n    gx: 9,\n    \"g##\": 9,\n    \"g###\": 10,\n    \"gx#\": 10,\n    \"g#x\": 10,\n    abbb: 6,\n    abb: 7,\n    ab: 8,\n    a: 9,\n    \"a#\": 10,\n    ax: 11,\n    \"a##\": 11,\n    \"a###\": 12,\n    \"ax#\": 12,\n    \"a#x\": 12,\n    bbbb: 8,\n    bbb: 9,\n    bb: 10,\n    b: 11,\n    \"b#\": 12,\n    bx: 13,\n    \"b##\": 13,\n    \"b###\": 14,\n    \"bx#\": 14,\n    \"b#x\": 14,\n};\n/**\n * scale index to note (sharps)\n * @hidden\n */\nconst scaleIndexToNote = [\n    \"C\",\n    \"C#\",\n    \"D\",\n    \"D#\",\n    \"E\",\n    \"F\",\n    \"F#\",\n    \"G\",\n    \"G#\",\n    \"A\",\n    \"A#\",\n    \"B\",\n];\n/**\n * Convert a value into a FrequencyClass object.\n * @category Unit\n * @example\n * const midi = Tone.Frequency(\"C3\").toMidi();\n * console.log(midi);\n * @example\n * const hertz = Tone.Frequency(38, \"midi\").toFrequency();\n * console.log(hertz);\n */\nexport function Frequency(value, units) {\n    return new FrequencyClass(getContext(), value, units);\n}\n//# sourceMappingURL=Frequency.js.map","import { getContext } from \"../Global.js\";\nimport { TimeClass } from \"./Time.js\";\n/**\n * TransportTime is a time along the Transport's\n * timeline. It is similar to Tone.Time, but instead of evaluating\n * against the AudioContext's clock, it is evaluated against\n * the Transport's position. See [TransportTime wiki](https://github.com/Tonejs/Tone.js/wiki/TransportTime).\n * @category Unit\n */\nexport class TransportTimeClass extends TimeClass {\n    constructor() {\n        super(...arguments);\n        this.name = \"TransportTime\";\n    }\n    /**\n     * Return the current time in whichever context is relevant\n     */\n    _now() {\n        return this.context.transport.seconds;\n    }\n}\n/**\n * TransportTime is a time along the Transport's\n * timeline. It is similar to Tone.Time, but instead of evaluating\n * against the AudioContext's clock, it is evaluated against\n * the Transport's position. See [TransportTime wiki](https://github.com/Tonejs/Tone.js/wiki/TransportTime).\n * @category Unit\n */\nexport function TransportTime(value, units) {\n    return new TransportTimeClass(getContext(), value, units);\n}\n//# sourceMappingURL=TransportTime.js.map","import { getContext } from \"../Global.js\";\nimport { Tone } from \"../Tone.js\";\nimport { FrequencyClass } from \"../type/Frequency.js\";\nimport { TimeClass } from \"../type/Time.js\";\nimport { TransportTimeClass } from \"../type/TransportTime.js\";\nimport { assertUsedScheduleTime } from \"../util/Debug.js\";\nimport { getDefaultsFromInstance, optionsFromArguments, } from \"../util/Defaults.js\";\nimport { isArray, isBoolean, isDefined, isNumber, isString, isUndef, } from \"../util/TypeCheck.js\";\n/**\n * The Base class for all nodes that have an AudioContext.\n */\nexport class ToneWithContext extends Tone {\n    constructor() {\n        super();\n        const options = optionsFromArguments(ToneWithContext.getDefaults(), arguments, [\"context\"]);\n        if (this.defaultContext) {\n            this.context = this.defaultContext;\n        }\n        else {\n            this.context = options.context;\n        }\n    }\n    static getDefaults() {\n        return {\n            context: getContext(),\n        };\n    }\n    /**\n     * Return the current time of the Context clock plus the lookAhead.\n     * @example\n     * setInterval(() => {\n     * \tconsole.log(Tone.now());\n     * }, 100);\n     */\n    now() {\n        return this.context.currentTime + this.context.lookAhead;\n    }\n    /**\n     * Return the current time of the Context clock without any lookAhead.\n     * @example\n     * setInterval(() => {\n     * \tconsole.log(Tone.immediate());\n     * }, 100);\n     */\n    immediate() {\n        return this.context.currentTime;\n    }\n    /**\n     * The duration in seconds of one sample.\n     */\n    get sampleTime() {\n        return 1 / this.context.sampleRate;\n    }\n    /**\n     * The number of seconds of 1 processing block (128 samples)\n     * @example\n     * console.log(Tone.Destination.blockTime);\n     */\n    get blockTime() {\n        return 128 / this.context.sampleRate;\n    }\n    /**\n     * Convert the incoming time to seconds.\n     * This is calculated against the current {@link TransportClass} bpm\n     * @example\n     * const gain = new Tone.Gain();\n     * setInterval(() => console.log(gain.toSeconds(\"4n\")), 100);\n     * // ramp the tempo to 60 bpm over 30 seconds\n     * Tone.getTransport().bpm.rampTo(60, 30);\n     */\n    toSeconds(time) {\n        assertUsedScheduleTime(time);\n        return new TimeClass(this.context, time).toSeconds();\n    }\n    /**\n     * Convert the input to a frequency number\n     * @example\n     * const gain = new Tone.Gain();\n     * console.log(gain.toFrequency(\"4n\"));\n     */\n    toFrequency(freq) {\n        return new FrequencyClass(this.context, freq).toFrequency();\n    }\n    /**\n     * Convert the input time into ticks\n     * @example\n     * const gain = new Tone.Gain();\n     * console.log(gain.toTicks(\"4n\"));\n     */\n    toTicks(time) {\n        return new TransportTimeClass(this.context, time).toTicks();\n    }\n    //-------------------------------------\n    // \tGET/SET\n    //-------------------------------------\n    /**\n     * Get a subset of the properties which are in the partial props\n     */\n    _getPartialProperties(props) {\n        const options = this.get();\n        // remove attributes from the prop that are not in the partial\n        Object.keys(options).forEach((name) => {\n            if (isUndef(props[name])) {\n                delete options[name];\n            }\n        });\n        return options;\n    }\n    /**\n     * Get the object's attributes.\n     * @example\n     * const osc = new Tone.Oscillator();\n     * console.log(osc.get());\n     */\n    get() {\n        const defaults = getDefaultsFromInstance(this);\n        Object.keys(defaults).forEach((attribute) => {\n            if (Reflect.has(this, attribute)) {\n                const member = this[attribute];\n                if (isDefined(member) &&\n                    isDefined(member.value) &&\n                    isDefined(member.setValueAtTime)) {\n                    defaults[attribute] = member.value;\n                }\n                else if (member instanceof ToneWithContext) {\n                    defaults[attribute] = member._getPartialProperties(defaults[attribute]);\n                    // otherwise make sure it's a serializable type\n                }\n                else if (isArray(member) ||\n                    isNumber(member) ||\n                    isString(member) ||\n                    isBoolean(member)) {\n                    defaults[attribute] = member;\n                }\n                else {\n                    // remove all undefined and unserializable attributes\n                    delete defaults[attribute];\n                }\n            }\n        });\n        return defaults;\n    }\n    /**\n     * Set multiple properties at once with an object.\n     * @example\n     * const filter = new Tone.Filter().toDestination();\n     * // set values using an object\n     * filter.set({\n     * \tfrequency: \"C6\",\n     * \ttype: \"highpass\"\n     * });\n     * const player = new Tone.Player(\"https://tonejs.github.io/audio/berklee/Analogsynth_octaves_highmid.mp3\").connect(filter);\n     * player.autostart = true;\n     */\n    set(props) {\n        Object.keys(props).forEach((attribute) => {\n            if (Reflect.has(this, attribute) && isDefined(this[attribute])) {\n                if (this[attribute] &&\n                    isDefined(this[attribute].value) &&\n                    isDefined(this[attribute].setValueAtTime)) {\n                    // small optimization\n                    if (this[attribute].value !== props[attribute]) {\n                        this[attribute].value = props[attribute];\n                    }\n                }\n                else if (this[attribute] instanceof ToneWithContext) {\n                    this[attribute].set(props[attribute]);\n                }\n                else {\n                    this[attribute] = props[attribute];\n                }\n            }\n        });\n        return this;\n    }\n}\n//# sourceMappingURL=ToneWithContext.js.map","import { Timeline } from \"./Timeline.js\";\nimport { assertRange } from \"./Debug.js\";\n/**\n * A Timeline State. Provides the methods: `setStateAtTime(\"state\", time)` and `getValueAtTime(time)`\n * @param initial The initial state of the StateTimeline.  Defaults to `undefined`\n * @internal\n */\nexport class StateTimeline extends Timeline {\n    constructor(initial = \"stopped\") {\n        super();\n        this.name = \"StateTimeline\";\n        this._initial = initial;\n        this.setStateAtTime(this._initial, 0);\n    }\n    /**\n     * Returns the scheduled state scheduled before or at\n     * the given time.\n     * @param  time  The time to query.\n     * @return  The name of the state input in setStateAtTime.\n     */\n    getValueAtTime(time) {\n        const event = this.get(time);\n        if (event !== null) {\n            return event.state;\n        }\n        else {\n            return this._initial;\n        }\n    }\n    /**\n     * Add a state to the timeline.\n     * @param  state The name of the state to set.\n     * @param  time  The time to query.\n     * @param options Any additional options that are needed in the timeline.\n     */\n    setStateAtTime(state, time, options) {\n        assertRange(time, 0);\n        this.add(Object.assign({}, options, {\n            state,\n            time,\n        }));\n        return this;\n    }\n    /**\n     * Return the event before the time with the given state\n     * @param  state The state to look for\n     * @param  time  When to check before\n     * @return  The event with the given state before the time\n     */\n    getLastState(state, time) {\n        // time = this.toSeconds(time);\n        const index = this._search(time);\n        for (let i = index; i >= 0; i--) {\n            const event = this._timeline[i];\n            if (event.state === state) {\n                return event;\n            }\n        }\n    }\n    /**\n     * Return the event after the time with the given state\n     * @param  state The state to look for\n     * @param  time  When to check from\n     * @return  The event with the given state after the time\n     */\n    getNextState(state, time) {\n        // time = this.toSeconds(time);\n        const index = this._search(time);\n        if (index !== -1) {\n            for (let i = index; i < this._timeline.length; i++) {\n                const event = this._timeline[i];\n                if (event.state === state) {\n                    return event;\n                }\n            }\n        }\n    }\n}\n//# sourceMappingURL=StateTimeline.js.map","import { dbToGain, gainToDb } from \"../type/Conversions.js\";\nimport { isAudioParam } from \"../util/AdvancedTypeCheck.js\";\nimport { optionsFromArguments } from \"../util/Defaults.js\";\nimport { Timeline } from \"../util/Timeline.js\";\nimport { isDefined } from \"../util/TypeCheck.js\";\nimport { ToneWithContext } from \"./ToneWithContext.js\";\nimport { EQ } from \"../util/Math.js\";\nimport { assert, assertRange } from \"../util/Debug.js\";\n/**\n * Param wraps the native Web Audio's AudioParam to provide\n * additional unit conversion functionality. It also\n * serves as a base-class for classes which have a single,\n * automatable parameter.\n * @category Core\n */\nexport class Param extends ToneWithContext {\n    constructor() {\n        const options = optionsFromArguments(Param.getDefaults(), arguments, [\n            \"param\",\n            \"units\",\n            \"convert\",\n        ]);\n        super(options);\n        this.name = \"Param\";\n        this.overridden = false;\n        /**\n         * The minimum output value\n         */\n        this._minOutput = 1e-7;\n        assert(isDefined(options.param) &&\n            (isAudioParam(options.param) || options.param instanceof Param), \"param must be an AudioParam\");\n        while (!isAudioParam(options.param)) {\n            options.param = options.param._param;\n        }\n        this._swappable = isDefined(options.swappable)\n            ? options.swappable\n            : false;\n        if (this._swappable) {\n            this.input = this.context.createGain();\n            // initialize\n            this._param = options.param;\n            this.input.connect(this._param);\n        }\n        else {\n            this._param = this.input = options.param;\n        }\n        this._events = new Timeline(1000);\n        this._initialValue = this._param.defaultValue;\n        this.units = options.units;\n        this.convert = options.convert;\n        this._minValue = options.minValue;\n        this._maxValue = options.maxValue;\n        // if the value is defined, set it immediately\n        if (isDefined(options.value) &&\n            options.value !== this._toType(this._initialValue)) {\n            this.setValueAtTime(options.value, 0);\n        }\n    }\n    static getDefaults() {\n        return Object.assign(ToneWithContext.getDefaults(), {\n            convert: true,\n            units: \"number\",\n        });\n    }\n    get value() {\n        const now = this.now();\n        return this.getValueAtTime(now);\n    }\n    set value(value) {\n        this.cancelScheduledValues(this.now());\n        this.setValueAtTime(value, this.now());\n    }\n    get minValue() {\n        // if it's not the default minValue, return it\n        if (isDefined(this._minValue)) {\n            return this._minValue;\n        }\n        else if (this.units === \"time\" ||\n            this.units === \"frequency\" ||\n            this.units === \"normalRange\" ||\n            this.units === \"positive\" ||\n            this.units === \"transportTime\" ||\n            this.units === \"ticks\" ||\n            this.units === \"bpm\" ||\n            this.units === \"hertz\" ||\n            this.units === \"samples\") {\n            return 0;\n        }\n        else if (this.units === \"audioRange\") {\n            return -1;\n        }\n        else if (this.units === \"decibels\") {\n            return -Infinity;\n        }\n        else {\n            return this._param.minValue;\n        }\n    }\n    get maxValue() {\n        if (isDefined(this._maxValue)) {\n            return this._maxValue;\n        }\n        else if (this.units === \"normalRange\" ||\n            this.units === \"audioRange\") {\n            return 1;\n        }\n        else {\n            return this._param.maxValue;\n        }\n    }\n    /**\n     * Type guard based on the unit name\n     */\n    _is(arg, type) {\n        return this.units === type;\n    }\n    /**\n     * Make sure the value is always in the defined range\n     */\n    _assertRange(value) {\n        if (isDefined(this.maxValue) && isDefined(this.minValue)) {\n            assertRange(value, this._fromType(this.minValue), this._fromType(this.maxValue));\n        }\n        return value;\n    }\n    /**\n     * Convert the given value from the type specified by Param.units\n     * into the destination value (such as Gain or Frequency).\n     */\n    _fromType(val) {\n        if (this.convert && !this.overridden) {\n            if (this._is(val, \"time\")) {\n                return this.toSeconds(val);\n            }\n            else if (this._is(val, \"decibels\")) {\n                return dbToGain(val);\n            }\n            else if (this._is(val, \"frequency\")) {\n                return this.toFrequency(val);\n            }\n            else {\n                return val;\n            }\n        }\n        else if (this.overridden) {\n            // if it's overridden, should only schedule 0s\n            return 0;\n        }\n        else {\n            return val;\n        }\n    }\n    /**\n     * Convert the parameters value into the units specified by Param.units.\n     */\n    _toType(val) {\n        if (this.convert && this.units === \"decibels\") {\n            return gainToDb(val);\n        }\n        else {\n            return val;\n        }\n    }\n    //-------------------------------------\n    // ABSTRACT PARAM INTERFACE\n    // all docs are generated from ParamInterface.ts\n    //-------------------------------------\n    setValueAtTime(value, time) {\n        const computedTime = this.toSeconds(time);\n        const numericValue = this._fromType(value);\n        assert(isFinite(numericValue) && isFinite(computedTime), `Invalid argument(s) to setValueAtTime: ${JSON.stringify(value)}, ${JSON.stringify(time)}`);\n        this._assertRange(numericValue);\n        this.log(this.units, \"setValueAtTime\", value, computedTime);\n        this._events.add({\n            time: computedTime,\n            type: \"setValueAtTime\",\n            value: numericValue,\n        });\n        this._param.setValueAtTime(numericValue, computedTime);\n        return this;\n    }\n    getValueAtTime(time) {\n        const computedTime = Math.max(this.toSeconds(time), 0);\n        const after = this._events.getAfter(computedTime);\n        const before = this._events.get(computedTime);\n        let value = this._initialValue;\n        // if it was set by\n        if (before === null) {\n            value = this._initialValue;\n        }\n        else if (before.type === \"setTargetAtTime\" &&\n            (after === null || after.type === \"setValueAtTime\")) {\n            const previous = this._events.getBefore(before.time);\n            let previousVal;\n            if (previous === null) {\n                previousVal = this._initialValue;\n            }\n            else {\n                previousVal = previous.value;\n            }\n            if (before.type === \"setTargetAtTime\") {\n                value = this._exponentialApproach(before.time, previousVal, before.value, before.constant, computedTime);\n            }\n        }\n        else if (after === null) {\n            value = before.value;\n        }\n        else if (after.type === \"linearRampToValueAtTime\" ||\n            after.type === \"exponentialRampToValueAtTime\") {\n            let beforeValue = before.value;\n            if (before.type === \"setTargetAtTime\") {\n                const previous = this._events.getBefore(before.time);\n                if (previous === null) {\n                    beforeValue = this._initialValue;\n                }\n                else {\n                    beforeValue = previous.value;\n                }\n            }\n            if (after.type === \"linearRampToValueAtTime\") {\n                value = this._linearInterpolate(before.time, beforeValue, after.time, after.value, computedTime);\n            }\n            else {\n                value = this._exponentialInterpolate(before.time, beforeValue, after.time, after.value, computedTime);\n            }\n        }\n        else {\n            value = before.value;\n        }\n        return this._toType(value);\n    }\n    setRampPoint(time) {\n        time = this.toSeconds(time);\n        let currentVal = this.getValueAtTime(time);\n        this.cancelAndHoldAtTime(time);\n        if (this._fromType(currentVal) === 0) {\n            currentVal = this._toType(this._minOutput);\n        }\n        this.setValueAtTime(currentVal, time);\n        return this;\n    }\n    linearRampToValueAtTime(value, endTime) {\n        const numericValue = this._fromType(value);\n        const computedTime = this.toSeconds(endTime);\n        assert(isFinite(numericValue) && isFinite(computedTime), `Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(value)}, ${JSON.stringify(endTime)}`);\n        this._assertRange(numericValue);\n        this._events.add({\n            time: computedTime,\n            type: \"linearRampToValueAtTime\",\n            value: numericValue,\n        });\n        this.log(this.units, \"linearRampToValueAtTime\", value, computedTime);\n        this._param.linearRampToValueAtTime(numericValue, computedTime);\n        return this;\n    }\n    exponentialRampToValueAtTime(value, endTime) {\n        let numericValue = this._fromType(value);\n        // the value can't be 0\n        numericValue = EQ(numericValue, 0) ? this._minOutput : numericValue;\n        this._assertRange(numericValue);\n        const computedTime = this.toSeconds(endTime);\n        assert(isFinite(numericValue) && isFinite(computedTime), `Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(value)}, ${JSON.stringify(endTime)}`);\n        // store the event\n        this._events.add({\n            time: computedTime,\n            type: \"exponentialRampToValueAtTime\",\n            value: numericValue,\n        });\n        this.log(this.units, \"exponentialRampToValueAtTime\", value, computedTime);\n        this._param.exponentialRampToValueAtTime(numericValue, computedTime);\n        return this;\n    }\n    exponentialRampTo(value, rampTime, startTime) {\n        startTime = this.toSeconds(startTime);\n        this.setRampPoint(startTime);\n        this.exponentialRampToValueAtTime(value, startTime + this.toSeconds(rampTime));\n        return this;\n    }\n    linearRampTo(value, rampTime, startTime) {\n        startTime = this.toSeconds(startTime);\n        this.setRampPoint(startTime);\n        this.linearRampToValueAtTime(value, startTime + this.toSeconds(rampTime));\n        return this;\n    }\n    targetRampTo(value, rampTime, startTime) {\n        startTime = this.toSeconds(startTime);\n        this.setRampPoint(startTime);\n        this.exponentialApproachValueAtTime(value, startTime, rampTime);\n        return this;\n    }\n    exponentialApproachValueAtTime(value, time, rampTime) {\n        time = this.toSeconds(time);\n        rampTime = this.toSeconds(rampTime);\n        const timeConstant = Math.log(rampTime + 1) / Math.log(200);\n        this.setTargetAtTime(value, time, timeConstant);\n        // at 90% start a linear ramp to the final value\n        this.cancelAndHoldAtTime(time + rampTime * 0.9);\n        this.linearRampToValueAtTime(value, time + rampTime);\n        return this;\n    }\n    setTargetAtTime(value, startTime, timeConstant) {\n        const numericValue = this._fromType(value);\n        // The value will never be able to approach without timeConstant > 0.\n        assert(isFinite(timeConstant) && timeConstant > 0, \"timeConstant must be a number greater than 0\");\n        const computedTime = this.toSeconds(startTime);\n        this._assertRange(numericValue);\n        assert(isFinite(numericValue) && isFinite(computedTime), `Invalid argument(s) to setTargetAtTime: ${JSON.stringify(value)}, ${JSON.stringify(startTime)}`);\n        this._events.add({\n            constant: timeConstant,\n            time: computedTime,\n            type: \"setTargetAtTime\",\n            value: numericValue,\n        });\n        this.log(this.units, \"setTargetAtTime\", value, computedTime, timeConstant);\n        this._param.setTargetAtTime(numericValue, computedTime, timeConstant);\n        return this;\n    }\n    setValueCurveAtTime(values, startTime, duration, scaling = 1) {\n        duration = this.toSeconds(duration);\n        startTime = this.toSeconds(startTime);\n        const startingValue = this._fromType(values[0]) * scaling;\n        this.setValueAtTime(this._toType(startingValue), startTime);\n        const segTime = duration / (values.length - 1);\n        for (let i = 1; i < values.length; i++) {\n            const numericValue = this._fromType(values[i]) * scaling;\n            this.linearRampToValueAtTime(this._toType(numericValue), startTime + i * segTime);\n        }\n        return this;\n    }\n    cancelScheduledValues(time) {\n        const computedTime = this.toSeconds(time);\n        assert(isFinite(computedTime), `Invalid argument to cancelScheduledValues: ${JSON.stringify(time)}`);\n        this._events.cancel(computedTime);\n        this._param.cancelScheduledValues(computedTime);\n        this.log(this.units, \"cancelScheduledValues\", computedTime);\n        return this;\n    }\n    cancelAndHoldAtTime(time) {\n        const computedTime = this.toSeconds(time);\n        const valueAtTime = this._fromType(this.getValueAtTime(computedTime));\n        // remove the schedule events\n        assert(isFinite(computedTime), `Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(time)}`);\n        this.log(this.units, \"cancelAndHoldAtTime\", computedTime, \"value=\" + valueAtTime);\n        // if there is an event at the given computedTime\n        // and that even is not a \"set\"\n        const before = this._events.get(computedTime);\n        const after = this._events.getAfter(computedTime);\n        if (before && EQ(before.time, computedTime)) {\n            // remove everything after\n            if (after) {\n                this._param.cancelScheduledValues(after.time);\n                this._events.cancel(after.time);\n            }\n            else {\n                this._param.cancelAndHoldAtTime(computedTime);\n                this._events.cancel(computedTime + this.sampleTime);\n            }\n        }\n        else if (after) {\n            this._param.cancelScheduledValues(after.time);\n            // cancel the next event(s)\n            this._events.cancel(after.time);\n            if (after.type === \"linearRampToValueAtTime\") {\n                this.linearRampToValueAtTime(this._toType(valueAtTime), computedTime);\n            }\n            else if (after.type === \"exponentialRampToValueAtTime\") {\n                this.exponentialRampToValueAtTime(this._toType(valueAtTime), computedTime);\n            }\n        }\n        // set the value at the given time\n        this._events.add({\n            time: computedTime,\n            type: \"setValueAtTime\",\n            value: valueAtTime,\n        });\n        this._param.setValueAtTime(valueAtTime, computedTime);\n        return this;\n    }\n    rampTo(value, rampTime = 0.1, startTime) {\n        if (this.units === \"frequency\" ||\n            this.units === \"bpm\" ||\n            this.units === \"decibels\") {\n            this.exponentialRampTo(value, rampTime, startTime);\n        }\n        else {\n            this.linearRampTo(value, rampTime, startTime);\n        }\n        return this;\n    }\n    /**\n     * Apply all of the previously scheduled events to the passed in Param or AudioParam.\n     * The applied values will start at the context's current time and schedule\n     * all of the events which are scheduled on this Param onto the passed in param.\n     */\n    apply(param) {\n        const now = this.context.currentTime;\n        // set the param's value at the current time and schedule everything else\n        param.setValueAtTime(this.getValueAtTime(now), now);\n        // if the previous event was a curve, then set the rest of it\n        const previousEvent = this._events.get(now);\n        if (previousEvent && previousEvent.type === \"setTargetAtTime\") {\n            // approx it until the next event with linear ramps\n            const nextEvent = this._events.getAfter(previousEvent.time);\n            // or for 2 seconds if there is no event\n            const endTime = nextEvent ? nextEvent.time : now + 2;\n            const subdivisions = (endTime - now) / 10;\n            for (let i = now; i < endTime; i += subdivisions) {\n                param.linearRampToValueAtTime(this.getValueAtTime(i), i);\n            }\n        }\n        this._events.forEachAfter(this.context.currentTime, (event) => {\n            if (event.type === \"cancelScheduledValues\") {\n                param.cancelScheduledValues(event.time);\n            }\n            else if (event.type === \"setTargetAtTime\") {\n                param.setTargetAtTime(event.value, event.time, event.constant);\n            }\n            else {\n                param[event.type](event.value, event.time);\n            }\n        });\n        return this;\n    }\n    /**\n     * Replace the Param's internal AudioParam. Will apply scheduled curves\n     * onto the parameter and replace the connections.\n     */\n    setParam(param) {\n        assert(this._swappable, \"The Param must be assigned as 'swappable' in the constructor\");\n        const input = this.input;\n        input.disconnect(this._param);\n        this.apply(param);\n        this._param = param;\n        input.connect(this._param);\n        return this;\n    }\n    dispose() {\n        super.dispose();\n        this._events.dispose();\n        return this;\n    }\n    get defaultValue() {\n        return this._toType(this._param.defaultValue);\n    }\n    //-------------------------------------\n    // \tAUTOMATION CURVE CALCULATIONS\n    // \tMIT License, copyright (c) 2014 Jordan Santell\n    //-------------------------------------\n    // Calculates the the value along the curve produced by setTargetAtTime\n    _exponentialApproach(t0, v0, v1, timeConstant, t) {\n        return v1 + (v0 - v1) * Math.exp(-(t - t0) / timeConstant);\n    }\n    // Calculates the the value along the curve produced by linearRampToValueAtTime\n    _linearInterpolate(t0, v0, t1, v1, t) {\n        return v0 + (v1 - v0) * ((t - t0) / (t1 - t0));\n    }\n    // Calculates the the value along the curve produced by exponentialRampToValueAtTime\n    _exponentialInterpolate(t0, v0, t1, v1, t) {\n        return v0 * Math.pow(v1 / v0, (t - t0) / (t1 - t0));\n    }\n}\n//# sourceMappingURL=Param.js.map","import { isAudioNode, isAudioParam } from \"../util/AdvancedTypeCheck.js\";\nimport { isDefined } from \"../util/TypeCheck.js\";\nimport { Param } from \"./Param.js\";\nimport { ToneWithContext } from \"./ToneWithContext.js\";\nimport { assert, warn } from \"../util/Debug.js\";\n/**\n * ToneAudioNode is the base class for classes which process audio.\n * @category Core\n */\nexport class ToneAudioNode extends ToneWithContext {\n    constructor() {\n        super(...arguments);\n        /**\n         * List all of the node that must be set to match the ChannelProperties\n         */\n        this._internalChannels = [];\n    }\n    /**\n     * The number of inputs feeding into the AudioNode.\n     * For source nodes, this will be 0.\n     * @example\n     * const node = new Tone.Gain();\n     * console.log(node.numberOfInputs);\n     */\n    get numberOfInputs() {\n        if (isDefined(this.input)) {\n            if (isAudioParam(this.input) || this.input instanceof Param) {\n                return 1;\n            }\n            else {\n                return this.input.numberOfInputs;\n            }\n        }\n        else {\n            return 0;\n        }\n    }\n    /**\n     * The number of outputs of the AudioNode.\n     * @example\n     * const node = new Tone.Gain();\n     * console.log(node.numberOfOutputs);\n     */\n    get numberOfOutputs() {\n        if (isDefined(this.output)) {\n            return this.output.numberOfOutputs;\n        }\n        else {\n            return 0;\n        }\n    }\n    //-------------------------------------\n    // AUDIO PROPERTIES\n    //-------------------------------------\n    /**\n     * Used to decide which nodes to get/set properties on\n     */\n    _isAudioNode(node) {\n        return (isDefined(node) &&\n            (node instanceof ToneAudioNode || isAudioNode(node)));\n    }\n    /**\n     * Get all of the audio nodes (either internal or input/output) which together\n     * make up how the class node responds to channel input/output\n     */\n    _getInternalNodes() {\n        const nodeList = this._internalChannels.slice(0);\n        if (this._isAudioNode(this.input)) {\n            nodeList.push(this.input);\n        }\n        if (this._isAudioNode(this.output)) {\n            if (this.input !== this.output) {\n                nodeList.push(this.output);\n            }\n        }\n        return nodeList;\n    }\n    /**\n     * Set the audio options for this node such as channelInterpretation\n     * channelCount, etc.\n     * @param options\n     */\n    _setChannelProperties(options) {\n        const nodeList = this._getInternalNodes();\n        nodeList.forEach((node) => {\n            node.channelCount = options.channelCount;\n            node.channelCountMode = options.channelCountMode;\n            node.channelInterpretation = options.channelInterpretation;\n        });\n    }\n    /**\n     * Get the current audio options for this node such as channelInterpretation\n     * channelCount, etc.\n     */\n    _getChannelProperties() {\n        const nodeList = this._getInternalNodes();\n        assert(nodeList.length > 0, \"ToneAudioNode does not have any internal nodes\");\n        // use the first node to get properties\n        // they should all be the same\n        const node = nodeList[0];\n        return {\n            channelCount: node.channelCount,\n            channelCountMode: node.channelCountMode,\n            channelInterpretation: node.channelInterpretation,\n        };\n    }\n    /**\n     * channelCount is the number of channels used when up-mixing and down-mixing\n     * connections to any inputs to the node. The default value is 2 except for\n     * specific nodes where its value is specially determined.\n     */\n    get channelCount() {\n        return this._getChannelProperties().channelCount;\n    }\n    set channelCount(channelCount) {\n        const props = this._getChannelProperties();\n        // merge it with the other properties\n        this._setChannelProperties(Object.assign(props, { channelCount }));\n    }\n    /**\n     * channelCountMode determines how channels will be counted when up-mixing and\n     * down-mixing connections to any inputs to the node.\n     * The default value is \"max\". This attribute has no effect for nodes with no inputs.\n     * * \"max\" - computedNumberOfChannels is the maximum of the number of channels of all connections to an input. In this mode channelCount is ignored.\n     * * \"clamped-max\" - computedNumberOfChannels is determined as for \"max\" and then clamped to a maximum value of the given channelCount.\n     * * \"explicit\" - computedNumberOfChannels is the exact value as specified by the channelCount.\n     */\n    get channelCountMode() {\n        return this._getChannelProperties().channelCountMode;\n    }\n    set channelCountMode(channelCountMode) {\n        const props = this._getChannelProperties();\n        // merge it with the other properties\n        this._setChannelProperties(Object.assign(props, { channelCountMode }));\n    }\n    /**\n     * channelInterpretation determines how individual channels will be treated\n     * when up-mixing and down-mixing connections to any inputs to the node.\n     * The default value is \"speakers\".\n     */\n    get channelInterpretation() {\n        return this._getChannelProperties().channelInterpretation;\n    }\n    set channelInterpretation(channelInterpretation) {\n        const props = this._getChannelProperties();\n        // merge it with the other properties\n        this._setChannelProperties(Object.assign(props, { channelInterpretation }));\n    }\n    //-------------------------------------\n    // CONNECTIONS\n    //-------------------------------------\n    /**\n     * connect the output of a ToneAudioNode to an AudioParam, AudioNode, or ToneAudioNode\n     * @param destination The output to connect to\n     * @param outputNum The output to connect from\n     * @param inputNum The input to connect to\n     */\n    connect(destination, outputNum = 0, inputNum = 0) {\n        connect(this, destination, outputNum, inputNum);\n        return this;\n    }\n    /**\n     * Connect the output to the context's destination node.\n     * @example\n     * const osc = new Tone.Oscillator(\"C2\").start();\n     * osc.toDestination();\n     */\n    toDestination() {\n        this.connect(this.context.destination);\n        return this;\n    }\n    /**\n     * Connect the output to the context's destination node.\n     * @see {@link toDestination}\n     * @deprecated\n     */\n    toMaster() {\n        warn(\"toMaster() has been renamed toDestination()\");\n        return this.toDestination();\n    }\n    /**\n     * disconnect the output\n     */\n    disconnect(destination, outputNum = 0, inputNum = 0) {\n        disconnect(this, destination, outputNum, inputNum);\n        return this;\n    }\n    /**\n     * Connect the output of this node to the rest of the nodes in series.\n     * @example\n     * const player = new Tone.Player(\"https://tonejs.github.io/audio/drum-samples/handdrum-loop.mp3\");\n     * player.autostart = true;\n     * const filter = new Tone.AutoFilter(4).start();\n     * const distortion = new Tone.Distortion(0.5);\n     * // connect the player to the filter, distortion and then to the master output\n     * player.chain(filter, distortion, Tone.Destination);\n     */\n    chain(...nodes) {\n        connectSeries(this, ...nodes);\n        return this;\n    }\n    /**\n     * connect the output of this node to the rest of the nodes in parallel.\n     * @example\n     * const player = new Tone.Player(\"https://tonejs.github.io/audio/drum-samples/conga-rhythm.mp3\");\n     * player.autostart = true;\n     * const pitchShift = new Tone.PitchShift(4).toDestination();\n     * const filter = new Tone.Filter(\"G5\").toDestination();\n     * // connect a node to the pitch shift and filter in parallel\n     * player.fan(pitchShift, filter);\n     */\n    fan(...nodes) {\n        nodes.forEach((node) => this.connect(node));\n        return this;\n    }\n    /**\n     * Dispose and disconnect\n     */\n    dispose() {\n        super.dispose();\n        if (isDefined(this.input)) {\n            if (this.input instanceof ToneAudioNode) {\n                this.input.dispose();\n            }\n            else if (isAudioNode(this.input)) {\n                this.input.disconnect();\n            }\n        }\n        if (isDefined(this.output)) {\n            if (this.output instanceof ToneAudioNode) {\n                this.output.dispose();\n            }\n            else if (isAudioNode(this.output)) {\n                this.output.disconnect();\n            }\n        }\n        this._internalChannels = [];\n        return this;\n    }\n}\n//-------------------------------------\n// CONNECTIONS\n//-------------------------------------\n/**\n * connect together all of the arguments in series\n * @param nodes\n */\nexport function connectSeries(...nodes) {\n    const first = nodes.shift();\n    nodes.reduce((prev, current) => {\n        if (prev instanceof ToneAudioNode) {\n            prev.connect(current);\n        }\n        else if (isAudioNode(prev)) {\n            connect(prev, current);\n        }\n        return current;\n    }, first);\n}\n/**\n * Connect two nodes together so that signal flows from the\n * first node to the second. Optionally specify the input and output channels.\n * @param srcNode The source node\n * @param dstNode The destination node\n * @param outputNumber The output channel of the srcNode\n * @param inputNumber The input channel of the dstNode\n */\nexport function connect(srcNode, dstNode, outputNumber = 0, inputNumber = 0) {\n    assert(isDefined(srcNode), \"Cannot connect from undefined node\");\n    assert(isDefined(dstNode), \"Cannot connect to undefined node\");\n    if (dstNode instanceof ToneAudioNode || isAudioNode(dstNode)) {\n        assert(dstNode.numberOfInputs > 0, \"Cannot connect to node with no inputs\");\n    }\n    assert(srcNode.numberOfOutputs > 0, \"Cannot connect from node with no outputs\");\n    // resolve the input of the dstNode\n    while (dstNode instanceof ToneAudioNode || dstNode instanceof Param) {\n        if (isDefined(dstNode.input)) {\n            dstNode = dstNode.input;\n        }\n    }\n    while (srcNode instanceof ToneAudioNode) {\n        if (isDefined(srcNode.output)) {\n            srcNode = srcNode.output;\n        }\n    }\n    // make the connection\n    if (isAudioParam(dstNode)) {\n        srcNode.connect(dstNode, outputNumber);\n    }\n    else {\n        srcNode.connect(dstNode, outputNumber, inputNumber);\n    }\n}\n/**\n * Disconnect a node from all nodes or optionally include a destination node and input/output channels.\n * @param srcNode The source node\n * @param dstNode The destination node\n * @param outputNumber The output channel of the srcNode\n * @param inputNumber The input channel of the dstNode\n */\nexport function disconnect(srcNode, dstNode, outputNumber = 0, inputNumber = 0) {\n    // resolve the destination node\n    if (isDefined(dstNode)) {\n        while (dstNode instanceof ToneAudioNode) {\n            dstNode = dstNode.input;\n        }\n    }\n    // resolve the src node\n    while (!isAudioNode(srcNode)) {\n        if (isDefined(srcNode.output)) {\n            srcNode = srcNode.output;\n        }\n    }\n    if (isAudioParam(dstNode)) {\n        srcNode.disconnect(dstNode, outputNumber);\n    }\n    else if (isAudioNode(dstNode)) {\n        srcNode.disconnect(dstNode, outputNumber, inputNumber);\n    }\n    else {\n        srcNode.disconnect();\n    }\n}\n/**\n * Connect the output of one or more source nodes to a single destination node\n * @param nodes One or more source nodes followed by one destination node\n * @example\n * const player = new Tone.Player(\"https://tonejs.github.io/audio/drum-samples/conga-rhythm.mp3\");\n * const player1 = new Tone.Player(\"https://tonejs.github.io/audio/drum-samples/conga-rhythm.mp3\");\n * const filter = new Tone.Filter(\"G5\").toDestination();\n * // connect nodes to a common destination\n * Tone.fanIn(player, player1, filter);\n */\nexport function fanIn(...nodes) {\n    const dstNode = nodes.pop();\n    if (isDefined(dstNode)) {\n        nodes.forEach((node) => connect(node, dstNode));\n    }\n}\n//# sourceMappingURL=ToneAudioNode.js.map","import { Param } from \"../context/Param.js\";\nimport { optionsFromArguments } from \"../util/Defaults.js\";\nimport { readOnly } from \"../util/Interface.js\";\nimport { ToneAudioNode } from \"./ToneAudioNode.js\";\n/**\n * A thin wrapper around the Native Web Audio GainNode.\n * The GainNode is a basic building block of the Web Audio\n * API and is useful for routing audio and adjusting gains.\n * @category Core\n * @example\n * return Tone.Offline(() => {\n * \tconst gainNode = new Tone.Gain(0).toDestination();\n * \tconst osc = new Tone.Oscillator(30).connect(gainNode).start();\n * \tgainNode.gain.rampTo(1, 0.1);\n * \tgainNode.gain.rampTo(0, 0.4, 0.2);\n * }, 0.7, 1);\n */\nexport class Gain extends ToneAudioNode {\n    constructor() {\n        const options = optionsFromArguments(Gain.getDefaults(), arguments, [\n            \"gain\",\n            \"units\",\n        ]);\n        super(options);\n        this.name = \"Gain\";\n        /**\n         * The wrapped GainNode.\n         */\n        this._gainNode = this.context.createGain();\n        // input = output\n        this.input = this._gainNode;\n        this.output = this._gainNode;\n        this.gain = new Param({\n            context: this.context,\n            convert: options.convert,\n            param: this._gainNode.gain,\n            units: options.units,\n            value: options.gain,\n            minValue: options.minValue,\n            maxValue: options.maxValue,\n        });\n        readOnly(this, \"gain\");\n    }\n    static getDefaults() {\n        return Object.assign(ToneAudioNode.getDefaults(), {\n            convert: true,\n            gain: 1,\n            units: \"gain\",\n        });\n    }\n    /**\n     * Clean up.\n     */\n    dispose() {\n        super.dispose();\n        this._gainNode.disconnect();\n        this.gain.dispose();\n        return this;\n    }\n}\n//# sourceMappingURL=Gain.js.map","import { Gain } from \"../core/context/Gain.js\";\nimport { ToneAudioNode, } from \"../core/context/ToneAudioNode.js\";\nimport { noOp } from \"../core/util/Interface.js\";\nimport { assert } from \"../core/util/Debug.js\";\n/**\n * Base class for fire-and-forget nodes\n */\nexport class OneShotSource extends ToneAudioNode {\n    constructor(options) {\n        super(options);\n        /**\n         * The callback to invoke after the\n         * source is done playing.\n         */\n        this.onended = noOp;\n        /**\n         * The start time\n         */\n        this._startTime = -1;\n        /**\n         * The stop time\n         */\n        this._stopTime = -1;\n        /**\n         * The id of the timeout\n         */\n        this._timeout = -1;\n        /**\n         * The public output node\n         */\n        this.output = new Gain({\n            context: this.context,\n            gain: 0,\n        });\n        /**\n         * The output gain node.\n         */\n        this._gainNode = this.output;\n        /**\n         * Get the playback state at the given time\n         */\n        this.getStateAtTime = function (time) {\n            const computedTime = this.toSeconds(time);\n            if (this._startTime !== -1 &&\n                computedTime >= this._startTime &&\n                (this._stopTime === -1 || computedTime <= this._stopTime)) {\n                return \"started\";\n            }\n            else {\n                return \"stopped\";\n            }\n        };\n        this._fadeIn = options.fadeIn;\n        this._fadeOut = options.fadeOut;\n        this._curve = options.curve;\n        this.onended = options.onended;\n    }\n    static getDefaults() {\n        return Object.assign(ToneAudioNode.getDefaults(), {\n            curve: \"linear\",\n            fadeIn: 0,\n            fadeOut: 0,\n            onended: noOp,\n        });\n    }\n    /**\n     * Start the source at the given time\n     * @param  time When to start the source\n     */\n    _startGain(time, gain = 1) {\n        assert(this._startTime === -1, \"Source cannot be started more than once\");\n        // apply a fade in envelope\n        const fadeInTime = this.toSeconds(this._fadeIn);\n        // record the start time\n        this._startTime = time + fadeInTime;\n        this._startTime = Math.max(this._startTime, this.context.currentTime);\n        // schedule the envelope\n        if (fadeInTime > 0) {\n            this._gainNode.gain.setValueAtTime(0, time);\n            if (this._curve === \"linear\") {\n                this._gainNode.gain.linearRampToValueAtTime(gain, time + fadeInTime);\n            }\n            else {\n                this._gainNode.gain.exponentialApproachValueAtTime(gain, time, fadeInTime);\n            }\n        }\n        else {\n            this._gainNode.gain.setValueAtTime(gain, time);\n        }\n        return this;\n    }\n    /**\n     * Stop the source node at the given time.\n     * @param time When to stop the source\n     */\n    stop(time) {\n        this.log(\"stop\", time);\n        this._stopGain(this.toSeconds(time));\n        return this;\n    }\n    /**\n     * Stop the source at the given time\n     * @param  time When to stop the source\n     */\n    _stopGain(time) {\n        assert(this._startTime !== -1, \"'start' must be called before 'stop'\");\n        // cancel the previous stop\n        this.cancelStop();\n        // the fadeOut time\n        const fadeOutTime = this.toSeconds(this._fadeOut);\n        // schedule the stop callback\n        this._stopTime = this.toSeconds(time) + fadeOutTime;\n        this._stopTime = Math.max(this._stopTime, this.now());\n        if (fadeOutTime > 0) {\n            // start the fade out curve at the given time\n            if (this._curve === \"linear\") {\n                this._gainNode.gain.linearRampTo(0, fadeOutTime, time);\n            }\n            else {\n                this._gainNode.gain.targetRampTo(0, fadeOutTime, time);\n            }\n        }\n        else {\n            // stop any ongoing ramps, and set the value to 0\n            this._gainNode.gain.cancelAndHoldAtTime(time);\n            this._gainNode.gain.setValueAtTime(0, time);\n        }\n        this.context.clearTimeout(this._timeout);\n        this._timeout = this.context.setTimeout(() => {\n            // allow additional time for the exponential curve to fully decay\n            const additionalTail = this._curve === \"exponential\" ? fadeOutTime * 2 : 0;\n            this._stopSource(this.now() + additionalTail);\n            this._onended();\n        }, this._stopTime - this.context.currentTime);\n        return this;\n    }\n    /**\n     * Invoke the onended callback\n     */\n    _onended() {\n        if (this.onended === noOp) {\n            return;\n        }\n        this.onended(this);\n        // overwrite onended to make sure it only is called once\n        this.onended = noOp;\n        // dispose when it's ended to free up for garbage collection only in the online context\n        if (!this.context.isOffline) {\n            const disposeCallback = () => this.dispose();\n            if (typeof requestIdleCallback !== \"undefined\") {\n                requestIdleCallback(disposeCallback);\n            }\n            else {\n                setTimeout(disposeCallback, 10);\n            }\n        }\n    }\n    /**\n     * Get the playback state at the current time\n     */\n    get state() {\n        return this.getStateAtTime(this.now());\n    }\n    /**\n     * Cancel a scheduled stop event\n     */\n    cancelStop() {\n        this.log(\"cancelStop\");\n        assert(this._startTime !== -1, \"Source is not started\");\n        // cancel the stop envelope\n        this._gainNode.gain.cancelScheduledValues(this._startTime + this.sampleTime);\n        this.context.clearTimeout(this._timeout);\n        this._stopTime = -1;\n        return this;\n    }\n    dispose() {\n        super.dispose();\n        this._gainNode.dispose();\n        this.onended = noOp;\n        return this;\n    }\n}\n//# sourceMappingURL=OneShotSource.js.map","import { connect } from \"../core/context/ToneAudioNode.js\";\nimport { Param } from \"../core/context/Param.js\";\nimport { optionsFromArguments } from \"../core/util/Defaults.js\";\nimport { OneShotSource, } from \"../source/OneShotSource.js\";\n/**\n * Wrapper around the native fire-and-forget ConstantSource.\n * Adds the ability to reschedule the stop method.\n * @category Signal\n */\nexport class ToneConstantSource extends OneShotSource {\n    constructor() {\n        const options = optionsFromArguments(ToneConstantSource.getDefaults(), arguments, [\"offset\"]);\n        super(options);\n        this.name = \"ToneConstantSource\";\n        /**\n         * The signal generator\n         */\n        this._source = this.context.createConstantSource();\n        connect(this._source, this._gainNode);\n        this.offset = new Param({\n            context: this.context,\n            convert: options.convert,\n            param: this._source.offset,\n            units: options.units,\n            value: options.offset,\n            minValue: options.minValue,\n            maxValue: options.maxValue,\n        });\n    }\n    static getDefaults() {\n        return Object.assign(OneShotSource.getDefaults(), {\n            convert: true,\n            offset: 1,\n            units: \"number\",\n        });\n    }\n    /**\n     * Start the source node at the given time\n     * @param  time When to start the source\n     */\n    start(time) {\n        const computedTime = this.toSeconds(time);\n        this.log(\"start\", computedTime);\n        this._startGain(computedTime);\n        this._source.start(computedTime);\n        return this;\n    }\n    _stopSource(time) {\n        this._source.stop(time);\n    }\n    dispose() {\n        super.dispose();\n        if (this.state === \"started\") {\n            this.stop();\n        }\n        this._source.disconnect();\n        this.offset.dispose();\n        return this;\n    }\n}\n//# sourceMappingURL=ToneConstantSource.js.map","import { Param } from \"../core/context/Param.js\";\nimport { ToneAudioNode, } from \"../core/context/ToneAudioNode.js\";\nimport { connect } from \"../core/context/ToneAudioNode.js\";\nimport { isAudioParam } from \"../core/util/AdvancedTypeCheck.js\";\nimport { optionsFromArguments } from \"../core/util/Defaults.js\";\nimport { ToneConstantSource } from \"./ToneConstantSource.js\";\n/**\n * A signal is an audio-rate value. Tone.Signal is a core component of the library.\n * Unlike a number, Signals can be scheduled with sample-level accuracy. Tone.Signal\n * has all of the methods available to native Web Audio\n * [AudioParam](http://webaudio.github.io/web-audio-api/#the-audioparam-interface)\n * as well as additional conveniences. Read more about working with signals\n * [here](https://github.com/Tonejs/Tone.js/wiki/Signals).\n *\n * @example\n * const osc = new Tone.Oscillator().toDestination().start();\n * // a scheduleable signal which can be connected to control an AudioParam or another Signal\n * const signal = new Tone.Signal({\n * \tvalue: \"C4\",\n * \tunits: \"frequency\"\n * }).connect(osc.frequency);\n * // the scheduled ramp controls the connected signal\n * signal.rampTo(\"C2\", 4, \"+0.5\");\n * @category Signal\n */\nexport class Signal extends ToneAudioNode {\n    constructor() {\n        const options = optionsFromArguments(Signal.getDefaults(), arguments, [\n            \"value\",\n            \"units\",\n        ]);\n        super(options);\n        this.name = \"Signal\";\n        /**\n         * Indicates if the value should be overridden on connection.\n         */\n        this.override = true;\n        this.output = this._constantSource = new ToneConstantSource({\n            context: this.context,\n            convert: options.convert,\n            offset: options.value,\n            units: options.units,\n            minValue: options.minValue,\n            maxValue: options.maxValue,\n        });\n        this._constantSource.start(0);\n        this.input = this._param = this._constantSource.offset;\n    }\n    static getDefaults() {\n        return Object.assign(ToneAudioNode.getDefaults(), {\n            convert: true,\n            units: \"number\",\n            value: 0,\n        });\n    }\n    connect(destination, outputNum = 0, inputNum = 0) {\n        // start it only when connected to something\n        connectSignal(this, destination, outputNum, inputNum);\n        return this;\n    }\n    dispose() {\n        super.dispose();\n        this._param.dispose();\n        this._constantSource.dispose();\n        return this;\n    }\n    //-------------------------------------\n    // ABSTRACT PARAM INTERFACE\n    // just a proxy for the ConstantSourceNode's offset AudioParam\n    // all docs are generated from AbstractParam.ts\n    //-------------------------------------\n    setValueAtTime(value, time) {\n        this._param.setValueAtTime(value, time);\n        return this;\n    }\n    getValueAtTime(time) {\n        return this._param.getValueAtTime(time);\n    }\n    setRampPoint(time) {\n        this._param.setRampPoint(time);\n        return this;\n    }\n    linearRampToValueAtTime(value, time) {\n        this._param.linearRampToValueAtTime(value, time);\n        return this;\n    }\n    exponentialRampToValueAtTime(value, time) {\n        this._param.exponentialRampToValueAtTime(value, time);\n        return this;\n    }\n    exponentialRampTo(value, rampTime, startTime) {\n        this._param.exponentialRampTo(value, rampTime, startTime);\n        return this;\n    }\n    linearRampTo(value, rampTime, startTime) {\n        this._param.linearRampTo(value, rampTime, startTime);\n        return this;\n    }\n    targetRampTo(value, rampTime, startTime) {\n        this._param.targetRampTo(value, rampTime, startTime);\n        return this;\n    }\n    exponentialApproachValueAtTime(value, time, rampTime) {\n        this._param.exponentialApproachValueAtTime(value, time, rampTime);\n        return this;\n    }\n    setTargetAtTime(value, startTime, timeConstant) {\n        this._param.setTargetAtTime(value, startTime, timeConstant);\n        return this;\n    }\n    setValueCurveAtTime(values, startTime, duration, scaling) {\n        this._param.setValueCurveAtTime(values, startTime, duration, scaling);\n        return this;\n    }\n    cancelScheduledValues(time) {\n        this._param.cancelScheduledValues(time);\n        return this;\n    }\n    cancelAndHoldAtTime(time) {\n        this._param.cancelAndHoldAtTime(time);\n        return this;\n    }\n    rampTo(value, rampTime, startTime) {\n        this._param.rampTo(value, rampTime, startTime);\n        return this;\n    }\n    get value() {\n        return this._param.value;\n    }\n    set value(value) {\n        this._param.value = value;\n    }\n    get convert() {\n        return this._param.convert;\n    }\n    set convert(convert) {\n        this._param.convert = convert;\n    }\n    get units() {\n        return this._param.units;\n    }\n    get overridden() {\n        return this._param.overridden;\n    }\n    set overridden(overridden) {\n        this._param.overridden = overridden;\n    }\n    get maxValue() {\n        return this._param.maxValue;\n    }\n    get minValue() {\n        return this._param.minValue;\n    }\n    /**\n     * @see {@link Param.apply}.\n     */\n    apply(param) {\n        this._param.apply(param);\n        return this;\n    }\n}\n/**\n * When connecting from a signal, it's necessary to zero out the node destination\n * node if that node is also a signal. If the destination is not 0, then the values\n * will be summed. This method insures that the output of the destination signal will\n * be the same as the source signal, making the destination signal a pass through node.\n * @param signal The output signal to connect from\n * @param destination the destination to connect to\n * @param outputNum the optional output number\n * @param inputNum the input number\n */\nexport function connectSignal(signal, destination, outputNum, inputNum) {\n    if (destination instanceof Param ||\n        isAudioParam(destination) ||\n        (destination instanceof Signal && destination.override)) {\n        // cancel changes\n        destination.cancelScheduledValues(0);\n        // reset the value\n        destination.setValueAtTime(0, 0);\n        // mark the value as overridden\n        if (destination instanceof Signal) {\n            destination.overridden = true;\n        }\n    }\n    connect(signal, destination, outputNum, inputNum);\n}\n//# sourceMappingURL=Signal.js.map","import { Param } from \"../context/Param.js\";\nimport { optionsFromArguments } from \"../util/Defaults.js\";\nimport { Timeline } from \"../util/Timeline.js\";\nimport { isUndef } from \"../util/TypeCheck.js\";\n/**\n * A Param class just for computing ticks. Similar to the {@link Param} class,\n * but offers conversion to BPM values as well as ability to compute tick\n * duration and elapsed ticks\n */\nexport class TickParam extends Param {\n    constructor() {\n        const options = optionsFromArguments(TickParam.getDefaults(), arguments, [\"value\"]);\n        super(options);\n        this.name = \"TickParam\";\n        /**\n         * The timeline which tracks all of the automations.\n         */\n        this._events = new Timeline(Infinity);\n        /**\n         * The internal holder for the multiplier value\n         */\n        this._multiplier = 1;\n        // set the multiplier\n        this._multiplier = options.multiplier;\n        // clear the ticks from the beginning\n        this._events.cancel(0);\n        // set an initial event\n        this._events.add({\n            ticks: 0,\n            time: 0,\n            type: \"setValueAtTime\",\n            value: this._fromType(options.value),\n        });\n        this.setValueAtTime(options.value, 0);\n    }\n    static getDefaults() {\n        return Object.assign(Param.getDefaults(), {\n            multiplier: 1,\n            units: \"hertz\",\n            value: 1,\n        });\n    }\n    setTargetAtTime(value, time, constant) {\n        // approximate it with multiple linear ramps\n        time = this.toSeconds(time);\n        this.setRampPoint(time);\n        const computedValue = this._fromType(value);\n        // start from previously scheduled value\n        const prevEvent = this._events.get(time);\n        const segments = Math.round(Math.max(1 / constant, 1));\n        for (let i = 0; i <= segments; i++) {\n            const segTime = constant * i + time;\n            const rampVal = this._exponentialApproach(prevEvent.time, prevEvent.value, computedValue, constant, segTime);\n            this.linearRampToValueAtTime(this._toType(rampVal), segTime);\n        }\n        return this;\n    }\n    setValueAtTime(value, time) {\n        const computedTime = this.toSeconds(time);\n        super.setValueAtTime(value, time);\n        const event = this._events.get(computedTime);\n        const previousEvent = this._events.previousEvent(event);\n        const ticksUntilTime = this._getTicksUntilEvent(previousEvent, computedTime);\n        event.ticks = Math.max(ticksUntilTime, 0);\n        return this;\n    }\n    linearRampToValueAtTime(value, time) {\n        const computedTime = this.toSeconds(time);\n        super.linearRampToValueAtTime(value, time);\n        const event = this._events.get(computedTime);\n        const previousEvent = this._events.previousEvent(event);\n        const ticksUntilTime = this._getTicksUntilEvent(previousEvent, computedTime);\n        event.ticks = Math.max(ticksUntilTime, 0);\n        return this;\n    }\n    exponentialRampToValueAtTime(value, time) {\n        // aproximate it with multiple linear ramps\n        time = this.toSeconds(time);\n        const computedVal = this._fromType(value);\n        // start from previously scheduled value\n        const prevEvent = this._events.get(time);\n        // approx 10 segments per second\n        const segments = Math.round(Math.max((time - prevEvent.time) * 10, 1));\n        const segmentDur = (time - prevEvent.time) / segments;\n        for (let i = 0; i <= segments; i++) {\n            const segTime = segmentDur * i + prevEvent.time;\n            const rampVal = this._exponentialInterpolate(prevEvent.time, prevEvent.value, time, computedVal, segTime);\n            this.linearRampToValueAtTime(this._toType(rampVal), segTime);\n        }\n        return this;\n    }\n    /**\n     * Returns the tick value at the time. Takes into account\n     * any automation curves scheduled on the signal.\n     * @param  event The time to get the tick count at\n     * @return The number of ticks which have elapsed at the time given any automations.\n     */\n    _getTicksUntilEvent(event, time) {\n        if (event === null) {\n            event = {\n                ticks: 0,\n                time: 0,\n                type: \"setValueAtTime\",\n                value: 0,\n            };\n        }\n        else if (isUndef(event.ticks)) {\n            const previousEvent = this._events.previousEvent(event);\n            event.ticks = this._getTicksUntilEvent(previousEvent, event.time);\n        }\n        const val0 = this._fromType(this.getValueAtTime(event.time));\n        let val1 = this._fromType(this.getValueAtTime(time));\n        // if it's right on the line, take the previous value\n        const onTheLineEvent = this._events.get(time);\n        if (onTheLineEvent &&\n            onTheLineEvent.time === time &&\n            onTheLineEvent.type === \"setValueAtTime\") {\n            val1 = this._fromType(this.getValueAtTime(time - this.sampleTime));\n        }\n        return 0.5 * (time - event.time) * (val0 + val1) + event.ticks;\n    }\n    /**\n     * Returns the tick value at the time. Takes into account\n     * any automation curves scheduled on the signal.\n     * @param  time The time to get the tick count at\n     * @return The number of ticks which have elapsed at the time given any automations.\n     */\n    getTicksAtTime(time) {\n        const computedTime = this.toSeconds(time);\n        const event = this._events.get(computedTime);\n        return Math.max(this._getTicksUntilEvent(event, computedTime), 0);\n    }\n    /**\n     * Return the elapsed time of the number of ticks from the given time\n     * @param ticks The number of ticks to calculate\n     * @param  time The time to get the next tick from\n     * @return The duration of the number of ticks from the given time in seconds\n     */\n    getDurationOfTicks(ticks, time) {\n        const computedTime = this.toSeconds(time);\n        const currentTick = this.getTicksAtTime(time);\n        return this.getTimeOfTick(currentTick + ticks) - computedTime;\n    }\n    /**\n     * Given a tick, returns the time that tick occurs at.\n     * @return The time that the tick occurs.\n     */\n    getTimeOfTick(tick) {\n        const before = this._events.get(tick, \"ticks\");\n        const after = this._events.getAfter(tick, \"ticks\");\n        if (before && before.ticks === tick) {\n            return before.time;\n        }\n        else if (before &&\n            after &&\n            after.type === \"linearRampToValueAtTime\" &&\n            before.value !== after.value) {\n            const val0 = this._fromType(this.getValueAtTime(before.time));\n            const val1 = this._fromType(this.getValueAtTime(after.time));\n            const delta = (val1 - val0) / (after.time - before.time);\n            const k = Math.sqrt(Math.pow(val0, 2) - 2 * delta * (before.ticks - tick));\n            const sol1 = (-val0 + k) / delta;\n            const sol2 = (-val0 - k) / delta;\n            return (sol1 > 0 ? sol1 : sol2) + before.time;\n        }\n        else if (before) {\n            if (before.value === 0) {\n                return Infinity;\n            }\n            else {\n                return before.time + (tick - before.ticks) / before.value;\n            }\n        }\n        else {\n            return tick / this._initialValue;\n        }\n    }\n    /**\n     * Convert some number of ticks their the duration in seconds accounting\n     * for any automation curves starting at the given time.\n     * @param  ticks The number of ticks to convert to seconds.\n     * @param  when  When along the automation timeline to convert the ticks.\n     * @return The duration in seconds of the ticks.\n     */\n    ticksToTime(ticks, when) {\n        return this.getDurationOfTicks(ticks, when);\n    }\n    /**\n     * The inverse of {@link ticksToTime}. Convert a duration in\n     * seconds to the corresponding number of ticks accounting for any\n     * automation curves starting at the given time.\n     * @param  duration The time interval to convert to ticks.\n     * @param  when When along the automation timeline to convert the ticks.\n     * @return The duration in ticks.\n     */\n    timeToTicks(duration, when) {\n        const computedTime = this.toSeconds(when);\n        const computedDuration = this.toSeconds(duration);\n        const startTicks = this.getTicksAtTime(computedTime);\n        const endTicks = this.getTicksAtTime(computedTime + computedDuration);\n        return endTicks - startTicks;\n    }\n    /**\n     * Convert from the type when the unit value is BPM\n     */\n    _fromType(val) {\n        if (this.units === \"bpm\" && this.multiplier) {\n            return 1 / (60 / val / this.multiplier);\n        }\n        else {\n            return super._fromType(val);\n        }\n    }\n    /**\n     * Special case of type conversion where the units === \"bpm\"\n     */\n    _toType(val) {\n        if (this.units === \"bpm\" && this.multiplier) {\n            return ((val / this.multiplier) * 60);\n        }\n        else {\n            return super._toType(val);\n        }\n    }\n    /**\n     * A multiplier on the bpm value. Useful for setting a PPQ relative to the base frequency value.\n     */\n    get multiplier() {\n        return this._multiplier;\n    }\n    set multiplier(m) {\n        // get and reset the current value with the new multiplier\n        // might be necessary to clear all the previous values\n        const currentVal = this.value;\n        this._multiplier = m;\n        this.cancelScheduledValues(0);\n        this.setValueAtTime(currentVal, 0);\n    }\n}\n//# sourceMappingURL=TickParam.js.map","import { Signal } from \"../../signal/Signal.js\";\nimport { optionsFromArguments } from \"../util/Defaults.js\";\nimport { TickParam } from \"./TickParam.js\";\n/**\n * TickSignal extends Tone.Signal, but adds the capability\n * to calculate the number of elapsed ticks. exponential and target curves\n * are approximated with multiple linear ramps.\n *\n * Thank you Bruno Dias, H. Sofia Pinto, and David M. Matos,\n * for your [WAC paper](https://smartech.gatech.edu/bitstream/handle/1853/54588/WAC2016-49.pdf)\n * describing integrating timing functions for tempo calculations.\n */\nexport class TickSignal extends Signal {\n    constructor() {\n        const options = optionsFromArguments(TickSignal.getDefaults(), arguments, [\"value\"]);\n        super(options);\n        this.name = \"TickSignal\";\n        this.input = this._param = new TickParam({\n            context: this.context,\n            convert: options.convert,\n            multiplier: options.multiplier,\n            param: this._constantSource.offset,\n            units: options.units,\n            value: options.value,\n        });\n    }\n    static getDefaults() {\n        return Object.assign(Signal.getDefaults(), {\n            multiplier: 1,\n            units: \"hertz\",\n            value: 1,\n        });\n    }\n    ticksToTime(ticks, when) {\n        return this._param.ticksToTime(ticks, when);\n    }\n    timeToTicks(duration, when) {\n        return this._param.timeToTicks(duration, when);\n    }\n    getTimeOfTick(tick) {\n        return this._param.getTimeOfTick(tick);\n    }\n    getDurationOfTicks(ticks, time) {\n        return this._param.getDurationOfTicks(ticks, time);\n    }\n    getTicksAtTime(time) {\n        return this._param.getTicksAtTime(time);\n    }\n    /**\n     * A multiplier on the bpm value. Useful for setting a PPQ relative to the base frequency value.\n     */\n    get multiplier() {\n        return this._param.multiplier;\n    }\n    set multiplier(m) {\n        this._param.multiplier = m;\n    }\n    dispose() {\n        super.dispose();\n        this._param.dispose();\n        return this;\n    }\n}\n//# sourceMappingURL=TickSignal.js.map","import { ToneWithContext, } from \"../context/ToneWithContext.js\";\nimport { optionsFromArguments } from \"../util/Defaults.js\";\nimport { readOnly } from \"../util/Interface.js\";\nimport { StateTimeline, } from \"../util/StateTimeline.js\";\nimport { Timeline } from \"../util/Timeline.js\";\nimport { isDefined } from \"../util/TypeCheck.js\";\nimport { TickSignal } from \"./TickSignal.js\";\nimport { EQ } from \"../util/Math.js\";\n/**\n * Uses [TickSignal](TickSignal) to track elapsed ticks with complex automation curves.\n */\nexport class TickSource extends ToneWithContext {\n    constructor() {\n        const options = optionsFromArguments(TickSource.getDefaults(), arguments, [\"frequency\"]);\n        super(options);\n        this.name = \"TickSource\";\n        /**\n         * The state timeline\n         */\n        this._state = new StateTimeline();\n        /**\n         * The offset values of the ticks\n         */\n        this._tickOffset = new Timeline();\n        /**\n         * Memoized values of getTicksAtTime at events with state other than \"started\"\n         */\n        this._ticksAtTime = new Timeline();\n        /**\n         * Memoized values of getSecondsAtTime at events with state other than \"started\"\n         */\n        this._secondsAtTime = new Timeline();\n        this.frequency = new TickSignal({\n            context: this.context,\n            units: options.units,\n            value: options.frequency,\n        });\n        readOnly(this, \"frequency\");\n        // set the initial state\n        this._state.setStateAtTime(\"stopped\", 0);\n        // add the first event\n        this.setTicksAtTime(0, 0);\n    }\n    static getDefaults() {\n        return Object.assign({\n            frequency: 1,\n            units: \"hertz\",\n        }, ToneWithContext.getDefaults());\n    }\n    /**\n     * Returns the playback state of the source, either \"started\", \"stopped\" or \"paused\".\n     */\n    get state() {\n        return this.getStateAtTime(this.now());\n    }\n    /**\n     * Start the clock at the given time. Optionally pass in an offset\n     * of where to start the tick counter from.\n     * @param  time    The time the clock should start\n     * @param offset The number of ticks to start the source at\n     */\n    start(time, offset) {\n        const computedTime = this.toSeconds(time);\n        if (this._state.getValueAtTime(computedTime) !== \"started\") {\n            this._state.setStateAtTime(\"started\", computedTime);\n            if (isDefined(offset)) {\n                this.setTicksAtTime(offset, computedTime);\n            }\n            this._ticksAtTime.cancel(computedTime);\n            this._secondsAtTime.cancel(computedTime);\n        }\n        return this;\n    }\n    /**\n     * Stop the clock. Stopping the clock resets the tick counter to 0.\n     * @param time The time when the clock should stop.\n     */\n    stop(time) {\n        const computedTime = this.toSeconds(time);\n        // cancel the previous stop\n        if (this._state.getValueAtTime(computedTime) === \"stopped\") {\n            const event = this._state.get(computedTime);\n            if (event && event.time > 0) {\n                this._tickOffset.cancel(event.time);\n                this._state.cancel(event.time);\n            }\n        }\n        this._state.cancel(computedTime);\n        this._state.setStateAtTime(\"stopped\", computedTime);\n        this.setTicksAtTime(0, computedTime);\n        this._ticksAtTime.cancel(computedTime);\n        this._secondsAtTime.cancel(computedTime);\n        return this;\n    }\n    /**\n     * Pause the clock. Pausing does not reset the tick counter.\n     * @param time The time when the clock should stop.\n     */\n    pause(time) {\n        const computedTime = this.toSeconds(time);\n        if (this._state.getValueAtTime(computedTime) === \"started\") {\n            this._state.setStateAtTime(\"paused\", computedTime);\n            this._ticksAtTime.cancel(computedTime);\n            this._secondsAtTime.cancel(computedTime);\n        }\n        return this;\n    }\n    /**\n     * Cancel start/stop/pause and setTickAtTime events scheduled after the given time.\n     * @param time When to clear the events after\n     */\n    cancel(time) {\n        time = this.toSeconds(time);\n        this._state.cancel(time);\n        this._tickOffset.cancel(time);\n        this._ticksAtTime.cancel(time);\n        this._secondsAtTime.cancel(time);\n        return this;\n    }\n    /**\n     * Get the elapsed ticks at the given time\n     * @param  time  When to get the tick value\n     * @return The number of ticks\n     */\n    getTicksAtTime(time) {\n        const computedTime = this.toSeconds(time);\n        const stopEvent = this._state.getLastState(\"stopped\", computedTime);\n        // get previously memoized ticks if available\n        const memoizedEvent = this._ticksAtTime.get(computedTime);\n        // this event allows forEachBetween to iterate until the current time\n        const tmpEvent = {\n            state: \"paused\",\n            time: computedTime,\n        };\n        this._state.add(tmpEvent);\n        // keep track of the previous offset event\n        let lastState = memoizedEvent ? memoizedEvent : stopEvent;\n        let elapsedTicks = memoizedEvent ? memoizedEvent.ticks : 0;\n        let eventToMemoize = null;\n        // iterate through all the events since the last stop\n        this._state.forEachBetween(lastState.time, computedTime + this.sampleTime, (e) => {\n            let periodStartTime = lastState.time;\n            // if there is an offset event in this period use that\n            const offsetEvent = this._tickOffset.get(e.time);\n            if (offsetEvent && offsetEvent.time >= lastState.time) {\n                elapsedTicks = offsetEvent.ticks;\n                periodStartTime = offsetEvent.time;\n            }\n            if (lastState.state === \"started\" && e.state !== \"started\") {\n                elapsedTicks +=\n                    this.frequency.getTicksAtTime(e.time) -\n                        this.frequency.getTicksAtTime(periodStartTime);\n                // do not memoize the temporary event\n                if (e.time !== tmpEvent.time) {\n                    eventToMemoize = {\n                        state: e.state,\n                        time: e.time,\n                        ticks: elapsedTicks,\n                    };\n                }\n            }\n            lastState = e;\n        });\n        // remove the temporary event\n        this._state.remove(tmpEvent);\n        // memoize the ticks at the most recent event with state other than \"started\"\n        if (eventToMemoize) {\n            this._ticksAtTime.add(eventToMemoize);\n        }\n        // return the ticks\n        return elapsedTicks;\n    }\n    /**\n     * The number of times the callback was invoked. Starts counting at 0\n     * and increments after the callback was invoked. Returns -1 when stopped.\n     */\n    get ticks() {\n        return this.getTicksAtTime(this.now());\n    }\n    set ticks(t) {\n        this.setTicksAtTime(t, this.now());\n    }\n    /**\n     * The time since ticks=0 that the TickSource has been running. Accounts\n     * for tempo curves\n     */\n    get seconds() {\n        return this.getSecondsAtTime(this.now());\n    }\n    set seconds(s) {\n        const now = this.now();\n        const ticks = this.frequency.timeToTicks(s, now);\n        this.setTicksAtTime(ticks, now);\n    }\n    /**\n     * Return the elapsed seconds at the given time.\n     * @param  time  When to get the elapsed seconds\n     * @return  The number of elapsed seconds\n     */\n    getSecondsAtTime(time) {\n        time = this.toSeconds(time);\n        const stopEvent = this._state.getLastState(\"stopped\", time);\n        // this event allows forEachBetween to iterate until the current time\n        const tmpEvent = { state: \"paused\", time };\n        this._state.add(tmpEvent);\n        // get previously memoized seconds if available\n        const memoizedEvent = this._secondsAtTime.get(time);\n        // keep track of the previous offset event\n        let lastState = memoizedEvent ? memoizedEvent : stopEvent;\n        let elapsedSeconds = memoizedEvent ? memoizedEvent.seconds : 0;\n        let eventToMemoize = null;\n        // iterate through all the events since the last stop\n        this._state.forEachBetween(lastState.time, time + this.sampleTime, (e) => {\n            let periodStartTime = lastState.time;\n            // if there is an offset event in this period use that\n            const offsetEvent = this._tickOffset.get(e.time);\n            if (offsetEvent && offsetEvent.time >= lastState.time) {\n                elapsedSeconds = offsetEvent.seconds;\n                periodStartTime = offsetEvent.time;\n            }\n            if (lastState.state === \"started\" && e.state !== \"started\") {\n                elapsedSeconds += e.time - periodStartTime;\n                // do not memoize the temporary event\n                if (e.time !== tmpEvent.time) {\n                    eventToMemoize = {\n                        state: e.state,\n                        time: e.time,\n                        seconds: elapsedSeconds,\n                    };\n                }\n            }\n            lastState = e;\n        });\n        // remove the temporary event\n        this._state.remove(tmpEvent);\n        // memoize the seconds at the most recent event with state other than \"started\"\n        if (eventToMemoize) {\n            this._secondsAtTime.add(eventToMemoize);\n        }\n        // return the seconds\n        return elapsedSeconds;\n    }\n    /**\n     * Set the clock's ticks at the given time.\n     * @param  ticks The tick value to set\n     * @param  time  When to set the tick value\n     */\n    setTicksAtTime(ticks, time) {\n        time = this.toSeconds(time);\n        this._tickOffset.cancel(time);\n        this._tickOffset.add({\n            seconds: this.frequency.getDurationOfTicks(ticks, time),\n            ticks,\n            time,\n        });\n        this._ticksAtTime.cancel(time);\n        this._secondsAtTime.cancel(time);\n        return this;\n    }\n    /**\n     * Returns the scheduled state at the given time.\n     * @param  time  The time to query.\n     */\n    getStateAtTime(time) {\n        time = this.toSeconds(time);\n        return this._state.getValueAtTime(time);\n    }\n    /**\n     * Get the time of the given tick. The second argument\n     * is when to test before. Since ticks can be set (with setTicksAtTime)\n     * there may be multiple times for a given tick value.\n     * @param  tick The tick number.\n     * @param  before When to measure the tick value from.\n     * @return The time of the tick\n     */\n    getTimeOfTick(tick, before = this.now()) {\n        const offset = this._tickOffset.get(before);\n        const event = this._state.get(before);\n        const startTime = Math.max(offset.time, event.time);\n        const absoluteTicks = this.frequency.getTicksAtTime(startTime) + tick - offset.ticks;\n        return this.frequency.getTimeOfTick(absoluteTicks);\n    }\n    /**\n     * Invoke the callback event at all scheduled ticks between the\n     * start time and the end time\n     * @param  startTime  The beginning of the search range\n     * @param  endTime    The end of the search range\n     * @param  callback   The callback to invoke with each tick\n     */\n    forEachTickBetween(startTime, endTime, callback) {\n        // only iterate through the sections where it is \"started\"\n        let lastStateEvent = this._state.get(startTime);\n        this._state.forEachBetween(startTime, endTime, (event) => {\n            if (lastStateEvent &&\n                lastStateEvent.state === \"started\" &&\n                event.state !== \"started\") {\n                this.forEachTickBetween(Math.max(lastStateEvent.time, startTime), event.time - this.sampleTime, callback);\n            }\n            lastStateEvent = event;\n        });\n        let error = null;\n        if (lastStateEvent && lastStateEvent.state === \"started\") {\n            const maxStartTime = Math.max(lastStateEvent.time, startTime);\n            // figure out the difference between the frequency ticks and the\n            const startTicks = this.frequency.getTicksAtTime(maxStartTime);\n            const ticksAtStart = this.frequency.getTicksAtTime(lastStateEvent.time);\n            const diff = startTicks - ticksAtStart;\n            let offset = Math.ceil(diff) - diff;\n            // guard against floating point issues\n            offset = EQ(offset, 1) ? 0 : offset;\n            let nextTickTime = this.frequency.getTimeOfTick(startTicks + offset);\n            while (nextTickTime < endTime) {\n                try {\n                    callback(nextTickTime, Math.round(this.getTicksAtTime(nextTickTime)));\n                }\n                catch (e) {\n                    error = e;\n                    break;\n                }\n                nextTickTime += this.frequency.getDurationOfTicks(1, nextTickTime);\n            }\n        }\n        if (error) {\n            throw error;\n        }\n        return this;\n    }\n    /**\n     * Clean up\n     */\n    dispose() {\n        super.dispose();\n        this._state.dispose();\n        this._tickOffset.dispose();\n        this._ticksAtTime.dispose();\n        this._secondsAtTime.dispose();\n        this.frequency.dispose();\n        return this;\n    }\n}\n//# sourceMappingURL=TickSource.js.map","import { ToneWithContext, } from \"../context/ToneWithContext.js\";\nimport { optionsFromArguments } from \"../util/Defaults.js\";\nimport { Emitter } from \"../util/Emitter.js\";\nimport { noOp, readOnly } from \"../util/Interface.js\";\nimport { StateTimeline } from \"../util/StateTimeline.js\";\nimport { TickSource } from \"./TickSource.js\";\nimport { assertContextRunning } from \"../util/Debug.js\";\n/**\n * A sample accurate clock which provides a callback at the given rate.\n * While the callback is not sample-accurate (it is still susceptible to\n * loose JS timing), the time passed in as the argument to the callback\n * is precise. For most applications, it is better to use Tone.Transport\n * instead of the Clock by itself since you can synchronize multiple callbacks.\n * @example\n * // the callback will be invoked approximately once a second\n * // and will print the time exactly once a second apart.\n * const clock = new Tone.Clock(time => {\n * \tconsole.log(time);\n * }, 1);\n * clock.start();\n * @category Core\n */\nexport class Clock extends ToneWithContext {\n    constructor() {\n        const options = optionsFromArguments(Clock.getDefaults(), arguments, [\n            \"callback\",\n            \"frequency\",\n        ]);\n        super(options);\n        this.name = \"Clock\";\n        /**\n         * The callback function to invoke at the scheduled tick.\n         */\n        this.callback = noOp;\n        /**\n         * The last time the loop callback was invoked\n         */\n        this._lastUpdate = 0;\n        /**\n         * Keep track of the playback state\n         */\n        this._state = new StateTimeline(\"stopped\");\n        /**\n         * Context bound reference to the _loop method\n         * This is necessary to remove the event in the end.\n         */\n        this._boundLoop = this._loop.bind(this);\n        this.callback = options.callback;\n        this._tickSource = new TickSource({\n            context: this.context,\n            frequency: options.frequency,\n            units: options.units,\n        });\n        this._lastUpdate = 0;\n        this.frequency = this._tickSource.frequency;\n        readOnly(this, \"frequency\");\n        // add an initial state\n        this._state.setStateAtTime(\"stopped\", 0);\n        // bind a callback to the worker thread\n        this.context.on(\"tick\", this._boundLoop);\n    }\n    static getDefaults() {\n        return Object.assign(ToneWithContext.getDefaults(), {\n            callback: noOp,\n            frequency: 1,\n            units: \"hertz\",\n        });\n    }\n    /**\n     * Returns the playback state of the source, either \"started\", \"stopped\" or \"paused\".\n     */\n    get state() {\n        return this._state.getValueAtTime(this.now());\n    }\n    /**\n     * Start the clock at the given time. Optionally pass in an offset\n     * of where to start the tick counter from.\n     * @param  time    The time the clock should start\n     * @param offset  Where the tick counter starts counting from.\n     */\n    start(time, offset) {\n        // make sure the context is running\n        assertContextRunning(this.context);\n        // start the loop\n        const computedTime = this.toSeconds(time);\n        this.log(\"start\", computedTime);\n        if (this._state.getValueAtTime(computedTime) !== \"started\") {\n            this._state.setStateAtTime(\"started\", computedTime);\n            this._tickSource.start(computedTime, offset);\n            if (computedTime < this._lastUpdate) {\n                this.emit(\"start\", computedTime, offset);\n            }\n        }\n        return this;\n    }\n    /**\n     * Stop the clock. Stopping the clock resets the tick counter to 0.\n     * @param time The time when the clock should stop.\n     * @example\n     * const clock = new Tone.Clock(time => {\n     * \tconsole.log(time);\n     * }, 1);\n     * clock.start();\n     * // stop the clock after 10 seconds\n     * clock.stop(\"+10\");\n     */\n    stop(time) {\n        const computedTime = this.toSeconds(time);\n        this.log(\"stop\", computedTime);\n        this._state.cancel(computedTime);\n        this._state.setStateAtTime(\"stopped\", computedTime);\n        this._tickSource.stop(computedTime);\n        if (computedTime < this._lastUpdate) {\n            this.emit(\"stop\", computedTime);\n        }\n        return this;\n    }\n    /**\n     * Pause the clock. Pausing does not reset the tick counter.\n     * @param time The time when the clock should stop.\n     */\n    pause(time) {\n        const computedTime = this.toSeconds(time);\n        if (this._state.getValueAtTime(computedTime) === \"started\") {\n            this._state.setStateAtTime(\"paused\", computedTime);\n            this._tickSource.pause(computedTime);\n            if (computedTime < this._lastUpdate) {\n                this.emit(\"pause\", computedTime);\n            }\n        }\n        return this;\n    }\n    /**\n     * The number of times the callback was invoked. Starts counting at 0\n     * and increments after the callback was invoked.\n     */\n    get ticks() {\n        return Math.ceil(this.getTicksAtTime(this.now()));\n    }\n    set ticks(t) {\n        this._tickSource.ticks = t;\n    }\n    /**\n     * The time since ticks=0 that the Clock has been running. Accounts for tempo curves\n     */\n    get seconds() {\n        return this._tickSource.seconds;\n    }\n    set seconds(s) {\n        this._tickSource.seconds = s;\n    }\n    /**\n     * Return the elapsed seconds at the given time.\n     * @param  time  When to get the elapsed seconds\n     * @return  The number of elapsed seconds\n     */\n    getSecondsAtTime(time) {\n        return this._tickSource.getSecondsAtTime(time);\n    }\n    /**\n     * Set the clock's ticks at the given time.\n     * @param  ticks The tick value to set\n     * @param  time  When to set the tick value\n     */\n    setTicksAtTime(ticks, time) {\n        this._tickSource.setTicksAtTime(ticks, time);\n        return this;\n    }\n    /**\n     * Get the time of the given tick. The second argument\n     * is when to test before. Since ticks can be set (with setTicksAtTime)\n     * there may be multiple times for a given tick value.\n     * @param  tick The tick number.\n     * @param  before When to measure the tick value from.\n     * @return The time of the tick\n     */\n    getTimeOfTick(tick, before = this.now()) {\n        return this._tickSource.getTimeOfTick(tick, before);\n    }\n    /**\n     * Get the clock's ticks at the given time.\n     * @param  time  When to get the tick value\n     * @return The tick value at the given time.\n     */\n    getTicksAtTime(time) {\n        return this._tickSource.getTicksAtTime(time);\n    }\n    /**\n     * Get the time of the next tick\n     * @param  offset The tick number.\n     */\n    nextTickTime(offset, when) {\n        const computedTime = this.toSeconds(when);\n        const currentTick = this.getTicksAtTime(computedTime);\n        return this._tickSource.getTimeOfTick(currentTick + offset, computedTime);\n    }\n    /**\n     * The scheduling loop.\n     */\n    _loop() {\n        const startTime = this._lastUpdate;\n        const endTime = this.now();\n        this._lastUpdate = endTime;\n        this.log(\"loop\", startTime, endTime);\n        if (startTime !== endTime) {\n            // the state change events\n            this._state.forEachBetween(startTime, endTime, (e) => {\n                switch (e.state) {\n                    case \"started\":\n                        const offset = this._tickSource.getTicksAtTime(e.time);\n                        this.emit(\"start\", e.time, offset);\n                        break;\n                    case \"stopped\":\n                        if (e.time !== 0) {\n                            this.emit(\"stop\", e.time);\n                        }\n                        break;\n                    case \"paused\":\n                        this.emit(\"pause\", e.time);\n                        break;\n                }\n            });\n            // the tick callbacks\n            this._tickSource.forEachTickBetween(startTime, endTime, (time, ticks) => {\n                this.callback(time, ticks);\n            });\n        }\n    }\n    /**\n     * Returns the scheduled state at the given time.\n     * @param  time  The time to query.\n     * @return  The name of the state input in setStateAtTime.\n     * @example\n     * const clock = new Tone.Clock();\n     * clock.start(\"+0.1\");\n     * clock.getStateAtTime(\"+0.1\"); // returns \"started\"\n     */\n    getStateAtTime(time) {\n        const computedTime = this.toSeconds(time);\n        return this._state.getValueAtTime(computedTime);\n    }\n    /**\n     * Clean up\n     */\n    dispose() {\n        super.dispose();\n        this.context.off(\"tick\", this._boundLoop);\n        this._tickSource.dispose();\n        this._state.dispose();\n        return this;\n    }\n}\nEmitter.mixin(Clock);\n//# sourceMappingURL=Clock.js.map","import { Gain } from \"../../core/context/Gain.js\";\nimport { ToneAudioNode, } from \"../../core/context/ToneAudioNode.js\";\nimport { optionsFromArguments } from \"../../core/util/Defaults.js\";\nimport { readOnly } from \"../../core/util/Interface.js\";\n/**\n * Volume is a simple volume node, useful for creating a volume fader.\n *\n * @example\n * const vol = new Tone.Volume(-12).toDestination();\n * const osc = new Tone.Oscillator().connect(vol).start();\n * @category Component\n */\nexport class Volume extends ToneAudioNode {\n    constructor() {\n        const options = optionsFromArguments(Volume.getDefaults(), arguments, [\n            \"volume\",\n        ]);\n        super(options);\n        this.name = \"Volume\";\n        this.input = this.output = new Gain({\n            context: this.context,\n            gain: options.volume,\n            units: \"decibels\",\n        });\n        this.volume = this.output.gain;\n        readOnly(this, \"volume\");\n        this._unmutedVolume = options.volume;\n        // set the mute initially\n        this.mute = options.mute;\n    }\n    static getDefaults() {\n        return Object.assign(ToneAudioNode.getDefaults(), {\n            mute: false,\n            volume: 0,\n        });\n    }\n    /**\n     * Mute the output.\n     * @example\n     * const vol = new Tone.Volume(-12).toDestination();\n     * const osc = new Tone.Oscillator().connect(vol).start();\n     * // mute the output\n     * vol.mute = true;\n     */\n    get mute() {\n        return this.volume.value === -Infinity;\n    }\n    set mute(mute) {\n        if (!this.mute && mute) {\n            this._unmutedVolume = this.volume.value;\n            // maybe it should ramp here?\n            this.volume.value = -Infinity;\n        }\n        else if (this.mute && !mute) {\n            this.volume.value = this._unmutedVolume;\n        }\n    }\n    /**\n     * clean up\n     */\n    dispose() {\n        super.dispose();\n        this.input.dispose();\n        this.volume.dispose();\n        return this;\n    }\n}\n//# sourceMappingURL=Volume.js.map","import { Volume } from \"../../component/channel/Volume.js\";\nimport { optionsFromArguments } from \"../util/Defaults.js\";\nimport { onContextClose, onContextInit } from \"./ContextInitialization.js\";\nimport { Gain } from \"./Gain.js\";\nimport { connectSeries, ToneAudioNode, } from \"./ToneAudioNode.js\";\n/**\n * A single master output which is connected to the\n * AudioDestinationNode (aka your speakers).\n * It provides useful conveniences such as the ability\n * to set the volume and mute the entire application.\n * It also gives you the ability to apply master effects to your application.\n *\n * @example\n * const oscillator = new Tone.Oscillator().start();\n * // the audio will go from the oscillator to the speakers\n * oscillator.connect(Tone.getDestination());\n * // a convenience for connecting to the master output is also provided:\n * oscillator.toDestination();\n * @category Core\n */\nexport class DestinationClass extends ToneAudioNode {\n    constructor() {\n        const options = optionsFromArguments(DestinationClass.getDefaults(), arguments);\n        super(options);\n        this.name = \"Destination\";\n        this.input = new Volume({ context: this.context });\n        this.output = new Gain({ context: this.context });\n        /**\n         * The volume of the master output in decibels. -Infinity is silent, and 0 is no change.\n         * @example\n         * const osc = new Tone.Oscillator().toDestination();\n         * osc.start();\n         * // ramp the volume down to silent over 10 seconds\n         * Tone.getDestination().volume.rampTo(-Infinity, 10);\n         */\n        this.volume = this.input.volume;\n        connectSeries(this.input, this.output, this.context.rawContext.destination);\n        this.mute = options.mute;\n        this._internalChannels = [\n            this.input,\n            this.context.rawContext.destination,\n            this.output,\n        ];\n    }\n    static getDefaults() {\n        return Object.assign(ToneAudioNode.getDefaults(), {\n            mute: false,\n            volume: 0,\n        });\n    }\n    /**\n     * Mute the output.\n     * @example\n     * const oscillator = new Tone.Oscillator().start().toDestination();\n     * setTimeout(() => {\n     * \t// mute the output\n     * \tTone.Destination.mute = true;\n     * }, 1000);\n     */\n    get mute() {\n        return this.input.mute;\n    }\n    set mute(mute) {\n        this.input.mute = mute;\n    }\n    /**\n     * Add a master effects chain. NOTE: this will disconnect any nodes which were previously\n     * chained in the master effects chain.\n     * @param args All arguments will be connected in a row and the Master will be routed through it.\n     * @example\n     * // route all audio through a filter and compressor\n     * const lowpass = new Tone.Filter(800, \"lowpass\");\n     * const compressor = new Tone.Compressor(-18);\n     * Tone.Destination.chain(lowpass, compressor);\n     */\n    chain(...args) {\n        this.input.disconnect();\n        args.unshift(this.input);\n        args.push(this.output);\n        connectSeries(...args);\n        return this;\n    }\n    /**\n     * The maximum number of channels the system can output\n     * @example\n     * console.log(Tone.Destination.maxChannelCount);\n     */\n    get maxChannelCount() {\n        return this.context.rawContext.destination.maxChannelCount;\n    }\n    /**\n     * Clean up\n     */\n    dispose() {\n        super.dispose();\n        this.volume.dispose();\n        return this;\n    }\n}\n//-------------------------------------\n// \tINITIALIZATION\n//-------------------------------------\nonContextInit((context) => {\n    context.destination = new DestinationClass({ context });\n});\nonContextClose((context) => {\n    context.destination.dispose();\n});\n//# sourceMappingURL=Destination.js.map","import { ToneAudioNode } from \"./ToneAudioNode.js\";\nimport { Param } from \"./Param.js\";\nimport { onContextClose, onContextInit } from \"./ContextInitialization.js\";\n/**\n * Tone.Listener is a thin wrapper around the AudioListener. Listener combined\n * with {@link Panner3D} makes up the Web Audio API's 3D panning system. Panner3D allows you\n * to place sounds in 3D and Listener allows you to navigate the 3D sound environment from\n * a first-person perspective. There is only one listener per audio context.\n */\nexport class ListenerClass extends ToneAudioNode {\n    constructor() {\n        super(...arguments);\n        this.name = \"Listener\";\n        this.positionX = new Param({\n            context: this.context,\n            param: this.context.rawContext.listener.positionX,\n        });\n        this.positionY = new Param({\n            context: this.context,\n            param: this.context.rawContext.listener.positionY,\n        });\n        this.positionZ = new Param({\n            context: this.context,\n            param: this.context.rawContext.listener.positionZ,\n        });\n        this.forwardX = new Param({\n            context: this.context,\n            param: this.context.rawContext.listener.forwardX,\n        });\n        this.forwardY = new Param({\n            context: this.context,\n            param: this.context.rawContext.listener.forwardY,\n        });\n        this.forwardZ = new Param({\n            context: this.context,\n            param: this.context.rawContext.listener.forwardZ,\n        });\n        this.upX = new Param({\n            context: this.context,\n            param: this.context.rawContext.listener.upX,\n        });\n        this.upY = new Param({\n            context: this.context,\n            param: this.context.rawContext.listener.upY,\n        });\n        this.upZ = new Param({\n            context: this.context,\n            param: this.context.rawContext.listener.upZ,\n        });\n    }\n    static getDefaults() {\n        return Object.assign(ToneAudioNode.getDefaults(), {\n            positionX: 0,\n            positionY: 0,\n            positionZ: 0,\n            forwardX: 0,\n            forwardY: 0,\n            forwardZ: -1,\n            upX: 0,\n            upY: 1,\n            upZ: 0,\n        });\n    }\n    dispose() {\n        super.dispose();\n        this.positionX.dispose();\n        this.positionY.dispose();\n        this.positionZ.dispose();\n        this.forwardX.dispose();\n        this.forwardY.dispose();\n        this.forwardZ.dispose();\n        this.upX.dispose();\n        this.upY.dispose();\n        this.upZ.dispose();\n        return this;\n    }\n}\n//-------------------------------------\n// \tINITIALIZATION\n//-------------------------------------\nonContextInit((context) => {\n    context.listener = new ListenerClass({ context });\n});\nonContextClose((context) => {\n    context.listener.dispose();\n});\n//# sourceMappingURL=Listener.js.map","import { Tone } from \"../Tone.js\";\nimport { optionsFromArguments } from \"../util/Defaults.js\";\nimport { noOp } from \"../util/Interface.js\";\nimport { isString } from \"../util/TypeCheck.js\";\nimport { ToneAudioBuffer } from \"./ToneAudioBuffer.js\";\nimport { assert } from \"../util/Debug.js\";\n/**\n * A data structure for holding multiple buffers in a Map-like datastructure.\n *\n * @example\n * const pianoSamples = new Tone.ToneAudioBuffers({\n * \tA1: \"https://tonejs.github.io/audio/casio/A1.mp3\",\n * \tA2: \"https://tonejs.github.io/audio/casio/A2.mp3\",\n * }, () => {\n * \tconst player = new Tone.Player().toDestination();\n * \t// play one of the samples when they all load\n * \tplayer.buffer = pianoSamples.get(\"A2\");\n * \tplayer.start();\n * });\n * @example\n * // To pass in additional parameters in the second parameter\n * const buffers = new Tone.ToneAudioBuffers({\n * \t urls: {\n * \t\t A1: \"A1.mp3\",\n * \t\t A2: \"A2.mp3\",\n * \t },\n * \t onload: () => console.log(\"loaded\"),\n * \t baseUrl: \"https://tonejs.github.io/audio/casio/\"\n * });\n * @category Core\n */\nexport class ToneAudioBuffers extends Tone {\n    constructor() {\n        super();\n        this.name = \"ToneAudioBuffers\";\n        /**\n         * All of the buffers\n         */\n        this._buffers = new Map();\n        /**\n         * Keep track of the number of loaded buffers\n         */\n        this._loadingCount = 0;\n        const options = optionsFromArguments(ToneAudioBuffers.getDefaults(), arguments, [\"urls\", \"onload\", \"baseUrl\"], \"urls\");\n        this.baseUrl = options.baseUrl;\n        // add each one\n        Object.keys(options.urls).forEach((name) => {\n            this._loadingCount++;\n            const url = options.urls[name];\n            this.add(name, url, this._bufferLoaded.bind(this, options.onload), options.onerror);\n        });\n    }\n    static getDefaults() {\n        return {\n            baseUrl: \"\",\n            onerror: noOp,\n            onload: noOp,\n            urls: {},\n        };\n    }\n    /**\n     * True if the buffers object has a buffer by that name.\n     * @param  name  The key or index of the buffer.\n     */\n    has(name) {\n        return this._buffers.has(name.toString());\n    }\n    /**\n     * Get a buffer by name. If an array was loaded,\n     * then use the array index.\n     * @param  name  The key or index of the buffer.\n     */\n    get(name) {\n        assert(this.has(name), `ToneAudioBuffers has no buffer named: ${name}`);\n        return this._buffers.get(name.toString());\n    }\n    /**\n     * A buffer was loaded. decrement the counter.\n     */\n    _bufferLoaded(callback) {\n        this._loadingCount--;\n        if (this._loadingCount === 0 && callback) {\n            callback();\n        }\n    }\n    /**\n     * If the buffers are loaded or not\n     */\n    get loaded() {\n        return Array.from(this._buffers).every(([_, buffer]) => buffer.loaded);\n    }\n    /**\n     * Add a buffer by name and url to the Buffers\n     * @param  name      A unique name to give the buffer\n     * @param  url  Either the url of the bufer, or a buffer which will be added with the given name.\n     * @param  callback  The callback to invoke when the url is loaded.\n     * @param  onerror  Invoked if the buffer can't be loaded\n     */\n    add(name, url, callback = noOp, onerror = noOp) {\n        if (isString(url)) {\n            // don't include the baseUrl if the url is a base64 encoded sound\n            if (this.baseUrl &&\n                url.trim().substring(0, 11).toLowerCase() === \"data:audio/\") {\n                this.baseUrl = \"\";\n            }\n            this._buffers.set(name.toString(), new ToneAudioBuffer(this.baseUrl + url, callback, onerror));\n        }\n        else {\n            this._buffers.set(name.toString(), new ToneAudioBuffer(url, callback, onerror));\n        }\n        return this;\n    }\n    dispose() {\n        super.dispose();\n        this._buffers.forEach((buffer) => buffer.dispose());\n        this._buffers.clear();\n        return this;\n    }\n}\n//# sourceMappingURL=ToneAudioBuffers.js.map","import { getContext } from \"../Global.js\";\nimport { ftom, mtof } from \"./Conversions.js\";\nimport { FrequencyClass } from \"./Frequency.js\";\n/**\n * Midi is a primitive type for encoding Time values.\n * Midi can be constructed with or without the `new` keyword. Midi can be passed\n * into the parameter of any method which takes time as an argument.\n * @category Unit\n */\nexport class MidiClass extends FrequencyClass {\n    constructor() {\n        super(...arguments);\n        this.name = \"MidiClass\";\n        this.defaultUnits = \"midi\";\n    }\n    /**\n     * Returns the value of a frequency in the current units\n     */\n    _frequencyToUnits(freq) {\n        return ftom(super._frequencyToUnits(freq));\n    }\n    /**\n     * Returns the value of a tick in the current time units\n     */\n    _ticksToUnits(ticks) {\n        return ftom(super._ticksToUnits(ticks));\n    }\n    /**\n     * Return the value of the beats in the current units\n     */\n    _beatsToUnits(beats) {\n        return ftom(super._beatsToUnits(beats));\n    }\n    /**\n     * Returns the value of a second in the current units\n     */\n    _secondsToUnits(seconds) {\n        return ftom(super._secondsToUnits(seconds));\n    }\n    /**\n     * Return the value of the frequency as a MIDI note\n     * @example\n     * Tone.Midi(60).toMidi(); // 60\n     */\n    toMidi() {\n        return this.valueOf();\n    }\n    /**\n     * Return the value of the frequency as a MIDI note\n     * @example\n     * Tone.Midi(60).toFrequency(); // 261.6255653005986\n     */\n    toFrequency() {\n        return mtof(this.toMidi());\n    }\n    /**\n     * Transposes the frequency by the given number of semitones.\n     * @return A new transposed MidiClass\n     * @example\n     * Tone.Midi(\"A4\").transpose(3); // \"C5\"\n     */\n    transpose(interval) {\n        return new MidiClass(this.context, this.toMidi() + interval);\n    }\n}\n/**\n * Convert a value into a FrequencyClass object.\n * @category Unit\n */\nexport function Midi(value, units) {\n    return new MidiClass(getContext(), value, units);\n}\n//# sourceMappingURL=Midi.js.map","import { getContext } from \"../Global.js\";\nimport { TransportTimeClass } from \"./TransportTime.js\";\n/**\n * Ticks is a primitive type for encoding Time values.\n * Ticks can be constructed with or without the `new` keyword. Ticks can be passed\n * into the parameter of any method which takes time as an argument.\n * @example\n * const t = Tone.Ticks(\"4n\"); // a quarter note as ticks\n * @category Unit\n */\nexport class TicksClass extends TransportTimeClass {\n    constructor() {\n        super(...arguments);\n        this.name = \"Ticks\";\n        this.defaultUnits = \"i\";\n    }\n    /**\n     * Get the current time in the given units\n     */\n    _now() {\n        return this.context.transport.ticks;\n    }\n    /**\n     * Return the value of the beats in the current units\n     */\n    _beatsToUnits(beats) {\n        return this._getPPQ() * beats;\n    }\n    /**\n     * Returns the value of a second in the current units\n     */\n    _secondsToUnits(seconds) {\n        return Math.floor((seconds / (60 / this._getBpm())) * this._getPPQ());\n    }\n    /**\n     * Returns the value of a tick in the current time units\n     */\n    _ticksToUnits(ticks) {\n        return ticks;\n    }\n    /**\n     * Return the time in ticks\n     */\n    toTicks() {\n        return this.valueOf();\n    }\n    /**\n     * Return the time in seconds\n     */\n    toSeconds() {\n        return (this.valueOf() / this._getPPQ()) * (60 / this._getBpm());\n    }\n}\n/**\n * Convert a time representation to ticks\n * @category Unit\n */\nexport function Ticks(value, units) {\n    return new TicksClass(getContext(), value, units);\n}\n//# sourceMappingURL=Ticks.js.map","import { ToneWithContext, } from \"../context/ToneWithContext.js\";\nimport { Timeline } from \"./Timeline.js\";\nimport { onContextClose, onContextInit, } from \"../context/ContextInitialization.js\";\n/**\n * Draw is useful for synchronizing visuals and audio events.\n * Callbacks from Tone.Transport or any of the Tone.Event classes\n * always happen _before_ the scheduled time and are not synchronized\n * to the animation frame so they are not good for triggering tightly\n * synchronized visuals and sound. Draw makes it easy to schedule\n * callbacks using the AudioContext time and uses requestAnimationFrame.\n * @example\n * Tone.Transport.schedule((time) => {\n * \t// use the time argument to schedule a callback with Draw\n * \tTone.Draw.schedule(() => {\n * \t\t// do drawing or DOM manipulation here\n * \t\tconsole.log(time);\n * \t}, time);\n * }, \"+0.5\");\n * Tone.Transport.start();\n * @category Core\n */\nexport class DrawClass extends ToneWithContext {\n    constructor() {\n        super(...arguments);\n        this.name = \"Draw\";\n        /**\n         * The duration after which events are not invoked.\n         */\n        this.expiration = 0.25;\n        /**\n         * The amount of time before the scheduled time\n         * that the callback can be invoked. Default is\n         * half the time of an animation frame (0.008 seconds).\n         */\n        this.anticipation = 0.008;\n        /**\n         * All of the events.\n         */\n        this._events = new Timeline();\n        /**\n         * The draw loop\n         */\n        this._boundDrawLoop = this._drawLoop.bind(this);\n        /**\n         * The animation frame id\n         */\n        this._animationFrame = -1;\n    }\n    /**\n     * Schedule a function at the given time to be invoked\n     * on the nearest animation frame.\n     * @param  callback  Callback is invoked at the given time.\n     * @param  time      The time relative to the AudioContext time to invoke the callback.\n     * @example\n     * Tone.Transport.scheduleRepeat(time => {\n     * \tTone.Draw.schedule(() => console.log(time), time);\n     * }, 1);\n     * Tone.Transport.start();\n     */\n    schedule(callback, time) {\n        this._events.add({\n            callback,\n            time: this.toSeconds(time),\n        });\n        // start the draw loop on the first event\n        if (this._events.length === 1) {\n            this._animationFrame = requestAnimationFrame(this._boundDrawLoop);\n        }\n        return this;\n    }\n    /**\n     * Cancel events scheduled after the given time\n     * @param  after  Time after which scheduled events will be removed from the scheduling timeline.\n     */\n    cancel(after) {\n        this._events.cancel(this.toSeconds(after));\n        return this;\n    }\n    /**\n     * The draw loop\n     */\n    _drawLoop() {\n        const now = this.context.currentTime;\n        this._events.forEachBefore(now + this.anticipation, (event) => {\n            if (now - event.time <= this.expiration) {\n                event.callback();\n            }\n            this._events.remove(event);\n        });\n        if (this._events.length > 0) {\n            this._animationFrame = requestAnimationFrame(this._boundDrawLoop);\n        }\n    }\n    dispose() {\n        super.dispose();\n        this._events.dispose();\n        cancelAnimationFrame(this._animationFrame);\n        return this;\n    }\n}\n//-------------------------------------\n// \tINITIALIZATION\n//-------------------------------------\nonContextInit((context) => {\n    context.draw = new DrawClass({ context });\n});\nonContextClose((context) => {\n    context.draw.dispose();\n});\n//# sourceMappingURL=Draw.js.map","import { Tone } from \"../Tone.js\";\nimport { isDefined } from \"./TypeCheck.js\";\nimport { assert } from \"./Debug.js\";\n/**\n * Similar to Tone.Timeline, but all events represent\n * intervals with both \"time\" and \"duration\" times. The\n * events are placed in a tree structure optimized\n * for querying an intersection point with the timeline\n * events. Internally uses an [Interval Tree](https://en.wikipedia.org/wiki/Interval_tree)\n * to represent the data.\n * @internal\n */\nexport class IntervalTimeline extends Tone {\n    constructor() {\n        super(...arguments);\n        this.name = \"IntervalTimeline\";\n        /**\n         * The root node of the inteval tree\n         */\n        this._root = null;\n        /**\n         * Keep track of the length of the timeline.\n         */\n        this._length = 0;\n    }\n    /**\n     * The event to add to the timeline. All events must\n     * have a time and duration value\n     * @param  event  The event to add to the timeline\n     */\n    add(event) {\n        assert(isDefined(event.time), \"Events must have a time property\");\n        assert(isDefined(event.duration), \"Events must have a duration parameter\");\n        event.time = event.time.valueOf();\n        let node = new IntervalNode(event.time, event.time + event.duration, event);\n        if (this._root === null) {\n            this._root = node;\n        }\n        else {\n            this._root.insert(node);\n        }\n        this._length++;\n        // Restructure tree to be balanced\n        while (node !== null) {\n            node.updateHeight();\n            node.updateMax();\n            this._rebalance(node);\n            node = node.parent;\n        }\n        return this;\n    }\n    /**\n     * Remove an event from the timeline.\n     * @param  event  The event to remove from the timeline\n     */\n    remove(event) {\n        if (this._root !== null) {\n            const results = [];\n            this._root.search(event.time, results);\n            for (const node of results) {\n                if (node.event === event) {\n                    this._removeNode(node);\n                    this._length--;\n                    break;\n                }\n            }\n        }\n        return this;\n    }\n    /**\n     * The number of items in the timeline.\n     * @readOnly\n     */\n    get length() {\n        return this._length;\n    }\n    /**\n     * Remove events whose time time is after the given time\n     * @param  after  The time to query.\n     */\n    cancel(after) {\n        this.forEachFrom(after, (event) => this.remove(event));\n        return this;\n    }\n    /**\n     * Set the root node as the given node\n     */\n    _setRoot(node) {\n        this._root = node;\n        if (this._root !== null) {\n            this._root.parent = null;\n        }\n    }\n    /**\n     * Replace the references to the node in the node's parent\n     * with the replacement node.\n     */\n    _replaceNodeInParent(node, replacement) {\n        if (node.parent !== null) {\n            if (node.isLeftChild()) {\n                node.parent.left = replacement;\n            }\n            else {\n                node.parent.right = replacement;\n            }\n            this._rebalance(node.parent);\n        }\n        else {\n            this._setRoot(replacement);\n        }\n    }\n    /**\n     * Remove the node from the tree and replace it with\n     * a successor which follows the schema.\n     */\n    _removeNode(node) {\n        if (node.left === null && node.right === null) {\n            this._replaceNodeInParent(node, null);\n        }\n        else if (node.right === null) {\n            this._replaceNodeInParent(node, node.left);\n        }\n        else if (node.left === null) {\n            this._replaceNodeInParent(node, node.right);\n        }\n        else {\n            const balance = node.getBalance();\n            let replacement;\n            let temp = null;\n            if (balance > 0) {\n                if (node.left.right === null) {\n                    replacement = node.left;\n                    replacement.right = node.right;\n                    temp = replacement;\n                }\n                else {\n                    replacement = node.left.right;\n                    while (replacement.right !== null) {\n                        replacement = replacement.right;\n                    }\n                    if (replacement.parent) {\n                        replacement.parent.right = replacement.left;\n                        temp = replacement.parent;\n                        replacement.left = node.left;\n                        replacement.right = node.right;\n                    }\n                }\n            }\n            else if (node.right.left === null) {\n                replacement = node.right;\n                replacement.left = node.left;\n                temp = replacement;\n            }\n            else {\n                replacement = node.right.left;\n                while (replacement.left !== null) {\n                    replacement = replacement.left;\n                }\n                if (replacement.parent) {\n                    replacement.parent.left = replacement.right;\n                    temp = replacement.parent;\n                    replacement.left = node.left;\n                    replacement.right = node.right;\n                }\n            }\n            if (node.parent !== null) {\n                if (node.isLeftChild()) {\n                    node.parent.left = replacement;\n                }\n                else {\n                    node.parent.right = replacement;\n                }\n            }\n            else {\n                this._setRoot(replacement);\n            }\n            if (temp) {\n                this._rebalance(temp);\n            }\n        }\n        node.dispose();\n    }\n    /**\n     * Rotate the tree to the left\n     */\n    _rotateLeft(node) {\n        const parent = node.parent;\n        const isLeftChild = node.isLeftChild();\n        // Make node.right the new root of this sub tree (instead of node)\n        const pivotNode = node.right;\n        if (pivotNode) {\n            node.right = pivotNode.left;\n            pivotNode.left = node;\n        }\n        if (parent !== null) {\n            if (isLeftChild) {\n                parent.left = pivotNode;\n            }\n            else {\n                parent.right = pivotNode;\n            }\n        }\n        else {\n            this._setRoot(pivotNode);\n        }\n    }\n    /**\n     * Rotate the tree to the right\n     */\n    _rotateRight(node) {\n        const parent = node.parent;\n        const isLeftChild = node.isLeftChild();\n        // Make node.left the new root of this sub tree (instead of node)\n        const pivotNode = node.left;\n        if (pivotNode) {\n            node.left = pivotNode.right;\n            pivotNode.right = node;\n        }\n        if (parent !== null) {\n            if (isLeftChild) {\n                parent.left = pivotNode;\n            }\n            else {\n                parent.right = pivotNode;\n            }\n        }\n        else {\n            this._setRoot(pivotNode);\n        }\n    }\n    /**\n     * Balance the BST\n     */\n    _rebalance(node) {\n        const balance = node.getBalance();\n        if (balance > 1 && node.left) {\n            if (node.left.getBalance() < 0) {\n                this._rotateLeft(node.left);\n            }\n            else {\n                this._rotateRight(node);\n            }\n        }\n        else if (balance < -1 && node.right) {\n            if (node.right.getBalance() > 0) {\n                this._rotateRight(node.right);\n            }\n            else {\n                this._rotateLeft(node);\n            }\n        }\n    }\n    /**\n     * Get an event whose time and duration span the give time. Will\n     * return the match whose \"time\" value is closest to the given time.\n     * @return  The event which spans the desired time\n     */\n    get(time) {\n        if (this._root !== null) {\n            const results = [];\n            this._root.search(time, results);\n            if (results.length > 0) {\n                let max = results[0];\n                for (let i = 1; i < results.length; i++) {\n                    if (results[i].low > max.low) {\n                        max = results[i];\n                    }\n                }\n                return max.event;\n            }\n        }\n        return null;\n    }\n    /**\n     * Iterate over everything in the timeline.\n     * @param  callback The callback to invoke with every item\n     */\n    forEach(callback) {\n        if (this._root !== null) {\n            const allNodes = [];\n            this._root.traverse((node) => allNodes.push(node));\n            allNodes.forEach((node) => {\n                if (node.event) {\n                    callback(node.event);\n                }\n            });\n        }\n        return this;\n    }\n    /**\n     * Iterate over everything in the array in which the given time\n     * overlaps with the time and duration time of the event.\n     * @param  time The time to check if items are overlapping\n     * @param  callback The callback to invoke with every item\n     */\n    forEachAtTime(time, callback) {\n        if (this._root !== null) {\n            const results = [];\n            this._root.search(time, results);\n            results.forEach((node) => {\n                if (node.event) {\n                    callback(node.event);\n                }\n            });\n        }\n        return this;\n    }\n    /**\n     * Iterate over everything in the array in which the time is greater\n     * than or equal to the given time.\n     * @param  time The time to check if items are before\n     * @param  callback The callback to invoke with every item\n     */\n    forEachFrom(time, callback) {\n        if (this._root !== null) {\n            const results = [];\n            this._root.searchAfter(time, results);\n            results.forEach((node) => {\n                if (node.event) {\n                    callback(node.event);\n                }\n            });\n        }\n        return this;\n    }\n    /**\n     * Clean up\n     */\n    dispose() {\n        super.dispose();\n        if (this._root !== null) {\n            this._root.traverse((node) => node.dispose());\n        }\n        this._root = null;\n        return this;\n    }\n}\n//-------------------------------------\n// \tINTERVAL NODE HELPER\n//-------------------------------------\n/**\n * Represents a node in the binary search tree, with the addition\n * of a \"high\" value which keeps track of the highest value of\n * its children.\n * References:\n * https://brooknovak.wordpress.com/2013/12/07/augmented-interval-tree-in-c/\n * http://www.mif.vu.lt/~valdas/ALGORITMAI/LITERATURA/Cormen/Cormen.pdf\n * @param low\n * @param high\n */\nclass IntervalNode {\n    constructor(low, high, event) {\n        // the nodes to the left\n        this._left = null;\n        // the nodes to the right\n        this._right = null;\n        // the parent node\n        this.parent = null;\n        // the number of child nodes\n        this.height = 0;\n        this.event = event;\n        // the low value\n        this.low = low;\n        // the high value\n        this.high = high;\n        // the high value for this and all child nodes\n        this.max = this.high;\n    }\n    /**\n     * Insert a node into the correct spot in the tree\n     */\n    insert(node) {\n        if (node.low <= this.low) {\n            if (this.left === null) {\n                this.left = node;\n            }\n            else {\n                this.left.insert(node);\n            }\n        }\n        else if (this.right === null) {\n            this.right = node;\n        }\n        else {\n            this.right.insert(node);\n        }\n    }\n    /**\n     * Search the tree for nodes which overlap\n     * with the given point\n     * @param  point  The point to query\n     * @param  results  The array to put the results\n     */\n    search(point, results) {\n        // If p is to the right of the rightmost point of any interval\n        // in this node and all children, there won't be any matches.\n        if (point > this.max) {\n            return;\n        }\n        // Search left children\n        if (this.left !== null) {\n            this.left.search(point, results);\n        }\n        // Check this node\n        if (this.low <= point && this.high > point) {\n            results.push(this);\n        }\n        // If p is to the left of the time of this interval,\n        // then it can't be in any child to the right.\n        if (this.low > point) {\n            return;\n        }\n        // Search right children\n        if (this.right !== null) {\n            this.right.search(point, results);\n        }\n    }\n    /**\n     * Search the tree for nodes which are less\n     * than the given point\n     * @param  point  The point to query\n     * @param  results  The array to put the results\n     */\n    searchAfter(point, results) {\n        // Check this node\n        if (this.low >= point) {\n            results.push(this);\n            if (this.left !== null) {\n                this.left.searchAfter(point, results);\n            }\n        }\n        // search the right side\n        if (this.right !== null) {\n            this.right.searchAfter(point, results);\n        }\n    }\n    /**\n     * Invoke the callback on this element and both it's branches\n     * @param  {Function}  callback\n     */\n    traverse(callback) {\n        callback(this);\n        if (this.left !== null) {\n            this.left.traverse(callback);\n        }\n        if (this.right !== null) {\n            this.right.traverse(callback);\n        }\n    }\n    /**\n     * Update the height of the node\n     */\n    updateHeight() {\n        if (this.left !== null && this.right !== null) {\n            this.height = Math.max(this.left.height, this.right.height) + 1;\n        }\n        else if (this.right !== null) {\n            this.height = this.right.height + 1;\n        }\n        else if (this.left !== null) {\n            this.height = this.left.height + 1;\n        }\n        else {\n            this.height = 0;\n        }\n    }\n    /**\n     * Update the height of the node\n     */\n    updateMax() {\n        this.max = this.high;\n        if (this.left !== null) {\n            this.max = Math.max(this.max, this.left.max);\n        }\n        if (this.right !== null) {\n            this.max = Math.max(this.max, this.right.max);\n        }\n    }\n    /**\n     * The balance is how the leafs are distributed on the node\n     * @return  Negative numbers are balanced to the right\n     */\n    getBalance() {\n        let balance = 0;\n        if (this.left !== null && this.right !== null) {\n            balance = this.left.height - this.right.height;\n        }\n        else if (this.left !== null) {\n            balance = this.left.height + 1;\n        }\n        else if (this.right !== null) {\n            balance = -(this.right.height + 1);\n        }\n        return balance;\n    }\n    /**\n     * @returns true if this node is the left child of its parent\n     */\n    isLeftChild() {\n        return this.parent !== null && this.parent.left === this;\n    }\n    /**\n     * get/set the left node\n     */\n    get left() {\n        return this._left;\n    }\n    set left(node) {\n        this._left = node;\n        if (node !== null) {\n            node.parent = this;\n        }\n        this.updateHeight();\n        this.updateMax();\n    }\n    /**\n     * get/set the right node\n     */\n    get right() {\n        return this._right;\n    }\n    set right(node) {\n        this._right = node;\n        if (node !== null) {\n            node.parent = this;\n        }\n        this.updateHeight();\n        this.updateMax();\n    }\n    /**\n     * null out references.\n     */\n    dispose() {\n        this.parent = null;\n        this._left = null;\n        this._right = null;\n        this.event = null;\n    }\n}\n//# sourceMappingURL=IntervalTimeline.js.map","import { Timeline } from \"./Timeline.js\";\nimport { Tone } from \"../Tone.js\";\n/**\n * Represents a single value which is gettable and settable in a timed way\n */\nexport class TimelineValue extends Tone {\n    /**\n     * @param initialValue The value to return if there is no scheduled values\n     */\n    constructor(initialValue) {\n        super();\n        this.name = \"TimelineValue\";\n        /**\n         * The timeline which stores the values\n         */\n        this._timeline = new Timeline({\n            memory: 10,\n        });\n        this._initialValue = initialValue;\n    }\n    /**\n     * Set the value at the given time\n     */\n    set(value, time) {\n        this._timeline.add({\n            value,\n            time,\n        });\n        return this;\n    }\n    /**\n     * Get the value at the given time\n     */\n    get(time) {\n        const event = this._timeline.get(time);\n        if (event) {\n            return event.value;\n        }\n        else {\n            return this._initialValue;\n        }\n    }\n}\n//# sourceMappingURL=TimelineValue.js.map","import { optionsFromArguments } from \"../core/util/Defaults.js\";\nimport { ToneAudioNode, } from \"../core/context/ToneAudioNode.js\";\nimport { connectSignal } from \"./Signal.js\";\n/**\n * A signal operator has an input and output and modifies the signal.\n */\nexport class SignalOperator extends ToneAudioNode {\n    constructor() {\n        super(optionsFromArguments(SignalOperator.getDefaults(), arguments, [\n            \"context\",\n        ]));\n    }\n    connect(destination, outputNum = 0, inputNum = 0) {\n        connectSignal(this, destination, outputNum, inputNum);\n        return this;\n    }\n}\n//# sourceMappingURL=SignalOperator.js.map","import { optionsFromArguments } from \"../core/util/Defaults.js\";\nimport { isArray, isFunction } from \"../core/util/TypeCheck.js\";\nimport { assert } from \"../core/util/Debug.js\";\nimport { Signal } from \"./Signal.js\";\nimport { SignalOperator } from \"./SignalOperator.js\";\n/**\n * Wraps the native Web Audio API\n * [WaveShaperNode](http://webaudio.github.io/web-audio-api/#the-waveshapernode-interface).\n *\n * @example\n * const osc = new Tone.Oscillator().toDestination().start();\n * // multiply the output of the signal by 2 using the waveshaper's function\n * const timesTwo = new Tone.WaveShaper((val) => val * 2, 2048).connect(osc.frequency);\n * const signal = new Tone.Signal(440).connect(timesTwo);\n * @category Signal\n */\nexport class WaveShaper extends SignalOperator {\n    constructor() {\n        const options = optionsFromArguments(WaveShaper.getDefaults(), arguments, [\"mapping\", \"length\"]);\n        super(options);\n        this.name = \"WaveShaper\";\n        /**\n         * the waveshaper node\n         */\n        this._shaper = this.context.createWaveShaper();\n        /**\n         * The input to the waveshaper node.\n         */\n        this.input = this._shaper;\n        /**\n         * The output from the waveshaper node\n         */\n        this.output = this._shaper;\n        if (isArray(options.mapping) ||\n            options.mapping instanceof Float32Array) {\n            this.curve = Float32Array.from(options.mapping);\n        }\n        else if (isFunction(options.mapping)) {\n            this.setMap(options.mapping, options.length);\n        }\n    }\n    static getDefaults() {\n        return Object.assign(Signal.getDefaults(), {\n            length: 1024,\n        });\n    }\n    /**\n     * Uses a mapping function to set the value of the curve.\n     * @param mapping The function used to define the values.\n     *                The mapping function take two arguments:\n     *                the first is the value at the current position\n     *                which goes from -1 to 1 over the number of elements\n     *                in the curve array. The second argument is the array position.\n     * @example\n     * const shaper = new Tone.WaveShaper();\n     * // map the input signal from [-1, 1] to [0, 10]\n     * shaper.setMap((val, index) => (val + 1) * 5);\n     */\n    setMap(mapping, length = 1024) {\n        const array = new Float32Array(length);\n        for (let i = 0, len = length; i < len; i++) {\n            const normalized = (i / (len - 1)) * 2 - 1;\n            array[i] = mapping(normalized, i);\n        }\n        this.curve = array;\n        return this;\n    }\n    /**\n     * The array to set as the waveshaper curve. For linear curves\n     * array length does not make much difference, but for complex curves\n     * longer arrays will provide smoother interpolation.\n     */\n    get curve() {\n        return this._shaper.curve;\n    }\n    set curve(mapping) {\n        this._shaper.curve = mapping;\n    }\n    /**\n     * Specifies what type of oversampling (if any) should be used when\n     * applying the shaping curve. Can either be \"none\", \"2x\" or \"4x\".\n     */\n    get oversample() {\n        return this._shaper.oversample;\n    }\n    set oversample(oversampling) {\n        const isOverSampleType = [\"none\", \"2x\", \"4x\"].some((str) => str.includes(oversampling));\n        assert(isOverSampleType, \"oversampling must be either 'none', '2x', or '4x'\");\n        this._shaper.oversample = oversampling;\n    }\n    /**\n     * Clean up.\n     */\n    dispose() {\n        super.dispose();\n        this._shaper.disconnect();\n        return this;\n    }\n}\n//# sourceMappingURL=WaveShaper.js.map","import { WaveShaper } from \"./WaveShaper.js\";\nimport { optionsFromArguments } from \"../core/util/Defaults.js\";\nimport { SignalOperator } from \"./SignalOperator.js\";\n/**\n * Pow applies an exponent to the incoming signal. The incoming signal must be AudioRange [-1, 1]\n *\n * @example\n * const pow = new Tone.Pow(2);\n * const sig = new Tone.Signal(0.5).connect(pow);\n * // output of pow is 0.25.\n * @category Signal\n */\nexport class Pow extends SignalOperator {\n    constructor() {\n        const options = optionsFromArguments(Pow.getDefaults(), arguments, [\n            \"value\",\n        ]);\n        super(options);\n        this.name = \"Pow\";\n        this._exponentScaler =\n            this.input =\n                this.output =\n                    new WaveShaper({\n                        context: this.context,\n                        mapping: this._expFunc(options.value),\n                        length: 8192,\n                    });\n        this._exponent = options.value;\n    }\n    static getDefaults() {\n        return Object.assign(SignalOperator.getDefaults(), {\n            value: 1,\n        });\n    }\n    /**\n     * the function which maps the waveshaper\n     * @param exponent exponent value\n     */\n    _expFunc(exponent) {\n        return (val) => {\n            return Math.pow(Math.abs(val), exponent);\n        };\n    }\n    /**\n     * The value of the exponent.\n     */\n    get value() {\n        return this._exponent;\n    }\n    set value(exponent) {\n        this._exponent = exponent;\n        this._exponentScaler.setMap(this._expFunc(this._exponent));\n    }\n    /**\n     * Clean up.\n     */\n    dispose() {\n        super.dispose();\n        this._exponentScaler.dispose();\n        return this;\n    }\n}\n//# sourceMappingURL=Pow.js.map","import { noOp } from \"../util/Interface.js\";\n/**\n * TransportEvent is an internal class used by {@link TransportClass}\n * to schedule events. Do no invoke this class directly, it is\n * handled from within Tone.Transport.\n */\nexport class TransportEvent {\n    /**\n     * @param transport The transport object which the event belongs to\n     */\n    constructor(transport, opts) {\n        /**\n         * The unique id of the event\n         */\n        this.id = TransportEvent._eventId++;\n        /**\n         * The remaining value between the passed in time, and Math.floor(time).\n         * This value is later added back when scheduling to get sub-tick precision.\n         */\n        this._remainderTime = 0;\n        const options = Object.assign(TransportEvent.getDefaults(), opts);\n        this.transport = transport;\n        this.callback = options.callback;\n        this._once = options.once;\n        this.time = Math.floor(options.time);\n        this._remainderTime = options.time - this.time;\n    }\n    static getDefaults() {\n        return {\n            callback: noOp,\n            once: false,\n            time: 0,\n        };\n    }\n    /**\n     * Get the time and remainder time.\n     */\n    get floatTime() {\n        return this.time + this._remainderTime;\n    }\n    /**\n     * Invoke the event callback.\n     * @param  time  The AudioContext time in seconds of the event\n     */\n    invoke(time) {\n        if (this.callback) {\n            const tickDuration = this.transport.bpm.getDurationOfTicks(1, time);\n            this.callback(time + this._remainderTime * tickDuration);\n            if (this._once) {\n                this.transport.clear(this.id);\n            }\n        }\n    }\n    /**\n     * Clean up\n     */\n    dispose() {\n        this.callback = undefined;\n        return this;\n    }\n}\n/**\n * Current ID counter\n */\nTransportEvent._eventId = 0;\n//# sourceMappingURL=TransportEvent.js.map","import { TicksClass } from \"../type/Ticks.js\";\nimport { TransportEvent } from \"./TransportEvent.js\";\nimport { GT, LT } from \"../util/Math.js\";\n/**\n * TransportRepeatEvent is an internal class used by Tone.Transport\n * to schedule repeat events. This class should not be instantiated directly.\n */\nexport class TransportRepeatEvent extends TransportEvent {\n    /**\n     * @param transport The transport object which the event belongs to\n     */\n    constructor(transport, opts) {\n        super(transport, opts);\n        /**\n         * The ID of the current timeline event\n         */\n        this._currentId = -1;\n        /**\n         * The ID of the next timeline event\n         */\n        this._nextId = -1;\n        /**\n         * The time of the next event\n         */\n        this._nextTick = this.time;\n        /**\n         * a reference to the bound start method\n         */\n        this._boundRestart = this._restart.bind(this);\n        const options = Object.assign(TransportRepeatEvent.getDefaults(), opts);\n        this.duration = options.duration;\n        this._interval = options.interval;\n        this._nextTick = options.time;\n        this.transport.on(\"start\", this._boundRestart);\n        this.transport.on(\"loopStart\", this._boundRestart);\n        this.transport.on(\"ticks\", this._boundRestart);\n        this.context = this.transport.context;\n        this._restart();\n    }\n    static getDefaults() {\n        return Object.assign({}, TransportEvent.getDefaults(), {\n            duration: Infinity,\n            interval: 1,\n            once: false,\n        });\n    }\n    /**\n     * Invoke the callback. Returns the tick time which\n     * the next event should be scheduled at.\n     * @param  time  The AudioContext time in seconds of the event\n     */\n    invoke(time) {\n        // create more events if necessary\n        this._createEvents(time);\n        // call the super class\n        super.invoke(time);\n    }\n    /**\n     * Create an event on the transport on the nextTick\n     */\n    _createEvent() {\n        if (LT(this._nextTick, this.floatTime + this.duration)) {\n            return this.transport.scheduleOnce(this.invoke.bind(this), new TicksClass(this.context, this._nextTick).toSeconds());\n        }\n        return -1;\n    }\n    /**\n     * Push more events onto the timeline to keep up with the position of the timeline\n     */\n    _createEvents(time) {\n        // schedule the next event\n        // const ticks = this.transport.getTicksAtTime(time);\n        // if the next tick is within the bounds set by \"duration\"\n        if (LT(this._nextTick + this._interval, this.floatTime + this.duration)) {\n            this._nextTick += this._interval;\n            this._currentId = this._nextId;\n            this._nextId = this.transport.scheduleOnce(this.invoke.bind(this), new TicksClass(this.context, this._nextTick).toSeconds());\n        }\n    }\n    /**\n     * Re-compute the events when the transport time has changed from a start/ticks/loopStart event\n     */\n    _restart(time) {\n        this.transport.clear(this._currentId);\n        this.transport.clear(this._nextId);\n        // start at the first event\n        this._nextTick = this.floatTime;\n        const ticks = this.transport.getTicksAtTime(time);\n        if (GT(ticks, this.time)) {\n            // the event is not being scheduled from the beginning and should be offset\n            this._nextTick =\n                this.floatTime +\n                    Math.ceil((ticks - this.floatTime) / this._interval) *\n                        this._interval;\n        }\n        this._currentId = this._createEvent();\n        this._nextTick += this._interval;\n        this._nextId = this._createEvent();\n    }\n    /**\n     * Clean up\n     */\n    dispose() {\n        super.dispose();\n        this.transport.clear(this._currentId);\n        this.transport.clear(this._nextId);\n        this.transport.off(\"start\", this._boundRestart);\n        this.transport.off(\"loopStart\", this._boundRestart);\n        this.transport.off(\"ticks\", this._boundRestart);\n        return this;\n    }\n}\n//# sourceMappingURL=TransportRepeatEvent.js.map","import { TimeClass } from \"../../core/type/Time.js\";\nimport { TimelineValue } from \"../../core/util/TimelineValue.js\";\nimport { Pow } from \"../../signal/Pow.js\";\nimport { onContextClose, onContextInit, } from \"../context/ContextInitialization.js\";\nimport { Gain } from \"../context/Gain.js\";\nimport { ToneWithContext, } from \"../context/ToneWithContext.js\";\nimport { TicksClass } from \"../type/Ticks.js\";\nimport { TransportTimeClass } from \"../type/TransportTime.js\";\nimport { enterScheduledCallback } from \"../util/Debug.js\";\nimport { optionsFromArguments } from \"../util/Defaults.js\";\nimport { Emitter } from \"../util/Emitter.js\";\nimport { readOnly, writable } from \"../util/Interface.js\";\nimport { IntervalTimeline } from \"../util/IntervalTimeline.js\";\nimport { Timeline } from \"../util/Timeline.js\";\nimport { isArray, isDefined } from \"../util/TypeCheck.js\";\nimport { Clock } from \"./Clock.js\";\nimport { TransportEvent } from \"./TransportEvent.js\";\nimport { TransportRepeatEvent } from \"./TransportRepeatEvent.js\";\n/**\n * Transport for timing musical events.\n * Supports tempo curves and time changes. Unlike browser-based timing (setInterval, requestAnimationFrame)\n * Transport timing events pass in the exact time of the scheduled event\n * in the argument of the callback function. Pass that time value to the object\n * you're scheduling. <br><br>\n * A single transport is created for you when the library is initialized.\n * <br><br>\n * The transport emits the events: \"start\", \"stop\", \"pause\", and \"loop\" which are\n * called with the time of that event as the argument.\n *\n * @example\n * const osc = new Tone.Oscillator().toDestination();\n * // repeated event every 8th note\n * Tone.getTransport().scheduleRepeat((time) => {\n * \t// use the callback time to schedule events\n * \tosc.start(time).stop(time + 0.1);\n * }, \"8n\");\n * // transport must be started before it starts invoking events\n * Tone.getTransport().start();\n * @category Core\n */\nexport class TransportClass extends ToneWithContext {\n    constructor() {\n        const options = optionsFromArguments(TransportClass.getDefaults(), arguments);\n        super(options);\n        this.name = \"Transport\";\n        //-------------------------------------\n        // \tLOOPING\n        //-------------------------------------\n        /**\n         * If the transport loops or not.\n         */\n        this._loop = new TimelineValue(false);\n        /**\n         * The loop start position in ticks\n         */\n        this._loopStart = 0;\n        /**\n         * The loop end position in ticks\n         */\n        this._loopEnd = 0;\n        //-------------------------------------\n        // \tTIMELINE EVENTS\n        //-------------------------------------\n        /**\n         * All the events in an object to keep track by ID\n         */\n        this._scheduledEvents = {};\n        /**\n         * The scheduled events.\n         */\n        this._timeline = new Timeline();\n        /**\n         * Repeated events\n         */\n        this._repeatedEvents = new IntervalTimeline();\n        /**\n         * All of the synced Signals\n         */\n        this._syncedSignals = [];\n        /**\n         * The swing amount\n         */\n        this._swingAmount = 0;\n        // CLOCK/TEMPO\n        this._ppq = options.ppq;\n        this._clock = new Clock({\n            callback: this._processTick.bind(this),\n            context: this.context,\n            frequency: 0,\n            units: \"bpm\",\n        });\n        this._bindClockEvents();\n        this.bpm = this._clock.frequency;\n        this._clock.frequency.multiplier = options.ppq;\n        this.bpm.setValueAtTime(options.bpm, 0);\n        readOnly(this, \"bpm\");\n        this._timeSignature = options.timeSignature;\n        // SWING\n        this._swingTicks = options.ppq / 2; // 8n\n    }\n    static getDefaults() {\n        return Object.assign(ToneWithContext.getDefaults(), {\n            bpm: 120,\n            loopEnd: \"4m\",\n            loopStart: 0,\n            ppq: 192,\n            swing: 0,\n            swingSubdivision: \"8n\",\n            timeSignature: 4,\n        });\n    }\n    //-------------------------------------\n    // \tTICKS\n    //-------------------------------------\n    /**\n     * called on every tick\n     * @param  tickTime clock relative tick time\n     */\n    _processTick(tickTime, ticks) {\n        // do the loop test\n        if (this._loop.get(tickTime)) {\n            if (ticks >= this._loopEnd) {\n                this.emit(\"loopEnd\", tickTime);\n                this._clock.setTicksAtTime(this._loopStart, tickTime);\n                ticks = this._loopStart;\n                this.emit(\"loopStart\", tickTime, this._clock.getSecondsAtTime(tickTime));\n                this.emit(\"loop\", tickTime);\n            }\n        }\n        // handle swing\n        if (this._swingAmount > 0 &&\n            ticks % this._ppq !== 0 && // not on a downbeat\n            ticks % (this._swingTicks * 2) !== 0) {\n            // add some swing\n            const progress = (ticks % (this._swingTicks * 2)) / (this._swingTicks * 2);\n            const amount = Math.sin(progress * Math.PI) * this._swingAmount;\n            tickTime +=\n                new TicksClass(this.context, (this._swingTicks * 2) / 3).toSeconds() * amount;\n        }\n        // invoke the timeline events scheduled on this tick\n        enterScheduledCallback(true);\n        this._timeline.forEachAtTime(ticks, (event) => event.invoke(tickTime));\n        enterScheduledCallback(false);\n    }\n    //-------------------------------------\n    // \tSCHEDULABLE EVENTS\n    //-------------------------------------\n    /**\n     * Schedule an event along the timeline.\n     * @param callback The callback to be invoked at the time.\n     * @param time The time to invoke the callback at.\n     * @return The id of the event which can be used for canceling the event.\n     * @example\n     * // schedule an event on the 16th measure\n     * Tone.getTransport().schedule((time) => {\n     * \t// invoked on measure 16\n     * \tconsole.log(\"measure 16!\");\n     * }, \"16:0:0\");\n     */\n    schedule(callback, time) {\n        const event = new TransportEvent(this, {\n            callback,\n            time: new TransportTimeClass(this.context, time).toTicks(),\n        });\n        return this._addEvent(event, this._timeline);\n    }\n    /**\n     * Schedule a repeated event along the timeline. The event will fire\n     * at the `interval` starting at the `startTime` and for the specified\n     * `duration`.\n     * @param  callback   The callback to invoke.\n     * @param  interval   The duration between successive callbacks. Must be a positive number.\n     * @param  startTime  When along the timeline the events should start being invoked.\n     * @param  duration How long the event should repeat.\n     * @return  The ID of the scheduled event. Use this to cancel the event.\n     * @example\n     * const osc = new Tone.Oscillator().toDestination().start();\n     * // a callback invoked every eighth note after the first measure\n     * Tone.getTransport().scheduleRepeat((time) => {\n     * \tosc.start(time).stop(time + 0.1);\n     * }, \"8n\", \"1m\");\n     */\n    scheduleRepeat(callback, interval, startTime, duration = Infinity) {\n        const event = new TransportRepeatEvent(this, {\n            callback,\n            duration: new TimeClass(this.context, duration).toTicks(),\n            interval: new TimeClass(this.context, interval).toTicks(),\n            time: new TransportTimeClass(this.context, startTime).toTicks(),\n        });\n        // kick it off if the Transport is started\n        // @ts-ignore\n        return this._addEvent(event, this._repeatedEvents);\n    }\n    /**\n     * Schedule an event that will be removed after it is invoked.\n     * @param callback The callback to invoke once.\n     * @param time The time the callback should be invoked.\n     * @returns The ID of the scheduled event.\n     */\n    scheduleOnce(callback, time) {\n        const event = new TransportEvent(this, {\n            callback,\n            once: true,\n            time: new TransportTimeClass(this.context, time).toTicks(),\n        });\n        return this._addEvent(event, this._timeline);\n    }\n    /**\n     * Clear the passed in event id from the timeline\n     * @param eventId The id of the event.\n     */\n    clear(eventId) {\n        if (this._scheduledEvents.hasOwnProperty(eventId)) {\n            const item = this._scheduledEvents[eventId.toString()];\n            item.timeline.remove(item.event);\n            item.event.dispose();\n            delete this._scheduledEvents[eventId.toString()];\n        }\n        return this;\n    }\n    /**\n     * Add an event to the correct timeline. Keep track of the\n     * timeline it was added to.\n     * @returns the event id which was just added\n     */\n    _addEvent(event, timeline) {\n        this._scheduledEvents[event.id.toString()] = {\n            event,\n            timeline,\n        };\n        timeline.add(event);\n        return event.id;\n    }\n    /**\n     * Remove scheduled events from the timeline after\n     * the given time. Repeated events will be removed\n     * if their startTime is after the given time\n     * @param after Clear all events after this time.\n     */\n    cancel(after = 0) {\n        const computedAfter = this.toTicks(after);\n        this._timeline.forEachFrom(computedAfter, (event) => this.clear(event.id));\n        this._repeatedEvents.forEachFrom(computedAfter, (event) => this.clear(event.id));\n        return this;\n    }\n    //-------------------------------------\n    // \tSTART/STOP/PAUSE\n    //-------------------------------------\n    /**\n     * Bind start/stop/pause events from the clock and emit them.\n     */\n    _bindClockEvents() {\n        this._clock.on(\"start\", (time, offset) => {\n            offset = new TicksClass(this.context, offset).toSeconds();\n            this.emit(\"start\", time, offset);\n        });\n        this._clock.on(\"stop\", (time) => {\n            this.emit(\"stop\", time);\n        });\n        this._clock.on(\"pause\", (time) => {\n            this.emit(\"pause\", time);\n        });\n    }\n    /**\n     * Returns the playback state of the source, either \"started\", \"stopped\", or \"paused\"\n     */\n    get state() {\n        return this._clock.getStateAtTime(this.now());\n    }\n    /**\n     * Start the transport and all sources synced to the transport.\n     * @param  time The time when the transport should start.\n     * @param  offset The timeline offset to start the transport.\n     * @example\n     * // start the transport in one second starting at beginning of the 5th measure.\n     * Tone.getTransport().start(\"+1\", \"4:0:0\");\n     */\n    start(time, offset) {\n        // start the context\n        this.context.resume();\n        let offsetTicks;\n        if (isDefined(offset)) {\n            offsetTicks = this.toTicks(offset);\n        }\n        // start the clock\n        this._clock.start(time, offsetTicks);\n        return this;\n    }\n    /**\n     * Stop the transport and all sources synced to the transport.\n     * @param time The time when the transport should stop.\n     * @example\n     * Tone.getTransport().stop();\n     */\n    stop(time) {\n        this._clock.stop(time);\n        return this;\n    }\n    /**\n     * Pause the transport and all sources synced to the transport.\n     */\n    pause(time) {\n        this._clock.pause(time);\n        return this;\n    }\n    /**\n     * Toggle the current state of the transport. If it is\n     * started, it will stop it, otherwise it will start the Transport.\n     * @param  time The time of the event\n     */\n    toggle(time) {\n        time = this.toSeconds(time);\n        if (this._clock.getStateAtTime(time) !== \"started\") {\n            this.start(time);\n        }\n        else {\n            this.stop(time);\n        }\n        return this;\n    }\n    //-------------------------------------\n    // \tSETTERS/GETTERS\n    //-------------------------------------\n    /**\n     * The time signature as just the numerator over 4.\n     * For example 4/4 would be just 4 and 6/8 would be 3.\n     * @example\n     * // common time\n     * Tone.getTransport().timeSignature = 4;\n     * // 7/8\n     * Tone.getTransport().timeSignature = [7, 8];\n     * // this will be reduced to a single number\n     * Tone.getTransport().timeSignature; // returns 3.5\n     */\n    get timeSignature() {\n        return this._timeSignature;\n    }\n    set timeSignature(timeSig) {\n        if (isArray(timeSig)) {\n            timeSig = (timeSig[0] / timeSig[1]) * 4;\n        }\n        this._timeSignature = timeSig;\n    }\n    /**\n     * When the Transport.loop = true, this is the starting position of the loop.\n     */\n    get loopStart() {\n        return new TimeClass(this.context, this._loopStart, \"i\").toSeconds();\n    }\n    set loopStart(startPosition) {\n        this._loopStart = this.toTicks(startPosition);\n    }\n    /**\n     * When the Transport.loop = true, this is the ending position of the loop.\n     */\n    get loopEnd() {\n        return new TimeClass(this.context, this._loopEnd, \"i\").toSeconds();\n    }\n    set loopEnd(endPosition) {\n        this._loopEnd = this.toTicks(endPosition);\n    }\n    /**\n     * If the transport loops or not.\n     */\n    get loop() {\n        return this._loop.get(this.now());\n    }\n    set loop(loop) {\n        this._loop.set(loop, this.now());\n    }\n    /**\n     * Set the loop start and stop at the same time.\n     * @example\n     * // loop over the first measure\n     * Tone.getTransport().setLoopPoints(0, \"1m\");\n     * Tone.getTransport().loop = true;\n     */\n    setLoopPoints(startPosition, endPosition) {\n        this.loopStart = startPosition;\n        this.loopEnd = endPosition;\n        return this;\n    }\n    /**\n     * The swing value. Between 0-1 where 1 equal to the note + half the subdivision.\n     */\n    get swing() {\n        return this._swingAmount;\n    }\n    set swing(amount) {\n        // scale the values to a normal range\n        this._swingAmount = amount;\n    }\n    /**\n     * Set the subdivision which the swing will be applied to.\n     * The default value is an 8th note. Value must be less\n     * than a quarter note.\n     */\n    get swingSubdivision() {\n        return new TicksClass(this.context, this._swingTicks).toNotation();\n    }\n    set swingSubdivision(subdivision) {\n        this._swingTicks = this.toTicks(subdivision);\n    }\n    /**\n     * The Transport's position in Bars:Beats:Sixteenths.\n     * Setting the value will jump to that position right away.\n     */\n    get position() {\n        const now = this.now();\n        const ticks = this._clock.getTicksAtTime(now);\n        return new TicksClass(this.context, ticks).toBarsBeatsSixteenths();\n    }\n    set position(progress) {\n        const ticks = this.toTicks(progress);\n        this.ticks = ticks;\n    }\n    /**\n     * The Transport's position in seconds.\n     * Setting the value will jump to that position right away.\n     */\n    get seconds() {\n        return this._clock.seconds;\n    }\n    set seconds(s) {\n        const now = this.now();\n        const ticks = this._clock.frequency.timeToTicks(s, now);\n        this.ticks = ticks;\n    }\n    /**\n     * The Transport's loop position as a normalized value. Always\n     * returns 0 if the Transport.loop = false.\n     */\n    get progress() {\n        if (this.loop) {\n            const now = this.now();\n            const ticks = this._clock.getTicksAtTime(now);\n            return ((ticks - this._loopStart) / (this._loopEnd - this._loopStart));\n        }\n        else {\n            return 0;\n        }\n    }\n    /**\n     * The Transport's current tick position.\n     */\n    get ticks() {\n        return this._clock.ticks;\n    }\n    set ticks(t) {\n        if (this._clock.ticks !== t) {\n            const now = this.now();\n            // stop everything synced to the transport\n            if (this.state === \"started\") {\n                const ticks = this._clock.getTicksAtTime(now);\n                // schedule to start on the next tick, #573\n                const remainingTick = this._clock.frequency.getDurationOfTicks(Math.ceil(ticks) - ticks, now);\n                const time = now + remainingTick;\n                this.emit(\"stop\", time);\n                this._clock.setTicksAtTime(t, time);\n                // restart it with the new time\n                this.emit(\"start\", time, this._clock.getSecondsAtTime(time));\n            }\n            else {\n                this.emit(\"ticks\", now);\n                this._clock.setTicksAtTime(t, now);\n            }\n        }\n    }\n    /**\n     * Get the clock's ticks at the given time.\n     * @param  time  When to get the tick value\n     * @return The tick value at the given time.\n     */\n    getTicksAtTime(time) {\n        return this._clock.getTicksAtTime(time);\n    }\n    /**\n     * Return the elapsed seconds at the given time.\n     * @param  time  When to get the elapsed seconds\n     * @return  The number of elapsed seconds\n     */\n    getSecondsAtTime(time) {\n        return this._clock.getSecondsAtTime(time);\n    }\n    /**\n     * Pulses Per Quarter note. This is the smallest resolution\n     * the Transport timing supports. This should be set once\n     * on initialization and not set again. Changing this value\n     * after other objects have been created can cause problems.\n     */\n    get PPQ() {\n        return this._clock.frequency.multiplier;\n    }\n    set PPQ(ppq) {\n        this._clock.frequency.multiplier = ppq;\n    }\n    //-------------------------------------\n    // \tSYNCING\n    //-------------------------------------\n    /**\n     * Returns the time aligned to the next subdivision\n     * of the Transport. If the Transport is not started,\n     * it will return 0.\n     * Note: this will not work precisely during tempo ramps.\n     * @param  subdivision  The subdivision to quantize to\n     * @return  The context time of the next subdivision.\n     * @example\n     * // the transport must be started, otherwise returns 0\n     * Tone.getTransport().start();\n     * Tone.getTransport().nextSubdivision(\"4n\");\n     */\n    nextSubdivision(subdivision) {\n        subdivision = this.toTicks(subdivision);\n        if (this.state !== \"started\") {\n            // if the transport's not started, return 0\n            return 0;\n        }\n        else {\n            const now = this.now();\n            // the remainder of the current ticks and the subdivision\n            const transportPos = this.getTicksAtTime(now);\n            const remainingTicks = subdivision - (transportPos % subdivision);\n            return this._clock.nextTickTime(remainingTicks, now);\n        }\n    }\n    /**\n     * Attaches the signal to the tempo control signal so that\n     * any changes in the tempo will change the signal in the same\n     * ratio.\n     *\n     * @param signal\n     * @param ratio Optionally pass in the ratio between the two signals.\n     * \t\t\tOtherwise it will be computed based on their current values.\n     */\n    syncSignal(signal, ratio) {\n        const now = this.now();\n        let source = this.bpm;\n        let sourceValue = 1 / (60 / source.getValueAtTime(now) / this.PPQ);\n        let nodes = [];\n        // If the signal is in the time domain, sync it to the reciprocal of\n        // the tempo instead of the tempo.\n        if (signal.units === \"time\") {\n            // The input to Pow should be in the range [1 / 4096, 1], where\n            // where 4096 is half of the buffer size of Pow's waveshaper.\n            // Pick a scaling factor based on the initial tempo that ensures\n            // that the initial input is in this range, while leaving room for\n            // tempo changes.\n            const scaleFactor = 1 / 64 / sourceValue;\n            const scaleBefore = new Gain(scaleFactor);\n            const reciprocal = new Pow(-1);\n            const scaleAfter = new Gain(scaleFactor);\n            // @ts-ignore\n            source.chain(scaleBefore, reciprocal, scaleAfter);\n            source = scaleAfter;\n            sourceValue = 1 / sourceValue;\n            nodes = [scaleBefore, reciprocal, scaleAfter];\n        }\n        if (!ratio) {\n            // get the sync ratio\n            if (signal.getValueAtTime(now) !== 0) {\n                ratio = signal.getValueAtTime(now) / sourceValue;\n            }\n            else {\n                ratio = 0;\n            }\n        }\n        const ratioSignal = new Gain(ratio);\n        // @ts-ignore\n        source.connect(ratioSignal);\n        // @ts-ignore\n        ratioSignal.connect(signal._param);\n        nodes.push(ratioSignal);\n        this._syncedSignals.push({\n            initial: signal.value,\n            nodes: nodes,\n            signal,\n        });\n        signal.value = 0;\n        return this;\n    }\n    /**\n     * Unsyncs a previously synced signal from the transport's control.\n     * @see {@link syncSignal}.\n     */\n    unsyncSignal(signal) {\n        for (let i = this._syncedSignals.length - 1; i >= 0; i--) {\n            const syncedSignal = this._syncedSignals[i];\n            if (syncedSignal.signal === signal) {\n                syncedSignal.nodes.forEach((node) => node.dispose());\n                syncedSignal.signal.value = syncedSignal.initial;\n                this._syncedSignals.splice(i, 1);\n            }\n        }\n        return this;\n    }\n    /**\n     * Clean up.\n     */\n    dispose() {\n        super.dispose();\n        this._clock.dispose();\n        writable(this, \"bpm\");\n        this._timeline.dispose();\n        this._repeatedEvents.dispose();\n        return this;\n    }\n}\nEmitter.mixin(TransportClass);\n//-------------------------------------\n// \tINITIALIZATION\n//-------------------------------------\nonContextInit((context) => {\n    context.transport = new TransportClass({ context });\n});\nonContextClose((context) => {\n    context.transport.dispose();\n});\n//# sourceMappingURL=Transport.js.map","import { Volume } from \"../component/channel/Volume.js\";\nimport \"../core/context/Destination.js\";\nimport \"../core/clock/Transport.js\";\nimport { ToneAudioNode, } from \"../core/context/ToneAudioNode.js\";\nimport { defaultArg } from \"../core/util/Defaults.js\";\nimport { noOp, readOnly } from \"../core/util/Interface.js\";\nimport { StateTimeline, } from \"../core/util/StateTimeline.js\";\nimport { isDefined, isUndef } from \"../core/util/TypeCheck.js\";\nimport { assert, assertContextRunning } from \"../core/util/Debug.js\";\nimport { GT } from \"../core/util/Math.js\";\n/**\n * Base class for sources.\n * start/stop of this.context.transport.\n *\n * ```\n * // Multiple state change events can be chained together,\n * // but must be set in the correct order and with ascending times\n * // OK\n * state.start().stop(\"+0.2\");\n * // OK\n * state.start().stop(\"+0.2\").start(\"+0.4\").stop(\"+0.7\")\n * // BAD\n * state.stop(\"+0.2\").start();\n * // BAD\n * state.start(\"+0.3\").stop(\"+0.2\");\n * ```\n */\nexport class Source extends ToneAudioNode {\n    constructor(options) {\n        super(options);\n        /**\n         * Sources have no inputs\n         */\n        this.input = undefined;\n        /**\n         * Keep track of the scheduled state.\n         */\n        this._state = new StateTimeline(\"stopped\");\n        /**\n         * The synced `start` callback function from the transport\n         */\n        this._synced = false;\n        /**\n         * Keep track of all of the scheduled event ids\n         */\n        this._scheduled = [];\n        /**\n         * Placeholder functions for syncing/unsyncing to transport\n         */\n        this._syncedStart = noOp;\n        this._syncedStop = noOp;\n        this._state.memory = 100;\n        this._state.increasing = true;\n        this._volume = this.output = new Volume({\n            context: this.context,\n            mute: options.mute,\n            volume: options.volume,\n        });\n        this.volume = this._volume.volume;\n        readOnly(this, \"volume\");\n        this.onstop = options.onstop;\n    }\n    static getDefaults() {\n        return Object.assign(ToneAudioNode.getDefaults(), {\n            mute: false,\n            onstop: noOp,\n            volume: 0,\n        });\n    }\n    /**\n     * Returns the playback state of the source, either \"started\" or \"stopped\".\n     * @example\n     * const player = new Tone.Player(\"https://tonejs.github.io/audio/berklee/ahntone_c3.mp3\", () => {\n     * \tplayer.start();\n     * \tconsole.log(player.state);\n     * }).toDestination();\n     */\n    get state() {\n        if (this._synced) {\n            if (this.context.transport.state === \"started\") {\n                return this._state.getValueAtTime(this.context.transport.seconds);\n            }\n            else {\n                return \"stopped\";\n            }\n        }\n        else {\n            return this._state.getValueAtTime(this.now());\n        }\n    }\n    /**\n     * Mute the output.\n     * @example\n     * const osc = new Tone.Oscillator().toDestination().start();\n     * // mute the output\n     * osc.mute = true;\n     */\n    get mute() {\n        return this._volume.mute;\n    }\n    set mute(mute) {\n        this._volume.mute = mute;\n    }\n    /**\n     * Ensure that the scheduled time is not before the current time.\n     * Should only be used when scheduled unsynced.\n     */\n    _clampToCurrentTime(time) {\n        if (this._synced) {\n            return time;\n        }\n        else {\n            return Math.max(time, this.context.currentTime);\n        }\n    }\n    /**\n     * Start the source at the specified time. If no time is given,\n     * start the source now.\n     * @param  time When the source should be started.\n     * @example\n     * const source = new Tone.Oscillator().toDestination();\n     * source.start(\"+0.5\"); // starts the source 0.5 seconds from now\n     */\n    start(time, offset, duration) {\n        let computedTime = isUndef(time) && this._synced\n            ? this.context.transport.seconds\n            : this.toSeconds(time);\n        computedTime = this._clampToCurrentTime(computedTime);\n        // if it's started, stop it and restart it\n        if (!this._synced &&\n            this._state.getValueAtTime(computedTime) === \"started\") {\n            // time should be strictly greater than the previous start time\n            assert(GT(computedTime, this._state.get(computedTime).time), \"Start time must be strictly greater than previous start time\");\n            this._state.cancel(computedTime);\n            this._state.setStateAtTime(\"started\", computedTime);\n            this.log(\"restart\", computedTime);\n            this.restart(computedTime, offset, duration);\n        }\n        else {\n            this.log(\"start\", computedTime);\n            this._state.setStateAtTime(\"started\", computedTime);\n            if (this._synced) {\n                // add the offset time to the event\n                const event = this._state.get(computedTime);\n                if (event) {\n                    event.offset = this.toSeconds(defaultArg(offset, 0));\n                    event.duration = duration\n                        ? this.toSeconds(duration)\n                        : undefined;\n                }\n                const sched = this.context.transport.schedule((t) => {\n                    this._start(t, offset, duration);\n                }, computedTime);\n                this._scheduled.push(sched);\n                // if the transport is already started\n                // and the time is greater than where the transport is\n                if (this.context.transport.state === \"started\" &&\n                    this.context.transport.getSecondsAtTime(this.immediate()) >\n                        computedTime) {\n                    this._syncedStart(this.now(), this.context.transport.seconds);\n                }\n            }\n            else {\n                assertContextRunning(this.context);\n                this._start(computedTime, offset, duration);\n            }\n        }\n        return this;\n    }\n    /**\n     * Stop the source at the specified time. If no time is given,\n     * stop the source now.\n     * @param  time When the source should be stopped.\n     * @example\n     * const source = new Tone.Oscillator().toDestination();\n     * source.start();\n     * source.stop(\"+0.5\"); // stops the source 0.5 seconds from now\n     */\n    stop(time) {\n        let computedTime = isUndef(time) && this._synced\n            ? this.context.transport.seconds\n            : this.toSeconds(time);\n        computedTime = this._clampToCurrentTime(computedTime);\n        if (this._state.getValueAtTime(computedTime) === \"started\" ||\n            isDefined(this._state.getNextState(\"started\", computedTime))) {\n            this.log(\"stop\", computedTime);\n            if (!this._synced) {\n                this._stop(computedTime);\n            }\n            else {\n                const sched = this.context.transport.schedule(this._stop.bind(this), computedTime);\n                this._scheduled.push(sched);\n            }\n            this._state.cancel(computedTime);\n            this._state.setStateAtTime(\"stopped\", computedTime);\n        }\n        return this;\n    }\n    /**\n     * Restart the source.\n     */\n    restart(time, offset, duration) {\n        time = this.toSeconds(time);\n        if (this._state.getValueAtTime(time) === \"started\") {\n            this._state.cancel(time);\n            this._restart(time, offset, duration);\n        }\n        return this;\n    }\n    /**\n     * Sync the source to the Transport so that all subsequent\n     * calls to `start` and `stop` are synced to the TransportTime\n     * instead of the AudioContext time.\n     *\n     * @example\n     * const osc = new Tone.Oscillator().toDestination();\n     * // sync the source so that it plays between 0 and 0.3 on the Transport's timeline\n     * osc.sync().start(0).stop(0.3);\n     * // start the transport.\n     * Tone.Transport.start();\n     * // set it to loop once a second\n     * Tone.Transport.loop = true;\n     * Tone.Transport.loopEnd = 1;\n     */\n    sync() {\n        if (!this._synced) {\n            this._synced = true;\n            this._syncedStart = (time, offset) => {\n                if (GT(offset, 0)) {\n                    // get the playback state at that time\n                    const stateEvent = this._state.get(offset);\n                    // listen for start events which may occur in the middle of the sync'ed time\n                    if (stateEvent &&\n                        stateEvent.state === \"started\" &&\n                        stateEvent.time !== offset) {\n                        // get the offset\n                        const startOffset = offset - this.toSeconds(stateEvent.time);\n                        let duration;\n                        if (stateEvent.duration) {\n                            duration =\n                                this.toSeconds(stateEvent.duration) -\n                                    startOffset;\n                        }\n                        this._start(time, this.toSeconds(stateEvent.offset) + startOffset, duration);\n                    }\n                }\n            };\n            this._syncedStop = (time) => {\n                const seconds = this.context.transport.getSecondsAtTime(Math.max(time - this.sampleTime, 0));\n                if (this._state.getValueAtTime(seconds) === \"started\") {\n                    this._stop(time);\n                }\n            };\n            this.context.transport.on(\"start\", this._syncedStart);\n            this.context.transport.on(\"loopStart\", this._syncedStart);\n            this.context.transport.on(\"stop\", this._syncedStop);\n            this.context.transport.on(\"pause\", this._syncedStop);\n            this.context.transport.on(\"loopEnd\", this._syncedStop);\n        }\n        return this;\n    }\n    /**\n     * Unsync the source to the Transport.\n     * @see {@link sync}\n     */\n    unsync() {\n        if (this._synced) {\n            this.context.transport.off(\"stop\", this._syncedStop);\n            this.context.transport.off(\"pause\", this._syncedStop);\n            this.context.transport.off(\"loopEnd\", this._syncedStop);\n            this.context.transport.off(\"start\", this._syncedStart);\n            this.context.transport.off(\"loopStart\", this._syncedStart);\n        }\n        this._synced = false;\n        // clear all of the scheduled ids\n        this._scheduled.forEach((id) => this.context.transport.clear(id));\n        this._scheduled = [];\n        this._state.cancel(0);\n        // stop it also\n        this._stop(0);\n        return this;\n    }\n    /**\n     * Clean up.\n     */\n    dispose() {\n        super.dispose();\n        this.onstop = noOp;\n        this.unsync();\n        this._volume.dispose();\n        this._state.dispose();\n        return this;\n    }\n}\n//# sourceMappingURL=Source.js.map","import { connect } from \"../../core/context/ToneAudioNode.js\";\nimport { Param } from \"../../core/context/Param.js\";\nimport { ToneAudioBuffer } from \"../../core/context/ToneAudioBuffer.js\";\nimport { defaultArg, optionsFromArguments } from \"../../core/util/Defaults.js\";\nimport { noOp } from \"../../core/util/Interface.js\";\nimport { isDefined } from \"../../core/util/TypeCheck.js\";\nimport { assert } from \"../../core/util/Debug.js\";\nimport { OneShotSource, } from \"../OneShotSource.js\";\nimport { EQ, GTE, LT } from \"../../core/util/Math.js\";\n/**\n * Wrapper around the native BufferSourceNode.\n * @category Source\n */\nexport class ToneBufferSource extends OneShotSource {\n    constructor() {\n        const options = optionsFromArguments(ToneBufferSource.getDefaults(), arguments, [\"url\", \"onload\"]);\n        super(options);\n        this.name = \"ToneBufferSource\";\n        /**\n         * The oscillator\n         */\n        this._source = this.context.createBufferSource();\n        this._internalChannels = [this._source];\n        /**\n         * indicators if the source has started/stopped\n         */\n        this._sourceStarted = false;\n        this._sourceStopped = false;\n        connect(this._source, this._gainNode);\n        this._source.onended = () => this._stopSource();\n        /**\n         * The playbackRate of the buffer\n         */\n        this.playbackRate = new Param({\n            context: this.context,\n            param: this._source.playbackRate,\n            units: \"positive\",\n            value: options.playbackRate,\n        });\n        // set some values initially\n        this.loop = options.loop;\n        this.loopStart = options.loopStart;\n        this.loopEnd = options.loopEnd;\n        this._buffer = new ToneAudioBuffer(options.url, options.onload, options.onerror);\n        this._internalChannels.push(this._source);\n    }\n    static getDefaults() {\n        return Object.assign(OneShotSource.getDefaults(), {\n            url: new ToneAudioBuffer(),\n            loop: false,\n            loopEnd: 0,\n            loopStart: 0,\n            onload: noOp,\n            onerror: noOp,\n            playbackRate: 1,\n        });\n    }\n    /**\n     * The fadeIn time of the amplitude envelope.\n     */\n    get fadeIn() {\n        return this._fadeIn;\n    }\n    set fadeIn(t) {\n        this._fadeIn = t;\n    }\n    /**\n     * The fadeOut time of the amplitude envelope.\n     */\n    get fadeOut() {\n        return this._fadeOut;\n    }\n    set fadeOut(t) {\n        this._fadeOut = t;\n    }\n    /**\n     * The curve applied to the fades, either \"linear\" or \"exponential\"\n     */\n    get curve() {\n        return this._curve;\n    }\n    set curve(t) {\n        this._curve = t;\n    }\n    /**\n     * Start the buffer\n     * @param  time When the player should start.\n     * @param  offset The offset from the beginning of the sample to start at.\n     * @param  duration How long the sample should play. If no duration is given, it will default to the full length of the sample (minus any offset)\n     * @param  gain  The gain to play the buffer back at.\n     */\n    start(time, offset, duration, gain = 1) {\n        assert(this.buffer.loaded, \"buffer is either not set or not loaded\");\n        const computedTime = this.toSeconds(time);\n        // apply the gain envelope\n        this._startGain(computedTime, gain);\n        // if it's a loop the default offset is the loopstart point\n        if (this.loop) {\n            offset = defaultArg(offset, this.loopStart);\n        }\n        else {\n            // otherwise the default offset is 0\n            offset = defaultArg(offset, 0);\n        }\n        // make sure the offset is not less than 0\n        let computedOffset = Math.max(this.toSeconds(offset), 0);\n        // start the buffer source\n        if (this.loop) {\n            // modify the offset if it's greater than the loop time\n            const loopEnd = this.toSeconds(this.loopEnd) || this.buffer.duration;\n            const loopStart = this.toSeconds(this.loopStart);\n            const loopDuration = loopEnd - loopStart;\n            // move the offset back\n            if (GTE(computedOffset, loopEnd)) {\n                computedOffset =\n                    ((computedOffset - loopStart) % loopDuration) + loopStart;\n            }\n            // when the offset is very close to the duration, set it to 0\n            if (EQ(computedOffset, this.buffer.duration)) {\n                computedOffset = 0;\n            }\n        }\n        // this.buffer.loaded would have return false if the AudioBuffer was undefined\n        this._source.buffer = this.buffer.get();\n        this._source.loopEnd =\n            this.toSeconds(this.loopEnd) || this.buffer.duration;\n        if (LT(computedOffset, this.buffer.duration)) {\n            this._sourceStarted = true;\n            this._source.start(computedTime, computedOffset);\n        }\n        // if a duration is given, schedule a stop\n        if (isDefined(duration)) {\n            let computedDur = this.toSeconds(duration);\n            // make sure it's never negative\n            computedDur = Math.max(computedDur, 0);\n            this.stop(computedTime + computedDur);\n        }\n        return this;\n    }\n    _stopSource(time) {\n        if (!this._sourceStopped && this._sourceStarted) {\n            this._sourceStopped = true;\n            this._source.stop(this.toSeconds(time));\n            this._onended();\n        }\n    }\n    /**\n     * If loop is true, the loop will start at this position.\n     */\n    get loopStart() {\n        return this._source.loopStart;\n    }\n    set loopStart(loopStart) {\n        this._source.loopStart = this.toSeconds(loopStart);\n    }\n    /**\n     * If loop is true, the loop will end at this position.\n     */\n    get loopEnd() {\n        return this._source.loopEnd;\n    }\n    set loopEnd(loopEnd) {\n        this._source.loopEnd = this.toSeconds(loopEnd);\n    }\n    /**\n     * The audio buffer belonging to the player.\n     */\n    get buffer() {\n        return this._buffer;\n    }\n    set buffer(buffer) {\n        this._buffer.set(buffer);\n    }\n    /**\n     * If the buffer should loop once it's over.\n     */\n    get loop() {\n        return this._source.loop;\n    }\n    set loop(loop) {\n        this._source.loop = loop;\n        if (this._sourceStarted) {\n            this.cancelStop();\n        }\n    }\n    /**\n     * Clean up.\n     */\n    dispose() {\n        super.dispose();\n        this._source.onended = null;\n        this._source.disconnect();\n        this._buffer.dispose();\n        this.playbackRate.dispose();\n        return this;\n    }\n}\n//# sourceMappingURL=ToneBufferSource.js.map","import { __awaiter } from \"tslib\";\nimport { OfflineContext } from \"../../core/context/OfflineContext.js\";\n/**\n * Render a segment of the oscillator to an offline context and return the results as an array\n */\nexport function generateWaveform(instance, length) {\n    return __awaiter(this, void 0, void 0, function* () {\n        const duration = length / instance.context.sampleRate;\n        const context = new OfflineContext(1, duration, instance.context.sampleRate);\n        const clone = new instance.constructor(Object.assign(instance.get(), {\n            // should do 2 iterations\n            frequency: 2 / duration,\n            // zero out the detune\n            detune: 0,\n            context,\n        })).toDestination();\n        clone.start(0);\n        const buffer = yield context.render();\n        return buffer.getChannelData(0);\n    });\n}\n//# sourceMappingURL=OscillatorInterface.js.map","import { connect } from \"../../core/context/ToneAudioNode.js\";\nimport { Param } from \"../../core/context/Param.js\";\nimport { optionsFromArguments } from \"../../core/util/Defaults.js\";\nimport { OneShotSource } from \"../OneShotSource.js\";\nimport { readOnly } from \"../../core/util/Interface.js\";\n/**\n * Wrapper around the native fire-and-forget OscillatorNode.\n * Adds the ability to reschedule the stop method.\n * ***{@link Oscillator} is better for most use-cases***\n * @category Source\n */\nexport class ToneOscillatorNode extends OneShotSource {\n    constructor() {\n        const options = optionsFromArguments(ToneOscillatorNode.getDefaults(), arguments, [\"frequency\", \"type\"]);\n        super(options);\n        this.name = \"ToneOscillatorNode\";\n        /**\n         * The oscillator\n         */\n        this._oscillator = this.context.createOscillator();\n        this._internalChannels = [this._oscillator];\n        connect(this._oscillator, this._gainNode);\n        this.type = options.type;\n        this.frequency = new Param({\n            context: this.context,\n            param: this._oscillator.frequency,\n            units: \"frequency\",\n            value: options.frequency,\n        });\n        this.detune = new Param({\n            context: this.context,\n            param: this._oscillator.detune,\n            units: \"cents\",\n            value: options.detune,\n        });\n        readOnly(this, [\"frequency\", \"detune\"]);\n    }\n    static getDefaults() {\n        return Object.assign(OneShotSource.getDefaults(), {\n            detune: 0,\n            frequency: 440,\n            type: \"sine\",\n        });\n    }\n    /**\n     * Start the oscillator node at the given time\n     * @param  time When to start the oscillator\n     */\n    start(time) {\n        const computedTime = this.toSeconds(time);\n        this.log(\"start\", computedTime);\n        this._startGain(computedTime);\n        this._oscillator.start(computedTime);\n        return this;\n    }\n    _stopSource(time) {\n        this._oscillator.stop(time);\n    }\n    /**\n     * Sets an arbitrary custom periodic waveform given a PeriodicWave.\n     * @param  periodicWave PeriodicWave should be created with context.createPeriodicWave\n     */\n    setPeriodicWave(periodicWave) {\n        this._oscillator.setPeriodicWave(periodicWave);\n        return this;\n    }\n    /**\n     * The oscillator type. Either 'sine', 'sawtooth', 'square', or 'triangle'\n     */\n    get type() {\n        return this._oscillator.type;\n    }\n    set type(type) {\n        this._oscillator.type = type;\n    }\n    /**\n     * Clean up.\n     */\n    dispose() {\n        super.dispose();\n        if (this.state === \"started\") {\n            this.stop();\n        }\n        this._oscillator.disconnect();\n        this.frequency.dispose();\n        this.detune.dispose();\n        return this;\n    }\n}\n//# sourceMappingURL=ToneOscillatorNode.js.map","import { __awaiter } from \"tslib\";\nimport { deepEquals, optionsFromArguments } from \"../../core/util/Defaults.js\";\nimport { readOnly } from \"../../core/util/Interface.js\";\nimport { isDefined } from \"../../core/util/TypeCheck.js\";\nimport { Signal } from \"../../signal/Signal.js\";\nimport { Source } from \"../Source.js\";\nimport { generateWaveform, } from \"./OscillatorInterface.js\";\nimport { ToneOscillatorNode } from \"./ToneOscillatorNode.js\";\nimport { assertRange } from \"../../core/util/Debug.js\";\nimport { clamp } from \"../../core/util/Math.js\";\n/**\n * Oscillator supports a number of features including\n * phase rotation, multiple oscillator types (see Oscillator.type),\n * and Transport syncing (see Oscillator.syncFrequency).\n *\n * @example\n * // make and start a 440hz sine tone\n * const osc = new Tone.Oscillator(440, \"sine\").toDestination().start();\n * @category Source\n */\nexport class Oscillator extends Source {\n    constructor() {\n        const options = optionsFromArguments(Oscillator.getDefaults(), arguments, [\"frequency\", \"type\"]);\n        super(options);\n        this.name = \"Oscillator\";\n        /**\n         * the main oscillator\n         */\n        this._oscillator = null;\n        this.frequency = new Signal({\n            context: this.context,\n            units: \"frequency\",\n            value: options.frequency,\n        });\n        readOnly(this, \"frequency\");\n        this.detune = new Signal({\n            context: this.context,\n            units: \"cents\",\n            value: options.detune,\n        });\n        readOnly(this, \"detune\");\n        this._partials = options.partials;\n        this._partialCount = options.partialCount;\n        this._type = options.type;\n        if (options.partialCount && options.type !== \"custom\") {\n            this._type = (this.baseType +\n                options.partialCount.toString());\n        }\n        this.phase = options.phase;\n    }\n    static getDefaults() {\n        return Object.assign(Source.getDefaults(), {\n            detune: 0,\n            frequency: 440,\n            partialCount: 0,\n            partials: [],\n            phase: 0,\n            type: \"sine\",\n        });\n    }\n    /**\n     * start the oscillator\n     */\n    _start(time) {\n        const computedTime = this.toSeconds(time);\n        // new oscillator with previous values\n        const oscillator = new ToneOscillatorNode({\n            context: this.context,\n            onended: () => this.onstop(this),\n        });\n        this._oscillator = oscillator;\n        if (this._wave) {\n            this._oscillator.setPeriodicWave(this._wave);\n        }\n        else {\n            this._oscillator.type = this._type;\n        }\n        // connect the control signal to the oscillator frequency & detune\n        this._oscillator.connect(this.output);\n        this.frequency.connect(this._oscillator.frequency);\n        this.detune.connect(this._oscillator.detune);\n        // start the oscillator\n        this._oscillator.start(computedTime);\n    }\n    /**\n     * stop the oscillator\n     */\n    _stop(time) {\n        const computedTime = this.toSeconds(time);\n        if (this._oscillator) {\n            this._oscillator.stop(computedTime);\n        }\n    }\n    /**\n     * Restart the oscillator. Does not stop the oscillator, but instead\n     * just cancels any scheduled 'stop' from being invoked.\n     */\n    _restart(time) {\n        const computedTime = this.toSeconds(time);\n        this.log(\"restart\", computedTime);\n        if (this._oscillator) {\n            this._oscillator.cancelStop();\n        }\n        this._state.cancel(computedTime);\n        return this;\n    }\n    /**\n     * Sync the signal to the Transport's bpm. Any changes to the transports bpm,\n     * will also affect the oscillators frequency.\n     * @example\n     * const osc = new Tone.Oscillator().toDestination().start();\n     * osc.frequency.value = 440;\n     * // the ratio between the bpm and the frequency will be maintained\n     * osc.syncFrequency();\n     * // double the tempo\n     * Tone.Transport.bpm.value *= 2;\n     * // the frequency of the oscillator is doubled to 880\n     */\n    syncFrequency() {\n        this.context.transport.syncSignal(this.frequency);\n        return this;\n    }\n    /**\n     * Unsync the oscillator's frequency from the Transport.\n     * @see {@link syncFrequency}\n     */\n    unsyncFrequency() {\n        this.context.transport.unsyncSignal(this.frequency);\n        return this;\n    }\n    /**\n     * Get a cached periodic wave. Avoids having to recompute\n     * the oscillator values when they have already been computed\n     * with the same values.\n     */\n    _getCachedPeriodicWave() {\n        if (this._type === \"custom\") {\n            const oscProps = Oscillator._periodicWaveCache.find((description) => {\n                return (description.phase === this._phase &&\n                    deepEquals(description.partials, this._partials));\n            });\n            return oscProps;\n        }\n        else {\n            const oscProps = Oscillator._periodicWaveCache.find((description) => {\n                return (description.type === this._type &&\n                    description.phase === this._phase);\n            });\n            this._partialCount = oscProps\n                ? oscProps.partialCount\n                : this._partialCount;\n            return oscProps;\n        }\n    }\n    get type() {\n        return this._type;\n    }\n    set type(type) {\n        this._type = type;\n        const isBasicType = [\"sine\", \"square\", \"sawtooth\", \"triangle\"].indexOf(type) !== -1;\n        if (this._phase === 0 && isBasicType) {\n            this._wave = undefined;\n            this._partialCount = 0;\n            // just go with the basic approach\n            if (this._oscillator !== null) {\n                // already tested that it's a basic type\n                this._oscillator.type = type;\n            }\n        }\n        else {\n            // first check if the value is cached\n            const cache = this._getCachedPeriodicWave();\n            if (isDefined(cache)) {\n                const { partials, wave } = cache;\n                this._wave = wave;\n                this._partials = partials;\n                if (this._oscillator !== null) {\n                    this._oscillator.setPeriodicWave(this._wave);\n                }\n            }\n            else {\n                const [real, imag] = this._getRealImaginary(type, this._phase);\n                const periodicWave = this.context.createPeriodicWave(real, imag);\n                this._wave = periodicWave;\n                if (this._oscillator !== null) {\n                    this._oscillator.setPeriodicWave(this._wave);\n                }\n                // set the cache\n                Oscillator._periodicWaveCache.push({\n                    imag,\n                    partialCount: this._partialCount,\n                    partials: this._partials,\n                    phase: this._phase,\n                    real,\n                    type: this._type,\n                    wave: this._wave,\n                });\n                if (Oscillator._periodicWaveCache.length > 100) {\n                    Oscillator._periodicWaveCache.shift();\n                }\n            }\n        }\n    }\n    get baseType() {\n        return this._type.replace(this.partialCount.toString(), \"\");\n    }\n    set baseType(baseType) {\n        if (this.partialCount &&\n            this._type !== \"custom\" &&\n            baseType !== \"custom\") {\n            this.type = (baseType + this.partialCount);\n        }\n        else {\n            this.type = baseType;\n        }\n    }\n    get partialCount() {\n        return this._partialCount;\n    }\n    set partialCount(p) {\n        assertRange(p, 0);\n        let type = this._type;\n        const partial = /^(sine|triangle|square|sawtooth)(\\d+)$/.exec(this._type);\n        if (partial) {\n            type = partial[1];\n        }\n        if (this._type !== \"custom\") {\n            if (p === 0) {\n                this.type = type;\n            }\n            else {\n                this.type = (type + p.toString());\n            }\n        }\n        else {\n            // extend or shorten the partials array\n            const fullPartials = new Float32Array(p);\n            // copy over the partials array\n            this._partials.forEach((v, i) => (fullPartials[i] = v));\n            this._partials = Array.from(fullPartials);\n            this.type = this._type;\n        }\n    }\n    /**\n     * Returns the real and imaginary components based\n     * on the oscillator type.\n     * @returns [real: Float32Array, imaginary: Float32Array]\n     */\n    _getRealImaginary(type, phase) {\n        const fftSize = 4096;\n        let periodicWaveSize = fftSize / 2;\n        const real = new Float32Array(periodicWaveSize);\n        const imag = new Float32Array(periodicWaveSize);\n        let partialCount = 1;\n        if (type === \"custom\") {\n            partialCount = this._partials.length + 1;\n            this._partialCount = this._partials.length;\n            periodicWaveSize = partialCount;\n            // if the partial count is 0, don't bother doing any computation\n            if (this._partials.length === 0) {\n                return [real, imag];\n            }\n        }\n        else {\n            const partial = /^(sine|triangle|square|sawtooth)(\\d+)$/.exec(type);\n            if (partial) {\n                partialCount = parseInt(partial[2], 10) + 1;\n                this._partialCount = parseInt(partial[2], 10);\n                type = partial[1];\n                partialCount = Math.max(partialCount, 2);\n                periodicWaveSize = partialCount;\n            }\n            else {\n                this._partialCount = 0;\n            }\n            this._partials = [];\n        }\n        for (let n = 1; n < periodicWaveSize; ++n) {\n            const piFactor = 2 / (n * Math.PI);\n            let b;\n            switch (type) {\n                case \"sine\":\n                    b = n <= partialCount ? 1 : 0;\n                    this._partials[n - 1] = b;\n                    break;\n                case \"square\":\n                    b = n & 1 ? 2 * piFactor : 0;\n                    this._partials[n - 1] = b;\n                    break;\n                case \"sawtooth\":\n                    b = piFactor * (n & 1 ? 1 : -1);\n                    this._partials[n - 1] = b;\n                    break;\n                case \"triangle\":\n                    if (n & 1) {\n                        b =\n                            2 *\n                                (piFactor * piFactor) *\n                                (((n - 1) >> 1) & 1 ? -1 : 1);\n                    }\n                    else {\n                        b = 0;\n                    }\n                    this._partials[n - 1] = b;\n                    break;\n                case \"custom\":\n                    b = this._partials[n - 1];\n                    break;\n                default:\n                    throw new TypeError(\"Oscillator: invalid type: \" + type);\n            }\n            if (b !== 0) {\n                real[n] = -b * Math.sin(phase * n);\n                imag[n] = b * Math.cos(phase * n);\n            }\n            else {\n                real[n] = 0;\n                imag[n] = 0;\n            }\n        }\n        return [real, imag];\n    }\n    /**\n     * Compute the inverse FFT for a given phase.\n     */\n    _inverseFFT(real, imag, phase) {\n        let sum = 0;\n        const len = real.length;\n        for (let i = 0; i < len; i++) {\n            sum +=\n                real[i] * Math.cos(i * phase) + imag[i] * Math.sin(i * phase);\n        }\n        return sum;\n    }\n    /**\n     * Returns the initial value of the oscillator when stopped.\n     * E.g. a \"sine\" oscillator with phase = 90 would return an initial value of -1.\n     */\n    getInitialValue() {\n        const [real, imag] = this._getRealImaginary(this._type, 0);\n        let maxValue = 0;\n        const twoPi = Math.PI * 2;\n        const testPositions = 32;\n        // check for peaks in 16 places\n        for (let i = 0; i < testPositions; i++) {\n            maxValue = Math.max(this._inverseFFT(real, imag, (i / testPositions) * twoPi), maxValue);\n        }\n        return clamp(-this._inverseFFT(real, imag, this._phase) / maxValue, -1, 1);\n    }\n    get partials() {\n        return this._partials.slice(0, this.partialCount);\n    }\n    set partials(partials) {\n        this._partials = partials;\n        this._partialCount = this._partials.length;\n        if (partials.length) {\n            this.type = \"custom\";\n        }\n    }\n    get phase() {\n        return this._phase * (180 / Math.PI);\n    }\n    set phase(phase) {\n        this._phase = (phase * Math.PI) / 180;\n        // reset the type\n        this.type = this._type;\n    }\n    asArray() {\n        return __awaiter(this, arguments, void 0, function* (length = 1024) {\n            return generateWaveform(this, length);\n        });\n    }\n    dispose() {\n        super.dispose();\n        if (this._oscillator !== null) {\n            this._oscillator.dispose();\n        }\n        this._wave = undefined;\n        this.frequency.dispose();\n        this.detune.dispose();\n        return this;\n    }\n}\n/**\n * Cache the periodic waves to avoid having to redo computations\n */\nOscillator._periodicWaveCache = [];\n//# sourceMappingURL=Oscillator.js.map","import { SignalOperator } from \"./SignalOperator.js\";\nimport { WaveShaper } from \"./WaveShaper.js\";\n/**\n * AudioToGain converts an input in AudioRange [-1,1] to NormalRange [0,1].\n * @see {@link GainToAudio}.\n * @category Signal\n */\nexport class AudioToGain extends SignalOperator {\n    constructor() {\n        super(...arguments);\n        this.name = \"AudioToGain\";\n        /**\n         * The node which converts the audio ranges\n         */\n        this._norm = new WaveShaper({\n            context: this.context,\n            mapping: (x) => (x + 1) / 2,\n        });\n        /**\n         * The AudioRange input [-1, 1]\n         */\n        this.input = this._norm;\n        /**\n         * The GainRange output [0, 1]\n         */\n        this.output = this._norm;\n    }\n    /**\n     * clean up\n     */\n    dispose() {\n        super.dispose();\n        this._norm.dispose();\n        return this;\n    }\n}\n//# sourceMappingURL=AudioToGain.js.map","import { Gain } from \"../core/context/Gain.js\";\nimport { optionsFromArguments } from \"../core/util/Defaults.js\";\nimport { Signal } from \"./Signal.js\";\n/**\n * Multiply two incoming signals. Or, if a number is given in the constructor,\n * multiplies the incoming signal by that value.\n *\n * @example\n * // multiply two signals\n * const mult = new Tone.Multiply();\n * const sigA = new Tone.Signal(3);\n * const sigB = new Tone.Signal(4);\n * sigA.connect(mult);\n * sigB.connect(mult.factor);\n * // output of mult is 12.\n * @example\n * // multiply a signal and a number\n * const mult = new Tone.Multiply(10);\n * const sig = new Tone.Signal(2).connect(mult);\n * // the output of mult is 20.\n * @category Signal\n */\nexport class Multiply extends Signal {\n    constructor() {\n        const options = optionsFromArguments(Multiply.getDefaults(), arguments, [\"value\"]);\n        super(options);\n        this.name = \"Multiply\";\n        /**\n         * Indicates if the value should be overridden on connection\n         */\n        this.override = false;\n        this._mult =\n            this.input =\n                this.output =\n                    new Gain({\n                        context: this.context,\n                        minValue: options.minValue,\n                        maxValue: options.maxValue,\n                    });\n        this.factor = this._param = this._mult\n            .gain;\n        this.factor.setValueAtTime(options.value, 0);\n    }\n    static getDefaults() {\n        return Object.assign(Signal.getDefaults(), {\n            value: 0,\n        });\n    }\n    dispose() {\n        super.dispose();\n        this._mult.dispose();\n        return this;\n    }\n}\n//# sourceMappingURL=Multiply.js.map","import { __awaiter } from \"tslib\";\nimport { Gain } from \"../../core/context/Gain.js\";\nimport { optionsFromArguments } from \"../../core/util/Defaults.js\";\nimport { readOnly } from \"../../core/util/Interface.js\";\nimport { AudioToGain } from \"../../signal/AudioToGain.js\";\nimport { Multiply } from \"../../signal/Multiply.js\";\nimport { Source } from \"../Source.js\";\nimport { Oscillator } from \"./Oscillator.js\";\nimport { generateWaveform, } from \"./OscillatorInterface.js\";\n/**\n * An amplitude modulated oscillator node. It is implemented with\n * two oscillators, one which modulators the other's amplitude\n * through a gain node.\n * ```\n *    +-------------+       +----------+\n *    | Carrier Osc +>------> GainNode |\n *    +-------------+       |          +--->Output\n *                      +---> gain     |\n * +---------------+    |   +----------+\n * | Modulator Osc +>---+\n * +---------------+\n * ```\n * @example\n * return Tone.Offline(() => {\n * \tconst amOsc = new Tone.AMOscillator(30, \"sine\", \"square\").toDestination().start();\n * }, 0.2, 1);\n * @category Source\n */\nexport class AMOscillator extends Source {\n    constructor() {\n        const options = optionsFromArguments(AMOscillator.getDefaults(), arguments, [\"frequency\", \"type\", \"modulationType\"]);\n        super(options);\n        this.name = \"AMOscillator\";\n        /**\n         * convert the -1,1 output to 0,1\n         */\n        this._modulationScale = new AudioToGain({ context: this.context });\n        /**\n         * the node where the modulation happens\n         */\n        this._modulationNode = new Gain({\n            context: this.context,\n        });\n        this._carrier = new Oscillator({\n            context: this.context,\n            detune: options.detune,\n            frequency: options.frequency,\n            onstop: () => this.onstop(this),\n            phase: options.phase,\n            type: options.type,\n        });\n        (this.frequency = this._carrier.frequency),\n            (this.detune = this._carrier.detune);\n        this._modulator = new Oscillator({\n            context: this.context,\n            phase: options.phase,\n            type: options.modulationType,\n        });\n        this.harmonicity = new Multiply({\n            context: this.context,\n            units: \"positive\",\n            value: options.harmonicity,\n        });\n        // connections\n        this.frequency.chain(this.harmonicity, this._modulator.frequency);\n        this._modulator.chain(this._modulationScale, this._modulationNode.gain);\n        this._carrier.chain(this._modulationNode, this.output);\n        readOnly(this, [\"frequency\", \"detune\", \"harmonicity\"]);\n    }\n    static getDefaults() {\n        return Object.assign(Oscillator.getDefaults(), {\n            harmonicity: 1,\n            modulationType: \"square\",\n        });\n    }\n    /**\n     * start the oscillator\n     */\n    _start(time) {\n        this._modulator.start(time);\n        this._carrier.start(time);\n    }\n    /**\n     * stop the oscillator\n     */\n    _stop(time) {\n        this._modulator.stop(time);\n        this._carrier.stop(time);\n    }\n    _restart(time) {\n        this._modulator.restart(time);\n        this._carrier.restart(time);\n    }\n    /**\n     * The type of the carrier oscillator\n     */\n    get type() {\n        return this._carrier.type;\n    }\n    set type(type) {\n        this._carrier.type = type;\n    }\n    get baseType() {\n        return this._carrier.baseType;\n    }\n    set baseType(baseType) {\n        this._carrier.baseType = baseType;\n    }\n    get partialCount() {\n        return this._carrier.partialCount;\n    }\n    set partialCount(partialCount) {\n        this._carrier.partialCount = partialCount;\n    }\n    /**\n     * The type of the modulator oscillator\n     */\n    get modulationType() {\n        return this._modulator.type;\n    }\n    set modulationType(type) {\n        this._modulator.type = type;\n    }\n    get phase() {\n        return this._carrier.phase;\n    }\n    set phase(phase) {\n        this._carrier.phase = phase;\n        this._modulator.phase = phase;\n    }\n    get partials() {\n        return this._carrier.partials;\n    }\n    set partials(partials) {\n        this._carrier.partials = partials;\n    }\n    asArray() {\n        return __awaiter(this, arguments, void 0, function* (length = 1024) {\n            return generateWaveform(this, length);\n        });\n    }\n    /**\n     * Clean up.\n     */\n    dispose() {\n        super.dispose();\n        this.frequency.dispose();\n        this.detune.dispose();\n        this.harmonicity.dispose();\n        this._carrier.dispose();\n        this._modulator.dispose();\n        this._modulationNode.dispose();\n        this._modulationScale.dispose();\n        return this;\n    }\n}\n//# sourceMappingURL=AMOscillator.js.map","import { __awaiter } from \"tslib\";\nimport { Gain } from \"../../core/context/Gain.js\";\nimport { optionsFromArguments } from \"../../core/util/Defaults.js\";\nimport { readOnly } from \"../../core/util/Interface.js\";\nimport { Multiply } from \"../../signal/Multiply.js\";\nimport { Signal } from \"../../signal/Signal.js\";\nimport { Source } from \"../Source.js\";\nimport { Oscillator } from \"./Oscillator.js\";\nimport { generateWaveform, } from \"./OscillatorInterface.js\";\n/**\n * FMOscillator implements a frequency modulation synthesis\n * ```\n *                                              +-------------+\n * +---------------+        +-------------+     | Carrier Osc |\n * | Modulator Osc +>-------> GainNode    |     |             +--->Output\n * +---------------+        |             +>----> frequency   |\n *                       +--> gain        |     +-------------+\n *                       |  +-------------+\n * +-----------------+   |\n * | modulationIndex +>--+\n * +-----------------+\n * ```\n *\n * @example\n * return Tone.Offline(() => {\n * \tconst fmOsc = new Tone.FMOscillator({\n * \t\tfrequency: 200,\n * \t\ttype: \"square\",\n * \t\tmodulationType: \"triangle\",\n * \t\tharmonicity: 0.2,\n * \t\tmodulationIndex: 3\n * \t}).toDestination().start();\n * }, 0.1, 1);\n * @category Source\n */\nexport class FMOscillator extends Source {\n    constructor() {\n        const options = optionsFromArguments(FMOscillator.getDefaults(), arguments, [\"frequency\", \"type\", \"modulationType\"]);\n        super(options);\n        this.name = \"FMOscillator\";\n        /**\n         * the node where the modulation happens\n         */\n        this._modulationNode = new Gain({\n            context: this.context,\n            gain: 0,\n        });\n        this._carrier = new Oscillator({\n            context: this.context,\n            detune: options.detune,\n            frequency: 0,\n            onstop: () => this.onstop(this),\n            phase: options.phase,\n            type: options.type,\n        });\n        this.detune = this._carrier.detune;\n        this.frequency = new Signal({\n            context: this.context,\n            units: \"frequency\",\n            value: options.frequency,\n        });\n        this._modulator = new Oscillator({\n            context: this.context,\n            phase: options.phase,\n            type: options.modulationType,\n        });\n        this.harmonicity = new Multiply({\n            context: this.context,\n            units: \"positive\",\n            value: options.harmonicity,\n        });\n        this.modulationIndex = new Multiply({\n            context: this.context,\n            units: \"positive\",\n            value: options.modulationIndex,\n        });\n        // connections\n        this.frequency.connect(this._carrier.frequency);\n        this.frequency.chain(this.harmonicity, this._modulator.frequency);\n        this.frequency.chain(this.modulationIndex, this._modulationNode);\n        this._modulator.connect(this._modulationNode.gain);\n        this._modulationNode.connect(this._carrier.frequency);\n        this._carrier.connect(this.output);\n        this.detune.connect(this._modulator.detune);\n        readOnly(this, [\n            \"modulationIndex\",\n            \"frequency\",\n            \"detune\",\n            \"harmonicity\",\n        ]);\n    }\n    static getDefaults() {\n        return Object.assign(Oscillator.getDefaults(), {\n            harmonicity: 1,\n            modulationIndex: 2,\n            modulationType: \"square\",\n        });\n    }\n    /**\n     * start the oscillator\n     */\n    _start(time) {\n        this._modulator.start(time);\n        this._carrier.start(time);\n    }\n    /**\n     * stop the oscillator\n     */\n    _stop(time) {\n        this._modulator.stop(time);\n        this._carrier.stop(time);\n    }\n    _restart(time) {\n        this._modulator.restart(time);\n        this._carrier.restart(time);\n        return this;\n    }\n    get type() {\n        return this._carrier.type;\n    }\n    set type(type) {\n        this._carrier.type = type;\n    }\n    get baseType() {\n        return this._carrier.baseType;\n    }\n    set baseType(baseType) {\n        this._carrier.baseType = baseType;\n    }\n    get partialCount() {\n        return this._carrier.partialCount;\n    }\n    set partialCount(partialCount) {\n        this._carrier.partialCount = partialCount;\n    }\n    /**\n     * The type of the modulator oscillator\n     */\n    get modulationType() {\n        return this._modulator.type;\n    }\n    set modulationType(type) {\n        this._modulator.type = type;\n    }\n    get phase() {\n        return this._carrier.phase;\n    }\n    set phase(phase) {\n        this._carrier.phase = phase;\n        this._modulator.phase = phase;\n    }\n    get partials() {\n        return this._carrier.partials;\n    }\n    set partials(partials) {\n        this._carrier.partials = partials;\n    }\n    asArray() {\n        return __awaiter(this, arguments, void 0, function* (length = 1024) {\n            return generateWaveform(this, length);\n        });\n    }\n    /**\n     * Clean up.\n     */\n    dispose() {\n        super.dispose();\n        this.frequency.dispose();\n        this.harmonicity.dispose();\n        this._carrier.dispose();\n        this._modulator.dispose();\n        this._modulationNode.dispose();\n        this.modulationIndex.dispose();\n        return this;\n    }\n}\n//# sourceMappingURL=FMOscillator.js.map","import { __awaiter } from \"tslib\";\nimport { Gain } from \"../../core/context/Gain.js\";\nimport { optionsFromArguments } from \"../../core/util/Defaults.js\";\nimport { readOnly } from \"../../core/util/Interface.js\";\nimport { Signal } from \"../../signal/Signal.js\";\nimport { WaveShaper } from \"../../signal/WaveShaper.js\";\nimport { Source } from \"../Source.js\";\nimport { Oscillator } from \"./Oscillator.js\";\nimport { generateWaveform, } from \"./OscillatorInterface.js\";\n/**\n * PulseOscillator is an oscillator with control over pulse width,\n * also known as the duty cycle. At 50% duty cycle (width = 0) the wave is\n * a square wave.\n * [Read more](https://wigglewave.wordpress.com/2014/08/16/pulse-waveforms-and-harmonics/).\n * ```\n *    width = -0.25        width = 0.0          width = 0.25\n *\n *   +-----+            +-------+       +    +-------+     +-+\n *   |     |            |       |       |            |     |\n *   |     |            |       |       |            |     |\n * +-+     +-------+    +       +-------+            +-----+\n *\n *\n *    width = -0.5                              width = 0.5\n *\n *     +---+                                 +-------+   +---+\n *     |   |                                         |   |\n *     |   |                                         |   |\n * +---+   +-------+                                 +---+\n *\n *\n *    width = -0.75                             width = 0.75\n *\n *       +-+                                 +-------+ +-----+\n *       | |                                         | |\n *       | |                                         | |\n * +-----+ +-------+                                 +-+\n * ```\n * @example\n * return Tone.Offline(() => {\n * \tconst pulse = new Tone.PulseOscillator(50, 0.4).toDestination().start();\n * }, 0.1, 1);\n * @category Source\n */\nexport class PulseOscillator extends Source {\n    constructor() {\n        const options = optionsFromArguments(PulseOscillator.getDefaults(), arguments, [\"frequency\", \"width\"]);\n        super(options);\n        this.name = \"PulseOscillator\";\n        /**\n         * gate the width amount\n         */\n        this._widthGate = new Gain({\n            context: this.context,\n            gain: 0,\n        });\n        /**\n         * Threshold the signal to turn it into a square\n         */\n        this._thresh = new WaveShaper({\n            context: this.context,\n            mapping: (val) => (val <= 0 ? -1 : 1),\n        });\n        this.width = new Signal({\n            context: this.context,\n            units: \"audioRange\",\n            value: options.width,\n        });\n        this._triangle = new Oscillator({\n            context: this.context,\n            detune: options.detune,\n            frequency: options.frequency,\n            onstop: () => this.onstop(this),\n            phase: options.phase,\n            type: \"triangle\",\n        });\n        this.frequency = this._triangle.frequency;\n        this.detune = this._triangle.detune;\n        // connections\n        this._triangle.chain(this._thresh, this.output);\n        this.width.chain(this._widthGate, this._thresh);\n        readOnly(this, [\"width\", \"frequency\", \"detune\"]);\n    }\n    static getDefaults() {\n        return Object.assign(Source.getDefaults(), {\n            detune: 0,\n            frequency: 440,\n            phase: 0,\n            type: \"pulse\",\n            width: 0.2,\n        });\n    }\n    /**\n     * start the oscillator\n     */\n    _start(time) {\n        time = this.toSeconds(time);\n        this._triangle.start(time);\n        this._widthGate.gain.setValueAtTime(1, time);\n    }\n    /**\n     * stop the oscillator\n     */\n    _stop(time) {\n        time = this.toSeconds(time);\n        this._triangle.stop(time);\n        // the width is still connected to the output.\n        // that needs to be stopped also\n        this._widthGate.gain.cancelScheduledValues(time);\n        this._widthGate.gain.setValueAtTime(0, time);\n    }\n    _restart(time) {\n        this._triangle.restart(time);\n        this._widthGate.gain.cancelScheduledValues(time);\n        this._widthGate.gain.setValueAtTime(1, time);\n    }\n    /**\n     * The phase of the oscillator in degrees.\n     */\n    get phase() {\n        return this._triangle.phase;\n    }\n    set phase(phase) {\n        this._triangle.phase = phase;\n    }\n    /**\n     * The type of the oscillator. Always returns \"pulse\".\n     */\n    get type() {\n        return \"pulse\";\n    }\n    /**\n     * The baseType of the oscillator. Always returns \"pulse\".\n     */\n    get baseType() {\n        return \"pulse\";\n    }\n    /**\n     * The partials of the waveform. Cannot set partials for this waveform type\n     */\n    get partials() {\n        return [];\n    }\n    /**\n     * No partials for this waveform type.\n     */\n    get partialCount() {\n        return 0;\n    }\n    /**\n     * *Internal use* The carrier oscillator type is fed through the\n     * waveshaper node to create the pulse. Using different carrier oscillators\n     * changes oscillator's behavior.\n     */\n    set carrierType(type) {\n        this._triangle.type = type;\n    }\n    asArray() {\n        return __awaiter(this, arguments, void 0, function* (length = 1024) {\n            return generateWaveform(this, length);\n        });\n    }\n    /**\n     * Clean up method.\n     */\n    dispose() {\n        super.dispose();\n        this._triangle.dispose();\n        this.width.dispose();\n        this._widthGate.dispose();\n        this._thresh.dispose();\n        return this;\n    }\n}\n//# sourceMappingURL=PulseOscillator.js.map","import { __awaiter } from \"tslib\";\nimport { optionsFromArguments } from \"../../core/util/Defaults.js\";\nimport { noOp, readOnly } from \"../../core/util/Interface.js\";\nimport { Signal } from \"../../signal/Signal.js\";\nimport { Source } from \"../Source.js\";\nimport { Oscillator } from \"./Oscillator.js\";\nimport { generateWaveform, } from \"./OscillatorInterface.js\";\nimport { assertRange } from \"../../core/util/Debug.js\";\n/**\n * FatOscillator is an array of oscillators with detune spread between the oscillators\n * @example\n * const fatOsc = new Tone.FatOscillator(\"Ab3\", \"sawtooth\", 40).toDestination().start();\n * @category Source\n */\nexport class FatOscillator extends Source {\n    constructor() {\n        const options = optionsFromArguments(FatOscillator.getDefaults(), arguments, [\"frequency\", \"type\", \"spread\"]);\n        super(options);\n        this.name = \"FatOscillator\";\n        /**\n         * The array of oscillators\n         */\n        this._oscillators = [];\n        this.frequency = new Signal({\n            context: this.context,\n            units: \"frequency\",\n            value: options.frequency,\n        });\n        this.detune = new Signal({\n            context: this.context,\n            units: \"cents\",\n            value: options.detune,\n        });\n        this._spread = options.spread;\n        this._type = options.type;\n        this._phase = options.phase;\n        this._partials = options.partials;\n        this._partialCount = options.partialCount;\n        // set the count initially\n        this.count = options.count;\n        readOnly(this, [\"frequency\", \"detune\"]);\n    }\n    static getDefaults() {\n        return Object.assign(Oscillator.getDefaults(), {\n            count: 3,\n            spread: 20,\n            type: \"sawtooth\",\n        });\n    }\n    /**\n     * start the oscillator\n     */\n    _start(time) {\n        time = this.toSeconds(time);\n        this._forEach((osc) => osc.start(time));\n    }\n    /**\n     * stop the oscillator\n     */\n    _stop(time) {\n        time = this.toSeconds(time);\n        this._forEach((osc) => osc.stop(time));\n    }\n    _restart(time) {\n        this._forEach((osc) => osc.restart(time));\n    }\n    /**\n     * Iterate over all of the oscillators\n     */\n    _forEach(iterator) {\n        for (let i = 0; i < this._oscillators.length; i++) {\n            iterator(this._oscillators[i], i);\n        }\n    }\n    /**\n     * The type of the oscillator\n     */\n    get type() {\n        return this._type;\n    }\n    set type(type) {\n        this._type = type;\n        this._forEach((osc) => (osc.type = type));\n    }\n    /**\n     * The detune spread between the oscillators. If \"count\" is\n     * set to 3 oscillators and the \"spread\" is set to 40,\n     * the three oscillators would be detuned like this: [-20, 0, 20]\n     * for a total detune spread of 40 cents.\n     * @example\n     * const fatOsc = new Tone.FatOscillator().toDestination().start();\n     * fatOsc.spread = 70;\n     */\n    get spread() {\n        return this._spread;\n    }\n    set spread(spread) {\n        this._spread = spread;\n        if (this._oscillators.length > 1) {\n            const start = -spread / 2;\n            const step = spread / (this._oscillators.length - 1);\n            this._forEach((osc, i) => (osc.detune.value = start + step * i));\n        }\n    }\n    /**\n     * The number of detuned oscillators. Must be an integer greater than 1.\n     * @example\n     * const fatOsc = new Tone.FatOscillator(\"C#3\", \"sawtooth\").toDestination().start();\n     * // use 4 sawtooth oscillators\n     * fatOsc.count = 4;\n     */\n    get count() {\n        return this._oscillators.length;\n    }\n    set count(count) {\n        assertRange(count, 1);\n        if (this._oscillators.length !== count) {\n            // dispose the previous oscillators\n            this._forEach((osc) => osc.dispose());\n            this._oscillators = [];\n            for (let i = 0; i < count; i++) {\n                const osc = new Oscillator({\n                    context: this.context,\n                    volume: -6 - count * 1.1,\n                    type: this._type,\n                    phase: this._phase + (i / count) * 360,\n                    partialCount: this._partialCount,\n                    onstop: i === 0 ? () => this.onstop(this) : noOp,\n                });\n                if (this.type === \"custom\") {\n                    osc.partials = this._partials;\n                }\n                this.frequency.connect(osc.frequency);\n                this.detune.connect(osc.detune);\n                osc.detune.overridden = false;\n                osc.connect(this.output);\n                this._oscillators[i] = osc;\n            }\n            // set the spread\n            this.spread = this._spread;\n            if (this.state === \"started\") {\n                this._forEach((osc) => osc.start());\n            }\n        }\n    }\n    get phase() {\n        return this._phase;\n    }\n    set phase(phase) {\n        this._phase = phase;\n        this._forEach((osc, i) => (osc.phase = this._phase + (i / this.count) * 360));\n    }\n    get baseType() {\n        return this._oscillators[0].baseType;\n    }\n    set baseType(baseType) {\n        this._forEach((osc) => (osc.baseType = baseType));\n        this._type = this._oscillators[0].type;\n    }\n    get partials() {\n        return this._oscillators[0].partials;\n    }\n    set partials(partials) {\n        this._partials = partials;\n        this._partialCount = this._partials.length;\n        if (partials.length) {\n            this._type = \"custom\";\n            this._forEach((osc) => (osc.partials = partials));\n        }\n    }\n    get partialCount() {\n        return this._oscillators[0].partialCount;\n    }\n    set partialCount(partialCount) {\n        this._partialCount = partialCount;\n        this._forEach((osc) => (osc.partialCount = partialCount));\n        this._type = this._oscillators[0].type;\n    }\n    asArray() {\n        return __awaiter(this, arguments, void 0, function* (length = 1024) {\n            return generateWaveform(this, length);\n        });\n    }\n    /**\n     * Clean up.\n     */\n    dispose() {\n        super.dispose();\n        this.frequency.dispose();\n        this.detune.dispose();\n        this._forEach((osc) => osc.dispose());\n        return this;\n    }\n}\n//# sourceMappingURL=FatOscillator.js.map","import { __awaiter } from \"tslib\";\nimport { optionsFromArguments } from \"../../core/util/Defaults.js\";\nimport { readOnly } from \"../../core/util/Interface.js\";\nimport { Multiply } from \"../../signal/Multiply.js\";\nimport { Source } from \"../Source.js\";\nimport { Oscillator } from \"./Oscillator.js\";\nimport { generateWaveform, } from \"./OscillatorInterface.js\";\nimport { PulseOscillator } from \"./PulseOscillator.js\";\n/**\n * PWMOscillator modulates the width of a Tone.PulseOscillator\n * at the modulationFrequency. This has the effect of continuously\n * changing the timbre of the oscillator by altering the harmonics\n * generated.\n * @example\n * return Tone.Offline(() => {\n * \tconst pwm = new Tone.PWMOscillator(60, 0.3).toDestination().start();\n * }, 0.1, 1);\n * @category Source\n */\nexport class PWMOscillator extends Source {\n    constructor() {\n        const options = optionsFromArguments(PWMOscillator.getDefaults(), arguments, [\"frequency\", \"modulationFrequency\"]);\n        super(options);\n        this.name = \"PWMOscillator\";\n        this.sourceType = \"pwm\";\n        /**\n         * Scale the oscillator so it doesn't go silent\n         * at the extreme values.\n         */\n        this._scale = new Multiply({\n            context: this.context,\n            value: 2,\n        });\n        this._pulse = new PulseOscillator({\n            context: this.context,\n            frequency: options.modulationFrequency,\n        });\n        // change the pulse oscillator type\n        this._pulse.carrierType = \"sine\";\n        this.modulationFrequency = this._pulse.frequency;\n        this._modulator = new Oscillator({\n            context: this.context,\n            detune: options.detune,\n            frequency: options.frequency,\n            onstop: () => this.onstop(this),\n            phase: options.phase,\n        });\n        this.frequency = this._modulator.frequency;\n        this.detune = this._modulator.detune;\n        // connections\n        this._modulator.chain(this._scale, this._pulse.width);\n        this._pulse.connect(this.output);\n        readOnly(this, [\"modulationFrequency\", \"frequency\", \"detune\"]);\n    }\n    static getDefaults() {\n        return Object.assign(Source.getDefaults(), {\n            detune: 0,\n            frequency: 440,\n            modulationFrequency: 0.4,\n            phase: 0,\n            type: \"pwm\",\n        });\n    }\n    /**\n     * start the oscillator\n     */\n    _start(time) {\n        time = this.toSeconds(time);\n        this._modulator.start(time);\n        this._pulse.start(time);\n    }\n    /**\n     * stop the oscillator\n     */\n    _stop(time) {\n        time = this.toSeconds(time);\n        this._modulator.stop(time);\n        this._pulse.stop(time);\n    }\n    /**\n     * restart the oscillator\n     */\n    _restart(time) {\n        this._modulator.restart(time);\n        this._pulse.restart(time);\n    }\n    /**\n     * The type of the oscillator. Always returns \"pwm\".\n     */\n    get type() {\n        return \"pwm\";\n    }\n    /**\n     * The baseType of the oscillator. Always returns \"pwm\".\n     */\n    get baseType() {\n        return \"pwm\";\n    }\n    /**\n     * The partials of the waveform. Cannot set partials for this waveform type\n     */\n    get partials() {\n        return [];\n    }\n    /**\n     * No partials for this waveform type.\n     */\n    get partialCount() {\n        return 0;\n    }\n    /**\n     * The phase of the oscillator in degrees.\n     */\n    get phase() {\n        return this._modulator.phase;\n    }\n    set phase(phase) {\n        this._modulator.phase = phase;\n    }\n    asArray() {\n        return __awaiter(this, arguments, void 0, function* (length = 1024) {\n            return generateWaveform(this, length);\n        });\n    }\n    /**\n     * Clean up.\n     */\n    dispose() {\n        super.dispose();\n        this._pulse.dispose();\n        this._scale.dispose();\n        this._modulator.dispose();\n        return this;\n    }\n}\n//# sourceMappingURL=PWMOscillator.js.map","import { __awaiter } from \"tslib\";\nimport { optionsFromArguments } from \"../../core/util/Defaults.js\";\nimport { readOnly } from \"../../core/util/Interface.js\";\nimport { isNumber, isString } from \"../../core/util/TypeCheck.js\";\nimport { Signal } from \"../../signal/Signal.js\";\nimport { Source } from \"../Source.js\";\nimport { AMOscillator } from \"./AMOscillator.js\";\nimport { FatOscillator } from \"./FatOscillator.js\";\nimport { FMOscillator } from \"./FMOscillator.js\";\nimport { Oscillator } from \"./Oscillator.js\";\nimport { generateWaveform, } from \"./OscillatorInterface.js\";\nimport { PulseOscillator } from \"./PulseOscillator.js\";\nimport { PWMOscillator } from \"./PWMOscillator.js\";\nconst OmniOscillatorSourceMap = {\n    am: AMOscillator,\n    fat: FatOscillator,\n    fm: FMOscillator,\n    oscillator: Oscillator,\n    pulse: PulseOscillator,\n    pwm: PWMOscillator,\n};\n/**\n * OmniOscillator aggregates all of the oscillator types into one.\n * @example\n * return Tone.Offline(() => {\n * \tconst omniOsc = new Tone.OmniOscillator(\"C#4\", \"pwm\").toDestination().start();\n * }, 0.1, 1);\n * @category Source\n */\nexport class OmniOscillator extends Source {\n    constructor() {\n        const options = optionsFromArguments(OmniOscillator.getDefaults(), arguments, [\"frequency\", \"type\"]);\n        super(options);\n        this.name = \"OmniOscillator\";\n        this.frequency = new Signal({\n            context: this.context,\n            units: \"frequency\",\n            value: options.frequency,\n        });\n        this.detune = new Signal({\n            context: this.context,\n            units: \"cents\",\n            value: options.detune,\n        });\n        readOnly(this, [\"frequency\", \"detune\"]);\n        // set the options\n        this.set(options);\n    }\n    static getDefaults() {\n        return Object.assign(Oscillator.getDefaults(), FMOscillator.getDefaults(), AMOscillator.getDefaults(), FatOscillator.getDefaults(), PulseOscillator.getDefaults(), PWMOscillator.getDefaults());\n    }\n    /**\n     * start the oscillator\n     */\n    _start(time) {\n        this._oscillator.start(time);\n    }\n    /**\n     * start the oscillator\n     */\n    _stop(time) {\n        this._oscillator.stop(time);\n    }\n    _restart(time) {\n        this._oscillator.restart(time);\n        return this;\n    }\n    /**\n     * The type of the oscillator. Can be any of the basic types: sine, square, triangle, sawtooth. Or\n     * prefix the basic types with \"fm\", \"am\", or \"fat\" to use the FMOscillator, AMOscillator or FatOscillator\n     * types. The oscillator could also be set to \"pwm\" or \"pulse\". All of the parameters of the\n     * oscillator's class are accessible when the oscillator is set to that type, but throws an error\n     * when it's not.\n     * @example\n     * const omniOsc = new Tone.OmniOscillator().toDestination().start();\n     * omniOsc.type = \"pwm\";\n     * // modulationFrequency is parameter which is available\n     * // only when the type is \"pwm\".\n     * omniOsc.modulationFrequency.value = 0.5;\n     */\n    get type() {\n        let prefix = \"\";\n        if ([\"am\", \"fm\", \"fat\"].some((p) => this._sourceType === p)) {\n            prefix = this._sourceType;\n        }\n        return (prefix + this._oscillator.type);\n    }\n    set type(type) {\n        if (type.substr(0, 2) === \"fm\") {\n            this._createNewOscillator(\"fm\");\n            this._oscillator = this._oscillator;\n            this._oscillator.type = type.substr(2);\n        }\n        else if (type.substr(0, 2) === \"am\") {\n            this._createNewOscillator(\"am\");\n            this._oscillator = this._oscillator;\n            this._oscillator.type = type.substr(2);\n        }\n        else if (type.substr(0, 3) === \"fat\") {\n            this._createNewOscillator(\"fat\");\n            this._oscillator = this._oscillator;\n            this._oscillator.type = type.substr(3);\n        }\n        else if (type === \"pwm\") {\n            this._createNewOscillator(\"pwm\");\n            this._oscillator = this._oscillator;\n        }\n        else if (type === \"pulse\") {\n            this._createNewOscillator(\"pulse\");\n        }\n        else {\n            this._createNewOscillator(\"oscillator\");\n            this._oscillator = this._oscillator;\n            this._oscillator.type = type;\n        }\n    }\n    /**\n     * The value is an empty array when the type is not \"custom\".\n     * This is not available on \"pwm\" and \"pulse\" oscillator types.\n     * @see {@link Oscillator.partials}\n     */\n    get partials() {\n        return this._oscillator.partials;\n    }\n    set partials(partials) {\n        if (!this._getOscType(this._oscillator, \"pulse\") &&\n            !this._getOscType(this._oscillator, \"pwm\")) {\n            this._oscillator.partials = partials;\n        }\n    }\n    get partialCount() {\n        return this._oscillator.partialCount;\n    }\n    set partialCount(partialCount) {\n        if (!this._getOscType(this._oscillator, \"pulse\") &&\n            !this._getOscType(this._oscillator, \"pwm\")) {\n            this._oscillator.partialCount = partialCount;\n        }\n    }\n    set(props) {\n        // make sure the type is set first\n        if (Reflect.has(props, \"type\") && props.type) {\n            this.type = props.type;\n        }\n        // then set the rest\n        super.set(props);\n        return this;\n    }\n    /**\n     * connect the oscillator to the frequency and detune signals\n     */\n    _createNewOscillator(oscType) {\n        if (oscType !== this._sourceType) {\n            this._sourceType = oscType;\n            const OscConstructor = OmniOscillatorSourceMap[oscType];\n            // short delay to avoid clicks on the change\n            const now = this.now();\n            if (this._oscillator) {\n                const oldOsc = this._oscillator;\n                oldOsc.stop(now);\n                // dispose the old one\n                this.context.setTimeout(() => oldOsc.dispose(), this.blockTime);\n            }\n            this._oscillator = new OscConstructor({\n                context: this.context,\n            });\n            this.frequency.connect(this._oscillator.frequency);\n            this.detune.connect(this._oscillator.detune);\n            this._oscillator.connect(this.output);\n            this._oscillator.onstop = () => this.onstop(this);\n            if (this.state === \"started\") {\n                this._oscillator.start(now);\n            }\n        }\n    }\n    get phase() {\n        return this._oscillator.phase;\n    }\n    set phase(phase) {\n        this._oscillator.phase = phase;\n    }\n    /**\n     * The source type of the oscillator.\n     * @example\n     * const omniOsc = new Tone.OmniOscillator(440, \"fmsquare\");\n     * console.log(omniOsc.sourceType); // 'fm'\n     */\n    get sourceType() {\n        return this._sourceType;\n    }\n    set sourceType(sType) {\n        // the basetype defaults to sine\n        let baseType = \"sine\";\n        if (this._oscillator.type !== \"pwm\" &&\n            this._oscillator.type !== \"pulse\") {\n            baseType = this._oscillator.type;\n        }\n        // set the type\n        if (sType === \"fm\") {\n            this.type = (\"fm\" + baseType);\n        }\n        else if (sType === \"am\") {\n            this.type = (\"am\" + baseType);\n        }\n        else if (sType === \"fat\") {\n            this.type = (\"fat\" + baseType);\n        }\n        else if (sType === \"oscillator\") {\n            this.type = baseType;\n        }\n        else if (sType === \"pulse\") {\n            this.type = \"pulse\";\n        }\n        else if (sType === \"pwm\") {\n            this.type = \"pwm\";\n        }\n    }\n    _getOscType(osc, sourceType) {\n        return osc instanceof OmniOscillatorSourceMap[sourceType];\n    }\n    /**\n     * The base type of the oscillator.\n     * @see {@link Oscillator.baseType}\n     * @example\n     * const omniOsc = new Tone.OmniOscillator(440, \"fmsquare4\");\n     * console.log(omniOsc.sourceType, omniOsc.baseType, omniOsc.partialCount);\n     */\n    get baseType() {\n        return this._oscillator.baseType;\n    }\n    set baseType(baseType) {\n        if (!this._getOscType(this._oscillator, \"pulse\") &&\n            !this._getOscType(this._oscillator, \"pwm\") &&\n            baseType !== \"pulse\" &&\n            baseType !== \"pwm\") {\n            this._oscillator.baseType = baseType;\n        }\n    }\n    /**\n     * The width of the oscillator when sourceType === \"pulse\".\n     * @see {@link PWMOscillator}\n     */\n    get width() {\n        if (this._getOscType(this._oscillator, \"pulse\")) {\n            return this._oscillator.width;\n        }\n        else {\n            return undefined;\n        }\n    }\n    /**\n     * The number of detuned oscillators when sourceType === \"fat\".\n     * @see {@link FatOscillator.count}\n     */\n    get count() {\n        if (this._getOscType(this._oscillator, \"fat\")) {\n            return this._oscillator.count;\n        }\n        else {\n            return undefined;\n        }\n    }\n    set count(count) {\n        if (this._getOscType(this._oscillator, \"fat\") && isNumber(count)) {\n            this._oscillator.count = count;\n        }\n    }\n    /**\n     * The detune spread between the oscillators when sourceType === \"fat\".\n     * @see {@link FatOscillator.count}\n     */\n    get spread() {\n        if (this._getOscType(this._oscillator, \"fat\")) {\n            return this._oscillator.spread;\n        }\n        else {\n            return undefined;\n        }\n    }\n    set spread(spread) {\n        if (this._getOscType(this._oscillator, \"fat\") && isNumber(spread)) {\n            this._oscillator.spread = spread;\n        }\n    }\n    /**\n     * The type of the modulator oscillator. Only if the oscillator is set to \"am\" or \"fm\" types.\n     * @see {@link AMOscillator} or {@link FMOscillator}\n     */\n    get modulationType() {\n        if (this._getOscType(this._oscillator, \"fm\") ||\n            this._getOscType(this._oscillator, \"am\")) {\n            return this._oscillator.modulationType;\n        }\n        else {\n            return undefined;\n        }\n    }\n    set modulationType(mType) {\n        if ((this._getOscType(this._oscillator, \"fm\") ||\n            this._getOscType(this._oscillator, \"am\")) &&\n            isString(mType)) {\n            this._oscillator.modulationType = mType;\n        }\n    }\n    /**\n     * The modulation index when the sourceType === \"fm\"\n     * @see {@link FMOscillator}.\n     */\n    get modulationIndex() {\n        if (this._getOscType(this._oscillator, \"fm\")) {\n            return this._oscillator.modulationIndex;\n        }\n        else {\n            return undefined;\n        }\n    }\n    /**\n     * Harmonicity is the frequency ratio between the carrier and the modulator oscillators.\n     * @see {@link AMOscillator} or {@link FMOscillator}\n     */\n    get harmonicity() {\n        if (this._getOscType(this._oscillator, \"fm\") ||\n            this._getOscType(this._oscillator, \"am\")) {\n            return this._oscillator.harmonicity;\n        }\n        else {\n            return undefined;\n        }\n    }\n    /**\n     * The modulationFrequency Signal of the oscillator when sourceType === \"pwm\"\n     * see {@link PWMOscillator}\n     * @min 0.1\n     * @max 5\n     */\n    get modulationFrequency() {\n        if (this._getOscType(this._oscillator, \"pwm\")) {\n            return this._oscillator.modulationFrequency;\n        }\n        else {\n            return undefined;\n        }\n    }\n    asArray() {\n        return __awaiter(this, arguments, void 0, function* (length = 1024) {\n            return generateWaveform(this, length);\n        });\n    }\n    dispose() {\n        super.dispose();\n        this.detune.dispose();\n        this.frequency.dispose();\n        this._oscillator.dispose();\n        return this;\n    }\n}\n//# sourceMappingURL=OmniOscillator.js.map","import { assertRange } from \"./Debug.js\";\n/**\n * Assert that the number is in the given range.\n */\nexport function range(min, max = Infinity) {\n    const valueMap = new WeakMap();\n    return function (target, propertyKey) {\n        Reflect.defineProperty(target, propertyKey, {\n            configurable: true,\n            enumerable: true,\n            get: function () {\n                return valueMap.get(this);\n            },\n            set: function (newValue) {\n                assertRange(newValue, min, max);\n                valueMap.set(this, newValue);\n            },\n        });\n    };\n}\n/**\n * Convert the time to seconds and assert that the time is in between the two\n * values when being set.\n */\nexport function timeRange(min, max = Infinity) {\n    const valueMap = new WeakMap();\n    return function (target, propertyKey) {\n        Reflect.defineProperty(target, propertyKey, {\n            configurable: true,\n            enumerable: true,\n            get: function () {\n                return valueMap.get(this);\n            },\n            set: function (newValue) {\n                assertRange(this.toSeconds(newValue), min, max);\n                valueMap.set(this, newValue);\n            },\n        });\n    };\n}\n//# sourceMappingURL=Decorator.js.map","import { __awaiter, __decorate } from \"tslib\";\nimport { ToneAudioBuffer } from \"../../core/context/ToneAudioBuffer.js\";\nimport { defaultArg, optionsFromArguments } from \"../../core/util/Defaults.js\";\nimport { noOp } from \"../../core/util/Interface.js\";\nimport { isUndef } from \"../../core/util/TypeCheck.js\";\nimport { Source } from \"../Source.js\";\nimport { ToneBufferSource } from \"./ToneBufferSource.js\";\nimport { assertRange } from \"../../core/util/Debug.js\";\nimport { timeRange } from \"../../core/util/Decorator.js\";\n/**\n * Player is an audio file player with start, loop, and stop functions.\n * @example\n * const player = new Tone.Player(\"https://tonejs.github.io/audio/berklee/gong_1.mp3\").toDestination();\n * // play as soon as the buffer is loaded\n * player.autostart = true;\n * @category Source\n */\nexport class Player extends Source {\n    constructor() {\n        const options = optionsFromArguments(Player.getDefaults(), arguments, [\n            \"url\",\n            \"onload\",\n        ]);\n        super(options);\n        this.name = \"Player\";\n        /**\n         * All of the active buffer source nodes\n         */\n        this._activeSources = new Set();\n        this._buffer = new ToneAudioBuffer({\n            onload: this._onload.bind(this, options.onload),\n            onerror: options.onerror,\n            reverse: options.reverse,\n            url: options.url,\n        });\n        this.autostart = options.autostart;\n        this._loop = options.loop;\n        this._loopStart = options.loopStart;\n        this._loopEnd = options.loopEnd;\n        this._playbackRate = options.playbackRate;\n        this.fadeIn = options.fadeIn;\n        this.fadeOut = options.fadeOut;\n    }\n    static getDefaults() {\n        return Object.assign(Source.getDefaults(), {\n            autostart: false,\n            fadeIn: 0,\n            fadeOut: 0,\n            loop: false,\n            loopEnd: 0,\n            loopStart: 0,\n            onload: noOp,\n            onerror: noOp,\n            playbackRate: 1,\n            reverse: false,\n        });\n    }\n    /**\n     * Load the audio file as an audio buffer.\n     * Decodes the audio asynchronously and invokes\n     * the callback once the audio buffer loads.\n     * Note: this does not need to be called if a url\n     * was passed in to the constructor. Only use this\n     * if you want to manually load a new url.\n     * @param url The url of the buffer to load. Filetype support depends on the browser.\n     */\n    load(url) {\n        return __awaiter(this, void 0, void 0, function* () {\n            yield this._buffer.load(url);\n            this._onload();\n            return this;\n        });\n    }\n    /**\n     * Internal callback when the buffer is loaded.\n     */\n    _onload(callback = noOp) {\n        callback();\n        if (this.autostart) {\n            this.start();\n        }\n    }\n    /**\n     * Internal callback when the buffer is done playing.\n     */\n    _onSourceEnd(source) {\n        // invoke the onstop function\n        this.onstop(this);\n        // delete the source from the active sources\n        this._activeSources.delete(source);\n        if (this._activeSources.size === 0 &&\n            !this._synced &&\n            this._state.getValueAtTime(this.now()) === \"started\") {\n            // remove the 'implicitEnd' event and replace with an explicit end\n            this._state.cancel(this.now());\n            this._state.setStateAtTime(\"stopped\", this.now());\n        }\n    }\n    /**\n     * Play the buffer at the given startTime. Optionally add an offset\n     * and/or duration which will play the buffer from a position\n     * within the buffer for the given duration.\n     *\n     * @param  time When the player should start.\n     * @param  offset The offset from the beginning of the sample to start at.\n     * @param  duration How long the sample should play. If no duration is given, it will default to the full length of the sample (minus any offset)\n     */\n    start(time, offset, duration) {\n        super.start(time, offset, duration);\n        return this;\n    }\n    /**\n     * Internal start method\n     */\n    _start(startTime, offset, duration) {\n        // if it's a loop the default offset is the loopStart point\n        if (this._loop) {\n            offset = defaultArg(offset, this._loopStart);\n        }\n        else {\n            // otherwise the default offset is 0\n            offset = defaultArg(offset, 0);\n        }\n        // compute the values in seconds\n        const computedOffset = this.toSeconds(offset);\n        // compute the duration which is either the passed in duration of the buffer.duration - offset\n        const origDuration = duration;\n        duration = defaultArg(duration, Math.max(this._buffer.duration - computedOffset, 0));\n        let computedDuration = this.toSeconds(duration);\n        // scale it by the playback rate\n        computedDuration = computedDuration / this._playbackRate;\n        // get the start time\n        startTime = this.toSeconds(startTime);\n        // make the source\n        const source = new ToneBufferSource({\n            url: this._buffer,\n            context: this.context,\n            fadeIn: this.fadeIn,\n            fadeOut: this.fadeOut,\n            loop: this._loop,\n            loopEnd: this._loopEnd,\n            loopStart: this._loopStart,\n            onended: this._onSourceEnd.bind(this),\n            playbackRate: this._playbackRate,\n        }).connect(this.output);\n        // set the looping properties\n        if (!this._loop && !this._synced) {\n            // cancel the previous stop\n            this._state.cancel(startTime + computedDuration);\n            // if it's not looping, set the state change at the end of the sample\n            this._state.setStateAtTime(\"stopped\", startTime + computedDuration, {\n                implicitEnd: true,\n            });\n        }\n        // add it to the array of active sources\n        this._activeSources.add(source);\n        // start it\n        if (this._loop && isUndef(origDuration)) {\n            source.start(startTime, computedOffset);\n        }\n        else {\n            // subtract the fade out time\n            source.start(startTime, computedOffset, computedDuration - this.toSeconds(this.fadeOut));\n        }\n    }\n    /**\n     * Stop playback.\n     */\n    _stop(time) {\n        const computedTime = this.toSeconds(time);\n        this._activeSources.forEach((source) => source.stop(computedTime));\n    }\n    /**\n     * Stop and then restart the player from the beginning (or offset)\n     * @param  time When the player should start.\n     * @param  offset The offset from the beginning of the sample to start at.\n     * @param  duration How long the sample should play. If no duration is given,\n     * \t\t\t\t\tit will default to the full length of the sample (minus any offset)\n     */\n    restart(time, offset, duration) {\n        super.restart(time, offset, duration);\n        return this;\n    }\n    _restart(time, offset, duration) {\n        var _a;\n        (_a = [...this._activeSources].pop()) === null || _a === void 0 ? void 0 : _a.stop(time); // explicitly stop only the most recently created source, to avoid edge case when > 1 source exists and _stop() erroneously sets all stop times past original end offset\n        this._start(time, offset, duration);\n    }\n    /**\n     * Seek to a specific time in the player's buffer. If the\n     * source is no longer playing at that time, it will stop.\n     * @param offset The time to seek to.\n     * @param when The time for the seek event to occur.\n     * @example\n     * const player = new Tone.Player(\"https://tonejs.github.io/audio/berklee/gurgling_theremin_1.mp3\", () => {\n     * \tplayer.start();\n     * \t// seek to the offset in 1 second from now\n     * \tplayer.seek(0.4, \"+1\");\n     * }).toDestination();\n     */\n    seek(offset, when) {\n        const computedTime = this.toSeconds(when);\n        if (this._state.getValueAtTime(computedTime) === \"started\") {\n            const computedOffset = this.toSeconds(offset);\n            // if it's currently playing, stop it\n            this._stop(computedTime);\n            // restart it at the given time\n            this._start(computedTime, computedOffset);\n        }\n        return this;\n    }\n    /**\n     * Set the loop start and end. Will only loop if loop is set to true.\n     * @param loopStart The loop start time\n     * @param loopEnd The loop end time\n     * @example\n     * const player = new Tone.Player(\"https://tonejs.github.io/audio/berklee/malevoices_aa2_F3.mp3\").toDestination();\n     * // loop between the given points\n     * player.setLoopPoints(0.2, 0.3);\n     * player.loop = true;\n     * player.autostart = true;\n     */\n    setLoopPoints(loopStart, loopEnd) {\n        this.loopStart = loopStart;\n        this.loopEnd = loopEnd;\n        return this;\n    }\n    /**\n     * If loop is true, the loop will start at this position.\n     */\n    get loopStart() {\n        return this._loopStart;\n    }\n    set loopStart(loopStart) {\n        this._loopStart = loopStart;\n        if (this.buffer.loaded) {\n            assertRange(this.toSeconds(loopStart), 0, this.buffer.duration);\n        }\n        // get the current source\n        this._activeSources.forEach((source) => {\n            source.loopStart = loopStart;\n        });\n    }\n    /**\n     * If loop is true, the loop will end at this position.\n     */\n    get loopEnd() {\n        return this._loopEnd;\n    }\n    set loopEnd(loopEnd) {\n        this._loopEnd = loopEnd;\n        if (this.buffer.loaded) {\n            assertRange(this.toSeconds(loopEnd), 0, this.buffer.duration);\n        }\n        // get the current source\n        this._activeSources.forEach((source) => {\n            source.loopEnd = loopEnd;\n        });\n    }\n    /**\n     * The audio buffer belonging to the player.\n     */\n    get buffer() {\n        return this._buffer;\n    }\n    set buffer(buffer) {\n        this._buffer.set(buffer);\n    }\n    /**\n     * If the buffer should loop once it's over.\n     * @example\n     * const player = new Tone.Player(\"https://tonejs.github.io/audio/drum-samples/breakbeat.mp3\").toDestination();\n     * player.loop = true;\n     * player.autostart = true;\n     */\n    get loop() {\n        return this._loop;\n    }\n    set loop(loop) {\n        // if no change, do nothing\n        if (this._loop === loop) {\n            return;\n        }\n        this._loop = loop;\n        // set the loop of all of the sources\n        this._activeSources.forEach((source) => {\n            source.loop = loop;\n        });\n        if (loop) {\n            // remove the next stopEvent\n            const stopEvent = this._state.getNextState(\"stopped\", this.now());\n            if (stopEvent) {\n                this._state.cancel(stopEvent.time);\n            }\n        }\n    }\n    /**\n     * Normal speed is 1. The pitch will change with the playback rate.\n     * @example\n     * const player = new Tone.Player(\"https://tonejs.github.io/audio/berklee/femalevoices_aa2_A5.mp3\").toDestination();\n     * // play at 1/4 speed\n     * player.playbackRate = 0.25;\n     * // play as soon as the buffer is loaded\n     * player.autostart = true;\n     */\n    get playbackRate() {\n        return this._playbackRate;\n    }\n    set playbackRate(rate) {\n        this._playbackRate = rate;\n        const now = this.now();\n        // cancel the stop event since it's at a different time now\n        const stopEvent = this._state.getNextState(\"stopped\", now);\n        if (stopEvent && stopEvent.implicitEnd) {\n            this._state.cancel(stopEvent.time);\n            this._activeSources.forEach((source) => source.cancelStop());\n        }\n        // set all the sources\n        this._activeSources.forEach((source) => {\n            source.playbackRate.setValueAtTime(rate, now);\n        });\n    }\n    /**\n     * If the buffer should be reversed. Note that this sets the underlying {@link ToneAudioBuffer.reverse}, so\n     * if multiple players are pointing at the same ToneAudioBuffer, they will all be reversed.\n     * @example\n     * const player = new Tone.Player(\"https://tonejs.github.io/audio/berklee/chime_1.mp3\").toDestination();\n     * player.autostart = true;\n     * player.reverse = true;\n     */\n    get reverse() {\n        return this._buffer.reverse;\n    }\n    set reverse(rev) {\n        this._buffer.reverse = rev;\n    }\n    /**\n     * If the buffer is loaded\n     */\n    get loaded() {\n        return this._buffer.loaded;\n    }\n    dispose() {\n        super.dispose();\n        // disconnect all of the players\n        this._activeSources.forEach((source) => source.dispose());\n        this._activeSources.clear();\n        this._buffer.dispose();\n        return this;\n    }\n}\n__decorate([\n    timeRange(0)\n], Player.prototype, \"fadeIn\", void 0);\n__decorate([\n    timeRange(0)\n], Player.prototype, \"fadeOut\", void 0);\n//# sourceMappingURL=Player.js.map","import { __awaiter, __decorate } from \"tslib\";\nimport { ToneAudioNode, } from \"../../core/context/ToneAudioNode.js\";\nimport { optionsFromArguments } from \"../../core/util/Defaults.js\";\nimport { isArray, isObject, isString } from \"../../core/util/TypeCheck.js\";\nimport { connectSignal, Signal } from \"../../signal/Signal.js\";\nimport { OfflineContext } from \"../../core/context/OfflineContext.js\";\nimport { assert } from \"../../core/util/Debug.js\";\nimport { range, timeRange } from \"../../core/util/Decorator.js\";\n/**\n * Envelope is an [ADSR](https://en.wikipedia.org/wiki/Synthesizer#ADSR_envelope)\n * envelope generator. Envelope outputs a signal which\n * can be connected to an AudioParam or Tone.Signal.\n * ```\n *           /\\\n *          /  \\\n *         /    \\\n *        /      \\\n *       /        \\___________\n *      /                     \\\n *     /                       \\\n *    /                         \\\n *   /                           \\\n * ```\n * @example\n * return Tone.Offline(() => {\n * \tconst env = new Tone.Envelope({\n * \t\tattack: 0.1,\n * \t\tdecay: 0.2,\n * \t\tsustain: 0.5,\n * \t\trelease: 0.8,\n * \t}).toDestination();\n * \tenv.triggerAttackRelease(0.5);\n * }, 1.5, 1);\n * @category Component\n */\nexport class Envelope extends ToneAudioNode {\n    constructor() {\n        const options = optionsFromArguments(Envelope.getDefaults(), arguments, [\"attack\", \"decay\", \"sustain\", \"release\"]);\n        super(options);\n        this.name = \"Envelope\";\n        /**\n         * the signal which is output.\n         */\n        this._sig = new Signal({\n            context: this.context,\n            value: 0,\n        });\n        /**\n         * The output signal of the envelope\n         */\n        this.output = this._sig;\n        /**\n         * Envelope has no input\n         */\n        this.input = undefined;\n        this.attack = options.attack;\n        this.decay = options.decay;\n        this.sustain = options.sustain;\n        this.release = options.release;\n        this.attackCurve = options.attackCurve;\n        this.releaseCurve = options.releaseCurve;\n        this.decayCurve = options.decayCurve;\n    }\n    static getDefaults() {\n        return Object.assign(ToneAudioNode.getDefaults(), {\n            attack: 0.01,\n            attackCurve: \"linear\",\n            decay: 0.1,\n            decayCurve: \"exponential\",\n            release: 1,\n            releaseCurve: \"exponential\",\n            sustain: 0.5,\n        });\n    }\n    /**\n     * Read the current value of the envelope. Useful for\n     * synchronizing visual output to the envelope.\n     */\n    get value() {\n        return this.getValueAtTime(this.now());\n    }\n    /**\n     * Get the curve\n     * @param  curve\n     * @param  direction  In/Out\n     * @return The curve name\n     */\n    _getCurve(curve, direction) {\n        if (isString(curve)) {\n            return curve;\n        }\n        else {\n            // look up the name in the curves array\n            let curveName;\n            for (curveName in EnvelopeCurves) {\n                if (EnvelopeCurves[curveName][direction] === curve) {\n                    return curveName;\n                }\n            }\n            // return the custom curve\n            return curve;\n        }\n    }\n    /**\n     * Assign a the curve to the given name using the direction\n     * @param  name\n     * @param  direction In/Out\n     * @param  curve\n     */\n    _setCurve(name, direction, curve) {\n        // check if it's a valid type\n        if (isString(curve) && Reflect.has(EnvelopeCurves, curve)) {\n            const curveDef = EnvelopeCurves[curve];\n            if (isObject(curveDef)) {\n                if (name !== \"_decayCurve\") {\n                    this[name] = curveDef[direction];\n                }\n            }\n            else {\n                this[name] = curveDef;\n            }\n        }\n        else if (isArray(curve) && name !== \"_decayCurve\") {\n            this[name] = curve;\n        }\n        else {\n            throw new Error(\"Envelope: invalid curve: \" + curve);\n        }\n    }\n    /**\n     * The shape of the attack.\n     * Can be any of these strings:\n     * * \"linear\"\n     * * \"exponential\"\n     * * \"sine\"\n     * * \"cosine\"\n     * * \"bounce\"\n     * * \"ripple\"\n     * * \"step\"\n     *\n     * Can also be an array which describes the curve. Values\n     * in the array are evenly subdivided and linearly\n     * interpolated over the duration of the attack.\n     * @example\n     * return Tone.Offline(() => {\n     * \tconst env = new Tone.Envelope(0.4).toDestination();\n     * \tenv.attackCurve = \"linear\";\n     * \tenv.triggerAttack();\n     * }, 1, 1);\n     */\n    get attackCurve() {\n        return this._getCurve(this._attackCurve, \"In\");\n    }\n    set attackCurve(curve) {\n        this._setCurve(\"_attackCurve\", \"In\", curve);\n    }\n    /**\n     * The shape of the release. See the attack curve types.\n     * @example\n     * return Tone.Offline(() => {\n     * \tconst env = new Tone.Envelope({\n     * \t\trelease: 0.8\n     * \t}).toDestination();\n     * \tenv.triggerAttack();\n     * \t// release curve could also be defined by an array\n     * \tenv.releaseCurve = [1, 0.3, 0.4, 0.2, 0.7, 0];\n     * \tenv.triggerRelease(0.2);\n     * }, 1, 1);\n     */\n    get releaseCurve() {\n        return this._getCurve(this._releaseCurve, \"Out\");\n    }\n    set releaseCurve(curve) {\n        this._setCurve(\"_releaseCurve\", \"Out\", curve);\n    }\n    /**\n     * The shape of the decay either \"linear\" or \"exponential\"\n     * @example\n     * return Tone.Offline(() => {\n     * \tconst env = new Tone.Envelope({\n     * \t\tsustain: 0.1,\n     * \t\tdecay: 0.5\n     * \t}).toDestination();\n     * \tenv.decayCurve = \"linear\";\n     * \tenv.triggerAttack();\n     * }, 1, 1);\n     */\n    get decayCurve() {\n        return this._getCurve(this._decayCurve, \"Out\");\n    }\n    set decayCurve(curve) {\n        this._setCurve(\"_decayCurve\", \"Out\", curve);\n    }\n    /**\n     * Trigger the attack/decay portion of the ADSR envelope.\n     * @param  time When the attack should start.\n     * @param velocity The velocity of the envelope scales the vales.\n     *                             number between 0-1\n     * @example\n     * const env = new Tone.AmplitudeEnvelope().toDestination();\n     * const osc = new Tone.Oscillator().connect(env).start();\n     * // trigger the attack 0.5 seconds from now with a velocity of 0.2\n     * env.triggerAttack(\"+0.5\", 0.2);\n     */\n    triggerAttack(time, velocity = 1) {\n        this.log(\"triggerAttack\", time, velocity);\n        time = this.toSeconds(time);\n        const originalAttack = this.toSeconds(this.attack);\n        let attack = originalAttack;\n        const decay = this.toSeconds(this.decay);\n        // check if it's not a complete attack\n        const currentValue = this.getValueAtTime(time);\n        if (currentValue > 0) {\n            // subtract the current value from the attack time\n            const attackRate = 1 / attack;\n            const remainingDistance = 1 - currentValue;\n            // the attack is now the remaining time\n            attack = remainingDistance / attackRate;\n        }\n        // attack\n        if (attack < this.sampleTime) {\n            this._sig.cancelScheduledValues(time);\n            // case where the attack time is 0 should set instantly\n            this._sig.setValueAtTime(velocity, time);\n        }\n        else if (this._attackCurve === \"linear\") {\n            this._sig.linearRampTo(velocity, attack, time);\n        }\n        else if (this._attackCurve === \"exponential\") {\n            this._sig.targetRampTo(velocity, attack, time);\n        }\n        else {\n            this._sig.cancelAndHoldAtTime(time);\n            let curve = this._attackCurve;\n            // find the starting position in the curve\n            for (let i = 1; i < curve.length; i++) {\n                // the starting index is between the two values\n                if (curve[i - 1] <= currentValue && currentValue <= curve[i]) {\n                    curve = this._attackCurve.slice(i);\n                    // the first index is the current value\n                    curve[0] = currentValue;\n                    break;\n                }\n            }\n            this._sig.setValueCurveAtTime(curve, time, attack, velocity);\n        }\n        // decay\n        if (decay && this.sustain < 1) {\n            const decayValue = velocity * this.sustain;\n            const decayStart = time + attack;\n            this.log(\"decay\", decayStart);\n            if (this._decayCurve === \"linear\") {\n                this._sig.linearRampToValueAtTime(decayValue, decay + decayStart);\n            }\n            else {\n                this._sig.exponentialApproachValueAtTime(decayValue, decayStart, decay);\n            }\n        }\n        return this;\n    }\n    /**\n     * Triggers the release of the envelope.\n     * @param  time When the release portion of the envelope should start.\n     * @example\n     * const env = new Tone.AmplitudeEnvelope().toDestination();\n     * const osc = new Tone.Oscillator({\n     * \ttype: \"sawtooth\"\n     * }).connect(env).start();\n     * env.triggerAttack();\n     * // trigger the release half a second after the attack\n     * env.triggerRelease(\"+0.5\");\n     */\n    triggerRelease(time) {\n        this.log(\"triggerRelease\", time);\n        time = this.toSeconds(time);\n        const currentValue = this.getValueAtTime(time);\n        if (currentValue > 0) {\n            const release = this.toSeconds(this.release);\n            if (release < this.sampleTime) {\n                this._sig.setValueAtTime(0, time);\n            }\n            else if (this._releaseCurve === \"linear\") {\n                this._sig.linearRampTo(0, release, time);\n            }\n            else if (this._releaseCurve === \"exponential\") {\n                this._sig.targetRampTo(0, release, time);\n            }\n            else {\n                assert(isArray(this._releaseCurve), \"releaseCurve must be either 'linear', 'exponential' or an array\");\n                this._sig.cancelAndHoldAtTime(time);\n                this._sig.setValueCurveAtTime(this._releaseCurve, time, release, currentValue);\n            }\n        }\n        return this;\n    }\n    /**\n     * Get the scheduled value at the given time. This will\n     * return the unconverted (raw) value.\n     * @example\n     * const env = new Tone.Envelope(0.5, 1, 0.4, 2);\n     * env.triggerAttackRelease(2);\n     * setInterval(() => console.log(env.getValueAtTime(Tone.now())), 100);\n     */\n    getValueAtTime(time) {\n        return this._sig.getValueAtTime(time);\n    }\n    /**\n     * triggerAttackRelease is shorthand for triggerAttack, then waiting\n     * some duration, then triggerRelease.\n     * @param duration The duration of the sustain.\n     * @param time When the attack should be triggered.\n     * @param velocity The velocity of the envelope.\n     * @example\n     * const env = new Tone.AmplitudeEnvelope().toDestination();\n     * const osc = new Tone.Oscillator().connect(env).start();\n     * // trigger the release 0.5 seconds after the attack\n     * env.triggerAttackRelease(0.5);\n     */\n    triggerAttackRelease(duration, time, velocity = 1) {\n        time = this.toSeconds(time);\n        this.triggerAttack(time, velocity);\n        this.triggerRelease(time + this.toSeconds(duration));\n        return this;\n    }\n    /**\n     * Cancels all scheduled envelope changes after the given time.\n     */\n    cancel(after) {\n        this._sig.cancelScheduledValues(this.toSeconds(after));\n        return this;\n    }\n    /**\n     * Connect the envelope to a destination node.\n     */\n    connect(destination, outputNumber = 0, inputNumber = 0) {\n        connectSignal(this, destination, outputNumber, inputNumber);\n        return this;\n    }\n    /**\n     * Render the envelope curve to an array of the given length.\n     * Good for visualizing the envelope curve. Rescales the duration of the\n     * envelope to fit the length.\n     */\n    asArray() {\n        return __awaiter(this, arguments, void 0, function* (length = 1024) {\n            const duration = length / this.context.sampleRate;\n            const context = new OfflineContext(1, duration, this.context.sampleRate);\n            // normalize the ADSR for the given duration with 20% sustain time\n            const attackPortion = this.toSeconds(this.attack) + this.toSeconds(this.decay);\n            const envelopeDuration = attackPortion + this.toSeconds(this.release);\n            const sustainTime = envelopeDuration * 0.1;\n            const totalDuration = envelopeDuration + sustainTime;\n            // @ts-ignore\n            const clone = new this.constructor(Object.assign(this.get(), {\n                attack: (duration * this.toSeconds(this.attack)) / totalDuration,\n                decay: (duration * this.toSeconds(this.decay)) / totalDuration,\n                release: (duration * this.toSeconds(this.release)) / totalDuration,\n                context,\n            }));\n            clone._sig.toDestination();\n            clone.triggerAttackRelease((duration * (attackPortion + sustainTime)) / totalDuration, 0);\n            const buffer = yield context.render();\n            return buffer.getChannelData(0);\n        });\n    }\n    dispose() {\n        super.dispose();\n        this._sig.dispose();\n        return this;\n    }\n}\n__decorate([\n    timeRange(0)\n], Envelope.prototype, \"attack\", void 0);\n__decorate([\n    timeRange(0)\n], Envelope.prototype, \"decay\", void 0);\n__decorate([\n    range(0, 1)\n], Envelope.prototype, \"sustain\", void 0);\n__decorate([\n    timeRange(0)\n], Envelope.prototype, \"release\", void 0);\n/**\n * Generate some complex envelope curves.\n */\nconst EnvelopeCurves = (() => {\n    const curveLen = 128;\n    let i;\n    let k;\n    // cosine curve\n    const cosineCurve = [];\n    for (i = 0; i < curveLen; i++) {\n        cosineCurve[i] = Math.sin((i / (curveLen - 1)) * (Math.PI / 2));\n    }\n    // ripple curve\n    const rippleCurve = [];\n    const rippleCurveFreq = 6.4;\n    for (i = 0; i < curveLen - 1; i++) {\n        k = i / (curveLen - 1);\n        const sineWave = Math.sin(k * (Math.PI * 2) * rippleCurveFreq - Math.PI / 2) + 1;\n        rippleCurve[i] = sineWave / 10 + k * 0.83;\n    }\n    rippleCurve[curveLen - 1] = 1;\n    // stairs curve\n    const stairsCurve = [];\n    const steps = 5;\n    for (i = 0; i < curveLen; i++) {\n        stairsCurve[i] = Math.ceil((i / (curveLen - 1)) * steps) / steps;\n    }\n    // in-out easing curve\n    const sineCurve = [];\n    for (i = 0; i < curveLen; i++) {\n        k = i / (curveLen - 1);\n        sineCurve[i] = 0.5 * (1 - Math.cos(Math.PI * k));\n    }\n    // a bounce curve\n    const bounceCurve = [];\n    for (i = 0; i < curveLen; i++) {\n        k = i / (curveLen - 1);\n        const freq = Math.pow(k, 3) * 4 + 0.2;\n        const val = Math.cos(freq * Math.PI * 2 * k);\n        bounceCurve[i] = Math.abs(val * (1 - k));\n    }\n    /**\n     * Invert a value curve to make it work for the release\n     */\n    function invertCurve(curve) {\n        const out = new Array(curve.length);\n        for (let j = 0; j < curve.length; j++) {\n            out[j] = 1 - curve[j];\n        }\n        return out;\n    }\n    /**\n     * reverse the curve\n     */\n    function reverseCurve(curve) {\n        return curve.slice(0).reverse();\n    }\n    /**\n     * attack and release curve arrays\n     */\n    return {\n        bounce: {\n            In: invertCurve(bounceCurve),\n            Out: bounceCurve,\n        },\n        cosine: {\n            In: cosineCurve,\n            Out: reverseCurve(cosineCurve),\n        },\n        exponential: \"exponential\",\n        linear: \"linear\",\n        ripple: {\n            In: rippleCurve,\n            Out: invertCurve(rippleCurve),\n        },\n        sine: {\n            In: sineCurve,\n            Out: invertCurve(sineCurve),\n        },\n        step: {\n            In: stairsCurve,\n            Out: invertCurve(stairsCurve),\n        },\n    };\n})();\n//# sourceMappingURL=Envelope.js.map","import { Volume } from \"../component/channel/Volume.js\";\nimport { ToneAudioNode, } from \"../core/context/ToneAudioNode.js\";\nimport { optionsFromArguments } from \"../core/util/Defaults.js\";\nimport { readOnly } from \"../core/util/Interface.js\";\n/**\n * Base-class for all instruments\n */\nexport class Instrument extends ToneAudioNode {\n    constructor() {\n        const options = optionsFromArguments(Instrument.getDefaults(), arguments);\n        super(options);\n        /**\n         * Keep track of all events scheduled to the transport\n         * when the instrument is 'synced'\n         */\n        this._scheduledEvents = [];\n        /**\n         * If the instrument is currently synced\n         */\n        this._synced = false;\n        this._original_triggerAttack = this.triggerAttack;\n        this._original_triggerRelease = this.triggerRelease;\n        /**\n         * The release which is scheduled to the timeline.\n         */\n        this._syncedRelease = (time) => this._original_triggerRelease(time);\n        this._volume = this.output = new Volume({\n            context: this.context,\n            volume: options.volume,\n        });\n        this.volume = this._volume.volume;\n        readOnly(this, \"volume\");\n    }\n    static getDefaults() {\n        return Object.assign(ToneAudioNode.getDefaults(), {\n            volume: 0,\n        });\n    }\n    /**\n     * Sync the instrument to the Transport. All subsequent calls of\n     * {@link triggerAttack} and {@link triggerRelease} will be scheduled along the transport.\n     * @example\n     * const fmSynth = new Tone.FMSynth().toDestination();\n     * fmSynth.volume.value = -6;\n     * fmSynth.sync();\n     * // schedule 3 notes when the transport first starts\n     * fmSynth.triggerAttackRelease(\"C4\", \"8n\", 0);\n     * fmSynth.triggerAttackRelease(\"E4\", \"8n\", \"8n\");\n     * fmSynth.triggerAttackRelease(\"G4\", \"8n\", \"4n\");\n     * // start the transport to hear the notes\n     * Tone.Transport.start();\n     */\n    sync() {\n        if (this._syncState()) {\n            this._syncMethod(\"triggerAttack\", 1);\n            this._syncMethod(\"triggerRelease\", 0);\n            this.context.transport.on(\"stop\", this._syncedRelease);\n            this.context.transport.on(\"pause\", this._syncedRelease);\n            this.context.transport.on(\"loopEnd\", this._syncedRelease);\n        }\n        return this;\n    }\n    /**\n     * set _sync\n     */\n    _syncState() {\n        let changed = false;\n        if (!this._synced) {\n            this._synced = true;\n            changed = true;\n        }\n        return changed;\n    }\n    /**\n     * Wrap the given method so that it can be synchronized\n     * @param method Which method to wrap and sync\n     * @param  timePosition What position the time argument appears in\n     */\n    _syncMethod(method, timePosition) {\n        const originalMethod = (this[\"_original_\" + method] = this[method]);\n        this[method] = (...args) => {\n            const time = args[timePosition];\n            const id = this.context.transport.schedule((t) => {\n                args[timePosition] = t;\n                originalMethod.apply(this, args);\n            }, time);\n            this._scheduledEvents.push(id);\n        };\n    }\n    /**\n     * Unsync the instrument from the Transport\n     */\n    unsync() {\n        this._scheduledEvents.forEach((id) => this.context.transport.clear(id));\n        this._scheduledEvents = [];\n        if (this._synced) {\n            this._synced = false;\n            this.triggerAttack = this._original_triggerAttack;\n            this.triggerRelease = this._original_triggerRelease;\n            this.context.transport.off(\"stop\", this._syncedRelease);\n            this.context.transport.off(\"pause\", this._syncedRelease);\n            this.context.transport.off(\"loopEnd\", this._syncedRelease);\n        }\n        return this;\n    }\n    /**\n     * Trigger the attack and then the release after the duration.\n     * @param  note     The note to trigger.\n     * @param  duration How long the note should be held for before\n     *                         triggering the release. This value must be greater than 0.\n     * @param time  When the note should be triggered.\n     * @param  velocity The velocity the note should be triggered at.\n     * @example\n     * const synth = new Tone.Synth().toDestination();\n     * // trigger \"C4\" for the duration of an 8th note\n     * synth.triggerAttackRelease(\"C4\", \"8n\");\n     */\n    triggerAttackRelease(note, duration, time, velocity) {\n        const computedTime = this.toSeconds(time);\n        const computedDuration = this.toSeconds(duration);\n        this.triggerAttack(note, computedTime, velocity);\n        this.triggerRelease(computedTime + computedDuration);\n        return this;\n    }\n    /**\n     * clean up\n     * @returns {Instrument} this\n     */\n    dispose() {\n        super.dispose();\n        this._volume.dispose();\n        this.unsync();\n        this._scheduledEvents = [];\n        return this;\n    }\n}\n//# sourceMappingURL=Instrument.js.map","import { __decorate } from \"tslib\";\nimport { FrequencyClass } from \"../core/type/Frequency.js\";\nimport { optionsFromArguments } from \"../core/util/Defaults.js\";\nimport { noOp } from \"../core/util/Interface.js\";\nimport { Instrument } from \"../instrument/Instrument.js\";\nimport { timeRange } from \"../core/util/Decorator.js\";\n/**\n * Abstract base class for other monophonic instruments to extend.\n */\nexport class Monophonic extends Instrument {\n    constructor() {\n        const options = optionsFromArguments(Monophonic.getDefaults(), arguments);\n        super(options);\n        this.portamento = options.portamento;\n        this.onsilence = options.onsilence;\n    }\n    static getDefaults() {\n        return Object.assign(Instrument.getDefaults(), {\n            detune: 0,\n            onsilence: noOp,\n            portamento: 0,\n        });\n    }\n    /**\n     * Trigger the attack of the note optionally with a given velocity.\n     * @param  note The note to trigger.\n     * @param  time When the note should start.\n     * @param  velocity The velocity determines how \"loud\" the note will be.\n     * @example\n     * const synth = new Tone.Synth().toDestination();\n     * // trigger the note a half second from now at half velocity\n     * synth.triggerAttack(\"C4\", \"+0.5\", 0.5);\n     */\n    triggerAttack(note, time, velocity = 1) {\n        this.log(\"triggerAttack\", note, time, velocity);\n        const seconds = this.toSeconds(time);\n        this._triggerEnvelopeAttack(seconds, velocity);\n        this.setNote(note, seconds);\n        return this;\n    }\n    /**\n     * Trigger the release portion of the envelope.\n     * @param  time If no time is given, the release happens immediately.\n     * @example\n     * const synth = new Tone.Synth().toDestination();\n     * synth.triggerAttack(\"C4\");\n     * // trigger the release a second from now\n     * synth.triggerRelease(\"+1\");\n     */\n    triggerRelease(time) {\n        this.log(\"triggerRelease\", time);\n        const seconds = this.toSeconds(time);\n        this._triggerEnvelopeRelease(seconds);\n        return this;\n    }\n    /**\n     * Set the note at the given time. If no time is given, the note\n     * will set immediately.\n     * @param note The note to change to.\n     * @param  time The time when the note should be set.\n     * @example\n     * const synth = new Tone.Synth().toDestination();\n     * synth.triggerAttack(\"C4\");\n     * // change to F#6 in one quarter note from now.\n     * synth.setNote(\"F#6\", \"+4n\");\n     */\n    setNote(note, time) {\n        const computedTime = this.toSeconds(time);\n        const computedFrequency = note instanceof FrequencyClass ? note.toFrequency() : note;\n        if (this.portamento > 0 && this.getLevelAtTime(computedTime) > 0.05) {\n            const portTime = this.toSeconds(this.portamento);\n            this.frequency.exponentialRampTo(computedFrequency, portTime, computedTime);\n        }\n        else {\n            this.frequency.setValueAtTime(computedFrequency, computedTime);\n        }\n        return this;\n    }\n}\n__decorate([\n    timeRange(0)\n], Monophonic.prototype, \"portamento\", void 0);\n//# sourceMappingURL=Monophonic.js.map","import { Gain } from \"../../core/context/Gain.js\";\nimport { optionsFromArguments } from \"../../core/util/Defaults.js\";\nimport { Envelope } from \"./Envelope.js\";\n/**\n * AmplitudeEnvelope is a Tone.Envelope connected to a gain node.\n * Unlike Tone.Envelope, which outputs the envelope's value, AmplitudeEnvelope accepts\n * an audio signal as the input and will apply the envelope to the amplitude\n * of the signal.\n * Read more about ADSR Envelopes on [Wikipedia](https://en.wikipedia.org/wiki/Synthesizer#ADSR_envelope).\n *\n * @example\n * return Tone.Offline(() => {\n * \tconst ampEnv = new Tone.AmplitudeEnvelope({\n * \t\tattack: 0.1,\n * \t\tdecay: 0.2,\n * \t\tsustain: 1.0,\n * \t\trelease: 0.8\n * \t}).toDestination();\n * \t// create an oscillator and connect it\n * \tconst osc = new Tone.Oscillator().connect(ampEnv).start();\n * \t// trigger the envelopes attack and release \"8t\" apart\n * \tampEnv.triggerAttackRelease(\"8t\");\n * }, 1.5, 1);\n * @category Component\n */\nexport class AmplitudeEnvelope extends Envelope {\n    constructor() {\n        super(optionsFromArguments(AmplitudeEnvelope.getDefaults(), arguments, [\n            \"attack\",\n            \"decay\",\n            \"sustain\",\n            \"release\",\n        ]));\n        this.name = \"AmplitudeEnvelope\";\n        this._gainNode = new Gain({\n            context: this.context,\n            gain: 0,\n        });\n        this.output = this._gainNode;\n        this.input = this._gainNode;\n        this._sig.connect(this._gainNode.gain);\n        this.output = this._gainNode;\n        this.input = this._gainNode;\n    }\n    /**\n     * Clean up\n     */\n    dispose() {\n        super.dispose();\n        this._gainNode.dispose();\n        return this;\n    }\n}\n//# sourceMappingURL=AmplitudeEnvelope.js.map","import { AmplitudeEnvelope } from \"../component/envelope/AmplitudeEnvelope.js\";\nimport { Envelope } from \"../component/envelope/Envelope.js\";\nimport { ToneAudioNode, } from \"../core/context/ToneAudioNode.js\";\nimport { omitFromObject, optionsFromArguments } from \"../core/util/Defaults.js\";\nimport { readOnly } from \"../core/util/Interface.js\";\nimport { OmniOscillator } from \"../source/oscillator/OmniOscillator.js\";\nimport { Source } from \"../source/Source.js\";\nimport { Monophonic } from \"./Monophonic.js\";\n/**\n * Synth is composed simply of a {@link OmniOscillator} routed through an {@link AmplitudeEnvelope}.\n * ```\n * +----------------+   +-------------------+\n * | OmniOscillator +>--> AmplitudeEnvelope +>--> Output\n * +----------------+   +-------------------+\n * ```\n * @example\n * const synth = new Tone.Synth().toDestination();\n * synth.triggerAttackRelease(\"C4\", \"8n\");\n * @category Instrument\n */\nexport class Synth extends Monophonic {\n    constructor() {\n        const options = optionsFromArguments(Synth.getDefaults(), arguments);\n        super(options);\n        this.name = \"Synth\";\n        this.oscillator = new OmniOscillator(Object.assign({\n            context: this.context,\n            detune: options.detune,\n            onstop: () => this.onsilence(this),\n        }, options.oscillator));\n        this.frequency = this.oscillator.frequency;\n        this.detune = this.oscillator.detune;\n        this.envelope = new AmplitudeEnvelope(Object.assign({\n            context: this.context,\n        }, options.envelope));\n        // connect the oscillators to the output\n        this.oscillator.chain(this.envelope, this.output);\n        readOnly(this, [\"oscillator\", \"frequency\", \"detune\", \"envelope\"]);\n    }\n    static getDefaults() {\n        return Object.assign(Monophonic.getDefaults(), {\n            envelope: Object.assign(omitFromObject(Envelope.getDefaults(), Object.keys(ToneAudioNode.getDefaults())), {\n                attack: 0.005,\n                decay: 0.1,\n                release: 1,\n                sustain: 0.3,\n            }),\n            oscillator: Object.assign(omitFromObject(OmniOscillator.getDefaults(), [\n                ...Object.keys(Source.getDefaults()),\n                \"frequency\",\n                \"detune\",\n            ]), {\n                type: \"triangle\",\n            }),\n        });\n    }\n    /**\n     * start the attack portion of the envelope\n     * @param time the time the attack should start\n     * @param velocity the velocity of the note (0-1)\n     */\n    _triggerEnvelopeAttack(time, velocity) {\n        // the envelopes\n        this.envelope.triggerAttack(time, velocity);\n        this.oscillator.start(time);\n        // if there is no release portion, stop the oscillator\n        if (this.envelope.sustain === 0) {\n            const computedAttack = this.toSeconds(this.envelope.attack);\n            const computedDecay = this.toSeconds(this.envelope.decay);\n            this.oscillator.stop(time + computedAttack + computedDecay);\n        }\n    }\n    /**\n     * start the release portion of the envelope\n     * @param time the time the release should start\n     */\n    _triggerEnvelopeRelease(time) {\n        this.envelope.triggerRelease(time);\n        this.oscillator.stop(time + this.toSeconds(this.envelope.release));\n    }\n    getLevelAtTime(time) {\n        time = this.toSeconds(time);\n        return this.envelope.getValueAtTime(time);\n    }\n    /**\n     * clean up\n     */\n    dispose() {\n        super.dispose();\n        this.oscillator.dispose();\n        this.envelope.dispose();\n        return this;\n    }\n}\n//# sourceMappingURL=Synth.js.map","import { __decorate } from \"tslib\";\nimport { FrequencyClass } from \"../core/type/Frequency.js\";\nimport { deepMerge, optionsFromArguments } from \"../core/util/Defaults.js\";\nimport { readOnly } from \"../core/util/Interface.js\";\nimport { Monophonic } from \"./Monophonic.js\";\nimport { Synth } from \"./Synth.js\";\nimport { range, timeRange } from \"../core/util/Decorator.js\";\n/**\n * MembraneSynth makes kick and tom sounds using a single oscillator\n * with an amplitude envelope and frequency ramp. A Tone.OmniOscillator\n * is routed through a Tone.AmplitudeEnvelope to the output. The drum\n * quality of the sound comes from the frequency envelope applied\n * during MembraneSynth.triggerAttack(note). The frequency envelope\n * starts at <code>note * .octaves</code> and ramps to <code>note</code>\n * over the duration of <code>.pitchDecay</code>.\n * @example\n * const synth = new Tone.MembraneSynth().toDestination();\n * synth.triggerAttackRelease(\"C2\", \"8n\");\n * @category Instrument\n */\nexport class MembraneSynth extends Synth {\n    constructor() {\n        const options = optionsFromArguments(MembraneSynth.getDefaults(), arguments);\n        super(options);\n        this.name = \"MembraneSynth\";\n        /**\n         * Portamento is ignored in this synth. use pitch decay instead.\n         */\n        this.portamento = 0;\n        this.pitchDecay = options.pitchDecay;\n        this.octaves = options.octaves;\n        readOnly(this, [\"oscillator\", \"envelope\"]);\n    }\n    static getDefaults() {\n        return deepMerge(Monophonic.getDefaults(), Synth.getDefaults(), {\n            envelope: {\n                attack: 0.001,\n                attackCurve: \"exponential\",\n                decay: 0.4,\n                release: 1.4,\n                sustain: 0.01,\n            },\n            octaves: 10,\n            oscillator: {\n                type: \"sine\",\n            },\n            pitchDecay: 0.05,\n        });\n    }\n    setNote(note, time) {\n        const seconds = this.toSeconds(time);\n        const hertz = this.toFrequency(note instanceof FrequencyClass ? note.toFrequency() : note);\n        const maxNote = hertz * this.octaves;\n        this.oscillator.frequency.setValueAtTime(maxNote, seconds);\n        this.oscillator.frequency.exponentialRampToValueAtTime(hertz, seconds + this.toSeconds(this.pitchDecay));\n        return this;\n    }\n    dispose() {\n        super.dispose();\n        return this;\n    }\n}\n__decorate([\n    range(0)\n], MembraneSynth.prototype, \"octaves\", void 0);\n__decorate([\n    timeRange(0)\n], MembraneSynth.prototype, \"pitchDecay\", void 0);\n//# sourceMappingURL=MembraneSynth.js.map","/**\n * All of the classes or functions which are loaded into the AudioWorkletGlobalScope\n */\nconst workletContext = new Set();\n/**\n * Add a class to the AudioWorkletGlobalScope\n */\nexport function addToWorklet(classOrFunction) {\n    workletContext.add(classOrFunction);\n}\n/**\n * Register a processor in the AudioWorkletGlobalScope with the given name\n */\nexport function registerProcessor(name, classDesc) {\n    const processor = /* javascript */ `registerProcessor(\"${name}\", ${classDesc})`;\n    workletContext.add(processor);\n}\n/**\n * Get all of the modules which have been registered to the AudioWorkletGlobalScope\n */\nexport function getWorkletGlobalScope() {\n    return Array.from(workletContext).join(\"\\n\");\n}\n//# sourceMappingURL=WorkletGlobalScope.js.map","import { addToWorklet } from \"./WorkletGlobalScope.js\";\nconst toneAudioWorkletProcessor = /* javascript */ `\n\t/**\n\t * The base AudioWorkletProcessor for use in Tone.js. Works with the {@link ToneAudioWorklet}. \n\t */\n\tclass ToneAudioWorkletProcessor extends AudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\t\n\t\t\tsuper(options);\n\t\t\t/**\n\t\t\t * If the processor was disposed or not. Keep alive until it's disposed.\n\t\t\t */\n\t\t\tthis.disposed = false;\n\t\t   \t/** \n\t\t\t * The number of samples in the processing block\n\t\t\t */\n\t\t\tthis.blockSize = 128;\n\t\t\t/**\n\t\t\t * the sample rate\n\t\t\t */\n\t\t\tthis.sampleRate = sampleRate;\n\n\t\t\tthis.port.onmessage = (event) => {\n\t\t\t\t// when it receives a dispose \n\t\t\t\tif (event.data === \"dispose\") {\n\t\t\t\t\tthis.disposed = true;\n\t\t\t\t}\n\t\t\t};\n\t\t}\n\t}\n`;\naddToWorklet(toneAudioWorkletProcessor);\n//# sourceMappingURL=ToneAudioWorkletProcessor.worklet.js.map","import \"./ToneAudioWorkletProcessor.worklet.js\";\nimport { addToWorklet } from \"./WorkletGlobalScope.js\";\nexport const singleIOProcess = /* javascript */ `\n\t/**\n\t * Abstract class for a single input/output processor. \n\t * has a 'generate' function which processes one sample at a time\n\t */\n\tclass SingleIOProcessor extends ToneAudioWorkletProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(Object.assign(options, {\n\t\t\t\tnumberOfInputs: 1,\n\t\t\t\tnumberOfOutputs: 1\n\t\t\t}));\n\t\t\t/**\n\t\t\t * Holds the name of the parameter and a single value of that\n\t\t\t * parameter at the current sample\n\t\t\t * @type { [name: string]: number }\n\t\t\t */\n\t\t\tthis.params = {}\n\t\t}\n\n\t\t/**\n\t\t * Generate an output sample from the input sample and parameters\n\t\t * @abstract\n\t\t * @param input number\n\t\t * @param channel number\n\t\t * @param parameters { [name: string]: number }\n\t\t * @returns number\n\t\t */\n\t\tgenerate(){}\n\n\t\t/**\n\t\t * Update the private params object with the \n\t\t * values of the parameters at the given index\n\t\t * @param parameters { [name: string]: Float32Array },\n\t\t * @param index number\n\t\t */\n\t\tupdateParams(parameters, index) {\n\t\t\tfor (const paramName in parameters) {\n\t\t\t\tconst param = parameters[paramName];\n\t\t\t\tif (param.length > 1) {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][index];\n\t\t\t\t} else {\n\t\t\t\t\tthis.params[paramName] = parameters[paramName][0];\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Process a single frame of the audio\n\t\t * @param inputs Float32Array[][]\n\t\t * @param outputs Float32Array[][]\n\t\t */\n\t\tprocess(inputs, outputs, parameters) {\n\t\t\tconst input = inputs[0];\n\t\t\tconst output = outputs[0];\n\t\t\t// get the parameter values\n\t\t\tconst channelCount = Math.max(input && input.length || 0, output.length);\n\t\t\tfor (let sample = 0; sample < this.blockSize; sample++) {\n\t\t\t\tthis.updateParams(parameters, sample);\n\t\t\t\tfor (let channel = 0; channel < channelCount; channel++) {\n\t\t\t\t\tconst inputSample = input && input.length ? input[channel][sample] : 0;\n\t\t\t\t\toutput[channel][sample] = this.generate(inputSample, channel, this.params);\n\t\t\t\t}\n\t\t\t}\n\t\t\treturn !this.disposed;\n\t\t}\n\t};\n`;\naddToWorklet(singleIOProcess);\n//# sourceMappingURL=SingleIOProcessor.worklet.js.map","import { addToWorklet } from \"./WorkletGlobalScope.js\";\nconst delayLine = /* javascript */ `\n\t/**\n\t * A multichannel buffer for use within an AudioWorkletProcessor as a delay line\n\t */\n\tclass DelayLine {\n\t\t\n\t\tconstructor(size, channels) {\n\t\t\tthis.buffer = [];\n\t\t\tthis.writeHead = []\n\t\t\tthis.size = size;\n\n\t\t\t// create the empty channels\n\t\t\tfor (let i = 0; i < channels; i++) {\n\t\t\t\tthis.buffer[i] = new Float32Array(this.size);\n\t\t\t\tthis.writeHead[i] = 0;\n\t\t\t}\n\t\t}\n\n\t\t/**\n\t\t * Push a value onto the end\n\t\t * @param channel number\n\t\t * @param value number\n\t\t */\n\t\tpush(channel, value) {\n\t\t\tthis.writeHead[channel] += 1;\n\t\t\tif (this.writeHead[channel] > this.size) {\n\t\t\t\tthis.writeHead[channel] = 0;\n\t\t\t}\n\t\t\tthis.buffer[channel][this.writeHead[channel]] = value;\n\t\t}\n\n\t\t/**\n\t\t * Get the recorded value of the channel given the delay\n\t\t * @param channel number\n\t\t * @param delay number delay samples\n\t\t */\n\t\tget(channel, delay) {\n\t\t\tlet readHead = this.writeHead[channel] - Math.floor(delay);\n\t\t\tif (readHead < 0) {\n\t\t\t\treadHead += this.size;\n\t\t\t}\n\t\t\treturn this.buffer[channel][readHead];\n\t\t}\n\t}\n`;\naddToWorklet(delayLine);\n//# sourceMappingURL=DelayLine.worklet.js.map","import \"../../core/worklet/SingleIOProcessor.worklet.js\";\nimport \"../../core/worklet/DelayLine.worklet.js\";\nimport { registerProcessor } from \"../../core/worklet/WorkletGlobalScope.js\";\nexport const workletName = \"feedback-comb-filter\";\nconst feedbackCombFilter = /* javascript */ `\n\tclass FeedbackCombFilterWorklet extends SingleIOProcessor {\n\n\t\tconstructor(options) {\n\t\t\tsuper(options);\n\t\t\tthis.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);\n\t\t}\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"delayTime\",\n\t\t\t\tdefaultValue: 0.1,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 1,\n\t\t\t\tautomationRate: \"k-rate\"\n\t\t\t}, {\n\t\t\t\tname: \"feedback\",\n\t\t\t\tdefaultValue: 0.5,\n\t\t\t\tminValue: 0,\n\t\t\t\tmaxValue: 0.9999,\n\t\t\t\tautomationRate: \"k-rate\"\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, channel, parameters) {\n\t\t\tconst delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);\n\t\t\tthis.delayLine.push(channel, input + delayedSample * parameters.feedback);\n\t\t\treturn delayedSample;\n\t\t}\n\t}\n`;\nregisterProcessor(workletName, feedbackCombFilter);\n//# sourceMappingURL=FeedbackCombFilter.worklet.js.map","import { MidiClass } from \"../core/type/Midi.js\";\nimport { deepMerge, omitFromObject, optionsFromArguments, } from \"../core/util/Defaults.js\";\nimport { isArray, isNumber } from \"../core/util/TypeCheck.js\";\nimport { Instrument } from \"./Instrument.js\";\nimport { Monophonic } from \"./Monophonic.js\";\nimport { Synth } from \"./Synth.js\";\nimport { assert, warn } from \"../core/util/Debug.js\";\n/**\n * PolySynth handles voice creation and allocation for any\n * instruments passed in as the second parameter. PolySynth is\n * not a synthesizer by itself, it merely manages voices of\n * one of the other types of synths, allowing any of the\n * monophonic synthesizers to be polyphonic.\n *\n * @example\n * const synth = new Tone.PolySynth().toDestination();\n * // set the attributes across all the voices using 'set'\n * synth.set({ detune: -1200 });\n * // play a chord\n * synth.triggerAttackRelease([\"C4\", \"E4\", \"A4\"], 1);\n * @category Instrument\n */\nexport class PolySynth extends Instrument {\n    constructor() {\n        const options = optionsFromArguments(PolySynth.getDefaults(), arguments, [\"voice\", \"options\"]);\n        super(options);\n        this.name = \"PolySynth\";\n        /**\n         * The voices which are not currently in use\n         */\n        this._availableVoices = [];\n        /**\n         * The currently active voices\n         */\n        this._activeVoices = [];\n        /**\n         * All of the allocated voices for this synth.\n         */\n        this._voices = [];\n        /**\n         * The GC timeout. Held so that it could be cancelled when the node is disposed.\n         */\n        this._gcTimeout = -1;\n        /**\n         * A moving average of the number of active voices\n         */\n        this._averageActiveVoices = 0;\n        /**\n         * The release which is scheduled to the timeline.\n         */\n        this._syncedRelease = (time) => this.releaseAll(time);\n        // check against the old API (pre 14.3.0)\n        assert(!isNumber(options.voice), \"DEPRECATED: The polyphony count is no longer the first argument.\");\n        const defaults = options.voice.getDefaults();\n        this.options = Object.assign(defaults, options.options);\n        this.voice = options.voice;\n        this.maxPolyphony = options.maxPolyphony;\n        // create the first voice\n        this._dummyVoice = this._getNextAvailableVoice();\n        // remove it from the voices list\n        const index = this._voices.indexOf(this._dummyVoice);\n        this._voices.splice(index, 1);\n        // kick off the GC interval\n        this._gcTimeout = this.context.setInterval(this._collectGarbage.bind(this), 1);\n    }\n    static getDefaults() {\n        return Object.assign(Instrument.getDefaults(), {\n            maxPolyphony: 32,\n            options: {},\n            voice: Synth,\n        });\n    }\n    /**\n     * The number of active voices.\n     */\n    get activeVoices() {\n        return this._activeVoices.length;\n    }\n    /**\n     * Invoked when the source is done making sound, so that it can be\n     * readded to the pool of available voices\n     */\n    _makeVoiceAvailable(voice) {\n        this._availableVoices.push(voice);\n        // remove the midi note from 'active voices'\n        const activeVoiceIndex = this._activeVoices.findIndex((e) => e.voice === voice);\n        this._activeVoices.splice(activeVoiceIndex, 1);\n    }\n    /**\n     * Get an available voice from the pool of available voices.\n     * If one is not available and the maxPolyphony limit is reached,\n     * steal a voice, otherwise return null.\n     */\n    _getNextAvailableVoice() {\n        // if there are available voices, return the first one\n        if (this._availableVoices.length) {\n            return this._availableVoices.shift();\n        }\n        else if (this._voices.length < this.maxPolyphony) {\n            // otherwise if there is still more maxPolyphony, make a new voice\n            const voice = new this.voice(Object.assign(this.options, {\n                context: this.context,\n                onsilence: this._makeVoiceAvailable.bind(this),\n            }));\n            assert(voice instanceof Monophonic, \"Voice must extend Monophonic class\");\n            voice.connect(this.output);\n            this._voices.push(voice);\n            return voice;\n        }\n        else {\n            warn(\"Max polyphony exceeded. Note dropped.\");\n        }\n    }\n    /**\n     * Occasionally check if there are any allocated voices which can be cleaned up.\n     */\n    _collectGarbage() {\n        this._averageActiveVoices = Math.max(this._averageActiveVoices * 0.95, this.activeVoices);\n        if (this._availableVoices.length &&\n            this._voices.length > Math.ceil(this._averageActiveVoices + 1)) {\n            // take off an available note\n            const firstAvail = this._availableVoices.shift();\n            const index = this._voices.indexOf(firstAvail);\n            this._voices.splice(index, 1);\n            if (!this.context.isOffline) {\n                firstAvail.dispose();\n            }\n        }\n    }\n    /**\n     * Internal method which triggers the attack\n     */\n    _triggerAttack(notes, time, velocity) {\n        notes.forEach((note) => {\n            const midiNote = new MidiClass(this.context, note).toMidi();\n            const voice = this._getNextAvailableVoice();\n            if (voice) {\n                voice.triggerAttack(note, time, velocity);\n                this._activeVoices.push({\n                    midi: midiNote,\n                    voice,\n                    released: false,\n                });\n                this.log(\"triggerAttack\", note, time);\n            }\n        });\n    }\n    /**\n     * Internal method which triggers the release\n     */\n    _triggerRelease(notes, time) {\n        notes.forEach((note) => {\n            const midiNote = new MidiClass(this.context, note).toMidi();\n            const event = this._activeVoices.find(({ midi, released }) => midi === midiNote && !released);\n            if (event) {\n                // trigger release on that note\n                event.voice.triggerRelease(time);\n                // mark it as released\n                event.released = true;\n                this.log(\"triggerRelease\", note, time);\n            }\n        });\n    }\n    /**\n     * Schedule the attack/release events. If the time is in the future, then it should set a timeout\n     * to wait for just-in-time scheduling\n     */\n    _scheduleEvent(type, notes, time, velocity) {\n        assert(!this.disposed, \"Synth was already disposed\");\n        // if the notes are greater than this amount of time in the future, they should be scheduled with setTimeout\n        if (time <= this.now()) {\n            // do it immediately\n            if (type === \"attack\") {\n                this._triggerAttack(notes, time, velocity);\n            }\n            else {\n                this._triggerRelease(notes, time);\n            }\n        }\n        else {\n            // schedule it to start in the future\n            this.context.setTimeout(() => {\n                if (!this.disposed) {\n                    this._scheduleEvent(type, notes, time, velocity);\n                }\n            }, time - this.now());\n        }\n    }\n    /**\n     * Trigger the attack portion of the note\n     * @param  notes The notes to play. Accepts a single Frequency or an array of frequencies.\n     * @param  time  The start time of the note.\n     * @param velocity The velocity of the note.\n     * @example\n     * const synth = new Tone.PolySynth(Tone.FMSynth).toDestination();\n     * // trigger a chord immediately with a velocity of 0.2\n     * synth.triggerAttack([\"Ab3\", \"C4\", \"F5\"], Tone.now(), 0.2);\n     */\n    triggerAttack(notes, time, velocity) {\n        if (!Array.isArray(notes)) {\n            notes = [notes];\n        }\n        const computedTime = this.toSeconds(time);\n        this._scheduleEvent(\"attack\", notes, computedTime, velocity);\n        return this;\n    }\n    /**\n     * Trigger the release of the note. Unlike monophonic instruments,\n     * a note (or array of notes) needs to be passed in as the first argument.\n     * @param  notes The notes to play. Accepts a single Frequency or an array of frequencies.\n     * @param  time  When the release will be triggered.\n     * @example\n     * const poly = new Tone.PolySynth(Tone.AMSynth).toDestination();\n     * poly.triggerAttack([\"Ab3\", \"C4\", \"F5\"]);\n     * // trigger the release of the given notes.\n     * poly.triggerRelease([\"Ab3\", \"C4\"], \"+1\");\n     * poly.triggerRelease(\"F5\", \"+3\");\n     */\n    triggerRelease(notes, time) {\n        if (!Array.isArray(notes)) {\n            notes = [notes];\n        }\n        const computedTime = this.toSeconds(time);\n        this._scheduleEvent(\"release\", notes, computedTime);\n        return this;\n    }\n    /**\n     * Trigger the attack and release after the specified duration\n     * @param  notes The notes to play. Accepts a single  Frequency or an array of frequencies.\n     * @param  duration the duration of the note\n     * @param  time  if no time is given, defaults to now\n     * @param  velocity the velocity of the attack (0-1)\n     * @example\n     * const poly = new Tone.PolySynth(Tone.AMSynth).toDestination();\n     * // can pass in an array of durations as well\n     * poly.triggerAttackRelease([\"Eb3\", \"G4\", \"Bb4\", \"D5\"], [4, 3, 2, 1]);\n     */\n    triggerAttackRelease(notes, duration, time, velocity) {\n        const computedTime = this.toSeconds(time);\n        this.triggerAttack(notes, computedTime, velocity);\n        if (isArray(duration)) {\n            assert(isArray(notes), \"If the duration is an array, the notes must also be an array\");\n            notes = notes;\n            for (let i = 0; i < notes.length; i++) {\n                const d = duration[Math.min(i, duration.length - 1)];\n                const durationSeconds = this.toSeconds(d);\n                assert(durationSeconds > 0, \"The duration must be greater than 0\");\n                this.triggerRelease(notes[i], computedTime + durationSeconds);\n            }\n        }\n        else {\n            const durationSeconds = this.toSeconds(duration);\n            assert(durationSeconds > 0, \"The duration must be greater than 0\");\n            this.triggerRelease(notes, computedTime + durationSeconds);\n        }\n        return this;\n    }\n    sync() {\n        if (this._syncState()) {\n            this._syncMethod(\"triggerAttack\", 1);\n            this._syncMethod(\"triggerRelease\", 1);\n            // make sure that the sound doesn't play after its been stopped\n            this.context.transport.on(\"stop\", this._syncedRelease);\n            this.context.transport.on(\"pause\", this._syncedRelease);\n            this.context.transport.on(\"loopEnd\", this._syncedRelease);\n        }\n        return this;\n    }\n    /**\n     * Set a member/attribute of the voices\n     * @example\n     * const poly = new Tone.PolySynth().toDestination();\n     * // set all of the voices using an options object for the synth type\n     * poly.set({\n     * \tenvelope: {\n     * \t\tattack: 0.25\n     * \t}\n     * });\n     * poly.triggerAttackRelease(\"Bb3\", 0.2);\n     */\n    set(options) {\n        // remove options which are controlled by the PolySynth\n        const sanitizedOptions = omitFromObject(options, [\n            \"onsilence\",\n            \"context\",\n        ]);\n        // store all of the options\n        this.options = deepMerge(this.options, sanitizedOptions);\n        this._voices.forEach((voice) => voice.set(sanitizedOptions));\n        this._dummyVoice.set(sanitizedOptions);\n        return this;\n    }\n    get() {\n        return this._dummyVoice.get();\n    }\n    /**\n     * Trigger the release portion of all the currently active voices immediately.\n     * Useful for silencing the synth.\n     */\n    releaseAll(time) {\n        const computedTime = this.toSeconds(time);\n        this._activeVoices.forEach(({ voice }) => {\n            voice.triggerRelease(computedTime);\n        });\n        return this;\n    }\n    dispose() {\n        super.dispose();\n        this._dummyVoice.dispose();\n        this._voices.forEach((v) => v.dispose());\n        this._activeVoices = [];\n        this._availableVoices = [];\n        this.context.clearInterval(this._gcTimeout);\n        return this;\n    }\n}\n//# sourceMappingURL=PolySynth.js.map","import { __decorate } from \"tslib\";\nimport { ToneAudioBuffers } from \"../core/context/ToneAudioBuffers.js\";\nimport { ftomf, intervalToFrequencyRatio } from \"../core/type/Conversions.js\";\nimport { FrequencyClass } from \"../core/type/Frequency.js\";\nimport { optionsFromArguments } from \"../core/util/Defaults.js\";\nimport { noOp } from \"../core/util/Interface.js\";\nimport { isArray, isNote, isNumber } from \"../core/util/TypeCheck.js\";\nimport { Instrument } from \"../instrument/Instrument.js\";\nimport { ToneBufferSource, } from \"../source/buffer/ToneBufferSource.js\";\nimport { timeRange } from \"../core/util/Decorator.js\";\nimport { assert } from \"../core/util/Debug.js\";\n/**\n * Pass in an object which maps the note's pitch or midi value to the url,\n * then you can trigger the attack and release of that note like other instruments.\n * By automatically repitching the samples, it is possible to play pitches which\n * were not explicitly included which can save loading time.\n *\n * For sample or buffer playback where repitching is not necessary,\n * use {@link Player}.\n * @example\n * const sampler = new Tone.Sampler({\n * \turls: {\n * \t\tA1: \"A1.mp3\",\n * \t\tA2: \"A2.mp3\",\n * \t},\n * \tbaseUrl: \"https://tonejs.github.io/audio/casio/\",\n * \tonload: () => {\n * \t\tsampler.triggerAttackRelease([\"C1\", \"E1\", \"G1\", \"B1\"], 0.5);\n * \t}\n * }).toDestination();\n * @category Instrument\n */\nexport class Sampler extends Instrument {\n    constructor() {\n        const options = optionsFromArguments(Sampler.getDefaults(), arguments, [\"urls\", \"onload\", \"baseUrl\"], \"urls\");\n        super(options);\n        this.name = \"Sampler\";\n        /**\n         * The object of all currently playing BufferSources\n         */\n        this._activeSources = new Map();\n        const urlMap = {};\n        Object.keys(options.urls).forEach((note) => {\n            const noteNumber = parseInt(note, 10);\n            assert(isNote(note) || (isNumber(noteNumber) && isFinite(noteNumber)), `url key is neither a note or midi pitch: ${note}`);\n            if (isNote(note)) {\n                // convert the note name to MIDI\n                const mid = new FrequencyClass(this.context, note).toMidi();\n                urlMap[mid] = options.urls[note];\n            }\n            else if (isNumber(noteNumber) && isFinite(noteNumber)) {\n                // otherwise if it's numbers assume it's midi\n                urlMap[noteNumber] = options.urls[noteNumber];\n            }\n        });\n        this._buffers = new ToneAudioBuffers({\n            urls: urlMap,\n            onload: options.onload,\n            baseUrl: options.baseUrl,\n            onerror: options.onerror,\n        });\n        this.attack = options.attack;\n        this.release = options.release;\n        this.curve = options.curve;\n        // invoke the callback if it's already loaded\n        if (this._buffers.loaded) {\n            // invoke onload deferred\n            Promise.resolve().then(options.onload);\n        }\n    }\n    static getDefaults() {\n        return Object.assign(Instrument.getDefaults(), {\n            attack: 0,\n            baseUrl: \"\",\n            curve: \"exponential\",\n            onload: noOp,\n            onerror: noOp,\n            release: 0.1,\n            urls: {},\n        });\n    }\n    /**\n     * Returns the difference in steps between the given midi note at the closets sample.\n     */\n    _findClosest(midi) {\n        // searches within 8 octaves of the given midi note\n        const MAX_INTERVAL = 96;\n        let interval = 0;\n        while (interval < MAX_INTERVAL) {\n            // check above and below\n            if (this._buffers.has(midi + interval)) {\n                return -interval;\n            }\n            else if (this._buffers.has(midi - interval)) {\n                return interval;\n            }\n            interval++;\n        }\n        throw new Error(`No available buffers for note: ${midi}`);\n    }\n    /**\n     * @param  notes\tThe note to play, or an array of notes.\n     * @param  time     When to play the note\n     * @param  velocity The velocity to play the sample back.\n     */\n    triggerAttack(notes, time, velocity = 1) {\n        this.log(\"triggerAttack\", notes, time, velocity);\n        if (!Array.isArray(notes)) {\n            notes = [notes];\n        }\n        notes.forEach((note) => {\n            const midiFloat = ftomf(new FrequencyClass(this.context, note).toFrequency());\n            const midi = Math.round(midiFloat);\n            const remainder = midiFloat - midi;\n            // find the closest note pitch\n            const difference = this._findClosest(midi);\n            const closestNote = midi - difference;\n            const buffer = this._buffers.get(closestNote);\n            const playbackRate = intervalToFrequencyRatio(difference + remainder);\n            // play that note\n            const source = new ToneBufferSource({\n                url: buffer,\n                context: this.context,\n                curve: this.curve,\n                fadeIn: this.attack,\n                fadeOut: this.release,\n                playbackRate,\n            }).connect(this.output);\n            source.start(time, 0, buffer.duration / playbackRate, velocity);\n            // add it to the active sources\n            if (!isArray(this._activeSources.get(midi))) {\n                this._activeSources.set(midi, []);\n            }\n            this._activeSources.get(midi).push(source);\n            // remove it when it's done\n            source.onended = () => {\n                if (this._activeSources && this._activeSources.has(midi)) {\n                    const sources = this._activeSources.get(midi);\n                    const index = sources.indexOf(source);\n                    if (index !== -1) {\n                        sources.splice(index, 1);\n                    }\n                }\n            };\n        });\n        return this;\n    }\n    /**\n     * @param  notes\tThe note to release, or an array of notes.\n     * @param  time     \tWhen to release the note.\n     */\n    triggerRelease(notes, time) {\n        this.log(\"triggerRelease\", notes, time);\n        if (!Array.isArray(notes)) {\n            notes = [notes];\n        }\n        notes.forEach((note) => {\n            const midi = new FrequencyClass(this.context, note).toMidi();\n            // find the note\n            if (this._activeSources.has(midi) &&\n                this._activeSources.get(midi).length) {\n                const sources = this._activeSources.get(midi);\n                time = this.toSeconds(time);\n                sources.forEach((source) => {\n                    source.stop(time);\n                });\n                this._activeSources.set(midi, []);\n            }\n        });\n        return this;\n    }\n    /**\n     * Release all currently active notes.\n     * @param  time     \tWhen to release the notes.\n     */\n    releaseAll(time) {\n        const computedTime = this.toSeconds(time);\n        this._activeSources.forEach((sources) => {\n            while (sources.length) {\n                const source = sources.shift();\n                source.stop(computedTime);\n            }\n        });\n        return this;\n    }\n    sync() {\n        if (this._syncState()) {\n            this._syncMethod(\"triggerAttack\", 1);\n            this._syncMethod(\"triggerRelease\", 1);\n        }\n        return this;\n    }\n    /**\n     * Invoke the attack phase, then after the duration, invoke the release.\n     * @param  notes\tThe note to play and release, or an array of notes.\n     * @param  duration The time the note should be held\n     * @param  time     When to start the attack\n     * @param  velocity The velocity of the attack\n     */\n    triggerAttackRelease(notes, duration, time, velocity = 1) {\n        const computedTime = this.toSeconds(time);\n        this.triggerAttack(notes, computedTime, velocity);\n        if (isArray(duration)) {\n            assert(isArray(notes), \"notes must be an array when duration is array\");\n            notes.forEach((note, index) => {\n                const d = duration[Math.min(index, duration.length - 1)];\n                this.triggerRelease(note, computedTime + this.toSeconds(d));\n            });\n        }\n        else {\n            this.triggerRelease(notes, computedTime + this.toSeconds(duration));\n        }\n        return this;\n    }\n    /**\n     * Add a note to the sampler.\n     * @param  note      The buffer's pitch.\n     * @param  url  Either the url of the buffer, or a buffer which will be added with the given name.\n     * @param  callback  The callback to invoke when the url is loaded.\n     */\n    add(note, url, callback) {\n        assert(isNote(note) || isFinite(note), `note must be a pitch or midi: ${note}`);\n        if (isNote(note)) {\n            // convert the note name to MIDI\n            const mid = new FrequencyClass(this.context, note).toMidi();\n            this._buffers.add(mid, url, callback);\n        }\n        else {\n            // otherwise if it's numbers assume it's midi\n            this._buffers.add(note, url, callback);\n        }\n        return this;\n    }\n    /**\n     * If the buffers are loaded or not\n     */\n    get loaded() {\n        return this._buffers.loaded;\n    }\n    /**\n     * Clean up\n     */\n    dispose() {\n        super.dispose();\n        this._buffers.dispose();\n        this._activeSources.forEach((sources) => {\n            sources.forEach((source) => source.dispose());\n        });\n        this._activeSources.clear();\n        return this;\n    }\n}\n__decorate([\n    timeRange(0)\n], Sampler.prototype, \"attack\", void 0);\n__decorate([\n    timeRange(0)\n], Sampler.prototype, \"release\", void 0);\n//# sourceMappingURL=Sampler.js.map","import { Param } from \"../../core/context/Param.js\";\nimport { ToneAudioNode, } from \"../../core/context/ToneAudioNode.js\";\nimport { optionsFromArguments } from \"../../core/util/Defaults.js\";\nimport { readOnly } from \"../../core/util/Interface.js\";\n/**\n * Panner is an equal power Left/Right Panner. It is a wrapper around the StereoPannerNode.\n * @example\n * return Tone.Offline(() => {\n * // move the input signal from right to left\n * \tconst panner = new Tone.Panner(1).toDestination();\n * \tpanner.pan.rampTo(-1, 0.5);\n * \tconst osc = new Tone.Oscillator(100).connect(panner).start();\n * }, 0.5, 2);\n * @category Component\n */\nexport class Panner extends ToneAudioNode {\n    constructor() {\n        const options = optionsFromArguments(Panner.getDefaults(), arguments, [\n            \"pan\",\n        ]);\n        super(options);\n        this.name = \"Panner\";\n        /**\n         * the panner node\n         */\n        this._panner = this.context.createStereoPanner();\n        this.input = this._panner;\n        this.output = this._panner;\n        this.pan = new Param({\n            context: this.context,\n            param: this._panner.pan,\n            value: options.pan,\n            minValue: -1,\n            maxValue: 1,\n        });\n        // this is necessary for standardized-audio-context\n        // doesn't make any difference for the native AudioContext\n        // https://github.com/chrisguttandin/standardized-audio-context/issues/647\n        this._panner.channelCount = options.channelCount;\n        this._panner.channelCountMode = \"explicit\";\n        // initial value\n        readOnly(this, \"pan\");\n    }\n    static getDefaults() {\n        return Object.assign(ToneAudioNode.getDefaults(), {\n            pan: 0,\n            channelCount: 1,\n        });\n    }\n    dispose() {\n        super.dispose();\n        this._panner.disconnect();\n        this.pan.dispose();\n        return this;\n    }\n}\n//# sourceMappingURL=Panner.js.map","import \"../core/worklet/SingleIOProcessor.worklet.js\";\nimport { registerProcessor } from \"../core/worklet/WorkletGlobalScope.js\";\nexport const workletName = \"bit-crusher\";\nexport const bitCrusherWorklet = /* javascript */ `\n\tclass BitCrusherWorklet extends SingleIOProcessor {\n\n\t\tstatic get parameterDescriptors() {\n\t\t\treturn [{\n\t\t\t\tname: \"bits\",\n\t\t\t\tdefaultValue: 12,\n\t\t\t\tminValue: 1,\n\t\t\t\tmaxValue: 16,\n\t\t\t\tautomationRate: 'k-rate'\n\t\t\t}];\n\t\t}\n\n\t\tgenerate(input, _channel, parameters) {\n\t\t\tconst step = Math.pow(0.5, parameters.bits - 1);\n\t\t\tconst val = step * Math.floor(input / step + 0.5);\n\t\t\treturn val;\n\t\t}\n\t}\n`;\nregisterProcessor(workletName, bitCrusherWorklet);\n//# sourceMappingURL=BitCrusher.worklet.js.map","import { Gain } from \"../../core/context/Gain.js\";\nimport { ToneAudioNode, } from \"../../core/context/ToneAudioNode.js\";\nimport { optionsFromArguments } from \"../../core/util/Defaults.js\";\n/**\n * Solo lets you isolate a specific audio stream. When an instance is set to `solo=true`,\n * it will mute all other instances of Solo.\n * @example\n * const soloA = new Tone.Solo().toDestination();\n * const oscA = new Tone.Oscillator(\"C4\", \"sawtooth\").connect(soloA);\n * const soloB = new Tone.Solo().toDestination();\n * const oscB = new Tone.Oscillator(\"E4\", \"square\").connect(soloB);\n * soloA.solo = true;\n * // no audio will pass through soloB\n * @category Component\n */\nexport class Solo extends ToneAudioNode {\n    constructor() {\n        const options = optionsFromArguments(Solo.getDefaults(), arguments, [\n            \"solo\",\n        ]);\n        super(options);\n        this.name = \"Solo\";\n        this.input = this.output = new Gain({\n            context: this.context,\n        });\n        if (!Solo._allSolos.has(this.context)) {\n            Solo._allSolos.set(this.context, new Set());\n        }\n        Solo._allSolos.get(this.context).add(this);\n        // set initially\n        this.solo = options.solo;\n    }\n    static getDefaults() {\n        return Object.assign(ToneAudioNode.getDefaults(), {\n            solo: false,\n        });\n    }\n    /**\n     * Isolates this instance and mutes all other instances of Solo.\n     * Only one instance can be soloed at a time. A soloed\n     * instance will report `solo=false` when another instance is soloed.\n     */\n    get solo() {\n        return this._isSoloed();\n    }\n    set solo(solo) {\n        if (solo) {\n            this._addSolo();\n        }\n        else {\n            this._removeSolo();\n        }\n        Solo._allSolos.get(this.context).forEach((instance) => instance._updateSolo());\n    }\n    /**\n     * If the current instance is muted, i.e. another instance is soloed\n     */\n    get muted() {\n        return this.input.gain.value === 0;\n    }\n    /**\n     * Add this to the soloed array\n     */\n    _addSolo() {\n        if (!Solo._soloed.has(this.context)) {\n            Solo._soloed.set(this.context, new Set());\n        }\n        Solo._soloed.get(this.context).add(this);\n    }\n    /**\n     * Remove this from the soloed array\n     */\n    _removeSolo() {\n        if (Solo._soloed.has(this.context)) {\n            Solo._soloed.get(this.context).delete(this);\n        }\n    }\n    /**\n     * Is this on the soloed array\n     */\n    _isSoloed() {\n        return (Solo._soloed.has(this.context) &&\n            Solo._soloed.get(this.context).has(this));\n    }\n    /**\n     * Returns true if no one is soloed\n     */\n    _noSolos() {\n        // either does not have any soloed added\n        return (!Solo._soloed.has(this.context) ||\n            // or has a solo set but doesn't include any items\n            (Solo._soloed.has(this.context) &&\n                Solo._soloed.get(this.context).size === 0));\n    }\n    /**\n     * Solo the current instance and unsolo all other instances.\n     */\n    _updateSolo() {\n        if (this._isSoloed()) {\n            this.input.gain.value = 1;\n        }\n        else if (this._noSolos()) {\n            // no one is soloed\n            this.input.gain.value = 1;\n        }\n        else {\n            this.input.gain.value = 0;\n        }\n    }\n    dispose() {\n        super.dispose();\n        Solo._allSolos.get(this.context).delete(this);\n        this._removeSolo();\n        return this;\n    }\n}\n/**\n * Hold all of the solo'ed tracks belonging to a specific context\n */\nSolo._allSolos = new Map();\n/**\n * Hold the currently solo'ed instance(s)\n */\nSolo._soloed = new Map();\n//# sourceMappingURL=Solo.js.map","import { readOnly } from \"../../core/util/Interface.js\";\nimport { ToneAudioNode, } from \"../../core/context/ToneAudioNode.js\";\nimport { optionsFromArguments } from \"../../core/util/Defaults.js\";\nimport { Panner } from \"./Panner.js\";\nimport { Volume } from \"./Volume.js\";\n/**\n * PanVol is a Tone.Panner and Tone.Volume in one.\n * @example\n * // pan the incoming signal left and drop the volume\n * const panVol = new Tone.PanVol(-0.25, -12).toDestination();\n * const osc = new Tone.Oscillator().connect(panVol).start();\n * @category Component\n */\nexport class PanVol extends ToneAudioNode {\n    constructor() {\n        const options = optionsFromArguments(PanVol.getDefaults(), arguments, [\n            \"pan\",\n            \"volume\",\n        ]);\n        super(options);\n        this.name = \"PanVol\";\n        this._panner = this.input = new Panner({\n            context: this.context,\n            pan: options.pan,\n            channelCount: options.channelCount,\n        });\n        this.pan = this._panner.pan;\n        this._volume = this.output = new Volume({\n            context: this.context,\n            volume: options.volume,\n        });\n        this.volume = this._volume.volume;\n        // connections\n        this._panner.connect(this._volume);\n        this.mute = options.mute;\n        readOnly(this, [\"pan\", \"volume\"]);\n    }\n    static getDefaults() {\n        return Object.assign(ToneAudioNode.getDefaults(), {\n            mute: false,\n            pan: 0,\n            volume: 0,\n            channelCount: 1,\n        });\n    }\n    /**\n     * Mute/unmute the volume\n     */\n    get mute() {\n        return this._volume.mute;\n    }\n    set mute(mute) {\n        this._volume.mute = mute;\n    }\n    dispose() {\n        super.dispose();\n        this._panner.dispose();\n        this.pan.dispose();\n        this._volume.dispose();\n        this.volume.dispose();\n        return this;\n    }\n}\n//# sourceMappingURL=PanVol.js.map","import { ToneAudioNode, } from \"../../core/context/ToneAudioNode.js\";\nimport { optionsFromArguments } from \"../../core/util/Defaults.js\";\nimport { Solo } from \"./Solo.js\";\nimport { PanVol } from \"./PanVol.js\";\nimport { readOnly } from \"../../core/util/Interface.js\";\nimport { Gain } from \"../../core/context/Gain.js\";\n/**\n * Channel provides a channel strip interface with volume, pan, solo and mute controls.\n * @see {@link PanVol} and {@link Solo}\n * @example\n * // pan the incoming signal left and drop the volume 12db\n * const channel = new Tone.Channel(-0.25, -12);\n * @category Component\n */\nexport class Channel extends ToneAudioNode {\n    constructor() {\n        const options = optionsFromArguments(Channel.getDefaults(), arguments, [\n            \"volume\",\n            \"pan\",\n        ]);\n        super(options);\n        this.name = \"Channel\";\n        this._solo = this.input = new Solo({\n            solo: options.solo,\n            context: this.context,\n        });\n        this._panVol = this.output = new PanVol({\n            context: this.context,\n            pan: options.pan,\n            volume: options.volume,\n            mute: options.mute,\n            channelCount: options.channelCount,\n        });\n        this.pan = this._panVol.pan;\n        this.volume = this._panVol.volume;\n        this._solo.connect(this._panVol);\n        readOnly(this, [\"pan\", \"volume\"]);\n    }\n    static getDefaults() {\n        return Object.assign(ToneAudioNode.getDefaults(), {\n            pan: 0,\n            volume: 0,\n            mute: false,\n            solo: false,\n            channelCount: 1,\n        });\n    }\n    /**\n     * Solo/unsolo the channel. Soloing is only relative to other {@link Channel}s and {@link Solo} instances\n     */\n    get solo() {\n        return this._solo.solo;\n    }\n    set solo(solo) {\n        this._solo.solo = solo;\n    }\n    /**\n     * If the current instance is muted, i.e. another instance is soloed,\n     * or the channel is muted\n     */\n    get muted() {\n        return this._solo.muted || this.mute;\n    }\n    /**\n     * Mute/unmute the volume\n     */\n    get mute() {\n        return this._panVol.mute;\n    }\n    set mute(mute) {\n        this._panVol.mute = mute;\n    }\n    /**\n     * Get the gain node belonging to the bus name. Create it if\n     * it doesn't exist\n     * @param name The bus name\n     */\n    _getBus(name) {\n        if (!Channel.buses.has(name)) {\n            Channel.buses.set(name, new Gain({ context: this.context }));\n        }\n        return Channel.buses.get(name);\n    }\n    /**\n     * Send audio to another channel using a string. `send` is a lot like\n     * {@link connect}, except it uses a string instead of an object. This can\n     * be useful in large applications to decouple sections since {@link send}\n     * and {@link receive} can be invoked separately in order to connect an object\n     * @param name The channel name to send the audio\n     * @param volume The amount of the signal to send.\n     * \tDefaults to 0db, i.e. send the entire signal\n     * @returns Returns the gain node of this connection.\n     */\n    send(name, volume = 0) {\n        const bus = this._getBus(name);\n        const sendKnob = new Gain({\n            context: this.context,\n            units: \"decibels\",\n            gain: volume,\n        });\n        this.connect(sendKnob);\n        sendKnob.connect(bus);\n        return sendKnob;\n    }\n    /**\n     * Receive audio from a channel which was connected with {@link send}.\n     * @param name The channel name to receive audio from.\n     */\n    receive(name) {\n        const bus = this._getBus(name);\n        bus.connect(this);\n        return this;\n    }\n    dispose() {\n        super.dispose();\n        this._panVol.dispose();\n        this.pan.dispose();\n        this.volume.dispose();\n        this._solo.dispose();\n        return this;\n    }\n}\n/**\n * Store the send/receive channels by name.\n */\nChannel.buses = new Map();\n//# sourceMappingURL=Channel.js.map","export { getContext, setContext } from \"./core/Global.js\";\nexport * from \"./classes.js\";\nexport * from \"./version.js\";\nimport { getContext } from \"./core/Global.js\";\nimport { ToneAudioBuffer } from \"./core/context/ToneAudioBuffer.js\";\nexport { start } from \"./core/Global.js\";\nexport { supported } from \"./core/context/AudioContext.js\";\n/**\n * The current audio context time of the global {@link BaseContext}.\n * @see {@link Context.now}\n * @category Core\n */\nexport function now() {\n    return getContext().now();\n}\n/**\n * The current audio context time of the global {@link Context} without the {@link Context.lookAhead}\n * @see {@link Context.immediate}\n * @category Core\n */\nexport function immediate() {\n    return getContext().immediate();\n}\n/**\n * The Transport object belonging to the global Tone.js Context.\n * @see {@link TransportClass}\n * @category Core\n * @deprecated Use {@link getTransport} instead\n */\nexport const Transport = getContext().transport;\n/**\n * The Transport object belonging to the global Tone.js Context.\n * @see {@link TransportClass}\n * @category Core\n */\nexport function getTransport() {\n    return getContext().transport;\n}\n/**\n * The Destination (output) belonging to the global Tone.js Context.\n * @see {@link DestinationClass}\n * @category Core\n * @deprecated Use {@link getDestination} instead\n */\nexport const Destination = getContext().destination;\n/**\n * @deprecated Use {@link getDestination} instead\n */\nexport const Master = getContext().destination;\n/**\n * The Destination (output) belonging to the global Tone.js Context.\n * @see {@link DestinationClass}\n * @category Core\n */\nexport function getDestination() {\n    return getContext().destination;\n}\n/**\n * The {@link ListenerClass} belonging to the global Tone.js Context.\n * @category Core\n * @deprecated Use {@link getListener} instead\n */\nexport const Listener = getContext().listener;\n/**\n * The {@link ListenerClass} belonging to the global Tone.js Context.\n * @category Core\n */\nexport function getListener() {\n    return getContext().listener;\n}\n/**\n * Draw is used to synchronize the draw frame with the Transport's callbacks.\n * @see {@link DrawClass}\n * @category Core\n * @deprecated Use {@link getDraw} instead\n */\nexport const Draw = getContext().draw;\n/**\n * Get the singleton attached to the global context.\n * Draw is used to synchronize the draw frame with the Transport's callbacks.\n * @see {@link DrawClass}\n * @category Core\n */\nexport function getDraw() {\n    return getContext().draw;\n}\n/**\n * A reference to the global context\n * @see {@link Context}\n * @deprecated Use {@link getContext} instead\n */\nexport const context = getContext();\n/**\n * Promise which resolves when all of the loading promises are resolved.\n * Alias for static {@link ToneAudioBuffer.loaded} method.\n * @category Core\n */\nexport function loaded() {\n    return ToneAudioBuffer.loaded();\n}\n// this fills in name changes from 13.x to 14.x\nimport { ToneAudioBuffers } from \"./core/context/ToneAudioBuffers.js\";\nimport { ToneBufferSource } from \"./source/buffer/ToneBufferSource.js\";\n/** @deprecated Use {@link ToneAudioBuffer} */\nexport const Buffer = ToneAudioBuffer;\n/** @deprecated Use {@link ToneAudioBuffers} */\nexport const Buffers = ToneAudioBuffers;\n/** @deprecated Use {@link ToneBufferSource} */\nexport const BufferSource = ToneBufferSource;\n//# sourceMappingURL=index.js.map","/**\n * Virtual Keyboard Component\n * Simulates MIDI input for testing sight reading practice\n * Uses Tone.js for audio synthesis\n */\n\nimport { useEffect, useCallback, useState, useRef } from 'react';\nimport * as Tone from 'tone';\nimport { Button } from '@hudak/ui/components/button';\nimport { Card, CardContent, CardHeader, CardTitle } from '@hudak/ui/components/card';\nimport { Badge } from '@hudak/ui/components/badge';\nimport { Piano } from 'lucide-react';\n\ninterface VirtualKeyboardProps {\n  onNotePlay: (midiNote: number, noteName: string) => void;\n  enabled?: boolean;\n  startOctave?: number;\n  octaveCount?: number;\n}\n\nconst NOTE_NAMES = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];\n\n// Keyboard mapping for computer keys to piano keys\nconst KEY_TO_NOTE_OFFSET: Record<string, number> = {\n  // White keys (lower row)\n  'z': 0,  // C\n  'x': 2,  // D\n  'c': 4,  // E\n  'v': 5,  // F\n  'b': 7,  // G\n  'n': 9,  // A\n  'm': 11, // B\n  // Black keys (upper row)\n  's': 1,  // C#\n  'd': 3,  // D#\n  'g': 6,  // F#\n  'h': 8,  // G#\n  'j': 10, // A#\n};\n\nexport function VirtualKeyboard({\n  onNotePlay,\n  enabled = true,\n  startOctave = 4,\n  octaveCount = 2\n}: VirtualKeyboardProps) {\n  const [isAudioReady, setIsAudioReady] = useState(false);\n  const [activeNotes, setActiveNotes] = useState<Set<number>>(new Set());\n\n  // Initialize Tone.js synth with a piano-like sound\n  const synthRef = useRef<Tone.PolySynth | null>(null);\n\n  // Initialize audio context and synth\n  useEffect(() => {\n    const initAudio = async () => {\n      try {\n        // Create a polyphonic synth for multiple simultaneous notes\n        synthRef.current = new Tone.PolySynth(Tone.Synth, {\n          oscillator: {\n            type: 'triangle'\n          },\n          envelope: {\n            attack: 0.005,\n            decay: 0.1,\n            sustain: 0.3,\n            release: 1\n          }\n        }).toDestination();\n\n        setIsAudioReady(true);\n      } catch (error) {\n        console.error('Failed to initialize audio:', error);\n      }\n    };\n\n    void initAudio();\n\n    return () => {\n      // Cleanup synth on unmount\n      if (synthRef.current) {\n        synthRef.current.dispose();\n      }\n    };\n  }, []);\n\n  const getMidiNote = (octave: number, noteOffset: number): number => {\n    // MIDI note number: (octave + 1) * 12 + noteOffset\n    // Middle C (C4) is MIDI 60\n    return (octave + 1) * 12 + noteOffset;\n  };\n\n  const getNoteName = (midiNote: number): string => {\n    const noteIndex = midiNote % 12;\n    const octave = Math.floor(midiNote / 12) - 1;\n    return `${NOTE_NAMES[noteIndex]}${octave}`;\n  };\n\n  const playNote = useCallback(async (midiNote: number) => {\n    if (!enabled || !synthRef.current) return;\n\n    // Start audio context on first user interaction\n    if (Tone.getContext().state !== 'running') {\n      await Tone.start();\n    }\n\n    const noteName = getNoteName(midiNote);\n\n    // Convert MIDI note to frequency and play\n    const frequency = Tone.Frequency(midiNote, 'midi').toFrequency();\n    synthRef.current.triggerAttackRelease(frequency, '8n');\n\n    // Visual feedback\n    setActiveNotes(prev => new Set(prev).add(midiNote));\n    setTimeout(() => {\n      setActiveNotes(prev => {\n        const next = new Set(prev);\n        next.delete(midiNote);\n        return next;\n      });\n    }, 200);\n\n    // Notify parent component\n    onNotePlay(midiNote, noteName);\n  }, [enabled, onNotePlay]);\n\n  // Handle computer keyboard input\n  useEffect(() => {\n    if (!enabled) return;\n\n    const handleKeyDown = (e: KeyboardEvent) => {\n      // Prevent repeat events\n      if (e.repeat) return;\n\n      const key = e.key.toLowerCase();\n      const noteOffset = KEY_TO_NOTE_OFFSET[key];\n\n      if (noteOffset !== undefined) {\n        // Use the middle octave of the displayed range\n        const octave = startOctave + Math.floor(octaveCount / 2);\n        const midiNote = getMidiNote(octave, noteOffset);\n        playNote(midiNote);\n        e.preventDefault();\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [enabled, startOctave, octaveCount, playNote]);\n\n  const isBlackKey = (noteOffset: number): boolean => {\n    return [1, 3, 6, 8, 10].includes(noteOffset);\n  };\n\n  const renderOctave = (octave: number) => {\n    // Define white key notes and their positions\n    const whiteKeyNotes = [\n      { note: 0, name: 'C' },   // C\n      { note: 2, name: 'D' },   // D\n      { note: 4, name: 'E' },   // E\n      { note: 5, name: 'F' },   // F\n      { note: 7, name: 'G' },   // G\n      { note: 9, name: 'A' },   // A\n      { note: 11, name: 'B' }   // B\n    ];\n\n    // Define black key notes and their positions (relative to white keys)\n    const blackKeyNotes = [\n      { note: 1, name: 'C#', position: 0 },   // Between C and D\n      { note: 3, name: 'D#', position: 1 },   // Between D and E\n      { note: 6, name: 'F#', position: 3 },   // Between F and G\n      { note: 8, name: 'G#', position: 4 },   // Between G and A\n      { note: 10, name: 'A#', position: 5 }   // Between A and B\n    ];\n\n    const whiteKeyWidth = 48; // px\n    const blackKeyWidth = 32; // px\n\n    return (\n      <div key={octave} className=\"relative inline-block\">\n        {/* White keys container */}\n        <div className=\"flex\">\n          {whiteKeyNotes.map(({ note, name }) => {\n            const midiNote = getMidiNote(octave, note);\n            const displayName = `${name}${octave}`;\n            const isActive = activeNotes.has(midiNote);\n\n            return (\n              <button\n                key={`${octave}-${note}`}\n                onClick={() => void playNote(midiNote)}\n                disabled={!enabled}\n                className={`h-40 border border-gray-400 flex flex-col items-center justify-end pb-2 disabled:opacity-50 transition-colors ${\n                  isActive\n                    ? 'bg-blue-200'\n                    : 'bg-white hover:bg-gray-50'\n                }`}\n                style={{ width: `${whiteKeyWidth}px` }}\n              >\n                <span className=\"text-xs font-medium text-gray-700\">\n                  {displayName}\n                </span>\n              </button>\n            );\n          })}\n        </div>\n\n        {/* Black keys container - positioned absolutely over white keys */}\n        <div className=\"absolute top-0 left-0 right-0 h-24 pointer-events-none\">\n          {blackKeyNotes.map(({ note, name, position }) => {\n            const midiNote = getMidiNote(octave, note);\n            const displayName = `${name}${octave}`;\n            const isActive = activeNotes.has(midiNote);\n\n            // Position black key between white keys\n            const leftOffset = position * whiteKeyWidth + whiteKeyWidth - (blackKeyWidth / 2);\n\n            return (\n              <button\n                key={`${octave}-${note}`}\n                onClick={() => void playNote(midiNote)}\n                disabled={!enabled}\n                className={`absolute h-24 border border-gray-800 pointer-events-auto disabled:opacity-50 transition-colors ${\n                  isActive\n                    ? 'bg-gray-600'\n                    : 'bg-black hover:bg-gray-800'\n                }`}\n                style={{\n                  width: `${blackKeyWidth}px`,\n                  left: `${leftOffset}px`\n                }}\n              >\n                <span className=\"text-[10px] font-medium text-gray-300 block mt-auto mb-1\">\n                  {displayName}\n                </span>\n              </button>\n            );\n          })}\n        </div>\n      </div>\n    );\n  };\n\n  const octaves = Array.from({ length: octaveCount }, (_, i) => startOctave + i);\n\n  return (\n    <Card className=\"w-full\">\n      <CardHeader className=\"pb-3\">\n        <div className=\"flex items-center justify-between\">\n          <div className=\"flex items-center gap-2\">\n            <Piano className=\"h-5 w-5\" />\n            <CardTitle className=\"text-lg\">Virtual Keyboard</CardTitle>\n          </div>\n          <div className=\"flex gap-2\">\n            <Badge variant={isAudioReady ? \"default\" : \"secondary\"}>\n              {isAudioReady ? \"Audio Ready\" : \"Loading Audio\"}\n            </Badge>\n            <Badge variant={enabled ? \"default\" : \"secondary\"}>\n              {enabled ? \"Active\" : \"Disabled\"}\n            </Badge>\n          </div>\n        </div>\n        <p className=\"text-sm text-muted-foreground mt-2\">\n          Click keys or use computer keyboard: Z-M for white keys, S-D-G-H-J for black keys\n        </p>\n      </CardHeader>\n      <CardContent>\n        <div className=\"flex overflow-x-auto pb-2\">\n          {octaves.map(octave => renderOctave(octave))}\n        </div>\n      </CardContent>\n    </Card>\n  );\n}\n","interface RadialTimerProps {\n  timeLeft: number;\n  maxTime: number;\n}\n\nexport function RadialTimer({ timeLeft, maxTime }: RadialTimerProps) {\n  const percentage = (timeLeft / maxTime) * 100;\n  const radius = 52;\n  const circumference = 2 * Math.PI * radius;\n  const strokeDashoffset = circumference - (percentage / 100) * circumference;\n\n  const isLow = percentage < 30;\n  const isMedium = percentage < 60 && percentage >= 30;\n\n  return (\n    <div className=\"relative\">\n      <svg width=\"130\" height=\"130\" viewBox=\"0 0 130 130\" className=\"transform -rotate-90\">\n        <circle\n          cx=\"65\"\n          cy=\"65\"\n          r={radius}\n          fill=\"none\"\n          stroke=\"currentColor\"\n          strokeWidth=\"10\"\n          className=\"text-muted/30\"\n        />\n        <circle\n          cx=\"65\"\n          cy=\"65\"\n          r={radius}\n          fill=\"none\"\n          stroke=\"currentColor\"\n          strokeWidth=\"10\"\n          strokeDasharray={circumference}\n          strokeDashoffset={strokeDashoffset}\n          strokeLinecap=\"round\"\n          className={`transition-all duration-100 ${\n            isLow ? 'text-red-500' : isMedium ? 'text-amber-500' : 'text-emerald-500'\n          }`}\n        />\n      </svg>\n      <div className=\"absolute inset-0 flex items-center justify-center\">\n        <div className=\"text-center\">\n          <div className={`text-3xl font-bold tabular-nums ${isLow ? 'text-red-500 animate-pulse' : ''}`}>\n            {Math.ceil(timeLeft)}\n          </div>\n          <div className=\"text-xs text-muted-foreground uppercase tracking-wider\">sec</div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","/**\n * Lives Display Component\n * Shows hearts representing remaining lives with animations\n */\n\nimport { motion, AnimatePresence } from 'framer-motion';\nimport { Heart } from 'lucide-react';\n\ninterface LivesDisplayProps {\n  lives: number;\n  maxLives: number;\n  className?: string;\n}\n\nexport function LivesDisplay({ lives, maxLives = 3, className = '' }: LivesDisplayProps) {\n  return (\n    <div className={`flex items-center gap-1 ${className}`}>\n      {[...Array(maxLives)].map((_, index) => {\n        const isAlive = index < lives;\n        const isLastLife = lives === 1 && index === 0;\n\n        return (\n          <motion.div\n            key={index}\n            initial={{ scale: 1 }}\n            animate={{\n              scale: isLastLife ? [1, 1.2, 1] : 1,\n              rotate: isLastLife ? [0, -10, 10, 0] : 0,\n            }}\n            transition={{\n              duration: 0.5,\n              repeat: isLastLife ? Infinity : 0,\n              repeatDelay: 0.5,\n            }}\n          >\n            <AnimatePresence mode=\"wait\">\n              {isAlive ? (\n                <motion.div\n                  key=\"alive\"\n                  initial={{ scale: 1 }}\n                  exit={{ scale: 0, rotate: -90, opacity: 0 }}\n                  transition={{\n                    type: 'spring',\n                    stiffness: 500,\n                    damping: 15,\n                  }}\n                >\n                  <Heart\n                    className={`h-6 w-6 ${\n                      isLastLife\n                        ? 'fill-red-500 text-red-500'\n                        : 'fill-red-400 text-red-400'\n                    }`}\n                  />\n                </motion.div>\n              ) : (\n                <motion.div\n                  key=\"lost\"\n                  initial={{ scale: 0, opacity: 0 }}\n                  animate={{ scale: 1, opacity: 1 }}\n                  transition={{\n                    type: 'spring',\n                    stiffness: 300,\n                    damping: 20,\n                  }}\n                >\n                  <Heart className=\"h-6 w-6 text-gray-300 dark:text-gray-600\" />\n                </motion.div>\n              )}\n            </AnimatePresence>\n          </motion.div>\n        );\n      })}\n      <span className=\"ml-2 text-sm font-medium text-muted-foreground\">\n        {lives}/{maxLives}\n      </span>\n    </div>\n  );\n}\n","import { Trophy, Flame, Target } from 'lucide-react';\nimport type { GameMode } from '../../hooks/use-game-round';\nimport { LivesDisplay } from '../lives-display';\nimport type { GameRoundState } from '../../hooks/use-game-round';\n\ninterface PracticeStats {\n  correct: number;\n  incorrect: number;\n  streak: number;\n}\n\ninterface ScoreHudProps {\n  gameMode: GameMode;\n  roundState: GameRoundState;\n  stats: PracticeStats;\n}\n\nexport function ScoreHud({ gameMode, roundState, stats }: ScoreHudProps) {\n  return (\n    <div className=\"flex items-center justify-between px-4\">\n      <div className=\"flex items-center gap-8\">\n        <div className=\"flex items-center gap-3\">\n          <div className=\"p-2 rounded-full bg-amber-500/20\">\n            <Trophy className=\"h-5 w-5 text-amber-500\" />\n          </div>\n          <div>\n            <div className=\"text-xs text-muted-foreground uppercase tracking-wider\">Score</div>\n            <div className=\"text-2xl font-bold tabular-nums\">\n              {gameMode === 'timed' ? (roundState.currentScore?.finalScore || 0) : stats.correct * 10}\n            </div>\n          </div>\n        </div>\n\n        <div className=\"flex items-center gap-3\">\n          <div className=\"p-2 rounded-full bg-orange-500/20\">\n            <Flame className=\"h-5 w-5 text-orange-500\" />\n          </div>\n          <div>\n            <div className=\"text-xs text-muted-foreground uppercase tracking-wider\">Streak</div>\n            <div className=\"flex items-baseline gap-2\">\n              <span className=\"text-2xl font-bold tabular-nums\">\n                {gameMode === 'timed' ? roundState.streak : stats.streak}\n              </span>\n              {stats.streak >= 3 && (\n                <span className=\"text-xs text-orange-500\"></span>\n              )}\n            </div>\n          </div>\n        </div>\n      </div>\n\n      <div className=\"flex items-center gap-8\">\n        {gameMode === 'timed' && roundState.isActive ? (\n          <>\n            <LivesDisplay lives={roundState.lives} maxLives={roundState.maxLives} />\n            <div className=\"text-center\">\n              <div className=\"text-xs text-muted-foreground uppercase tracking-wider\">Progress</div>\n              <div className=\"text-2xl font-bold text-blue-500\">\n                {roundState.notesCompleted}/{roundState.notesRequired}\n              </div>\n            </div>\n          </>\n        ) : (\n          <>\n            <div className=\"flex items-center gap-3\">\n              <div className=\"p-2 rounded-full bg-emerald-500/20\">\n                <Target className=\"h-5 w-5 text-emerald-500\" />\n              </div>\n              <div>\n                <div className=\"text-xs text-muted-foreground uppercase tracking-wider\">Correct</div>\n                <div className=\"text-2xl font-bold tabular-nums text-emerald-500\">{stats.correct}</div>\n              </div>\n            </div>\n            <div>\n              <div className=\"text-xs text-muted-foreground uppercase tracking-wider\">Incorrect</div>\n              <div className=\"text-2xl font-bold tabular-nums text-red-500\">{stats.incorrect}</div>\n            </div>\n          </>\n        )}\n      </div>\n    </div>\n  );\n}\n","import React, { useState, useRef, useEffect, useMemo } from 'react';\nimport { jsxs, jsx } from 'react/jsx-runtime';\n\n// src/components/pitch-gauge.tsx\nvar mapCentsToPercent = (cents) => {\n  const clampedCents = Math.max(-50, Math.min(50, cents));\n  return (clampedCents + 50) / 100;\n};\nvar smoothValue = (current, target, alpha = 0.3) => {\n  return current + (target - current) * alpha;\n};\nvar FLAT_COLOR = \"#ef4444\";\nvar INTUNE_COLOR = \"#10b981\";\nvar SHARP_COLOR = \"#f59e0b\";\nvar polarToCartesian = (cx, cy, r, angleDeg) => {\n  const rad = angleDeg * Math.PI / 180;\n  return { x: cx + r * Math.cos(rad), y: cy - r * Math.sin(rad) };\n};\nvar describeArcBand = (cx, cy, rOuter, rInner, startAngle, endAngle) => {\n  const outerStart = polarToCartesian(cx, cy, rOuter, startAngle);\n  const outerEnd = polarToCartesian(cx, cy, rOuter, endAngle);\n  const innerStart = polarToCartesian(cx, cy, rInner, endAngle);\n  const innerEnd = polarToCartesian(cx, cy, rInner, startAngle);\n  const largeArc = Math.abs(endAngle - startAngle) > 180 ? 1 : 0;\n  return [\n    `M ${outerStart.x} ${outerStart.y}`,\n    `A ${rOuter} ${rOuter} 0 ${largeArc} 0 ${outerEnd.x} ${outerEnd.y}`,\n    `L ${innerStart.x} ${innerStart.y}`,\n    `A ${rInner} ${rInner} 0 ${largeArc} 1 ${innerEnd.x} ${innerEnd.y}`,\n    \"Z\"\n  ].join(\" \");\n};\nvar GaugeSVG = React.memo(({ percent }) => {\n  const cx = 100, cy = 100, rOuter = 85, rInner = 68;\n  const flatBand = describeArcBand(cx, cy, rOuter, rInner, 121, 179);\n  const inTuneBand = describeArcBand(cx, cy, rOuter, rInner, 61, 119);\n  const sharpBand = describeArcBand(cx, cy, rOuter, rInner, 1, 59);\n  const trackBand = describeArcBand(cx, cy, rOuter + 1, rInner - 1, 0, 180);\n  const needleAngle = 180 - percent * 180;\n  const needleLen = rInner - 4;\n  const needleTip = polarToCartesian(cx, cy, needleLen, needleAngle);\n  const needleBase1 = polarToCartesian(cx, cy, 5, needleAngle + 90);\n  const needleBase2 = polarToCartesian(cx, cy, 5, needleAngle - 90);\n  return /* @__PURE__ */ jsxs(\"svg\", { viewBox: \"0 0 200 115\", className: \"w-full h-full\", children: [\n    /* @__PURE__ */ jsx(\"path\", { d: trackBand, fill: \"var(--gauge-track, #e5e7eb)\", opacity: 0.3 }),\n    /* @__PURE__ */ jsx(\"path\", { d: flatBand, fill: FLAT_COLOR, opacity: 0.75 }),\n    /* @__PURE__ */ jsx(\"path\", { d: inTuneBand, fill: INTUNE_COLOR, opacity: 0.75 }),\n    /* @__PURE__ */ jsx(\"path\", { d: sharpBand, fill: SHARP_COLOR, opacity: 0.75 }),\n    (() => {\n      const inner = polarToCartesian(cx, cy, rInner - 5, 90);\n      const outer = polarToCartesian(cx, cy, rOuter + 5, 90);\n      return /* @__PURE__ */ jsx(\n        \"line\",\n        {\n          x1: inner.x,\n          y1: inner.y,\n          x2: outer.x,\n          y2: outer.y,\n          stroke: \"var(--gauge-tick, #4b5563)\",\n          strokeWidth: 2.5\n        }\n      );\n    })(),\n    [45, 135].map((angle) => {\n      const inner = polarToCartesian(cx, cy, rInner - 3, angle);\n      const outer = polarToCartesian(cx, cy, rOuter + 3, angle);\n      return /* @__PURE__ */ jsx(\n        \"line\",\n        {\n          x1: inner.x,\n          y1: inner.y,\n          x2: outer.x,\n          y2: outer.y,\n          stroke: \"var(--gauge-tick-minor, #6b7280)\",\n          strokeWidth: 1.5\n        },\n        angle\n      );\n    }),\n    /* @__PURE__ */ jsx(\"text\", { x: \"22\", y: cy + 14, fontSize: \"10\", fill: \"var(--gauge-label, #4b5563)\", fontWeight: \"500\", textAnchor: \"middle\", children: \"\\u266D\" }),\n    /* @__PURE__ */ jsx(\"text\", { x: \"178\", y: cy + 14, fontSize: \"10\", fill: \"var(--gauge-label, #4b5563)\", fontWeight: \"500\", textAnchor: \"middle\", children: \"\\u266F\" }),\n    /* @__PURE__ */ jsx(\n      \"polygon\",\n      {\n        points: `${needleTip.x},${needleTip.y} ${needleBase1.x},${needleBase1.y} ${needleBase2.x},${needleBase2.y}`,\n        fill: \"var(--gauge-needle, #374151)\"\n      }\n    ),\n    /* @__PURE__ */ jsx(\"circle\", { cx, cy, r: 6, fill: \"var(--gauge-needle, #374151)\" }),\n    /* @__PURE__ */ jsx(\"circle\", { cx, cy, r: 3, fill: \"var(--gauge-tick-minor, #6b7280)\" })\n  ] });\n});\nvar PitchGaugeComponent = ({\n  note,\n  cents,\n  className = \"\",\n  clarity,\n  inTuneThreshold = 5,\n  smoothingFactor = 0.7,\n  subdueNote = false\n}) => {\n  const [smoothedCents, setSmoothedCents] = useState(cents);\n  const animationFrameRef = useRef(null);\n  useEffect(() => {\n    let isAnimating = true;\n    const updateSmoothedValue = () => {\n      if (!isAnimating) return;\n      setSmoothedCents((prevSmoothed) => {\n        const baseAlpha = 0.05 + (1 - smoothingFactor) * 0.75;\n        const diff = Math.abs(cents - prevSmoothed);\n        const adaptiveFactor = diff > 10 ? 1.5 : diff > 5 ? 1 : 0.6;\n        const alpha = Math.min(1, baseAlpha * adaptiveFactor);\n        const newValue = smoothValue(prevSmoothed, cents, alpha);\n        if (Math.abs(newValue - cents) < 0.5) {\n          return cents;\n        }\n        return newValue;\n      });\n      if (isAnimating) {\n        animationFrameRef.current = requestAnimationFrame(updateSmoothedValue);\n      }\n    };\n    animationFrameRef.current = requestAnimationFrame(updateSmoothedValue);\n    return () => {\n      isAnimating = false;\n      if (animationFrameRef.current !== null) {\n        cancelAnimationFrame(animationFrameRef.current);\n      }\n    };\n  }, [cents, smoothingFactor]);\n  const percent = useMemo(() => mapCentsToPercent(smoothedCents), [smoothedCents]);\n  const displayCents = useMemo(() => Math.round(smoothedCents), [smoothedCents]);\n  const direction = useMemo(\n    () => displayCents < -inTuneThreshold ? \"\\u266D\" : displayCents > inTuneThreshold ? \"\\u266F\" : \"\",\n    [displayCents, inTuneThreshold]\n  );\n  const inTune = Math.abs(displayCents) <= inTuneThreshold;\n  return /* @__PURE__ */ jsxs(\"div\", { className: `flex flex-col items-center ${className}`, children: [\n    /* @__PURE__ */ jsx(\"span\", { className: `font-bold drop-shadow-md transition-all duration-200 mb-1 ${subdueNote ? \"text-2xl opacity-60\" : \"text-4xl\"} ${inTune ? \"text-green-600 dark:text-green-400\" : \"text-gray-800 dark:text-gray-200\"}`, children: note }),\n    /* @__PURE__ */ jsx(\"div\", { className: \"w-56\", children: /* @__PURE__ */ jsx(GaugeSVG, { percent }) }),\n    /* @__PURE__ */ jsxs(\"div\", { className: \"text-center mt-1\", children: [\n      /* @__PURE__ */ jsxs(\"span\", { className: `text-2xl font-mono font-semibold transition-colors duration-200 ${Math.abs(displayCents) <= inTuneThreshold ? \"text-green-600 dark:text-green-400\" : displayCents < 0 ? \"text-red-500 dark:text-red-400\" : \"text-amber-500 dark:text-amber-400\"}`, children: [\n        direction && /* @__PURE__ */ jsx(\"span\", { className: \"mr-1\", children: direction }),\n        Math.abs(displayCents),\n        \"\\xA2\"\n      ] }),\n      /* @__PURE__ */ jsx(\"div\", { className: \"text-sm text-muted-foreground mt-0.5\", children: inTune ? \"In tune! \\u2713\" : displayCents < 0 ? \"Too flat\" : \"Too sharp\" }),\n      clarity !== void 0 && /* @__PURE__ */ jsxs(\"div\", { className: \"text-xs font-medium text-gray-600 dark:text-gray-300 mt-0.5\", children: [\n        \"clarity: \",\n        Math.round(clarity * 100),\n        \"%\"\n      ] })\n    ] })\n  ] });\n};\nvar PitchGauge = React.memo(PitchGaugeComponent, (prevProps, nextProps) => {\n  return prevProps.note === nextProps.note && Math.abs(prevProps.cents - nextProps.cents) < 0.5 && prevProps.clarity === nextProps.clarity && prevProps.className === nextProps.className && prevProps.inTuneThreshold === nextProps.inTuneThreshold && prevProps.smoothingFactor === nextProps.smoothingFactor && prevProps.subdueNote === nextProps.subdueNote;\n});\n\nexport { PitchGauge };\n//# sourceMappingURL=index.js.map\n//# sourceMappingURL=index.js.map","import { AnimatePresence, motion } from 'framer-motion';\nimport { Volume2, Zap } from 'lucide-react';\nimport { Badge } from '@hudak/ui/components/badge';\nimport { Button } from '@hudak/ui/components/button';\nimport { Card, CardContent } from '@hudak/ui/components/card';\nimport { PitchGauge } from '@hudak/audio-components';\nimport type { RefObject } from 'react';\n\ninterface DetectedNote {\n  note: number;\n  noteName: string;\n  centsOff?: number;\n}\n\ninterface DetectedPitch {\n  note: string;\n  cents: number;\n  clarity: number;\n}\n\ninterface NotationCardProps {\n  instrument: string;\n  tabDisplayMode: 'staff' | 'tab' | 'both';\n  isMicrophoneInstrument: boolean;\n  staffContainerRef: RefObject<HTMLDivElement>;\n  tabContainerRef: RefObject<HTMLDivElement>;\n  detectedPitch: DetectedPitch | null;\n  pitchSensitivity: number;\n  pitchSmoothing: number;\n  feedback: string;\n  lastDetectedNote: DetectedNote | null;\n  tabOrientation?: 'standard' | 'leftHanded';\n  onTabOrientationChange?: (orientation: 'standard' | 'leftHanded') => void;\n}\n\nexport function NotationCard({\n  instrument,\n  tabDisplayMode,\n  isMicrophoneInstrument,\n  staffContainerRef,\n  tabContainerRef,\n  detectedPitch,\n  pitchSensitivity,\n  pitchSmoothing,\n  feedback,\n  lastDetectedNote,\n  tabOrientation = 'standard',\n  onTabOrientationChange,\n}: NotationCardProps) {\n  const showTabOrientationToggle = instrument === 'guitar' && (tabDisplayMode === 'tab' || tabDisplayMode === 'both');\n\n  return (\n    <Card className=\"border-2 shadow-2xl bg-card/95 backdrop-blur overflow-hidden\">\n      {/* Tab Orientation Toggle for Guitar */}\n      {showTabOrientationToggle && onTabOrientationChange && (\n        <div className=\"px-4 py-2 bg-muted/50 border-b border-border flex items-center justify-between\">\n          <span className=\"text-xs font-medium text-muted-foreground\">Tab Layout</span>\n          <div className=\"flex gap-2\">\n            <Button\n              variant={tabOrientation === 'standard' ? 'default' : 'ghost'}\n              size=\"sm\"\n              onClick={() => onTabOrientationChange('standard')}\n              className=\"h-7 text-xs\"\n              title=\"Standard orientation: Low string on bottom\"\n            >\n              Standard\n            </Button>\n            <Button\n              variant={tabOrientation === 'leftHanded' ? 'default' : 'ghost'}\n              size=\"sm\"\n              onClick={() => onTabOrientationChange('leftHanded')}\n              className=\"h-7 text-xs gap-1\"\n              title=\"Left-handed: Low string on top\"\n            >\n              <Zap className=\"h-3 w-3\" />\n              Lefty\n            </Button>\n          </div>\n        </div>\n      )}\n\n      <CardContent className=\"p-0\">\n        <div className={`flex ${isMicrophoneInstrument ? 'flex-row' : 'flex-col'} items-center justify-center`}>\n          <div className={`flex-1 p-8 flex items-center justify-center ${\n            instrument === 'guitar' && tabDisplayMode === 'both' ? 'min-h-[400px]' : 'min-h-[300px]'\n          }`}>\n            <div\n              id=\"staff-display\"\n              ref={staffContainerRef}\n              className={(instrument === 'guitar' && tabDisplayMode !== 'staff') ? 'hidden' : 'block'}\n            />\n            <div\n              id=\"tab-display\"\n              ref={tabContainerRef}\n              className={(instrument === 'guitar' && (tabDisplayMode === 'tab' || tabDisplayMode === 'both')) ? 'block' : 'hidden'}\n            />\n          </div>\n\n          {isMicrophoneInstrument && (\n            <div className=\"flex-shrink-0 p-6 border-l border-border bg-gradient-to-br from-blue-50/50 to-purple-50/50 dark:from-blue-950/30 dark:to-purple-950/30\">\n              {detectedPitch ? (\n                <PitchGauge\n                  note={detectedPitch.note}\n                  cents={detectedPitch.cents}\n                  clarity={detectedPitch.clarity}\n                  inTuneThreshold={pitchSensitivity}\n                  smoothingFactor={pitchSmoothing}\n                />\n              ) : (\n                <div className=\"w-56 h-56 flex items-center justify-center\">\n                  <div className=\"text-center text-muted-foreground\">\n                    <Volume2 className=\"h-8 w-8 mx-auto mb-2 opacity-50\" />\n                    <p className=\"text-sm\">Waiting for audio...</p>\n                  </div>\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n\n        <AnimatePresence mode=\"wait\">\n          {feedback && (\n            <motion.div\n              key={feedback}\n              initial={{ opacity: 0, y: 10 }}\n              animate={{ opacity: 1, y: 0 }}\n              exit={{ opacity: 0, y: -10 }}\n              className={`px-6 py-3 text-center text-sm font-medium ${\n                feedback.includes('')\n                  ? 'bg-emerald-500/10 text-emerald-600 dark:text-emerald-400'\n                  : feedback.includes('') || feedback.includes('Try again')\n                  ? 'bg-red-500/10 text-red-600 dark:text-red-400'\n                  : 'bg-muted/50 text-muted-foreground'\n              }`}\n            >\n              {feedback}\n            </motion.div>\n          )}\n        </AnimatePresence>\n\n        {(instrument === 'piano' || instrument === 'piano-virtual') && lastDetectedNote && (\n          <div className=\"px-6 py-3 flex items-center justify-center gap-4 bg-blue-50/50 dark:bg-blue-950/30 border-t border-border\">\n            <Volume2 className=\"h-4 w-4 text-blue-600 dark:text-blue-400\" />\n            <span className=\"text-sm font-medium text-blue-900 dark:text-blue-100\">\n              Detected: {lastDetectedNote.noteName}\n            </span>\n            {lastDetectedNote.centsOff !== undefined && (\n              <Badge variant={Math.abs(lastDetectedNote.centsOff) < 10 ? \"default\" : \"secondary\"}>\n                {lastDetectedNote.centsOff > 0 ? '+' : ''}{lastDetectedNote.centsOff.toFixed(0)}\n              </Badge>\n            )}\n          </div>\n        )}\n      </CardContent>\n    </Card>\n  );\n}\n","/**\n * Score Summary Component\n * Displays round results with confetti celebration\n */\n\nimport { useEffect, useState } from 'react';\nimport { motion } from 'framer-motion';\nimport Confetti from 'react-confetti';\nimport { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@hudak/ui/components/card';\nimport { Button } from '@hudak/ui/components/button';\nimport { Badge } from '@hudak/ui/components/badge';\nimport { Trophy, TrendingUp, Clock, Target } from 'lucide-react';\nimport { type ScoreResult, SCORE_RANKS } from '../lib/utils/scoring';\n\ninterface ScoreSummaryProps {\n  scoreResult: ScoreResult;\n  correctCount: number;\n  totalNotes: number;\n  isSuccessful: boolean;\n  onContinue: () => void;\n  onRetry?: () => void;\n  showConfetti?: boolean;\n  className?: string;\n}\n\nexport function ScoreSummary({\n  scoreResult,\n  correctCount,\n  totalNotes,\n  isSuccessful,\n  onContinue,\n  onRetry,\n  showConfetti = true,\n  className = '',\n}: ScoreSummaryProps) {\n  const [showConfettiEffect, setShowConfettiEffect] = useState(false);\n  const [windowSize, setWindowSize] = useState({ width: 0, height: 0 });\n\n  // Update window size for confetti\n  useEffect(() => {\n    const updateSize = () => {\n      setWindowSize({ width: window.innerWidth, height: window.innerHeight });\n    };\n    updateSize();\n    window.addEventListener('resize', updateSize);\n    return () => window.removeEventListener('resize', updateSize);\n  }, []);\n\n  // Trigger confetti on successful round\n  useEffect(() => {\n    if (isSuccessful && showConfetti) {\n      setShowConfettiEffect(true);\n      const timer = setTimeout(() => setShowConfettiEffect(false), 5000);\n      return () => clearTimeout(timer);\n    }\n    return undefined;\n  }, [isSuccessful, showConfetti]);\n\n  const rankInfo = SCORE_RANKS[scoreResult.rank];\n  const accuracy = totalNotes > 0 ? (correctCount / totalNotes) * 100 : 0;\n\n  return (\n    <>\n      {showConfettiEffect && (\n        <Confetti\n          width={windowSize.width}\n          height={windowSize.height}\n          recycle={false}\n          numberOfPieces={200}\n          gravity={0.2}\n          colors={['#3B82F6', '#10B981', '#F59E0B', '#8B5CF6', '#EC4899']}\n        />\n      )}\n\n      <motion.div\n        initial={{ scale: 0.8, opacity: 0 }}\n        animate={{ scale: 1, opacity: 1 }}\n        transition={{ type: 'spring', stiffness: 300, damping: 20 }}\n        className={className}\n      >\n        <Card className=\"border-2\">\n          <CardHeader className=\"text-center\">\n            <motion.div\n              initial={{ rotate: -180, scale: 0 }}\n              animate={{ rotate: 0, scale: 1 }}\n              transition={{ type: 'spring', stiffness: 200, damping: 15, delay: 0.2 }}\n              className=\"flex justify-center mb-4\"\n            >\n              <Trophy className={`h-16 w-16 ${rankInfo.color}`} />\n            </motion.div>\n            <CardTitle className=\"text-3xl font-bold\">\n              {isSuccessful ? 'Round Complete!' : 'Round Failed'}\n            </CardTitle>\n            <CardDescription className=\"text-lg mt-2\">\n              <Badge\n                variant=\"outline\"\n                className={`text-2xl font-bold px-4 py-2 ${rankInfo.color} border-current`}\n              >\n                Rank {scoreResult.rank}\n              </Badge>\n            </CardDescription>\n          </CardHeader>\n\n          <CardContent className=\"space-y-6\">\n            {/* Score Breakdown */}\n            <div className=\"space-y-4\">\n              <div className=\"flex items-center justify-between p-4 bg-muted rounded-lg\">\n                <div className=\"flex items-center gap-3\">\n                  <Target className=\"h-6 w-6 text-blue-500\" />\n                  <div>\n                    <p className=\"text-sm text-muted-foreground\">Accuracy</p>\n                    <p className=\"text-2xl font-bold\">{accuracy.toFixed(0)}%</p>\n                  </div>\n                </div>\n                <div className=\"text-right\">\n                  <p className=\"text-sm text-muted-foreground\">Notes</p>\n                  <p className=\"text-xl font-semibold\">\n                    {correctCount}/{totalNotes}\n                  </p>\n                </div>\n              </div>\n\n              {scoreResult.speedBonus > 0 && (\n                <motion.div\n                  initial={{ x: -20, opacity: 0 }}\n                  animate={{ x: 0, opacity: 1 }}\n                  transition={{ delay: 0.3 }}\n                  className=\"flex items-center justify-between p-4 bg-yellow-500/10 rounded-lg border border-yellow-500/20\"\n                >\n                  <div className=\"flex items-center gap-3\">\n                    <Clock className=\"h-6 w-6 text-yellow-500\" />\n                    <div>\n                      <p className=\"text-sm text-muted-foreground\">Speed Bonus</p>\n                      <p className=\"text-xl font-bold text-yellow-500\">\n                        +{scoreResult.speedBonus}%\n                      </p>\n                    </div>\n                  </div>\n                </motion.div>\n              )}\n\n              {scoreResult.streakMultiplier > 1 && (\n                <motion.div\n                  initial={{ x: -20, opacity: 0 }}\n                  animate={{ x: 0, opacity: 1 }}\n                  transition={{ delay: 0.4 }}\n                  className=\"flex items-center justify-between p-4 bg-orange-500/10 rounded-lg border border-orange-500/20\"\n                >\n                  <div className=\"flex items-center gap-3\">\n                    <TrendingUp className=\"h-6 w-6 text-orange-500\" />\n                    <div>\n                      <p className=\"text-sm text-muted-foreground\">Streak Multiplier</p>\n                      <p className=\"text-xl font-bold text-orange-500\">\n                        {scoreResult.streakMultiplier.toFixed(1)}\n                      </p>\n                    </div>\n                  </div>\n                </motion.div>\n              )}\n\n              <motion.div\n                initial={{ scale: 0.8, opacity: 0 }}\n                animate={{ scale: 1, opacity: 1 }}\n                transition={{ delay: 0.5, type: 'spring' }}\n                className=\"p-6 bg-gradient-to-r from-blue-500/10 to-purple-500/10 rounded-lg border-2 border-blue-500/20\"\n              >\n                <p className=\"text-sm text-muted-foreground text-center mb-2\">\n                  Total Score\n                </p>\n                <p className=\"text-5xl font-bold text-center text-blue-500\">\n                  {scoreResult.finalScore}\n                </p>\n                <p className=\"text-center text-lg font-medium mt-2 text-muted-foreground\">\n                  {rankInfo.label}\n                </p>\n              </motion.div>\n            </div>\n\n            {/* Actions */}\n            <div className=\"flex gap-3 pt-4\">\n              {onRetry && !isSuccessful && (\n                <Button onClick={onRetry} variant=\"outline\" className=\"flex-1\">\n                  Try Again\n                </Button>\n              )}\n              <Button onClick={onContinue} className=\"flex-1\">\n                {isSuccessful ? 'Next Round' : 'Continue'}\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      </motion.div>\n    </>\n  );\n}\n","import { AnimatePresence } from 'framer-motion';\nimport { ScoreSummary } from '../score-summary';\nimport type { ScoreResult } from '../../lib/utils/scoring';\n\ninterface ScoreSummaryModalProps {\n  isOpen: boolean;\n  scoreResult: ScoreResult | null;\n  correctCount: number;\n  totalNotes: number;\n  isSuccessful: boolean;\n  onContinue: () => void;\n  onRetry?: () => void;\n}\n\nexport function ScoreSummaryModal({\n  isOpen,\n  scoreResult,\n  correctCount,\n  totalNotes,\n  isSuccessful,\n  onContinue,\n  onRetry,\n}: ScoreSummaryModalProps) {\n  return (\n    <AnimatePresence>\n      {isOpen && scoreResult && (\n        <div className=\"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4 backdrop-blur-sm\">\n          <ScoreSummary\n            scoreResult={scoreResult}\n            correctCount={correctCount}\n            totalNotes={totalNotes}\n            isSuccessful={isSuccessful}\n            onContinue={onContinue}\n            onRetry={onRetry}\n            showConfetti={isSuccessful}\n          />\n        </div>\n      )}\n    </AnimatePresence>\n  );\n}\n","/**\n * Play Route - Flash card game interface with centered notation display\n */\n\nimport { createFileRoute, useNavigate } from '@tanstack/react-router';\nimport { useEffect, useState, useRef, useCallback } from 'react';\nimport { Button } from '@hudak/ui/components/button';\nimport { Badge } from '@hudak/ui/components/badge';\nimport { X, SkipForward } from 'lucide-react';\nimport { toast } from 'sonner';\nimport { motion } from 'framer-motion';\n\n// Import our libraries\nimport { MidiManager, type NoteOnEvent, type DeviceChangeEvent } from '../lib/input/midi-manager';\nimport { AudioManager, type PitchDetectedEvent } from '../lib/input/audio-manager';\nimport { StaffRenderer } from '../lib/notation/staff-renderer';\nimport { TabRenderer } from '../lib/notation/tab-renderer';\nimport { getInstrument, requiresMIDI } from '../lib/utils/instrument-config';\nimport { generateRandomNote, validateNote } from '../lib/utils/music-theory';\nimport { Storage } from '../lib/utils/storage';\nimport { AudioPlayback } from '../lib/utils/audio-playback';\nimport { getNoteRange } from '../lib/game/note-range';\nimport { renderPracticeNote } from '../lib/game/render-note';\n\n// Game components\nimport { useGameRound, type GameMode } from '../hooks/use-game-round';\nimport { getStreakMilestoneMessage } from '../lib/utils/scoring';\nimport { VirtualKeyboard } from '../components/virtual-keyboard';\nimport { RadialTimer } from '../components/play/radial-timer';\nimport { ScoreHud } from '../components/play/score-hud';\nimport { NotationCard } from '../components/play/notation-card';\nimport { ScoreSummaryModal } from '../components/play/score-summary-modal';\n\n// Search params for game settings\ninterface PlaySearchParams {\n  instrument?: string;\n  clef?: string;\n  difficulty?: string;\n  gameMode?: string;\n  tabDisplayMode?: string;\n  pitchSensitivity?: number;\n  pitchSmoothing?: number;\n  selectedAudioDevice?: string;\n}\n\nexport const Route = createFileRoute('/play')({\n  component: PlayRoute,\n  validateSearch: (search: Record<string, unknown>): PlaySearchParams => ({\n    instrument: (search.instrument as string) || 'piano',\n    clef: (search.clef as string) || 'treble',\n    difficulty: (search.difficulty as string) || 'beginner',\n    gameMode: (search.gameMode as string) || 'practice',\n    tabDisplayMode: (search.tabDisplayMode as string) || 'both',\n    pitchSensitivity: Number(search.pitchSensitivity) || 10,\n    pitchSmoothing: Number(search.pitchSmoothing) || 0.7,\n    selectedAudioDevice: (search.selectedAudioDevice as string) || '',\n  }),\n});\n\nfunction PlayRoute() {\n  const navigate = useNavigate();\n  const search = Route.useSearch();\n\n  // Extract settings from search params\n  const instrument = search.instrument || 'piano';\n  const clef = search.clef || 'treble';\n  const difficulty = (search.difficulty || 'beginner') as 'beginner' | 'intermediate' | 'advanced';\n  const gameMode = (search.gameMode || 'practice') as GameMode;\n  const tabDisplayMode = (search.tabDisplayMode || 'both') as 'staff' | 'tab' | 'both';\n  const pitchSensitivity = search.pitchSensitivity || 10;\n  const pitchSmoothing = search.pitchSmoothing || 0.7;\n  const selectedAudioDevice = search.selectedAudioDevice || '';\n\n  // Input status\n  const [midiConnected, setMidiConnected] = useState(false);\n  const [microphoneActive, setMicrophoneActive] = useState(false);\n\n  // Practice session state\n  const [sessionActive, setSessionActive] = useState(false);\n  const [stats, setStats] = useState({ correct: 0, incorrect: 0, streak: 0, avgTime: '-' });\n  const [feedback, setFeedback] = useState('');\n  const [, setCurrentNote] = useState<number | null>(null);\n  const [lastDetectedNote, setLastDetectedNote] = useState<{ note: number; noteName: string; centsOff?: number } | null>(null);\n  const [showScoreSummary, setShowScoreSummary] = useState(false);\n\n  // Pitch detection state\n  const [detectedPitch, setDetectedPitch] = useState<{ note: string; cents: number; clarity: number } | null>(null);\n\n  // Tab orientation for left-handed guitarists\n  const [tabOrientation, setTabOrientation] = useState<'standard' | 'leftHanded'>(() => {\n    const settings = Storage.getSettings();\n    return settings.tabOrientation || 'standard';\n  });\n\n  // Refs\n  const sessionActiveRef = useRef(false);\n  const currentNoteRef = useRef<number | null>(null);\n  const instrumentRef = useRef(instrument);\n  const clefRef = useRef(clef);\n  const gameModeRef = useRef(gameMode);\n  const roundActionsRef = useRef<any>(null);\n  const roundStateRef = useRef<any>(null);\n  const midiManager = useRef<MidiManager | null>(null);\n  const audioManager = useRef<AudioManager | null>(null);\n  const audioPlayback = useRef<AudioPlayback | null>(null);\n  const staffRenderer = useRef<StaffRenderer | null>(null);\n  const tabRenderer = useRef<TabRenderer | null>(null);\n  const staffContainerRef = useRef<HTMLDivElement>(null);\n  const tabContainerRef = useRef<HTMLDivElement>(null);\n  const lastIncorrectFeedbackRef = useRef(0);\n  const audioInitAttemptedRef = useRef(false);\n  const noteValidatedRef = useRef(false);\n  const correctDetectionsRef = useRef(0);\n  const lastDetectionTimeRef = useRef(0);\n\n  // Get note range based on difficulty and instrument\n  const noteRange = useCallback(() => getNoteRange(instrument, difficulty), [difficulty, instrument]);\n\n  // Stable callbacks for game round hook to prevent infinite re-renders\n  const handleRoundComplete = useCallback((state: any) => {\n    setShowScoreSummary(true);\n\n    // Calculate range inline to avoid dependency cycle\n    const range = getNoteRange(instrument, difficulty);\n\n    Storage.saveSession({\n      module: 'sightReading',\n      correct: state.correctCount,\n      incorrect: state.incorrectCount,\n      bestStreak: state.streak,\n      gameMode,\n      roundScore: state.currentScore?.finalScore,\n      timeLeft: state.timeLeft,\n      livesRemaining: state.lives,\n      instrument,\n      clef,\n      range,\n    });\n    toast.success('Round Complete! ', {\n      description: `Score: ${state.currentScore?.finalScore || 0} points`,\n    });\n  }, [gameMode, instrument, clef, difficulty]);\n\n  const handleRoundFail = useCallback((state: any) => {\n    setShowScoreSummary(true);\n    toast.error('Round Failed', {\n      description: `You scored ${state.currentScore?.finalScore || 0} points. Try again!`,\n    });\n  }, []);\n\n  const handleLifeLost = useCallback((livesLeft: number) => {\n    if (livesLeft === 1) {\n      toast.warning('Last Life! ', { description: 'Be careful on the next note!', duration: 2000 });\n    }\n  }, []);\n\n  const handleStreakMilestone = useCallback((streak: number) => {\n    const message = getStreakMilestoneMessage(streak);\n    if (message) toast.success(message, { duration: 2500 });\n  }, []);\n\n  // Game round hook\n  const [roundState, roundActions] = useGameRound({\n    difficulty,\n    gameMode,\n    onRoundComplete: handleRoundComplete,\n    onRoundFail: handleRoundFail,\n    onLifeLost: handleLifeLost,\n    onStreakMilestone: handleStreakMilestone,\n  });\n\n  // Next note function\n  const nextNote = useCallback(() => {\n    noteValidatedRef.current = false;\n    correctDetectionsRef.current = 0;\n    lastDetectionTimeRef.current = 0;\n\n    const note = generateRandomNote(noteRange(), clef as 'treble' | 'bass');\n    if (note) {\n      setCurrentNote(note.midiNote);\n      currentNoteRef.current = note.midiNote;\n\n      renderPracticeNote({\n        instrument,\n        tabDisplayMode,\n        clef: clef as 'treble' | 'bass',\n        midiNote: note.midiNote,\n        staffRenderer: staffRenderer.current,\n        tabRenderer: tabRenderer.current,\n      });\n    }\n  }, [clef, instrument, noteRange, tabDisplayMode]);\n\n  // Handle MIDI device changes\n  const handleMidiDeviceChange = useCallback((_event: DeviceChangeEvent) => {\n    if (midiManager.current) {\n      const devices = midiManager.current.getInputDevices();\n      setMidiConnected(devices.length > 0);\n    }\n  }, []);\n\n  // Handle pitch detection\n  const handlePitchDetected = useCallback((event: PitchDetectedEvent) => {\n    setDetectedPitch({ note: event.noteName, cents: event.cents, clarity: event.clarity });\n\n    let centsOff: number | undefined;\n    if (currentNoteRef.current !== null) {\n      const instrumentConfig = getInstrument(instrumentRef.current as 'piano' | 'violin' | 'guitar');\n      const result = validateNote(event.midi, currentNoteRef.current, {\n        allowOctaveError: instrumentConfig.validation.octaveFlexible,\n      });\n      centsOff = result.centsOff;\n    }\n\n    setLastDetectedNote({ note: event.midi, noteName: event.noteName, centsOff });\n\n    if (sessionActiveRef.current && currentNoteRef.current !== null) {\n      const instrumentConfig = getInstrument(instrumentRef.current as 'piano' | 'violin' | 'guitar');\n      const result = validateNote(event.midi, currentNoteRef.current, {\n        allowOctaveError: instrumentConfig.validation.octaveFlexible,\n      });\n\n      if (result.isCorrect) {\n        correctDetectionsRef.current += 1;\n        lastDetectionTimeRef.current = Date.now();\n        const REQUIRED_CONSECUTIVE_DETECTIONS = 4;\n\n        if (correctDetectionsRef.current >= REQUIRED_CONSECUTIVE_DETECTIONS && !noteValidatedRef.current) {\n          noteValidatedRef.current = true;\n          if (gameModeRef.current === 'timed' && roundStateRef.current?.isActive) {\n            roundActionsRef.current?.noteCorrect();\n          }\n          setStats(prev => ({\n            correct: prev.correct + 1,\n            incorrect: prev.incorrect,\n            streak: gameModeRef.current === 'timed' ? (roundStateRef.current?.streak || 0) : prev.streak + 1,\n            avgTime: prev.avgTime\n          }));\n          setFeedback('Correct! ');\n          if (staffRenderer.current) staffRenderer.current.showFeedback(true);\n        }\n      } else {\n        correctDetectionsRef.current = 0;\n        lastDetectionTimeRef.current = Date.now();\n        const now = Date.now();\n        if (now - lastIncorrectFeedbackRef.current > 1000 && !noteValidatedRef.current) {\n          if (gameModeRef.current === 'timed' && roundStateRef.current?.isActive) {\n            roundActionsRef.current?.noteIncorrect();\n          }\n          setStats(prev => ({ correct: prev.correct, incorrect: prev.incorrect + 1, streak: 0, avgTime: prev.avgTime }));\n          setFeedback(`Try again - you played ${event.noteName}`);\n          if (staffRenderer.current) staffRenderer.current.showFeedback(false);\n          lastIncorrectFeedbackRef.current = now;\n        }\n      }\n    }\n  }, []);\n\n  // Handle MIDI note input - use refs to avoid recreating callback\n  const nextNoteRef = useRef(nextNote);\n  useEffect(() => { nextNoteRef.current = nextNote; }, [nextNote]);\n\n  const handleMidiNoteOn = useCallback((event: NoteOnEvent) => {\n    if (audioPlayback.current) audioPlayback.current.playNote(event.note);\n\n    let centsOff: number | undefined;\n    if (currentNoteRef.current !== null) {\n      const instrumentConfig = getInstrument(instrumentRef.current as 'piano' | 'violin' | 'guitar');\n      const result = validateNote(event.note, currentNoteRef.current, {\n        allowOctaveError: instrumentConfig.validation.octaveFlexible,\n      });\n      centsOff = result.centsOff;\n    }\n\n    setLastDetectedNote({ note: event.note, noteName: event.noteName, centsOff });\n\n    if (sessionActiveRef.current && currentNoteRef.current !== null) {\n      const instrumentConfig = getInstrument(instrumentRef.current as 'piano' | 'violin' | 'guitar');\n      const result = validateNote(event.note, currentNoteRef.current, {\n        allowOctaveError: instrumentConfig.validation.octaveFlexible,\n      });\n\n      if (result.isCorrect) {\n        if (gameModeRef.current === 'timed' && roundStateRef.current?.isActive) {\n          roundActionsRef.current?.noteCorrect();\n        }\n        setStats(prev => ({\n          correct: prev.correct + 1,\n          incorrect: prev.incorrect,\n          streak: gameModeRef.current === 'timed' ? (roundStateRef.current?.streak || 0) : prev.streak + 1,\n          avgTime: prev.avgTime\n        }));\n        setFeedback('Correct! ');\n        if (staffRenderer.current) staffRenderer.current.showFeedback(true);\n        setTimeout(() => { if (!roundStateRef.current?.isComplete) nextNoteRef.current(); }, 500);\n      } else {\n        if (gameModeRef.current === 'timed' && roundStateRef.current?.isActive) {\n          roundActionsRef.current?.noteIncorrect();\n        }\n        setStats(prev => ({ correct: prev.correct, incorrect: prev.incorrect + 1, streak: 0, avgTime: prev.avgTime }));\n        setFeedback('Try again ');\n        if (staffRenderer.current) staffRenderer.current.showFeedback(false);\n      }\n    }\n  }, []);\n\n  // Initialize managers\n  useEffect(() => {\n    const initManagers = async () => {\n      audioPlayback.current = new AudioPlayback();\n\n      if (requiresMIDI(instrument as any)) {\n        midiManager.current = new MidiManager();\n        const success = await midiManager.current.init();\n        setMidiConnected(success);\n        if (success) {\n          midiManager.current.on('noteOn', handleMidiNoteOn);\n          midiManager.current.on('deviceChange', handleMidiDeviceChange);\n        }\n      }\n\n      setTimeout(() => {\n        if (staffContainerRef.current && !staffRenderer.current) {\n          staffRenderer.current = new StaffRenderer('staff-display');\n        }\n        if (tabContainerRef.current && !tabRenderer.current) {\n          tabRenderer.current = new TabRenderer('tab-display', instrumentRef.current);\n        }\n      }, 200);\n    };\n\n    initManagers();\n\n    return () => {\n      midiManager.current?.disconnectDevice();\n      audioManager.current?.disconnect();\n      audioPlayback.current?.cleanup();\n    };\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // Sync refs\n  useEffect(() => {\n    instrumentRef.current = instrument;\n    if (tabRenderer.current && tabContainerRef.current) {\n      tabRenderer.current = new TabRenderer('tab-display', instrument, tabOrientation);\n    }\n  }, [instrument, tabOrientation]);\n\n  useEffect(() => {\n    // Update TabRenderer's tab orientation when setting changes\n    if (tabRenderer.current) {\n      tabRenderer.current.setTabOrientation(tabOrientation);\n    }\n    // Persist setting to storage\n    Storage.saveSettings({ tabOrientation });\n  }, [tabOrientation]);\n\n  useEffect(() => { clefRef.current = clef; }, [clef]);\n  useEffect(() => { gameModeRef.current = gameMode; }, [gameMode]);\n\n  // Update refs in render phase - this is safe and doesn't cause re-renders\n  // React docs: \"You can mutate refs during rendering as long as the mutation doesn't affect rendering output\"\n  roundActionsRef.current = roundActions;\n  roundStateRef.current = roundState;\n\n  // Silence detection for microphone\n  useEffect(() => {\n    if (!sessionActive) return;\n    const SILENCE_THRESHOLD_MS = 800;\n    const checkInterval = setInterval(() => {\n      const timeSinceLastDetection = Date.now() - lastDetectionTimeRef.current;\n      if (noteValidatedRef.current && timeSinceLastDetection > SILENCE_THRESHOLD_MS) {\n        noteValidatedRef.current = false;\n        correctDetectionsRef.current = 0;\n        lastDetectionTimeRef.current = 0;\n        // Use refs to avoid dependency on roundState object and nextNote callback\n        if (!roundStateRef.current?.isComplete) nextNoteRef.current();\n      }\n    }, 100);\n    return () => clearInterval(checkInterval);\n  }, [sessionActive]); // Removed roundState.isComplete and nextNote dependencies\n\n  // Audio manager for microphone instruments\n  useEffect(() => {\n    const isMicrophoneInstrument = instrument === 'violin' || instrument === 'guitar';\n    if (isMicrophoneInstrument && !audioInitAttemptedRef.current) {\n      const initAudio = async () => {\n        audioInitAttemptedRef.current = true;\n        const devices = await AudioManager.getAudioInputDevices();\n        const deviceId = selectedAudioDevice || devices[0]?.deviceId;\n        audioManager.current = new AudioManager();\n        const success = await audioManager.current.init(deviceId);\n        setMicrophoneActive(success);\n        if (success) {\n          audioManager.current.on('pitchDetected', handlePitchDetected);\n          audioManager.current.on('statusChange', (status) => setMicrophoneActive(status.microphoneActive));\n          audioManager.current.startListening();\n        } else {\n          toast.error('Microphone Access Required', {\n            description: 'Click the camera/microphone icon in your browser\\'s address bar to allow microphone access.',\n            duration: 10000,\n          });\n        }\n      };\n      initAudio();\n    } else if (!isMicrophoneInstrument && audioManager.current) {\n      audioManager.current.disconnect();\n      audioManager.current = null;\n      setMicrophoneActive(false);\n      audioInitAttemptedRef.current = false;\n    }\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [instrument, selectedAudioDevice]);\n\n  // Auto-start session on mount\n  useEffect(() => {\n    const startSession = () => {\n      if (gameMode === 'timed') roundActions.startRound();\n      const note = generateRandomNote(noteRange(), clef as 'treble' | 'bass');\n      if (note) {\n        setCurrentNote(note.midiNote);\n        currentNoteRef.current = note.midiNote;\n\n        setTimeout(() => {\n          renderPracticeNote({\n            instrument,\n            tabDisplayMode,\n            clef: clef as 'treble' | 'bass',\n            midiNote: note.midiNote,\n            staffRenderer: staffRenderer.current,\n            tabRenderer: tabRenderer.current,\n          });\n        }, 100);\n\n        setSessionActive(true);\n        sessionActiveRef.current = true;\n        setFeedback('Play the note!');\n        setStats({ correct: 0, incorrect: 0, streak: 0, avgTime: '-' });\n      }\n    };\n\n    const timer = setTimeout(startSession, 600);\n    return () => clearTimeout(timer);\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  // Stop session\n  const stopSession = () => {\n    if (gameMode === 'timed' && roundState.isActive) roundActions.endRound();\n    setSessionActive(false);\n    sessionActiveRef.current = false;\n    if (gameMode !== 'timed' && (stats.correct > 0 || stats.incorrect > 0)) {\n      Storage.saveSession({\n        module: 'sightReading',\n        instrument,\n        clef,\n        range: noteRange(),\n        ...stats,\n        timestamp: Date.now()\n      });\n    }\n    navigate({ to: '/' });\n  };\n\n  const isMicrophoneInstrument = instrument === 'violin' || instrument === 'guitar';\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-background via-background to-muted/20 flex flex-col\">\n      {/* Exit Button - Top Right */}\n      <div className=\"fixed top-6 right-6 z-30\">\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          onClick={stopSession}\n          className=\"h-12 w-12 rounded-full bg-card/80 backdrop-blur hover:bg-destructive hover:text-destructive-foreground transition-all shadow-lg\"\n        >\n          <X className=\"h-5 w-5\" />\n        </Button>\n      </div>\n\n      {/* Connection Status - Top Left */}\n      <div className=\"fixed top-6 left-6 z-30 flex gap-2\">\n        {midiConnected && <Badge variant=\"default\" className=\"bg-emerald-600\">MIDI Connected</Badge>}\n        {microphoneActive && isMicrophoneInstrument && (\n          <Badge variant=\"default\" className=\"bg-emerald-600\"> Mic Active</Badge>\n        )}\n      </div>\n\n      {/* Main Game Area */}\n      <div className=\"flex-1 flex items-center justify-center p-8\">\n        <div className=\"w-full max-w-4xl space-y-8\">\n          <motion.div\n            initial={{ opacity: 0, y: -20 }}\n            animate={{ opacity: 1, y: 0 }}\n            className=\"flex items-center justify-between px-4\"\n          >\n            <ScoreHud gameMode={gameMode} roundState={roundState} stats={stats} />\n            {gameMode === 'timed' && roundState.isActive && (\n              <RadialTimer\n                timeLeft={roundState.timeLeft}\n                maxTime={roundState.maxTime}\n              />\n            )}\n          </motion.div>\n\n          {/* Flash Card with Notation */}\n          <motion.div\n            initial={{ opacity: 0, scale: 0.95 }}\n            animate={{ opacity: 1, scale: 1 }}\n            transition={{ delay: 0.1 }}\n          >\n            <NotationCard\n              instrument={instrument}\n              tabDisplayMode={tabDisplayMode}\n              isMicrophoneInstrument={isMicrophoneInstrument}\n              staffContainerRef={staffContainerRef}\n              tabContainerRef={tabContainerRef}\n              detectedPitch={detectedPitch}\n              pitchSensitivity={pitchSensitivity}\n              pitchSmoothing={pitchSmoothing}\n              feedback={feedback}\n              lastDetectedNote={lastDetectedNote}\n              tabOrientation={tabOrientation}\n              onTabOrientationChange={setTabOrientation}\n            />\n          </motion.div>\n\n          {/* Skip Button (Practice Mode Only) */}\n          {gameMode === 'practice' && (\n            <motion.div\n              initial={{ opacity: 0 }}\n              animate={{ opacity: 1 }}\n              transition={{ delay: 0.2 }}\n              className=\"flex justify-center\"\n            >\n              <Button\n                variant=\"ghost\"\n                onClick={nextNote}\n                className=\"gap-2\"\n              >\n                <SkipForward className=\"h-4 w-4\" />\n                Skip Note\n              </Button>\n            </motion.div>\n          )}\n        </div>\n      </div>\n\n      {/* Virtual Keyboard */}\n      {instrument === 'piano-virtual' && (\n        <div className=\"pb-8 px-8\">\n          <VirtualKeyboard\n            onNotePlay={(midiNote, noteName) => {\n              const frequency = 440 * Math.pow(2, (midiNote - 69) / 12);\n              handleMidiNoteOn({\n                note: midiNote,\n                noteName,\n                velocity: 100,\n                frequency,\n                timestamp: Date.now()\n              });\n            }}\n            enabled={true}\n            startOctave={3}\n            octaveCount={3}\n          />\n        </div>\n      )}\n\n      <ScoreSummaryModal\n        isOpen={showScoreSummary}\n        scoreResult={roundState.currentScore}\n        correctCount={roundState.correctCount}\n        totalNotes={roundState.notesRequired}\n        isSuccessful={roundState.isSuccessful || false}\n        onContinue={() => {\n          setShowScoreSummary(false);\n          roundActions.startRound();\n          const note = generateRandomNote(noteRange(), clef as 'treble' | 'bass');\n          if (note) {\n            setCurrentNote(note.midiNote);\n            currentNoteRef.current = note.midiNote;\n            setSessionActive(true);\n            sessionActiveRef.current = true;\n            setTimeout(() => {\n              renderPracticeNote({\n                instrument,\n                tabDisplayMode,\n                clef: clef as 'treble' | 'bass',\n                midiNote: note.midiNote,\n                staffRenderer: staffRenderer.current,\n                tabRenderer: tabRenderer.current,\n              });\n            }, 100);\n          }\n        }}\n        onRetry={!roundState.isSuccessful ? () => {\n          setShowScoreSummary(false);\n          roundActions.resetRound();\n          const note = generateRandomNote(noteRange(), clef as 'treble' | 'bass');\n          if (note) {\n            setCurrentNote(note.midiNote);\n            currentNoteRef.current = note.midiNote;\n            setSessionActive(true);\n            sessionActiveRef.current = true;\n            setTimeout(() => {\n              renderPracticeNote({\n                instrument,\n                tabDisplayMode,\n                clef: clef as 'treble' | 'bass',\n                midiNote: note.midiNote,\n                staffRenderer: staffRenderer.current,\n                tabRenderer: tabRenderer.current,\n              });\n            }, 100);\n          }\n        } : undefined}\n      />\n    </div>\n  );\n}\n"],"names":["Clock","createLucideIcon","Flame","Heart","Piano","SkipForward","TrendingUp","isNamedPitch","src","isPitch","pitch2","FIFTHS","STEPS_TO_OCTS","fifths","coordinates","step","alt","oct","dir","f","FIFTHS_TO_STEPS","pitch","coord","o","unaltered","i","fillStr","n","NoInterval","INTERVAL_TONAL_REGEX","INTERVAL_SHORTHAND_REGEX","REGEX","tokenizeInterval","str","m","cache","interval","parse","pitchName","SIZES","TYPES","tokens","num","q","t","type","name","simple","qToAlt","semitones","chroma","coordToInterval","forceDescending","isDescending","ivl","props","calcNum","d","altToQ","NoNote","stepToLetter","altToAcc","accToAlt","acc","note","stringSrc","cached","value","tokenizeNote","coordToNote","noteCoord","mod","SEMI","noteName","letter","octStr","pc","height","midi","freq","transpose","intervalName","asNote","intervalCoord","asInterval","tr","distance","fromNote","toNote","from","to","fcoord","tcoord","octs","rotate","times","arr","len","EmptyPcset","setNumToChroma","num2","chromaToNumber","chroma2","isChroma","set","isPcsetNum","isPcset","get","listToChroma","chromaToPcset","IVLS","chromaToIntervals","intervals2","chromaRotations","binary","_","setNum","normalizedNum","normalized","CHORDS","data_default","NoChordType","dictionary","index","add","intervals","aliases","fullName","quality","getQuality","chord","pcset","alias","addAlias","has","ivls","names2","a","b","subtract","combinator","fn","coordA","coordB","SCALES","NoScaleType","scale","NoChord","tokenize","tokenizeBass","note2","chord2","split","getChord","tonic","bass","typeName","optionalTonic","optionalBass","getChordType","bassInterval","bassIndex","hasRoot","root","rootDegree","hasBass","newNum","notes2","transposeNote","symbol","DATA","denominator","shorthand","SHARPS","FLATS","midiToNoteName","options","fromMidi","midi2","MODES","NoMode","modes","toMode","mode2","modeNum","triad","seventh","getType","chords","chords2","modeName","triads2","tonics","x","NoScale","st","getScaleType","notes","InstrumentType","InputMethod","Clef","INSTRUMENTS","getInstrument","instrumentId","instrument","requiresMIDI","getTuning","noteNames","vexflowNoteNames","midiNote","Note.fromMidi","noteNameToMidi","Note.midi","midiToVexflow","clef","octave","noteIndex","generateRandomNote","range","naturalsOnly","start","end","startMidi","endMidi","availableNotes","randomIndex","generateRandomNoteFromMidiRange","minMidi","maxMidi","validateNote","playedMidi","targetMidi","allowOctaveError","tolerance","pitchToleranceCents","playedPitch","targetPitch","validatePitchWithCents","playedFrequency","toleranceCents","targetFrequency","midiToFrequency","frequencyToMidi","centsOff","getCentsDeviation","message","Note.freq","frequency","getCentsFromMidi","generateMajorScale","Scale.get","generateMinorScale","generateScale","scaleType","generateChord","Chord.get","getAllKeySignatures","getInterval","note1","midi1","isFrequencyInRange","minFreq","maxFreq","midiToTabPosition","tuning","possiblePositions","stringInfo","openStringMidi","stringNumber","fret","aMiddleBonus","bMiddleBonus","getAllTabPositions","positions","MusicTheory","MidiManager","error","devices","input","deviceId","status","velocity","callback","event","data","duration","FFT","size","table","angle","power","j","shift","revShift","fft","complex","storage","res","spectrum","half","out","width","outOff","bitrev","off","inv","quarterLen","limit","k","A","B","C","D","Ar","Ai","Br","Bi","Cr","Ci","Dr","Di","MAr","MAi","tableBr","tableBi","MBr","MBi","tableCr","tableCi","MCr","MCi","tableDr","tableDi","MDr","MDi","T0r","T0i","T1r","T1i","T2r","T2i","T3r","T3i","FAr","FAi","FCr","FCi","FBr","FBi","FDr","FDi","evenR","evenI","oddR","oddI","leftR","leftI","rightR","rightI","step2","step3","halfLen","hquarterLen","ST0r","ST0i","ST1r","ST1i","ST2r","ST2i","ST3r","ST3i","SFAr","SFAi","SFBr","SFBi","SA","SB","Autocorrelator","inputLength","bufferSupplier","__publicField","ceilPow2","length","output","tb","getKeyMaximumIndices","keyIndices","lookingForMaximum","max","maxIndex","refineResultIndex","x0","x1","x2","y0","y1","y2","c","xMax","yMax","PitchDetector$1","PitchDetector","threshold","volume","db","amplitude","sampleRate","keyMaximumIndices","nMax","resultIndex","refinedResultIndex","clarity","squareSum","v","config","PitchyDetector","buffer","rate","cents","min","configs","AudioManager","err","audioConstraints","level","result","now","sum","track","ms","_a","device","audioTrack","StaffRenderer","containerId","svg","strokeColor","el","element","VF","vexflowNote","stave","voice","staveNotes","midiNotes","vexflowNotes","notehead","isCorrect","noteheads","color","TabRenderer","tabOrientation","orientation","tabPosition","tabStave","orientedString","tabNote","tabPositions","pos","tabNotes","staffStave","connector","staffNote","staffVoice","tabVoice","text","noteText","KEYS","isLocalStorageAvailable","saveSession","sessionData","sessions","getSessions","newSession","generateId","updateStats","getSessionsByInstrument","session","stats","getStats","totalTime","module","getDefaultStats","saveSettings","settings","updatedSettings","getSettings","getDefaultSettings","clearAll","clearAllIncludingSettings","exportData","importData","jsonData","Storage","AudioPlayback","osc1","osc2","osc3","gain1","gain2","gain3","envelopeGain","attackTime","decayTime","sustainLevel","releaseTime","NOTE_RANGES","getNoteRange","difficulty","renderPracticeNote","tabDisplayMode","staffRenderer","tabRenderer","ROUND_CONFIGS","SCORE_RANKS","calculateScore","correct","total","timeLeft","maxTime","streak","accuracyPercent","speedBonus","streakMultiplier","baseScore","scoreWithSpeed","finalScore","rank","getScoreRank","score","isRoundSuccessful","getStreakMilestoneMessage","useGameRound","gameMode","onRoundComplete","onRoundFail","onTimeUp","onLifeLost","onStreakMilestone","maxLives","state","setState","useState","stateRef","useRef","useEffect","timer","prev","newTimeLeft","startRound","useCallback","endRound","isSuccessful","newState","noteCorrect","newCorrect","newCompleted","newStreak","consecutiveWrong","roundComplete","noteIncorrect","newIncorrect","newLives","failedByLives","failedByConsecutive","roundFailed","resetRound","version","createExtendedExponentialRampToValueAutomationEvent","endTime","insertTime","createExtendedLinearRampToValueAutomationEvent","createSetValueAutomationEvent","startTime","createSetValueCurveAutomationEvent","values","getTargetValueAtTime","time","valueAtStartTime","target","timeConstant","isExponentialRampToValueAutomationEvent","automationEvent","isLinearRampToValueAutomationEvent","isAnyRampToValueAutomationEvent","isSetValueAutomationEvent","isSetValueCurveAutomationEvent","getValueOfAutomationEventAtIndexAtTime","automationEvents","defaultValue","getEndTimeAndValueOfPreviousAutomationEvent","currentAutomationEvent","nextAutomationEvent","isCancelAndHoldAutomationEvent","isCancelScheduledValuesAutomationEvent","getEventTime","getExponentialRampValueAtTime","getLinearRampValueAtTime","interpolateValue","theoreticIndex","lowerIndex","upperIndex","getValueCurveValueAtTime","isSetTargetAutomationEvent","AutomationEventList","eventTime","removedAutomationEvent","lastAutomationEvent","startValue","truncatedAutomationEvent","ratio","fraction","factor","previousAutomationEvent","persistentAutomationEvent","remainingAutomationEvents","firstRemainingAutomationEvent","indexOfNextEvent","indexOfCurrentEvent","createCancelAndHoldAutomationEvent","cancelTime","createCancelScheduledValuesAutomationEvent","createExponentialRampToValueAutomationEvent","createLinearRampToValueAutomationEvent","createSetTargetAutomationEvent","createAbortError","createAddActiveInputConnectionToAudioNode","insertElementInSet","activeInputs","source","eventListener","ignoreDuplicates","activeInputConnection","createAddAudioNodeConnections","audioNodeConnectionsStore","audioNode","audioNodeRenderer","nativeAudioNode","createAddAudioParamConnections","audioParamConnectionsStore","audioParam","audioParamRenderer","ACTIVE_AUDIO_NODE_STORE","AUDIO_NODE_CONNECTIONS_STORE","AUDIO_NODE_STORE","AUDIO_PARAM_CONNECTIONS_STORE","AUDIO_PARAM_STORE","CONTEXT_STORE","EVENT_LISTENERS","CYCLE_COUNTERS","NODE_NAME_TO_PROCESSOR_CONSTRUCTOR_MAPS","NODE_TO_PROCESSOR_MAPS","handler","isConstructible","constructible","proxy","IMPORT_STATEMENT_REGEX","splitImportStatements","url","importStatements","sourceWithoutImportStatements","unresolvedUrl","importStatementWithResolvedUrl","verifyParameterDescriptors","parameterDescriptors","verifyProcessorCtor","processorCtor","createAddAudioWorkletModule","cacheTestResult","createNotSupportedError","evaluateSource","exposeCurrentFrameAndCurrentTime","fetchSource","getNativeContext","getOrCreateBackupOfflineAudioContext","isNativeOfflineAudioContext","nativeAudioWorkletNodeConstructor","ongoingRequests","resolvedRequests","testAudioWorkletProcessorPostMessageSupport","window","context","moduleURL","resolvedRequestsOfContext","ongoingRequestsOfContext","promiseOfOngoingRequest","nativeContext","promise","absoluteUrl","wrappedSource","evaluateAudioWorkletGlobalScope","nodeNameToProcessorConstructorMap","isSupportingPostMessage","currentIndex","blob","backupOfflineAudioContext","nativeContextOrBackupOfflineAudioContext","updatedResolvedRequestsOfContext","updatedOngoingRequestsOfContext","getValueForKey","map","key","pickElementFromSet","predicate","matchingElements","matchingElement","deletePassiveInputConnectionToAudioNode","passiveInputs","passiveInputConnections","matchingConnection","passiveInputConnection","getEventListenersOfAudioNode","setInternalStateToActive","isAudioWorkletNode","setInternalStateToPassive","setInternalStateToPassiveWhenNecessary","connections","createAddConnectionToAudioNode","addActiveInputConnectionToAudioNode","addPassiveInputConnectionToAudioNode","connectNativeAudioNodeToNativeAudioNode","deleteActiveInputConnectionToAudioNode","disconnectNativeAudioNodeFromNativeAudioNode","getAudioNodeConnections","getAudioNodeTailTime","getNativeAudioNode","isActiveAudioNode","isPartOfACycle","isPassiveAudioNode","tailTimeTimeoutIds","destination","isOffline","outputs","eventListeners","isActive","nativeDestinationAudioNode","nativeSourceAudioNode","partialConnection","tailTime","tailTimeTimeoutId","outputConnection","createAddPassiveInputConnectionToAudioNode","createAddSilentConnection","createNativeGainNode","nativeAudioScheduledSourceNode","nativeGainNode","disconnect","createAddUnrenderedAudioWorkletNode","getUnrenderedAudioWorkletNodes","audioWorkletNode","DEFAULT_OPTIONS","createAnalyserNodeConstructor","audionNodeConstructor","createAnalyserNodeRenderer","createIndexSizeError","createNativeAnalyserNode","mergedOptions","nativeAnalyserNode","analyserNodeRenderer","maxDecibels","minDecibels","array","isOwnedByContext","createAnalyserNodeRendererFactory","renderInputsOfAudioNode","renderedNativeAnalyserNodes","createAnalyserNode","nativeOfflineAudioContext","renderedNativeAnalyserNode","testAudioBufferCopyChannelMethodsOutOfBoundsSupport","nativeAudioBuffer","wrapAudioBufferGetChannelDataMethod","audioBuffer","getChannelData","channel","createAudioBufferConstructor","audioBufferStore","nativeAudioBufferConstructor","nativeOfflineAudioContextConstructor","testNativeAudioBufferConstructorSupport","wrapAudioBufferCopyChannelMethods","wrapAudioBufferCopyChannelMethodsOutOfBounds","AudioBuffer","numberOfChannels","instance","MOST_NEGATIVE_SINGLE_FLOAT","MOST_POSITIVE_SINGLE_FLOAT","createAudioBufferSourceNodeConstructor","audioNodeConstructor","createAudioBufferSourceNodeRenderer","createAudioParam","createInvalidStateError","createNativeAudioBufferSourceNode","wrapEventListener","nativeAudioBufferSourceNode","audioBufferSourceNodeRenderer","wrappedListener","nativeOnEnded","when","offset","resetInternalStateToPassive","createAudioBufferSourceNodeRendererFactory","connectAudioParam","renderAutomation","renderedNativeAudioBufferSourceNodes","stop","createAudioBufferSourceNode","nativeAudioBufferSourceNodeIsOwnedByContext","renderedNativeAudioBufferSourceNode","isAudioBufferSourceNode","isBiquadFilterNode","isConstantSourceNode","isGainNode","isOscillatorNode","isStereoPannerNode","getAudioParamConnections","deactivateActiveAudioNodeInputConnections","trace","audioParams","audioParamConnections","deactivateAudioGraph","isValidLatencyHint","latencyHint","createAudioContextConstructor","baseAudioContextConstructor","createUnknownError","mediaElementAudioSourceNodeConstructor","mediaStreamAudioDestinationNodeConstructor","mediaStreamAudioSourceNodeConstructor","mediaStreamTrackAudioSourceNodeConstructor","nativeAudioContextConstructor","nativeAudioContext","revokeState","mediaElement","mediaStream","mediaStreamTrack","resolve","reject","resolvePromise","createAudioDestinationNodeConstructor","createAudioDestinationNodeRenderer","createNativeAudioDestinationNode","channelCount","nativeAudioDestinationNode","audioDestinationNodeRenderer","renderedNativeAudioDestinationNodes","createAudioDestinationNode","renderedNativeAudioDestinationNode","createAudioListenerFactory","createNativeChannelMergerNode","createNativeConstantSourceNode","createNativeScriptProcessorNode","getFirstSample","overwriteAccessors","nativeListener","createFakeAudioParams","channelMergerNode","isScriptProcessorNodeCreated","lastOrientation","lastPosition","createScriptProcessorNode","scriptProcessorNode","inputBuffer","positon","createSetOrientation","createSetPosition","createFakeAudioParam","initialValue","setValue","constantSourceNode","cancelAndHoldAtTime","args","cancelScheduledValues","exponentialRampToValueAtTime","linearRampToValueAtTime","setTargetAtTime","setValueAtTime","setValueCurveAtTime","forwardX","forwardY","forwardZ","positionX","positionY","positionZ","upX","upY","upZ","isAudioNode","audioNodeOrAudioParam","isAudioNodeOutputConnection","lmnt","addActiveInputConnectionToAudioParam","addPassiveInputConnectionToAudioParam","isNativeAudioNodeFaker","nativeAudioNodeOrNativeAudioNodeFaker","fakeNativeDestinationAudioNode","deleteActiveInputConnection","activeInputConnections","deleteActiveInputConnectionToAudioParam","deleteEventListenerOfAudioNode","deletePassiveInputConnectionToAudioParam","getNativeAudioParam","testAudioNodeDisconnectMethodSupport","analyzer","dummy","ones","channelData","chnnlDt","sample","visitEachAudioNodeOnce","cycles","visitor","counts","cycle","count","isNativeAudioNode","nativeAudioNodeOrAudioParam","wrapAudioNodeDisconnectMethod","connect","returnValue","connectionsToDestination","connection","destinationOrOutput","filteredConnections","addConnectionToAudioParamOfAudioContext","nativeAudioParam","deleteInputConnectionOfAudioNode","deleteInputConnectionOfAudioParam","deleteInputsOfAudioNode","listener","deleteInputsOfAudioParam","deleteAnyConnection","audioNodeConnectionsOfSource","destinations","deleteConnectionAtOutput","deleteConnectionToDestination","createAudioNodeConstructor","addAudioNodeConnections","addConnectionToAudioNode","createIncrementCycleCounter","createInvalidAccessError","decrementCycleCounter","detectCycles","eventTargetConstructor","isNativeAudioContext","isNativeAudioParam","isPassive","createAudioParamFactory","addAudioParamConnections","audioParamAudioNodeStore","audioParamStore","createAudioParamRenderer","setValueAtTimeUntilPossible","isAudioParamOfOfflineAudioContext","maxValue","minValue","automationEventList","previousLastEvent","currentLastEvent","currentTime","convertedValues","firstSample","lastSample","numberOfInterpolatedValues","interpolatedValues","timeOfLastSample","ReadOnlyMap","parameters","thisArg","createAudioWorkletNodeConstructor","addUnrenderedAudioWorkletNode","createAudioWorkletNodeRenderer","createNativeAudioWorkletNode","getBackupOfflineAudioContext","sanitizeAudioWorkletNodeOptions","setActiveAudioWorkletNodeInputs","testAudioWorkletNodeOptionsClonability","processorConstructor","nativeAudioWorkletNode","audioWorkletNodeRenderer","nm","nativeOnProcessorError","copyFromChannel","parent","channelNumber","bufferOffset","slicedInput","copyToChannel","createNestedArrays","y","arrays","getAudioWorkletProcessor","nodeToProcessorMap","processBuffer","renderedBuffer","outputChannelCount","numberOfInputChannels","numberOfOutputChannels","processedBuffer","audioNodeConnections","audioWorkletProcessor","inputs","prmtrs","potentiallyEmptyInputs","activeSourceFlag","outputChannelSplitterNodeOutput","createAudioWorkletNodeRendererFactory","connectMultipleOutputs","createNativeChannelSplitterNode","deleteUnrenderedAudioWorkletNode","disconnectMultipleOutputs","renderNativeOfflineAudioContext","renderedNativeAudioNodes","processedBufferPromise","createAudioNode","nativeOutputNodes","nativeAudioWorkletNodeIsOwnedByContext","outputChannelSplitterNode","outputChannelMergerNodes","outputGainNode","numberOfParameters","partialOfflineAudioContext","gainNodes","inputChannelSplitterNodes","constantSourceNodes","inputChannelMergerNode","gainNode","audioBufferSourceNode","outputChannelMergerNode","renderedNativeAudioWorkletNodeOrGainNode","createBaseAudioContextConstructor","addAudioWorkletModule","analyserNodeConstructor","audioBufferConstructor","audioBufferSourceNodeConstructor","biquadFilterNodeConstructor","channelMergerNodeConstructor","channelSplitterNodeConstructor","constantSourceNodeConstructor","convolverNodeConstructor","decodeAudioData","delayNodeConstructor","dynamicsCompressorNodeConstructor","gainNodeConstructor","iIRFilterNodeConstructor","minimalBaseAudioContextConstructor","oscillatorNodeConstructor","pannerNodeConstructor","periodicWaveConstructor","stereoPannerNodeConstructor","waveShaperNodeConstructor","_nativeContext","numberOfInputs","numberOfOutputs","maxDelayTime","feedforward","feedback","real","imag","constraints","audioData","successCallback","errorCallback","createBiquadFilterNodeConstructor","createBiquadFilterNodeRenderer","createNativeBiquadFilterNode","setAudioNodeTailTime","nativeBiquadFilterNode","biquadFilterNodeRenderer","frequencyHz","magResponse","phaseResponse","createBiquadFilterNodeRendererFactory","renderedNativeBiquadFilterNodes","createBiquadFilterNode","nativeBiquadFilterNodeIsOwnedByContext","renderedNativeBiquadFilterNode","createCacheTestResult","ongoingTests","testResults","tester","test","cachedTestResult","ongoingTest","synchronousTestResult","finalTestResult","createChannelMergerNodeConstructor","createChannelMergerNodeRenderer","nativeChannelMergerNode","channelMergerNodeRenderer","createChannelMergerNodeRendererFactory","renderedNativeAudioNode","createChannelSplitterNodeConstructor","createChannelSplitterNodeRenderer","sanitizeChannelSplitterOptions","nativeChannelSplitterNode","channelSplitterNodeRenderer","createChannelSplitterNodeRendererFactory","createConnectAudioParam","renderInputsOfAudioParam","createConnectMultipleOutputs","outputAudioNodes","outputAudioNode","createConnectedNativeAudioBufferSourceNodeFactory","createConstantSourceNodeConstructor","createConstantSourceNodeRendererFactory","nativeConstantSourceNode","constantSourceNodeRenderer","renderedNativeConstantSourceNodes","createConstantSourceNode","nativeConstantSourceNodeIsOwnedByContext","renderedNativeConstantSourceNode","createConvertNumberToUnsignedLong","unit32Array","createConvolverNodeConstructor","createConvolverNodeRenderer","createNativeConvolverNode","nativeConvolverNode","convolverNodeRenderer","createConvolverNodeRendererFactory","renderedNativeConvolverNodes","createConvolverNode","renderedNativeConvolverNode","createCreateNativeOfflineAudioContext","createDataCloneError","detachArrayBuffer","arrayBuffer","port1","port2","closeAndResolve","createDecodeAudioData","createEncodingError","detachedArrayBuffers","isNativeContext","testPromiseSupport","anyContext","complete","fail","createDecrementCycleCounter","cycleCounters","cycleCounter","nativeDestinationAudioParam","createDelayNodeConstructor","createDelayNodeRenderer","createNativeDelayNode","nativeDelayNode","delayNodeRenderer","createDelayNodeRendererFactory","renderedNativeDelayNodes","createDelayNode","nativeDelayNodeIsOwnedByContext","renderedNativeDelayNode","createDeleteActiveInputConnectionToAudioNode","createDeleteUnrenderedAudioWorkletNode","isDelayNode","createDetectCycles","chain","nextLink","mergedCycles","nestedCycles","getOutputAudioNodeAtIndex","createDisconnectMultipleOutputs","createDynamicsCompressorNodeConstructor","createDynamicsCompressorNodeRenderer","createNativeDynamicsCompressorNode","nativeDynamicsCompressorNode","dynamicsCompressorNodeRenderer","previousChannelCount","createDynamicsCompressorNodeRendererFactory","renderedNativeDynamicsCompressorNodes","createDynamicsCompressorNode","nativeDynamicsCompressorNodeIsOwnedByContext","renderedNativeDynamicsCompressorNode","createEvaluateSource","head","script","originalOnErrorHandler","removeErrorEventListenerAndRevokeUrl","lineno","colno","createEventTargetConstructor","_nativeEventTarget","wrappedEventListener","createExposeCurrentFrameAndCurrentTime","createFetchSource","response","createGainNodeConstructor","createGainNodeRenderer","gainNodeRenderer","createGainNodeRendererFactory","renderedNativeGainNodes","createGainNode","nativeGainNodeIsOwnedByContext","renderedNativeGainNode","createGetActiveAudioWorkletNodeInputs","activeAudioWorkletNodeInputsStore","createGetAudioNodeRenderer","createGetAudioNodeTailTime","audioNodeTailTimeStore","createGetAudioParamRenderer","createGetBackupOfflineAudioContext","backupOfflineAudioContextStore","createGetNativeContext","contextStore","createGetOrCreateBackupOfflineAudioContext","createGetUnrenderedAudioWorkletNodes","unrenderedAudioWorkletNodeStore","unrenderedAudioWorkletNodes","wrapIIRFilterNodeGetFrequencyResponseMethod","nativeIIRFilterNode","getFrequencyResponse","createIIRFilterNodeConstructor","createNativeIIRFilterNode","createIIRFilterNodeRenderer","iirFilterNodeRenderer","filterBuffer","feedbackLength","feedforwardLength","minLength","xBuffer","yBuffer","bufferIndex","bufferLength","filterFullBuffer","convertedFeedback","convertedFeedforward","filteredBuffer","createIIRFilterNodeRendererFactory","filteredBufferPromise","nativeIIRFilterNodeIsOwnedByContext","createIncrementCycleCounterFactory","createIsAnyAudioContext","anything","createIsAnyAudioNode","audioNodeStore","createIsAnyAudioParam","createIsAnyOfflineAudioContext","createIsNativeAudioContext","createIsNativeAudioNode","createIsNativeAudioParam","createIsNativeContext","createIsNativeOfflineAudioContext","createIsSecureContext","createMediaElementAudioSourceNodeConstructor","createNativeMediaElementAudioSourceNode","nativeMediaElementAudioSourceNode","createMediaStreamAudioDestinationNodeConstructor","createNativeMediaStreamAudioDestinationNode","nativeMediaStreamAudioDestinationNode","createMediaStreamAudioSourceNodeConstructor","createNativeMediaStreamAudioSourceNode","nativeMediaStreamAudioSourceNode","createMediaStreamTrackAudioSourceNodeConstructor","createNativeMediaStreamTrackAudioSourceNode","nativeMediaStreamTrackAudioSourceNode","createMinimalBaseAudioContextConstructor","audioDestinationNodeConstructor","createAudioListener","nativeOnStateChange","uint32Array","createMonitorConnections","whenConnected","whenDisconnected","wasDisconnected","wasConnected","isDisconnected","assignNativeAudioNodeOption","option","assignNativeAudioNodeOptions","testAnalyserNodeGetFloatTimeDomainDataMethodSupport","wrapAnalyserNodeGetFloatTimeDomainDataMethod","byteTimeDomainData","createNativeAnalyserNodeFactory","createNativeAudioBufferConstructor","assignNativeAudioNodeAudioParamValue","wrapAudioBufferSourceNodeStartMethodConsecutiveCalls","isScheduled","wrapAudioScheduledSourceNodeStartMethodNegativeParameters","wrapAudioScheduledSourceNodeStopMethodNegativeParameters","createNativeAudioBufferSourceNodeFactory","addSilentConnection","testAudioBufferSourceNodeStartMethodConsecutiveCallsSupport","testAudioBufferSourceNodeStartMethodOffsetClampingSupport","testAudioBufferSourceNodeStopMethodNullifiedBufferSupport","testAudioScheduledSourceNodeStartMethodNegativeParametersSupport","testAudioScheduledSourceNodeStopMethodConsecutiveCallsSupport","testAudioScheduledSourceNodeStopMethodNegativeParametersSupport","wrapAudioBufferSourceNodeStartMethodOffsetClampling","wrapAudioBufferSourceNodeStopMethodNullifiedBuffer","wrapAudioScheduledSourceNodeStopMethodConsecutiveCalls","createNativeAudioContextConstructor","createNativeAudioDestinationNodeFactory","isNodeOfNativeOfflineAudioContext","createNativeAudioWorkletNodeConstructor","testClonabilityOfAudioWorkletNodeOptions","audioWorkletNodeOptions","createNativeAudioWorkletNodeFactory","createNativeAudioWorkletNodeFaker","monitorConnections","baseLatency","patchedEventListeners","onprocessorerror","addEventListener","unpatchedEventListener","patchedEventListener","removeEventListener","computeBufferSize","cloneAudioWorkletNodeOptions","createAudioWorkletProcessorPromise","clonedAudioWorkletNodeOptions","createAudioWorkletProcessor","audioWorkletProcessorPromise","createNativeAudioWorkletNodeFakerFactory","getActiveAudioWorkletNodeInputs","messageChannel","bufferSize","parameterMap","channelInterpretation","nativeAudioWorkletNodeFaker","onmessage","dWrkltPrcssr","disconnectOutputsGraph","activeInputIndexes","outputBuffer","isConnected","disconnectFakeGraph","connectFakeGraph","createNativeChannelMergerNodeFactory","wrapChannelMergerNode","wrapChannelSplitterNode","channelSplitterNode","createNativeConstantSourceNodeFactory","createNativeConstantSourceNodeFaker","interceptConnections","original","interceptor","createNativeConstantSourceNodeFakerFactory","audioNodeOptions","nativeConstantSourceNodeFaker","createNativeConvolverNodeFactory","createNativeDynamicsCompressorNodeFactory","createNativeIIRFilterNodeFactory","createNativeIIRFilterNodeFaker","divide","multiply","evaluatePolynomial","coefficient","z","createNativeIIRFilterNodeFakerFactory","channelCountMode","bufferIndexes","xBuffers","yBuffers","nyquist","omega","numerator","audioStreamTracks","filteredAudioStreamTracks","createNativeMediaStreamTrackAudioSourceNodeFactory","createNativeOfflineAudioContextConstructor","createNativeOscillatorNodeFactory","nativeOscillatorNode","createNativePannerNodeFactory","createNativePannerNodeFaker","nativePannerNode","createNativePannerNodeFakerFactory","createNativeWaveShaperNode","coneInnerAngle","coneOuterAngle","coneOuterGain","distanceModel","maxDistance","orientationX","orientationY","orientationZ","panningModel","refDistance","rolloffFactor","pannerNode","SINGLE_CHANNEL_OPTIONS","inputGainNode","orientationXGainNode","orientationYGainNode","orientationZGainNode","positionXGainNode","positionYGainNode","positionZGainNode","waveShaperNode","nativePannerNodeFaker","createNativePeriodicWaveFactory","disableNormalization","convertedImag","convertedReal","nativePeriodicWave","createNativeStereoPannerNodeFactory","createNativeStereoPannerNodeFaker","nativeStereoPannerNode","createNativeStereoPannerNodeFakerFactory","DC_CURVE","HALF_PI","SINGLE_CHANNEL_WAVE_SHAPER_OPTIONS","buildInternalGraphForMono","panGainNode","leftWaveShaperCurve","rightWaveShaperCurve","leftGainNode","leftWaveShaperNode","panWaveShaperNode","rightGainNode","rightWaveShaperNode","buildInternalGraphForStereo","leftInputForLeftOutputWaveShaperCurve","leftInputForRightOutputWaveShaperCurve","rightInputForLeftOutputWaveShaperCurve","rightInputForRightOutputWaveShaperCurve","centerIndex","leftInputForLeftOutputGainNode","leftInputForLeftOutputWaveShaperNode","leftInputForRightOutputGainNode","leftInputForRightOutputWaveShaperNode","rightInputForLeftOutputGainNode","rightInputForLeftOutputWaveShaperNode","rightInputForRightOutputGainNode","rightInputForRightOutputWaveShaperNode","buildInternalGraph","pan","connectGraph","disconnectGraph","nativeStereoPannerNodeFakerFactory","createNativeWaveShaperNodeFactory","createConnectedNativeAudioBufferSourceNode","createNativeWaveShaperNodeFaker","isDCCurve","nativeWaveShaperNode","curve","disconnectNativeAudioBufferSourceNode","createNativeWaveShaperNodeFakerFactory","oversample","negativeWaveShaperNode","positiveWaveShaperNode","invertGainNode","revertGainNode","unmodifiedCurve","nativeWaveShaperNodeFaker","curveLength","negativeCurve","positiveCurve","createOfflineAudioContextConstructor","createNativeOfflineAudioContext","startRendering","delayStateChangeEvent","createOscillatorNodeConstructor","createNativeOscillatorNode","createOscillatorNodeRenderer","oscillatorNodeRenderer","periodicWave","createOscillatorNodeRendererFactory","renderedNativeOscillatorNodes","createOscillatorNode","nativeOscillatorNodeIsOwnedByContext","renderedNativeOscillatorNode","createPannerNodeConstructor","createNativePannerNode","createPannerNodeRenderer","pannerNodeRenderer","createPannerNodeRendererFactory","renderedBufferPromise","commonAudioNodeOptions","commonNativePannerNodeOptions","nativePannerNodeIsOwnedByContext","nativeConstantSourceNodes","channelDatas","gateGainNode","partialPannerNode","renderedNativeGainNodeOrNativePannerNode","createPeriodicWaveConstructor","createNativePeriodicWave","periodicWaveStore","sanitizePeriodicWaveOptions","PeriodicWave","createRenderAutomation","getAudioParamRenderer","createRenderInputsOfAudioNode","getAudioNodeRenderer","allRenderingPromises","renderingPromises","createRenderInputsOfAudioParam","createRenderNativeOfflineAudioContext","testOfflineAudioContextCurrentTimeSupport","isOfflineAudioContextCurrentTimeSupported","createSetActiveAudioWorkletNodeInputs","createSetAudioNodeTailTime","createStartRendering","createStereoPannerNodeConstructor","createNativeStereoPannerNode","createStereoPannerNodeRenderer","stereoPannerNodeRenderer","createStereoPannerNodeRendererFactory","renderedNativeStereoPannerNodes","createStereoPannerNode","nativeStereoPannerNodeIsOwnedByContext","renderedNativeStereoPannerNode","createTestAudioBufferConstructorSupport","createTestAudioWorkletProcessorPostMessageSupport","offlineAudioContext","isEmittingMessageEvents","isEmittingProcessorErrorEvents","oscillator","createTestOfflineAudioContextCurrentTimeSupport","createWaveShaperNodeConstructor","createWaveShaperNodeRenderer","waveShaperNodeRenderer","createWaveShaperNodeRendererFactory","renderedNativeWaveShaperNodes","createWaveShaperNode","renderedNativeWaveShaperNode","createWindow","createWrapAudioBufferCopyChannelMethods","convertNumberToUnsignedLong","channelNumberAsNumber","bufferOffsetAsNumber","audioBufferLength","destinationLength","sourceLength","createWrapAudioBufferCopyChannelMethodsOutOfBounds","createWrapAudioBufferSourceNodeStopMethodNullifiedBuffer","nullifiedBuffer","createWrapChannelMergerNode","object","property","createGetter","createSetter","prototype","wrapAudioBufferSourceNodeStartMethodOffsetClamping","clampedOffset","disconnectGainNode","isStopped","descriptor","createConstantSourceNodeRenderer","isSecureContext","audioContextConstructor","audioWorkletNodeConstructor","offlineAudioContextConstructor","isAnyAudioContext","isAnyAudioNode","isAnyAudioParam","isAnyOfflineAudioContext","isUndef","arg","isDefined","isFunction","isNumber","isObject","isBoolean","isArray","isString","isNote","assert","statement","assertRange","gte","lte","assertContextRunning","warn","isInsideScheduledCallback","printedScheduledWarning","enterScheduledCallback","insideCallback","assertUsedScheduleTime","defaultLogger","log","createAudioContext","stdAudioContext","createOfflineAudioContext","channels","stdOfflineAudioContext","theWindow","hasAudioContext","createAudioWorkletNode","stdAudioWorkletNode","Ticker","updateInterval","contextSampleRate","blobUrl","worker","isAudioParam","isOfflineAudioContext","isAudioContext","isAudioBuffer","noCopy","deepMerge","sources","deepEquals","arrayA","arrayB","optionsFromArguments","defaults","argsArray","keys","objKey","opts","getDefaultsFromInstance","defaultArg","given","fallback","omitFromObject","obj","omit","prop","Tone","EPSILON","GT","GTE","EQ","LT","clamp","Timeline","lastValue","diff","param","after","beginning","midPoint","nextEvent","testEvent","lowerBound","upperBound","notifyNewContext","onContextInit","cb","initializeContext","ctx","notifyCloseContext","onContextClose","closeContext","Emitter","eventName","boundCallback","eventList","constr","BaseContext","Context","_b","feedForward","stream","l","__awaiter","val","constant","timeout","id","intervalFn","DummyContext","_numberOfChannels","_length","_sampleRate","_numberOfInputs","_numberOfOutputs","_maxDelayTime","_feedForward","_feedback","_real","_imag","_constraints","_stream","_element","_audioData","_name","_options","_url","_fn","_timeout","_id","_interval","_val","_d","readOnly","writable","noOp","ToneAudioBuffer","getContext","doneLoading","isMultidimensional","multiChannelArray","chanNum","outputArray","numChannels","channelArray","ret","startSamples","endSamples","retBuffer","rev","baseUrl","extensions","extension","OfflineContext","asynchronous","yieldEvery","done","dummyContext","globalContext","setContext","disposeOld","printString","dbToGain","gainToDb","gain","intervalToFrequencyRatio","A4","getA4","setA4","ftom","ftomf","mtof","TimeBaseClass","units","dot","numericValue","scalar","s","quantity","expr","matching","beats","seconds","ticks","TimeClass","capture","quantTo","subdiv","percent","subdivision","testNotations","closest","closestSeconds","notation","notationSeconds","quarterTime","quarters","measures","sixteenths","sixteenthString","FrequencyClass","noteNumber","noteToScaleIndex","scaleIndexToNote","Frequency","TransportTimeClass","ToneWithContext","attribute","member","StateTimeline","initial","Param","computedTime","before","previous","previousVal","beforeValue","currentVal","rampTime","scaling","startingValue","segTime","valueAtTime","previousEvent","subdivisions","t0","v0","v1","t1","ToneAudioNode","node","nodeList","outputNum","inputNum","nodes","connectSeries","first","current","srcNode","dstNode","outputNumber","inputNumber","Gain","OneShotSource","fadeInTime","fadeOutTime","additionalTail","disposeCallback","ToneConstantSource","Signal","connectSignal","convert","overridden","signal","TickParam","computedValue","prevEvent","segments","rampVal","ticksUntilTime","computedVal","segmentDur","val0","val1","onTheLineEvent","currentTick","tick","delta","sol1","sol2","computedDuration","startTicks","TickSignal","TickSource","stopEvent","memoizedEvent","tmpEvent","lastState","elapsedTicks","eventToMemoize","e","periodStartTime","offsetEvent","elapsedSeconds","absoluteTicks","lastStateEvent","maxStartTime","ticksAtStart","nextTickTime","Volume","mute","DestinationClass","ListenerClass","ToneAudioBuffers","onerror","MidiClass","TicksClass","DrawClass","IntervalTimeline","IntervalNode","results","replacement","balance","temp","isLeftChild","pivotNode","allNodes","low","high","point","TimelineValue","SignalOperator","WaveShaper","mapping","oversampling","isOverSampleType","Pow","exponent","TransportEvent","transport","tickDuration","TransportRepeatEvent","TransportClass","tickTime","progress","amount","eventId","item","timeline","computedAfter","offsetTicks","timeSig","startPosition","endPosition","loop","remainingTick","ppq","transportPos","remainingTicks","sourceValue","scaleFactor","scaleBefore","reciprocal","scaleAfter","ratioSignal","syncedSignal","Source","sched","stateEvent","startOffset","ToneBufferSource","computedOffset","loopEnd","loopStart","loopDuration","computedDur","generateWaveform","ToneOscillatorNode","Oscillator","description","oscProps","isBasicType","partials","wave","baseType","p","partial","fullPartials","phase","periodicWaveSize","partialCount","piFactor","twoPi","testPositions","AudioToGain","Multiply","AMOscillator","FMOscillator","PulseOscillator","FatOscillator","osc","iterator","spread","PWMOscillator","OmniOscillatorSourceMap","OmniOscillator","prefix","oscType","OscConstructor","oldOsc","sType","sourceType","mType","valueMap","propertyKey","newValue","timeRange","Player","origDuration","__decorate","Envelope","direction","curveName","EnvelopeCurves","curveDef","attack","decay","currentValue","attackRate","decayValue","decayStart","release","attackPortion","envelopeDuration","sustainTime","totalDuration","clone","cosineCurve","rippleCurve","rippleCurveFreq","sineWave","stairsCurve","steps","sineCurve","bounceCurve","invertCurve","reverseCurve","Instrument","changed","method","timePosition","originalMethod","Monophonic","computedFrequency","portTime","AmplitudeEnvelope","Synth","computedAttack","computedDecay","MembraneSynth","hertz","maxNote","workletContext","addToWorklet","classOrFunction","registerProcessor","classDesc","processor","toneAudioWorkletProcessor","singleIOProcess","delayLine","workletName","feedbackCombFilter","PolySynth","activeVoiceIndex","firstAvail","released","durationSeconds","sanitizedOptions","Sampler","urlMap","mid","midiFloat","remainder","difference","closestNote","playbackRate","Panner","bitCrusherWorklet","Solo","solo","PanVol","Channel","bus","sendKnob","NOTE_NAMES","KEY_TO_NOTE_OFFSET","VirtualKeyboard","onNotePlay","enabled","startOctave","octaveCount","isAudioReady","setIsAudioReady","activeNotes","setActiveNotes","synthRef","Tone.PolySynth","Tone.Synth","getMidiNote","noteOffset","getNoteName","playNote","Tone.getContext","Tone.start","Tone.Frequency","next","handleKeyDown","renderOctave","whiteKeyNotes","blackKeyNotes","whiteKeyWidth","blackKeyWidth","jsxs","jsx","displayName","position","leftOffset","octaves","Card","CardHeader","CardTitle","Badge","CardContent","RadialTimer","percentage","radius","circumference","strokeDashoffset","isLow","isMedium","LivesDisplay","lives","className","isAlive","isLastLife","motion","AnimatePresence","ScoreHud","roundState","Trophy","Fragment","Target","mapCentsToPercent","smoothValue","alpha","FLAT_COLOR","INTUNE_COLOR","SHARP_COLOR","polarToCartesian","cx","cy","r","angleDeg","rad","describeArcBand","rOuter","rInner","startAngle","endAngle","outerStart","outerEnd","innerStart","innerEnd","largeArc","GaugeSVG","React","flatBand","inTuneBand","sharpBand","trackBand","needleAngle","needleTip","needleBase1","needleBase2","inner","outer","PitchGaugeComponent","inTuneThreshold","smoothingFactor","subdueNote","smoothedCents","setSmoothedCents","animationFrameRef","isAnimating","updateSmoothedValue","prevSmoothed","baseAlpha","adaptiveFactor","useMemo","displayCents","inTune","PitchGauge","prevProps","nextProps","NotationCard","isMicrophoneInstrument","staffContainerRef","tabContainerRef","detectedPitch","pitchSensitivity","pitchSmoothing","lastDetectedNote","onTabOrientationChange","showTabOrientationToggle","Button","Zap","Volume2","ScoreSummary","scoreResult","correctCount","totalNotes","onContinue","onRetry","showConfetti","showConfettiEffect","setShowConfettiEffect","windowSize","setWindowSize","updateSize","rankInfo","accuracy","Confetti","CardDescription","ScoreSummaryModal","isOpen","PlayRoute","navigate","useNavigate","search","Route","useSearch","selectedAudioDevice","midiConnected","setMidiConnected","microphoneActive","setMicrophoneActive","sessionActive","setSessionActive","setStats","incorrect","avgTime","setFeedback","setCurrentNote","setLastDetectedNote","showScoreSummary","setShowScoreSummary","setDetectedPitch","setTabOrientation","sessionActiveRef","currentNoteRef","instrumentRef","clefRef","gameModeRef","roundActionsRef","roundStateRef","midiManager","audioManager","audioPlayback","lastIncorrectFeedbackRef","audioInitAttemptedRef","noteValidatedRef","correctDetectionsRef","lastDetectionTimeRef","noteRange","handleRoundComplete","incorrectCount","bestStreak","roundScore","currentScore","livesRemaining","toast","success","handleRoundFail","handleLifeLost","livesLeft","warning","handleStreakMilestone","roundActions","nextNote","handleMidiDeviceChange","_event","getInputDevices","handlePitchDetected","instrumentConfig","validation","octaveFlexible","Date","showFeedback","nextNoteRef","handleMidiNoteOn","setTimeout","isComplete","init","on","initManagers","disconnectDevice","cleanup","SILENCE_THRESHOLD_MS","checkInterval","setInterval","timeSinceLastDetection","clearInterval","getAudioInputDevices","startListening","initAudio","startSession","clearTimeout","stopSession","timestamp","X","opacity","delay","Math","pow","notesRequired","undefined"],"mappings":"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","x_google_ignoreList":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,24,25,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,85,86,87,88,89,90,91,92,93,94,95,96,97,98,99,100,101,102,103,104,105,106,107,108,109,110,111,112,113,114,115,116,117,118,119,120,121,122,123,124,125,126,127,128,129,130,131,132,133,134,135,136,137,138,139,140,141,142,143,144,145,146,147,148,149,150,151,152,153,154,155,156,157,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,175,176,177,178,179,180,181,182,183,184,185,186,187,188,189,190,191,192,193,194,195,196,197,198,199,200,201,202,203,204,205,206,207,208,209,210,211,212,213,214,215,216,217,218,219,220,221,222,223,224,225,226,227,228,229,230,231,232,233,234,235,236,237,238,239,240,241,242,243,244,245,246,247,248,249,250,251,252,253,254,255,256,257,258,259,260,261,262,263,264,265,266,267,268,269,270,271,272,273,274,275,276,277,278,279,280,281,282,283,284,285,286,287,288,289,290,291,292,293,294,295,296,297,298,299,300,301,302,303,304,305,306,307,308,309,310,311,312,313,314,315,316,317,318,319,320,321,322,323,324,325,326,327,328,329,330,331,332,333,334,335,336,337,338,339,340,341,342,343,344,345,346,347,348,349,350,351,352,353,354,355,356,357,358,359,360,361,362,363,364,365,366,367,368,369,370,371,372,373,374,375,376,377,378,379,380,381,382,383,384]}