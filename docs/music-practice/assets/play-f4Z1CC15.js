import{c as zn,a as Vo,r as G,_ as je,b as on,j as P,g as lT,d as dy,e as hT,R as Us,B as ka,u as fT,f as dT,t as ls}from"./index-RP11MDmN.js";import{B as Ni,A as Cd}from"./index-DKFWcsJK.js";import{m as pT,a as q0,M as mT,b as Gu,c as gT,P as _T,S as F0,g as Lo,d as jo,v as zo,r as yT,A as $0}from"./storage-CZgyC9t8.js";import{C as Md,a as py,b as my,c as Ad,m as Bt,d as vT}from"./proxy-Dy2Df-aJ.js";/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bT=zn("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wT=zn("Flame",[["path",{d:"M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.153.433-2.294 1-3a2.5 2.5 0 0 0 2.5 2.5z",key:"96xj49"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V0=zn("Heart",[["path",{d:"M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z",key:"c3ymky"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xT=zn("SkipForward",[["polygon",{points:"5 4 15 12 5 20 5 4",key:"16p6eg"}],["line",{x1:"19",x2:"19",y1:"5",y2:"19",key:"futhcm"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gy=zn("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TT=zn("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _y=zn("Trophy",[["path",{d:"M6 9H4.5a2.5 2.5 0 0 1 0-5H6",key:"17hqa7"}],["path",{d:"M18 9h1.5a2.5 2.5 0 0 0 0-5H18",key:"lmptdp"}],["path",{d:"M4 22h16",key:"57wxv0"}],["path",{d:"M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22",key:"1nw9bq"}],["path",{d:"M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22",key:"1np0yb"}],["path",{d:"M18 2H6v7a6 6 0 0 0 12 0V2Z",key:"u46fv3"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L0=zn("Volume2",[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]]);/**
 * @license lucide-react v0.468.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ST=zn("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);var Hu,j0;function Nd(){if(j0)return Hu;j0=1;var t=Array.isArray;return Hu=t,Hu}var Yu,z0;function yy(){if(z0)return Yu;z0=1;var t=typeof Vo=="object"&&Vo&&Vo.Object===Object&&Vo;return Yu=t,Yu}var Xu,B0;function Bn(){if(B0)return Xu;B0=1;var t=yy(),e=typeof self=="object"&&self&&self.Object===Object&&self,n=t||e||Function("return this")();return Xu=n,Xu}var Zu,W0;function kd(){if(W0)return Zu;W0=1;var t=Bn(),e=t.Symbol;return Zu=e,Zu}var Ku,U0;function CT(){if(U0)return Ku;U0=1;var t=kd(),e=Object.prototype,n=e.hasOwnProperty,r=e.toString,i=t?t.toStringTag:void 0;function s(o){var a=n.call(o,i),c=o[i];try{o[i]=void 0;var u=!0}catch{}var l=r.call(o);return u&&(a?o[i]=c:delete o[i]),l}return Ku=s,Ku}var Qu,G0;function MT(){if(G0)return Qu;G0=1;var t=Object.prototype,e=t.toString;function n(r){return e.call(r)}return Qu=n,Qu}var Ju,H0;function Rc(){if(H0)return Ju;H0=1;var t=kd(),e=CT(),n=MT(),r="[object Null]",i="[object Undefined]",s=t?t.toStringTag:void 0;function o(a){return a==null?a===void 0?i:r:s&&s in Object(a)?e(a):n(a)}return Ju=o,Ju}var el,Y0;function Ic(){if(Y0)return el;Y0=1;function t(e){return e!=null&&typeof e=="object"}return el=t,el}var tl,X0;function vy(){if(X0)return tl;X0=1;function t(e){var n=typeof e;return e!=null&&(n=="object"||n=="function")}return tl=t,tl}var nl,Z0;function by(){if(Z0)return nl;Z0=1;var t=Rc(),e=vy(),n="[object AsyncFunction]",r="[object Function]",i="[object GeneratorFunction]",s="[object Proxy]";function o(a){if(!e(a))return!1;var c=t(a);return c==r||c==i||c==n||c==s}return nl=o,nl}var rl,K0;function AT(){if(K0)return rl;K0=1;var t=Bn(),e=t["__core-js_shared__"];return rl=e,rl}var il,Q0;function NT(){if(Q0)return il;Q0=1;var t=AT(),e=(function(){var r=/[^.]+$/.exec(t&&t.keys&&t.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""})();function n(r){return!!e&&e in r}return il=n,il}var sl,J0;function wy(){if(J0)return sl;J0=1;var t=Function.prototype,e=t.toString;function n(r){if(r!=null){try{return e.call(r)}catch{}try{return r+""}catch{}}return""}return sl=n,sl}var ol,em;function kT(){if(em)return ol;em=1;var t=by(),e=NT(),n=vy(),r=wy(),i=/[\\^$.*+?()[\]{}|]/g,s=/^\[object .+?Constructor\]$/,o=Function.prototype,a=Object.prototype,c=o.toString,u=a.hasOwnProperty,l=RegExp("^"+c.call(u).replace(i,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function h(f){if(!n(f)||e(f))return!1;var d=t(f)?l:s;return d.test(r(f))}return ol=h,ol}var al,tm;function ET(){if(tm)return al;tm=1;function t(e,n){return e==null?void 0:e[n]}return al=t,al}var cl,nm;function Qi(){if(nm)return cl;nm=1;var t=kT(),e=ET();function n(r,i){var s=e(r,i);return t(s)?s:void 0}return cl=n,cl}var ul,rm;function Oc(){if(rm)return ul;rm=1;var t=Qi(),e=t(Object,"create");return ul=e,ul}var ll,im;function RT(){if(im)return ll;im=1;var t=Oc();function e(){this.__data__=t?t(null):{},this.size=0}return ll=e,ll}var hl,sm;function IT(){if(sm)return hl;sm=1;function t(e){var n=this.has(e)&&delete this.__data__[e];return this.size-=n?1:0,n}return hl=t,hl}var fl,om;function OT(){if(om)return fl;om=1;var t=Oc(),e="__lodash_hash_undefined__",n=Object.prototype,r=n.hasOwnProperty;function i(s){var o=this.__data__;if(t){var a=o[s];return a===e?void 0:a}return r.call(o,s)?o[s]:void 0}return fl=i,fl}var dl,am;function DT(){if(am)return dl;am=1;var t=Oc(),e=Object.prototype,n=e.hasOwnProperty;function r(i){var s=this.__data__;return t?s[i]!==void 0:n.call(s,i)}return dl=r,dl}var pl,cm;function PT(){if(cm)return pl;cm=1;var t=Oc(),e="__lodash_hash_undefined__";function n(r,i){var s=this.__data__;return this.size+=this.has(r)?0:1,s[r]=t&&i===void 0?e:i,this}return pl=n,pl}var ml,um;function qT(){if(um)return ml;um=1;var t=RT(),e=IT(),n=OT(),r=DT(),i=PT();function s(o){var a=-1,c=o==null?0:o.length;for(this.clear();++a<c;){var u=o[a];this.set(u[0],u[1])}}return s.prototype.clear=t,s.prototype.delete=e,s.prototype.get=n,s.prototype.has=r,s.prototype.set=i,ml=s,ml}var gl,lm;function FT(){if(lm)return gl;lm=1;function t(){this.__data__=[],this.size=0}return gl=t,gl}var _l,hm;function xy(){if(hm)return _l;hm=1;function t(e,n){return e===n||e!==e&&n!==n}return _l=t,_l}var yl,fm;function Dc(){if(fm)return yl;fm=1;var t=xy();function e(n,r){for(var i=n.length;i--;)if(t(n[i][0],r))return i;return-1}return yl=e,yl}var vl,dm;function $T(){if(dm)return vl;dm=1;var t=Dc(),e=Array.prototype,n=e.splice;function r(i){var s=this.__data__,o=t(s,i);if(o<0)return!1;var a=s.length-1;return o==a?s.pop():n.call(s,o,1),--this.size,!0}return vl=r,vl}var bl,pm;function VT(){if(pm)return bl;pm=1;var t=Dc();function e(n){var r=this.__data__,i=t(r,n);return i<0?void 0:r[i][1]}return bl=e,bl}var wl,mm;function LT(){if(mm)return wl;mm=1;var t=Dc();function e(n){return t(this.__data__,n)>-1}return wl=e,wl}var xl,gm;function jT(){if(gm)return xl;gm=1;var t=Dc();function e(n,r){var i=this.__data__,s=t(i,n);return s<0?(++this.size,i.push([n,r])):i[s][1]=r,this}return xl=e,xl}var Tl,_m;function Pc(){if(_m)return Tl;_m=1;var t=FT(),e=$T(),n=VT(),r=LT(),i=jT();function s(o){var a=-1,c=o==null?0:o.length;for(this.clear();++a<c;){var u=o[a];this.set(u[0],u[1])}}return s.prototype.clear=t,s.prototype.delete=e,s.prototype.get=n,s.prototype.has=r,s.prototype.set=i,Tl=s,Tl}var Sl,ym;function Ed(){if(ym)return Sl;ym=1;var t=Qi(),e=Bn(),n=t(e,"Map");return Sl=n,Sl}var Cl,vm;function zT(){if(vm)return Cl;vm=1;var t=qT(),e=Pc(),n=Ed();function r(){this.size=0,this.__data__={hash:new t,map:new(n||e),string:new t}}return Cl=r,Cl}var Ml,bm;function BT(){if(bm)return Ml;bm=1;function t(e){var n=typeof e;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?e!=="__proto__":e===null}return Ml=t,Ml}var Al,wm;function qc(){if(wm)return Al;wm=1;var t=BT();function e(n,r){var i=n.__data__;return t(r)?i[typeof r=="string"?"string":"hash"]:i.map}return Al=e,Al}var Nl,xm;function WT(){if(xm)return Nl;xm=1;var t=qc();function e(n){var r=t(this,n).delete(n);return this.size-=r?1:0,r}return Nl=e,Nl}var kl,Tm;function UT(){if(Tm)return kl;Tm=1;var t=qc();function e(n){return t(this,n).get(n)}return kl=e,kl}var El,Sm;function GT(){if(Sm)return El;Sm=1;var t=qc();function e(n){return t(this,n).has(n)}return El=e,El}var Rl,Cm;function HT(){if(Cm)return Rl;Cm=1;var t=qc();function e(n,r){var i=t(this,n),s=i.size;return i.set(n,r),this.size+=i.size==s?0:1,this}return Rl=e,Rl}var Il,Mm;function Ty(){if(Mm)return Il;Mm=1;var t=zT(),e=WT(),n=UT(),r=GT(),i=HT();function s(o){var a=-1,c=o==null?0:o.length;for(this.clear();++a<c;){var u=o[a];this.set(u[0],u[1])}}return s.prototype.clear=t,s.prototype.delete=e,s.prototype.get=n,s.prototype.has=r,s.prototype.set=i,Il=s,Il}function ae(t){return function(){return t}}const Am=Math.abs,tt=Math.atan2,En=Math.cos,YT=Math.max,xi=Math.min,Mt=Math.sin,Ce=Math.sqrt,st=1e-12,or=Math.PI,Ea=or/2,ir=2*or;function XT(t){return t>1?0:t<-1?or:Math.acos(t)}function Nm(t){return t>=1?Ea:t<=-1?-Ea:Math.asin(t)}const _f=Math.PI,yf=2*_f,Sr=1e-6,ZT=yf-Sr;function Sy(t){this._+=t[0];for(let e=1,n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function KT(t){let e=Math.floor(t);if(!(e>=0))throw new Error(`invalid digits: ${t}`);if(e>15)return Sy;const n=10**e;return function(r){this._+=r[0];for(let i=1,s=r.length;i<s;++i)this._+=Math.round(arguments[i]*n)/n+r[i]}}let po=class{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?Sy:KT(e)}moveTo(e,n){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,n){this._append`L${this._x1=+e},${this._y1=+n}`}quadraticCurveTo(e,n,r,i){this._append`Q${+e},${+n},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,n,r,i,s,o){this._append`C${+e},${+n},${+r},${+i},${this._x1=+s},${this._y1=+o}`}arcTo(e,n,r,i,s){if(e=+e,n=+n,r=+r,i=+i,s=+s,s<0)throw new Error(`negative radius: ${s}`);let o=this._x1,a=this._y1,c=r-e,u=i-n,l=o-e,h=a-n,f=l*l+h*h;if(this._x1===null)this._append`M${this._x1=e},${this._y1=n}`;else if(f>Sr)if(!(Math.abs(h*c-u*l)>Sr)||!s)this._append`L${this._x1=e},${this._y1=n}`;else{let d=r-o,p=i-a,g=c*c+u*u,m=d*d+p*p,_=Math.sqrt(g),b=Math.sqrt(f),v=s*Math.tan((_f-Math.acos((g+f-m)/(2*_*b)))/2),y=v/b,w=v/_;Math.abs(y-1)>Sr&&this._append`L${e+y*l},${n+y*h}`,this._append`A${s},${s},0,0,${+(h*d>l*p)},${this._x1=e+w*c},${this._y1=n+w*u}`}}arc(e,n,r,i,s,o){if(e=+e,n=+n,r=+r,o=!!o,r<0)throw new Error(`negative radius: ${r}`);let a=r*Math.cos(i),c=r*Math.sin(i),u=e+a,l=n+c,h=1^o,f=o?i-s:s-i;this._x1===null?this._append`M${u},${l}`:(Math.abs(this._x1-u)>Sr||Math.abs(this._y1-l)>Sr)&&this._append`L${u},${l}`,r&&(f<0&&(f=f%yf+yf),f>ZT?this._append`A${r},${r},0,1,${h},${e-a},${n-c}A${r},${r},0,1,${h},${this._x1=u},${this._y1=l}`:f>Sr&&this._append`A${r},${r},0,${+(f>=_f)},${h},${this._x1=e+r*Math.cos(s)},${this._y1=n+r*Math.sin(s)}`)}rect(e,n,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}};function Rd(){return new po}Rd.prototype=po.prototype;function QT(t=3){return new po(+t)}function mo(t){let e=3;return t.digits=function(n){if(!arguments.length)return e;if(n==null)e=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);e=r}return t},()=>new po(e)}function JT(t){return t.innerRadius}function eS(t){return t.outerRadius}function tS(t){return t.startAngle}function nS(t){return t.endAngle}function rS(t){return t&&t.padAngle}function iS(t,e,n,r,i,s,o,a){var c=n-t,u=r-e,l=o-i,h=a-s,f=h*c-l*u;if(!(f*f<st))return f=(l*(e-s)-h*(t-i))/f,[t+f*c,e+f*u]}function Bo(t,e,n,r,i,s,o){var a=t-n,c=e-r,u=(o?s:-s)/Ce(a*a+c*c),l=u*c,h=-u*a,f=t+l,d=e+h,p=n+l,g=r+h,m=(f+p)/2,_=(d+g)/2,b=p-f,v=g-d,y=b*b+v*v,w=i-s,x=f*g-p*d,C=(v<0?-1:1)*Ce(YT(0,w*w*y-x*x)),S=(x*v-b*C)/y,A=(-x*b-v*C)/y,N=(x*v+b*C)/y,T=(-x*b+v*C)/y,k=S-m,I=A-_,M=N-m,E=T-_;return k*k+I*I>M*M+E*E&&(S=N,A=T),{cx:S,cy:A,x01:-l,y01:-h,x11:S*(i/w-1),y11:A*(i/w-1)}}function sS(){var t=JT,e=eS,n=ae(0),r=null,i=tS,s=nS,o=rS,a=null,c=mo(u);function u(){var l,h,f=+t.apply(this,arguments),d=+e.apply(this,arguments),p=i.apply(this,arguments)-Ea,g=s.apply(this,arguments)-Ea,m=Am(g-p),_=g>p;if(a||(a=l=c()),d<f&&(h=d,d=f,f=h),!(d>st))a.moveTo(0,0);else if(m>ir-st)a.moveTo(d*En(p),d*Mt(p)),a.arc(0,0,d,p,g,!_),f>st&&(a.moveTo(f*En(g),f*Mt(g)),a.arc(0,0,f,g,p,_));else{var b=p,v=g,y=p,w=g,x=m,C=m,S=o.apply(this,arguments)/2,A=S>st&&(r?+r.apply(this,arguments):Ce(f*f+d*d)),N=xi(Am(d-f)/2,+n.apply(this,arguments)),T=N,k=N,I,M;if(A>st){var E=Nm(A/f*Mt(S)),R=Nm(A/d*Mt(S));(x-=E*2)>st?(E*=_?1:-1,y+=E,w-=E):(x=0,y=w=(p+g)/2),(C-=R*2)>st?(R*=_?1:-1,b+=R,v-=R):(C=0,b=v=(p+g)/2)}var O=d*En(b),q=d*Mt(b),D=f*En(w),$=f*Mt(w);if(N>st){var F=d*En(v),L=d*Mt(v),te=f*En(y),Z=f*Mt(y),W;if(m<or)if(W=iS(O,q,te,Z,F,L,D,$)){var ne=O-W[0],J=q-W[1],B=F-W[0],z=L-W[1],Y=1/Mt(XT((ne*B+J*z)/(Ce(ne*ne+J*J)*Ce(B*B+z*z)))/2),K=Ce(W[0]*W[0]+W[1]*W[1]);T=xi(N,(f-K)/(Y-1)),k=xi(N,(d-K)/(Y+1))}else T=k=0}C>st?k>st?(I=Bo(te,Z,O,q,d,k,_),M=Bo(F,L,D,$,d,k,_),a.moveTo(I.cx+I.x01,I.cy+I.y01),k<N?a.arc(I.cx,I.cy,k,tt(I.y01,I.x01),tt(M.y01,M.x01),!_):(a.arc(I.cx,I.cy,k,tt(I.y01,I.x01),tt(I.y11,I.x11),!_),a.arc(0,0,d,tt(I.cy+I.y11,I.cx+I.x11),tt(M.cy+M.y11,M.cx+M.x11),!_),a.arc(M.cx,M.cy,k,tt(M.y11,M.x11),tt(M.y01,M.x01),!_))):(a.moveTo(O,q),a.arc(0,0,d,b,v,!_)):a.moveTo(O,q),!(f>st)||!(x>st)?a.lineTo(D,$):T>st?(I=Bo(D,$,F,L,f,-T,_),M=Bo(O,q,te,Z,f,-T,_),a.lineTo(I.cx+I.x01,I.cy+I.y01),T<N?a.arc(I.cx,I.cy,T,tt(I.y01,I.x01),tt(M.y01,M.x01),!_):(a.arc(I.cx,I.cy,T,tt(I.y01,I.x01),tt(I.y11,I.x11),!_),a.arc(0,0,f,tt(I.cy+I.y11,I.cx+I.x11),tt(M.cy+M.y11,M.cx+M.x11),_),a.arc(M.cx,M.cy,T,tt(M.y11,M.x11),tt(M.y01,M.x01),!_))):a.arc(0,0,f,w,y,_)}if(a.closePath(),l)return a=null,l+""||null}return u.centroid=function(){var l=(+t.apply(this,arguments)+ +e.apply(this,arguments))/2,h=(+i.apply(this,arguments)+ +s.apply(this,arguments))/2-or/2;return[En(h)*l,Mt(h)*l]},u.innerRadius=function(l){return arguments.length?(t=typeof l=="function"?l:ae(+l),u):t},u.outerRadius=function(l){return arguments.length?(e=typeof l=="function"?l:ae(+l),u):e},u.cornerRadius=function(l){return arguments.length?(n=typeof l=="function"?l:ae(+l),u):n},u.padRadius=function(l){return arguments.length?(r=l==null?null:typeof l=="function"?l:ae(+l),u):r},u.startAngle=function(l){return arguments.length?(i=typeof l=="function"?l:ae(+l),u):i},u.endAngle=function(l){return arguments.length?(s=typeof l=="function"?l:ae(+l),u):s},u.padAngle=function(l){return arguments.length?(o=typeof l=="function"?l:ae(+l),u):o},u.context=function(l){return arguments.length?(a=l??null,u):a},u}var oS=Array.prototype.slice;function Fc(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function Cy(t){this._context=t}Cy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:this._context.lineTo(t,e);break}}};function $c(t){return new Cy(t)}function Id(t){return t[0]}function Od(t){return t[1]}function Dd(t,e){var n=ae(!0),r=null,i=$c,s=null,o=mo(a);t=typeof t=="function"?t:t===void 0?Id:ae(t),e=typeof e=="function"?e:e===void 0?Od:ae(e);function a(c){var u,l=(c=Fc(c)).length,h,f=!1,d;for(r==null&&(s=i(d=o())),u=0;u<=l;++u)!(u<l&&n(h=c[u],u,c))===f&&((f=!f)?s.lineStart():s.lineEnd()),f&&s.point(+t(h,u,c),+e(h,u,c));if(d)return s=null,d+""||null}return a.x=function(c){return arguments.length?(t=typeof c=="function"?c:ae(+c),a):t},a.y=function(c){return arguments.length?(e=typeof c=="function"?c:ae(+c),a):e},a.defined=function(c){return arguments.length?(n=typeof c=="function"?c:ae(!!c),a):n},a.curve=function(c){return arguments.length?(i=c,r!=null&&(s=i(r)),a):i},a.context=function(c){return arguments.length?(c==null?r=s=null:s=i(r=c),a):r},a}function My(t,e,n){var r=null,i=ae(!0),s=null,o=$c,a=null,c=mo(u);t=typeof t=="function"?t:t===void 0?Id:ae(+t),e=typeof e=="function"?e:ae(e===void 0?0:+e),n=typeof n=="function"?n:n===void 0?Od:ae(+n);function u(h){var f,d,p,g=(h=Fc(h)).length,m,_=!1,b,v=new Array(g),y=new Array(g);for(s==null&&(a=o(b=c())),f=0;f<=g;++f){if(!(f<g&&i(m=h[f],f,h))===_)if(_=!_)d=f,a.areaStart(),a.lineStart();else{for(a.lineEnd(),a.lineStart(),p=f-1;p>=d;--p)a.point(v[p],y[p]);a.lineEnd(),a.areaEnd()}_&&(v[f]=+t(m,f,h),y[f]=+e(m,f,h),a.point(r?+r(m,f,h):v[f],n?+n(m,f,h):y[f]))}if(b)return a=null,b+""||null}function l(){return Dd().defined(i).curve(o).context(s)}return u.x=function(h){return arguments.length?(t=typeof h=="function"?h:ae(+h),r=null,u):t},u.x0=function(h){return arguments.length?(t=typeof h=="function"?h:ae(+h),u):t},u.x1=function(h){return arguments.length?(r=h==null?null:typeof h=="function"?h:ae(+h),u):r},u.y=function(h){return arguments.length?(e=typeof h=="function"?h:ae(+h),n=null,u):e},u.y0=function(h){return arguments.length?(e=typeof h=="function"?h:ae(+h),u):e},u.y1=function(h){return arguments.length?(n=h==null?null:typeof h=="function"?h:ae(+h),u):n},u.lineX0=u.lineY0=function(){return l().x(t).y(e)},u.lineY1=function(){return l().x(t).y(n)},u.lineX1=function(){return l().x(r).y(e)},u.defined=function(h){return arguments.length?(i=typeof h=="function"?h:ae(!!h),u):i},u.curve=function(h){return arguments.length?(o=h,s!=null&&(a=o(s)),u):o},u.context=function(h){return arguments.length?(h==null?s=a=null:a=o(s=h),u):s},u}function aS(t,e){return e<t?-1:e>t?1:e>=t?0:NaN}function cS(t){return t}function uS(){var t=cS,e=aS,n=null,r=ae(0),i=ae(ir),s=ae(0);function o(a){var c,u=(a=Fc(a)).length,l,h,f=0,d=new Array(u),p=new Array(u),g=+r.apply(this,arguments),m=Math.min(ir,Math.max(-ir,i.apply(this,arguments)-g)),_,b=Math.min(Math.abs(m)/u,s.apply(this,arguments)),v=b*(m<0?-1:1),y;for(c=0;c<u;++c)(y=p[d[c]=c]=+t(a[c],c,a))>0&&(f+=y);for(e!=null?d.sort(function(w,x){return e(p[w],p[x])}):n!=null&&d.sort(function(w,x){return n(a[w],a[x])}),c=0,h=f?(m-u*v)/f:0;c<u;++c,g=_)l=d[c],y=p[l],_=g+(y>0?y*h:0)+v,p[l]={data:a[l],index:c,value:y,startAngle:g,endAngle:_,padAngle:b};return p}return o.value=function(a){return arguments.length?(t=typeof a=="function"?a:ae(+a),o):t},o.sortValues=function(a){return arguments.length?(e=a,n=null,o):e},o.sort=function(a){return arguments.length?(n=a,e=null,o):n},o.startAngle=function(a){return arguments.length?(r=typeof a=="function"?a:ae(+a),o):r},o.endAngle=function(a){return arguments.length?(i=typeof a=="function"?a:ae(+a),o):i},o.padAngle=function(a){return arguments.length?(s=typeof a=="function"?a:ae(+a),o):s},o}var Ay=Pd($c);function Ny(t){this._curve=t}Ny.prototype={areaStart:function(){this._curve.areaStart()},areaEnd:function(){this._curve.areaEnd()},lineStart:function(){this._curve.lineStart()},lineEnd:function(){this._curve.lineEnd()},point:function(t,e){this._curve.point(e*Math.sin(t),e*-Math.cos(t))}};function Pd(t){function e(n){return new Ny(t(n))}return e._curve=t,e}function xs(t){var e=t.curve;return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t.curve=function(n){return arguments.length?e(Pd(n)):e()._curve},t}function km(){return xs(Dd().curve(Ay))}function Em(){var t=My().curve(Ay),e=t.curve,n=t.lineX0,r=t.lineX1,i=t.lineY0,s=t.lineY1;return t.angle=t.x,delete t.x,t.startAngle=t.x0,delete t.x0,t.endAngle=t.x1,delete t.x1,t.radius=t.y,delete t.y,t.innerRadius=t.y0,delete t.y0,t.outerRadius=t.y1,delete t.y1,t.lineStartAngle=function(){return xs(n())},delete t.lineX0,t.lineEndAngle=function(){return xs(r())},delete t.lineX1,t.lineInnerRadius=function(){return xs(i())},delete t.lineY0,t.lineOuterRadius=function(){return xs(s())},delete t.lineY1,t.curve=function(o){return arguments.length?e(Pd(o)):e()._curve},t}function Ts(t,e){return[(e=+e)*Math.cos(t-=Math.PI/2),e*Math.sin(t)]}class ky{constructor(e,n){this._context=e,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,n){switch(e=+e,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(e,n):this._context.moveTo(e,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+e)/2,this._y0,this._x0,n,e,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,e,this._y0,e,n);break}}this._x0=e,this._y0=n}}class lS{constructor(e){this._context=e}lineStart(){this._point=0}lineEnd(){}point(e,n){if(e=+e,n=+n,this._point===0)this._point=1;else{const r=Ts(this._x0,this._y0),i=Ts(this._x0,this._y0=(this._y0+n)/2),s=Ts(e,this._y0),o=Ts(e,n);this._context.moveTo(...r),this._context.bezierCurveTo(...i,...s,...o)}this._x0=e,this._y0=n}}function Ey(t){return new ky(t,!0)}function Ry(t){return new ky(t,!1)}function hS(t){return new lS(t)}function fS(t){return t.source}function dS(t){return t.target}function Vc(t){let e=fS,n=dS,r=Id,i=Od,s=null,o=null,a=mo(c);function c(){let u;const l=oS.call(arguments),h=e.apply(this,l),f=n.apply(this,l);if(s==null&&(o=t(u=a())),o.lineStart(),l[0]=h,o.point(+r.apply(this,l),+i.apply(this,l)),l[0]=f,o.point(+r.apply(this,l),+i.apply(this,l)),o.lineEnd(),u)return o=null,u+""||null}return c.source=function(u){return arguments.length?(e=u,c):e},c.target=function(u){return arguments.length?(n=u,c):n},c.x=function(u){return arguments.length?(r=typeof u=="function"?u:ae(+u),c):r},c.y=function(u){return arguments.length?(i=typeof u=="function"?u:ae(+u),c):i},c.context=function(u){return arguments.length?(u==null?s=o=null:o=t(s=u),c):s},c}function pS(){return Vc(Ey)}function mS(){return Vc(Ry)}function gS(){const t=Vc(hS);return t.angle=t.x,delete t.x,t.radius=t.y,delete t.y,t}const _S=Ce(3),Iy={draw(t,e){const n=Ce(e+xi(e/28,.75))*.59436,r=n/2,i=r*_S;t.moveTo(0,n),t.lineTo(0,-n),t.moveTo(-i,-r),t.lineTo(i,r),t.moveTo(-i,r),t.lineTo(i,-r)}},Lc={draw(t,e){const n=Ce(e/or);t.moveTo(n,0),t.arc(0,0,n,0,ir)}},Oy={draw(t,e){const n=Ce(e/5)/2;t.moveTo(-3*n,-n),t.lineTo(-n,-n),t.lineTo(-n,-3*n),t.lineTo(n,-3*n),t.lineTo(n,-n),t.lineTo(3*n,-n),t.lineTo(3*n,n),t.lineTo(n,n),t.lineTo(n,3*n),t.lineTo(-n,3*n),t.lineTo(-n,n),t.lineTo(-3*n,n),t.closePath()}},Dy=Ce(1/3),yS=Dy*2,Py={draw(t,e){const n=Ce(e/yS),r=n*Dy;t.moveTo(0,-n),t.lineTo(r,0),t.lineTo(0,n),t.lineTo(-r,0),t.closePath()}},qy={draw(t,e){const n=Ce(e)*.62625;t.moveTo(0,-n),t.lineTo(n,0),t.lineTo(0,n),t.lineTo(-n,0),t.closePath()}},Fy={draw(t,e){const n=Ce(e-xi(e/7,2))*.87559;t.moveTo(-n,0),t.lineTo(n,0),t.moveTo(0,n),t.lineTo(0,-n)}},$y={draw(t,e){const n=Ce(e),r=-n/2;t.rect(r,r,n,n)}},Vy={draw(t,e){const n=Ce(e)*.4431;t.moveTo(n,n),t.lineTo(n,-n),t.lineTo(-n,-n),t.lineTo(-n,n),t.closePath()}},vS=.8908130915292852,Ly=Mt(or/10)/Mt(7*or/10),bS=Mt(ir/10)*Ly,wS=-En(ir/10)*Ly,jy={draw(t,e){const n=Ce(e*vS),r=bS*n,i=wS*n;t.moveTo(0,-n),t.lineTo(r,i);for(let s=1;s<5;++s){const o=ir*s/5,a=En(o),c=Mt(o);t.lineTo(c*n,-a*n),t.lineTo(a*r-c*i,c*r+a*i)}t.closePath()}},Ol=Ce(3),zy={draw(t,e){const n=-Ce(e/(Ol*3));t.moveTo(0,n*2),t.lineTo(-Ol*n,-n),t.lineTo(Ol*n,-n),t.closePath()}},xS=Ce(3),By={draw(t,e){const n=Ce(e)*.6824,r=n/2,i=n*xS/2;t.moveTo(0,-n),t.lineTo(i,r),t.lineTo(-i,r),t.closePath()}},Lt=-.5,jt=Ce(3)/2,vf=1/Ce(12),TS=(vf/2+1)*3,Wy={draw(t,e){const n=Ce(e/TS),r=n/2,i=n*vf,s=r,o=n*vf+n,a=-s,c=o;t.moveTo(r,i),t.lineTo(s,o),t.lineTo(a,c),t.lineTo(Lt*r-jt*i,jt*r+Lt*i),t.lineTo(Lt*s-jt*o,jt*s+Lt*o),t.lineTo(Lt*a-jt*c,jt*a+Lt*c),t.lineTo(Lt*r+jt*i,Lt*i-jt*r),t.lineTo(Lt*s+jt*o,Lt*o-jt*s),t.lineTo(Lt*a+jt*c,Lt*c-jt*a),t.closePath()}},bf={draw(t,e){const n=Ce(e-xi(e/6,1.7))*.6189;t.moveTo(-n,-n),t.lineTo(n,n),t.moveTo(-n,n),t.lineTo(n,-n)}},Rm=[Lc,Oy,Py,$y,jy,zy,Wy],SS=[Lc,Fy,bf,By,Iy,Vy,qy];function CS(t,e){let n=null,r=mo(i);t=typeof t=="function"?t:ae(t||Lc),e=typeof e=="function"?e:ae(e===void 0?64:+e);function i(){let s;if(n||(n=s=r()),t.apply(this,arguments).draw(n,+e.apply(this,arguments)),s)return n=null,s+""||null}return i.type=function(s){return arguments.length?(t=typeof s=="function"?s:ae(s),i):t},i.size=function(s){return arguments.length?(e=typeof s=="function"?s:ae(+s),i):e},i.context=function(s){return arguments.length?(n=s??null,i):n},i}function ar(){}function Ra(t,e,n){t._context.bezierCurveTo((2*t._x0+t._x1)/3,(2*t._y0+t._y1)/3,(t._x0+2*t._x1)/3,(t._y0+2*t._y1)/3,(t._x0+4*t._x1+e)/6,(t._y0+4*t._y1+n)/6)}function jc(t){this._context=t}jc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:Ra(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:Ra(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function MS(t){return new jc(t)}function Uy(t){this._context=t}Uy.prototype={areaStart:ar,areaEnd:ar,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x2=t,this._y2=e;break;case 1:this._point=2,this._x3=t,this._y3=e;break;case 2:this._point=3,this._x4=t,this._y4=e,this._context.moveTo((this._x0+4*this._x1+t)/6,(this._y0+4*this._y1+e)/6);break;default:Ra(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function AS(t){return new Uy(t)}function Gy(t){this._context=t}Gy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+t)/6,r=(this._y0+4*this._y1+e)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:Ra(this,t,e);break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e}};function NS(t){return new Gy(t)}function Hy(t,e){this._basis=new jc(t),this._beta=e}Hy.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var t=this._x,e=this._y,n=t.length-1;if(n>0)for(var r=t[0],i=e[0],s=t[n]-r,o=e[n]-i,a=-1,c;++a<=n;)c=a/n,this._basis.point(this._beta*t[a]+(1-this._beta)*(r+c*s),this._beta*e[a]+(1-this._beta)*(i+c*o));this._x=this._y=null,this._basis.lineEnd()},point:function(t,e){this._x.push(+t),this._y.push(+e)}};const kS=(function t(e){function n(r){return e===1?new jc(r):new Hy(r,e)}return n.beta=function(r){return t(+r)},n})(.85);function Ia(t,e,n){t._context.bezierCurveTo(t._x1+t._k*(t._x2-t._x0),t._y1+t._k*(t._y2-t._y0),t._x2+t._k*(t._x1-e),t._y2+t._k*(t._y1-n),t._x2,t._y2)}function qd(t,e){this._context=t,this._k=(1-e)/6}qd.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:Ia(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2,this._x1=t,this._y1=e;break;case 2:this._point=3;default:Ia(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const ES=(function t(e){function n(r){return new qd(r,e)}return n.tension=function(r){return t(+r)},n})(0);function Fd(t,e){this._context=t,this._k=(1-e)/6}Fd.prototype={areaStart:ar,areaEnd:ar,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Ia(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const RS=(function t(e){function n(r){return new Fd(r,e)}return n.tension=function(r){return t(+r)},n})(0);function $d(t,e){this._context=t,this._k=(1-e)/6}$d.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Ia(this,t,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const IS=(function t(e){function n(r){return new $d(r,e)}return n.tension=function(r){return t(+r)},n})(0);function Vd(t,e,n){var r=t._x1,i=t._y1,s=t._x2,o=t._y2;if(t._l01_a>st){var a=2*t._l01_2a+3*t._l01_a*t._l12_a+t._l12_2a,c=3*t._l01_a*(t._l01_a+t._l12_a);r=(r*a-t._x0*t._l12_2a+t._x2*t._l01_2a)/c,i=(i*a-t._y0*t._l12_2a+t._y2*t._l01_2a)/c}if(t._l23_a>st){var u=2*t._l23_2a+3*t._l23_a*t._l12_a+t._l12_2a,l=3*t._l23_a*(t._l23_a+t._l12_a);s=(s*u+t._x1*t._l23_2a-e*t._l12_2a)/l,o=(o*u+t._y1*t._l23_2a-n*t._l12_2a)/l}t._context.bezierCurveTo(r,i,s,o,t._x2,t._y2)}function Yy(t,e){this._context=t,this._alpha=e}Yy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3;default:Vd(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const OS=(function t(e){function n(r){return e?new Yy(r,e):new qd(r,0)}return n.alpha=function(r){return t(+r)},n})(.5);function Xy(t,e){this._context=t,this._alpha=e}Xy.prototype={areaStart:ar,areaEnd:ar,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=t,this._y3=e;break;case 1:this._point=2,this._context.moveTo(this._x4=t,this._y4=e);break;case 2:this._point=3,this._x5=t,this._y5=e;break;default:Vd(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const DS=(function t(e){function n(r){return e?new Xy(r,e):new Fd(r,0)}return n.alpha=function(r){return t(+r)},n})(.5);function Zy(t,e){this._context=t,this._alpha=e}Zy.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){if(t=+t,e=+e,this._point){var n=this._x2-t,r=this._y2-e;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:Vd(this,t,e);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=t,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const PS=(function t(e){function n(r){return e?new Zy(r,e):new $d(r,0)}return n.alpha=function(r){return t(+r)},n})(.5);function Ky(t){this._context=t}Ky.prototype={areaStart:ar,areaEnd:ar,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(t,e){t=+t,e=+e,this._point?this._context.lineTo(t,e):(this._point=1,this._context.moveTo(t,e))}};function qS(t){return new Ky(t)}function Im(t){return t<0?-1:1}function Om(t,e,n){var r=t._x1-t._x0,i=e-t._x1,s=(t._y1-t._y0)/(r||i<0&&-0),o=(n-t._y1)/(i||r<0&&-0),a=(s*i+o*r)/(r+i);return(Im(s)+Im(o))*Math.min(Math.abs(s),Math.abs(o),.5*Math.abs(a))||0}function Dm(t,e){var n=t._x1-t._x0;return n?(3*(t._y1-t._y0)/n-e)/2:e}function Dl(t,e,n){var r=t._x0,i=t._y0,s=t._x1,o=t._y1,a=(s-r)/3;t._context.bezierCurveTo(r+a,i+a*e,s-a,o-a*n,s,o)}function Oa(t){this._context=t}Oa.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:Dl(this,this._t0,Dm(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(t,e){var n=NaN;if(t=+t,e=+e,!(t===this._x1&&e===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,Dl(this,Dm(this,n=Om(this,t,e)),n);break;default:Dl(this,this._t0,n=Om(this,t,e));break}this._x0=this._x1,this._x1=t,this._y0=this._y1,this._y1=e,this._t0=n}}};function Qy(t){this._context=new Jy(t)}(Qy.prototype=Object.create(Oa.prototype)).point=function(t,e){Oa.prototype.point.call(this,e,t)};function Jy(t){this._context=t}Jy.prototype={moveTo:function(t,e){this._context.moveTo(e,t)},closePath:function(){this._context.closePath()},lineTo:function(t,e){this._context.lineTo(e,t)},bezierCurveTo:function(t,e,n,r,i,s){this._context.bezierCurveTo(e,t,r,n,s,i)}};function FS(t){return new Oa(t)}function $S(t){return new Qy(t)}function ev(t){this._context=t}ev.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var t=this._x,e=this._y,n=t.length;if(n)if(this._line?this._context.lineTo(t[0],e[0]):this._context.moveTo(t[0],e[0]),n===2)this._context.lineTo(t[1],e[1]);else for(var r=Pm(t),i=Pm(e),s=0,o=1;o<n;++s,++o)this._context.bezierCurveTo(r[0][s],i[0][s],r[1][s],i[1][s],t[o],e[o]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(t,e){this._x.push(+t),this._y.push(+e)}};function Pm(t){var e,n=t.length-1,r,i=new Array(n),s=new Array(n),o=new Array(n);for(i[0]=0,s[0]=2,o[0]=t[0]+2*t[1],e=1;e<n-1;++e)i[e]=1,s[e]=4,o[e]=4*t[e]+2*t[e+1];for(i[n-1]=2,s[n-1]=7,o[n-1]=8*t[n-1]+t[n],e=1;e<n;++e)r=i[e]/s[e-1],s[e]-=r,o[e]-=r*o[e-1];for(i[n-1]=o[n-1]/s[n-1],e=n-2;e>=0;--e)i[e]=(o[e]-i[e+1])/s[e];for(s[n-1]=(t[n]+i[n-1])/2,e=0;e<n-1;++e)s[e]=2*t[e+1]-i[e+1];return[i,s]}function VS(t){return new ev(t)}function zc(t,e){this._context=t,this._t=e}zc.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(t,e){switch(t=+t,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(t,e);else{var n=this._x*(1-this._t)+t*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,e)}break}}this._x=t,this._y=e}};function LS(t){return new zc(t,.5)}function jS(t){return new zc(t,0)}function zS(t){return new zc(t,1)}function ki(t,e){if((o=t.length)>1)for(var n=1,r,i,s=t[e[0]],o,a=s.length;n<o;++n)for(i=s,s=t[e[n]],r=0;r<a;++r)s[r][1]+=s[r][0]=isNaN(i[r][1])?i[r][0]:i[r][1]}function Ei(t){for(var e=t.length,n=new Array(e);--e>=0;)n[e]=e;return n}function BS(t,e){return t[e]}function WS(t){const e=[];return e.key=t,e}function US(){var t=ae([]),e=Ei,n=ki,r=BS;function i(s){var o=Array.from(t.apply(this,arguments),WS),a,c=o.length,u=-1,l;for(const h of s)for(a=0,++u;a<c;++a)(o[a][u]=[0,+r(h,o[a].key,u,s)]).data=h;for(a=0,l=Fc(e(o));a<c;++a)o[l[a]].index=a;return n(o,l),o}return i.keys=function(s){return arguments.length?(t=typeof s=="function"?s:ae(Array.from(s)),i):t},i.value=function(s){return arguments.length?(r=typeof s=="function"?s:ae(+s),i):r},i.order=function(s){return arguments.length?(e=s==null?Ei:typeof s=="function"?s:ae(Array.from(s)),i):e},i.offset=function(s){return arguments.length?(n=s??ki,i):n},i}function GS(t,e){if((r=t.length)>0){for(var n,r,i=0,s=t[0].length,o;i<s;++i){for(o=n=0;n<r;++n)o+=t[n][i][1]||0;if(o)for(n=0;n<r;++n)t[n][i][1]/=o}ki(t,e)}}function HS(t,e){if((c=t.length)>0)for(var n,r=0,i,s,o,a,c,u=t[e[0]].length;r<u;++r)for(o=a=0,n=0;n<c;++n)(s=(i=t[e[n]][r])[1]-i[0])>0?(i[0]=o,i[1]=o+=s):s<0?(i[1]=a,i[0]=a+=s):(i[0]=0,i[1]=s)}function YS(t,e){if((i=t.length)>0){for(var n=0,r=t[e[0]],i,s=r.length;n<s;++n){for(var o=0,a=0;o<i;++o)a+=t[o][n][1]||0;r[n][1]+=r[n][0]=-a/2}ki(t,e)}}function XS(t,e){if(!(!((o=t.length)>0)||!((s=(i=t[e[0]]).length)>0))){for(var n=0,r=1,i,s,o;r<s;++r){for(var a=0,c=0,u=0;a<o;++a){for(var l=t[e[a]],h=l[r][1]||0,f=l[r-1][1]||0,d=(h-f)/2,p=0;p<a;++p){var g=t[e[p]],m=g[r][1]||0,_=g[r-1][1]||0;d+=m-_}c+=h,u+=d*h}i[r-1][1]+=i[r-1][0]=n,c&&(n-=u/c)}i[r-1][1]+=i[r-1][0]=n,ki(t,e)}}function tv(t){var e=t.map(ZS);return Ei(t).sort(function(n,r){return e[n]-e[r]})}function ZS(t){for(var e=-1,n=0,r=t.length,i,s=-1/0;++e<r;)(i=+t[e][1])>s&&(s=i,n=e);return n}function nv(t){var e=t.map(rv);return Ei(t).sort(function(n,r){return e[n]-e[r]})}function rv(t){for(var e=0,n=-1,r=t.length,i;++n<r;)(i=+t[n][1])&&(e+=i);return e}function KS(t){return nv(t).reverse()}function QS(t){var e=t.length,n,r,i=t.map(rv),s=tv(t),o=0,a=0,c=[],u=[];for(n=0;n<e;++n)r=s[n],o<a?(o+=i[r],c.push(r)):(a+=i[r],u.push(r));return u.reverse().concat(c)}function JS(t){return Ei(t).reverse()}var Pl,qm;function eC(){if(qm)return Pl;qm=1;var t=Pc();function e(){this.__data__=new t,this.size=0}return Pl=e,Pl}var ql,Fm;function tC(){if(Fm)return ql;Fm=1;function t(e){var n=this.__data__,r=n.delete(e);return this.size=n.size,r}return ql=t,ql}var Fl,$m;function nC(){if($m)return Fl;$m=1;function t(e){return this.__data__.get(e)}return Fl=t,Fl}var $l,Vm;function rC(){if(Vm)return $l;Vm=1;function t(e){return this.__data__.has(e)}return $l=t,$l}var Vl,Lm;function iC(){if(Lm)return Vl;Lm=1;var t=Pc(),e=Ed(),n=Ty(),r=200;function i(s,o){var a=this.__data__;if(a instanceof t){var c=a.__data__;if(!e||c.length<r-1)return c.push([s,o]),this.size=++a.size,this;a=this.__data__=new n(c)}return a.set(s,o),this.size=a.size,this}return Vl=i,Vl}var Ll,jm;function sC(){if(jm)return Ll;jm=1;var t=Pc(),e=eC(),n=tC(),r=nC(),i=rC(),s=iC();function o(a){var c=this.__data__=new t(a);this.size=c.size}return o.prototype.clear=e,o.prototype.delete=n,o.prototype.get=r,o.prototype.has=i,o.prototype.set=s,Ll=o,Ll}var jl,zm;function oC(){if(zm)return jl;zm=1;var t="__lodash_hash_undefined__";function e(n){return this.__data__.set(n,t),this}return jl=e,jl}var zl,Bm;function aC(){if(Bm)return zl;Bm=1;function t(e){return this.__data__.has(e)}return zl=t,zl}var Bl,Wm;function cC(){if(Wm)return Bl;Wm=1;var t=Ty(),e=oC(),n=aC();function r(i){var s=-1,o=i==null?0:i.length;for(this.__data__=new t;++s<o;)this.add(i[s])}return r.prototype.add=r.prototype.push=e,r.prototype.has=n,Bl=r,Bl}var Wl,Um;function uC(){if(Um)return Wl;Um=1;function t(e,n){for(var r=-1,i=e==null?0:e.length;++r<i;)if(n(e[r],r,e))return!0;return!1}return Wl=t,Wl}var Ul,Gm;function lC(){if(Gm)return Ul;Gm=1;function t(e,n){return e.has(n)}return Ul=t,Ul}var Gl,Hm;function iv(){if(Hm)return Gl;Hm=1;var t=cC(),e=uC(),n=lC(),r=1,i=2;function s(o,a,c,u,l,h){var f=c&r,d=o.length,p=a.length;if(d!=p&&!(f&&p>d))return!1;var g=h.get(o),m=h.get(a);if(g&&m)return g==a&&m==o;var _=-1,b=!0,v=c&i?new t:void 0;for(h.set(o,a),h.set(a,o);++_<d;){var y=o[_],w=a[_];if(u)var x=f?u(w,y,_,a,o,h):u(y,w,_,o,a,h);if(x!==void 0){if(x)continue;b=!1;break}if(v){if(!e(a,function(C,S){if(!n(v,S)&&(y===C||l(y,C,c,u,h)))return v.push(S)})){b=!1;break}}else if(!(y===w||l(y,w,c,u,h))){b=!1;break}}return h.delete(o),h.delete(a),b}return Gl=s,Gl}var Hl,Ym;function hC(){if(Ym)return Hl;Ym=1;var t=Bn(),e=t.Uint8Array;return Hl=e,Hl}var Yl,Xm;function fC(){if(Xm)return Yl;Xm=1;function t(e){var n=-1,r=Array(e.size);return e.forEach(function(i,s){r[++n]=[s,i]}),r}return Yl=t,Yl}var Xl,Zm;function dC(){if(Zm)return Xl;Zm=1;function t(e){var n=-1,r=Array(e.size);return e.forEach(function(i){r[++n]=i}),r}return Xl=t,Xl}var Zl,Km;function pC(){if(Km)return Zl;Km=1;var t=kd(),e=hC(),n=xy(),r=iv(),i=fC(),s=dC(),o=1,a=2,c="[object Boolean]",u="[object Date]",l="[object Error]",h="[object Map]",f="[object Number]",d="[object RegExp]",p="[object Set]",g="[object String]",m="[object Symbol]",_="[object ArrayBuffer]",b="[object DataView]",v=t?t.prototype:void 0,y=v?v.valueOf:void 0;function w(x,C,S,A,N,T,k){switch(S){case b:if(x.byteLength!=C.byteLength||x.byteOffset!=C.byteOffset)return!1;x=x.buffer,C=C.buffer;case _:return!(x.byteLength!=C.byteLength||!T(new e(x),new e(C)));case c:case u:case f:return n(+x,+C);case l:return x.name==C.name&&x.message==C.message;case d:case g:return x==C+"";case h:var I=i;case p:var M=A&o;if(I||(I=s),x.size!=C.size&&!M)return!1;var E=k.get(x);if(E)return E==C;A|=a,k.set(x,C);var R=r(I(x),I(C),A,N,T,k);return k.delete(x),R;case m:if(y)return y.call(x)==y.call(C)}return!1}return Zl=w,Zl}var Kl,Qm;function mC(){if(Qm)return Kl;Qm=1;function t(e,n){for(var r=-1,i=n.length,s=e.length;++r<i;)e[s+r]=n[r];return e}return Kl=t,Kl}var Ql,Jm;function gC(){if(Jm)return Ql;Jm=1;var t=mC(),e=Nd();function n(r,i,s){var o=i(r);return e(r)?o:t(o,s(r))}return Ql=n,Ql}var Jl,eg;function _C(){if(eg)return Jl;eg=1;function t(e,n){for(var r=-1,i=e==null?0:e.length,s=0,o=[];++r<i;){var a=e[r];n(a,r,e)&&(o[s++]=a)}return o}return Jl=t,Jl}var eh,tg;function yC(){if(tg)return eh;tg=1;function t(){return[]}return eh=t,eh}var th,ng;function vC(){if(ng)return th;ng=1;var t=_C(),e=yC(),n=Object.prototype,r=n.propertyIsEnumerable,i=Object.getOwnPropertySymbols,s=i?function(o){return o==null?[]:(o=Object(o),t(i(o),function(a){return r.call(o,a)}))}:e;return th=s,th}var nh,rg;function bC(){if(rg)return nh;rg=1;function t(e,n){for(var r=-1,i=Array(e);++r<e;)i[r]=n(r);return i}return nh=t,nh}var rh,ig;function wC(){if(ig)return rh;ig=1;var t=Rc(),e=Ic(),n="[object Arguments]";function r(i){return e(i)&&t(i)==n}return rh=r,rh}var ih,sg;function xC(){if(sg)return ih;sg=1;var t=wC(),e=Ic(),n=Object.prototype,r=n.hasOwnProperty,i=n.propertyIsEnumerable,s=t((function(){return arguments})())?t:function(o){return e(o)&&r.call(o,"callee")&&!i.call(o,"callee")};return ih=s,ih}var Ss={exports:{}},sh,og;function TC(){if(og)return sh;og=1;function t(){return!1}return sh=t,sh}Ss.exports;var ag;function sv(){return ag||(ag=1,(function(t,e){var n=Bn(),r=TC(),i=e&&!e.nodeType&&e,s=i&&!0&&t&&!t.nodeType&&t,o=s&&s.exports===i,a=o?n.Buffer:void 0,c=a?a.isBuffer:void 0,u=c||r;t.exports=u})(Ss,Ss.exports)),Ss.exports}var oh,cg;function SC(){if(cg)return oh;cg=1;var t=9007199254740991,e=/^(?:0|[1-9]\d*)$/;function n(r,i){var s=typeof r;return i=i??t,!!i&&(s=="number"||s!="symbol"&&e.test(r))&&r>-1&&r%1==0&&r<i}return oh=n,oh}var ah,ug;function ov(){if(ug)return ah;ug=1;var t=9007199254740991;function e(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=t}return ah=e,ah}var ch,lg;function CC(){if(lg)return ch;lg=1;var t=Rc(),e=ov(),n=Ic(),r="[object Arguments]",i="[object Array]",s="[object Boolean]",o="[object Date]",a="[object Error]",c="[object Function]",u="[object Map]",l="[object Number]",h="[object Object]",f="[object RegExp]",d="[object Set]",p="[object String]",g="[object WeakMap]",m="[object ArrayBuffer]",_="[object DataView]",b="[object Float32Array]",v="[object Float64Array]",y="[object Int8Array]",w="[object Int16Array]",x="[object Int32Array]",C="[object Uint8Array]",S="[object Uint8ClampedArray]",A="[object Uint16Array]",N="[object Uint32Array]",T={};T[b]=T[v]=T[y]=T[w]=T[x]=T[C]=T[S]=T[A]=T[N]=!0,T[r]=T[i]=T[m]=T[s]=T[_]=T[o]=T[a]=T[c]=T[u]=T[l]=T[h]=T[f]=T[d]=T[p]=T[g]=!1;function k(I){return n(I)&&e(I.length)&&!!T[t(I)]}return ch=k,ch}var uh,hg;function MC(){if(hg)return uh;hg=1;function t(e){return function(n){return e(n)}}return uh=t,uh}var Cs={exports:{}};Cs.exports;var fg;function AC(){return fg||(fg=1,(function(t,e){var n=yy(),r=e&&!e.nodeType&&e,i=r&&!0&&t&&!t.nodeType&&t,s=i&&i.exports===r,o=s&&n.process,a=(function(){try{var c=i&&i.require&&i.require("util").types;return c||o&&o.binding&&o.binding("util")}catch{}})();t.exports=a})(Cs,Cs.exports)),Cs.exports}var lh,dg;function av(){if(dg)return lh;dg=1;var t=CC(),e=MC(),n=AC(),r=n&&n.isTypedArray,i=r?e(r):t;return lh=i,lh}var hh,pg;function NC(){if(pg)return hh;pg=1;var t=bC(),e=xC(),n=Nd(),r=sv(),i=SC(),s=av(),o=Object.prototype,a=o.hasOwnProperty;function c(u,l){var h=n(u),f=!h&&e(u),d=!h&&!f&&r(u),p=!h&&!f&&!d&&s(u),g=h||f||d||p,m=g?t(u.length,String):[],_=m.length;for(var b in u)(l||a.call(u,b))&&!(g&&(b=="length"||d&&(b=="offset"||b=="parent")||p&&(b=="buffer"||b=="byteLength"||b=="byteOffset")||i(b,_)))&&m.push(b);return m}return hh=c,hh}var fh,mg;function kC(){if(mg)return fh;mg=1;var t=Object.prototype;function e(n){var r=n&&n.constructor,i=typeof r=="function"&&r.prototype||t;return n===i}return fh=e,fh}var dh,gg;function EC(){if(gg)return dh;gg=1;function t(e,n){return function(r){return e(n(r))}}return dh=t,dh}var ph,_g;function RC(){if(_g)return ph;_g=1;var t=EC(),e=t(Object.keys,Object);return ph=e,ph}var mh,yg;function IC(){if(yg)return mh;yg=1;var t=kC(),e=RC(),n=Object.prototype,r=n.hasOwnProperty;function i(s){if(!t(s))return e(s);var o=[];for(var a in Object(s))r.call(s,a)&&a!="constructor"&&o.push(a);return o}return mh=i,mh}var gh,vg;function OC(){if(vg)return gh;vg=1;var t=by(),e=ov();function n(r){return r!=null&&e(r.length)&&!t(r)}return gh=n,gh}var _h,bg;function DC(){if(bg)return _h;bg=1;var t=NC(),e=IC(),n=OC();function r(i){return n(i)?t(i):e(i)}return _h=r,_h}var yh,wg;function PC(){if(wg)return yh;wg=1;var t=gC(),e=vC(),n=DC();function r(i){return t(i,n,e)}return yh=r,yh}var vh,xg;function qC(){if(xg)return vh;xg=1;var t=PC(),e=1,n=Object.prototype,r=n.hasOwnProperty;function i(s,o,a,c,u,l){var h=a&e,f=t(s),d=f.length,p=t(o),g=p.length;if(d!=g&&!h)return!1;for(var m=d;m--;){var _=f[m];if(!(h?_ in o:r.call(o,_)))return!1}var b=l.get(s),v=l.get(o);if(b&&v)return b==o&&v==s;var y=!0;l.set(s,o),l.set(o,s);for(var w=h;++m<d;){_=f[m];var x=s[_],C=o[_];if(c)var S=h?c(C,x,_,o,s,l):c(x,C,_,s,o,l);if(!(S===void 0?x===C||u(x,C,a,c,l):S)){y=!1;break}w||(w=_=="constructor")}if(y&&!w){var A=s.constructor,N=o.constructor;A!=N&&"constructor"in s&&"constructor"in o&&!(typeof A=="function"&&A instanceof A&&typeof N=="function"&&N instanceof N)&&(y=!1)}return l.delete(s),l.delete(o),y}return vh=i,vh}var bh,Tg;function FC(){if(Tg)return bh;Tg=1;var t=Qi(),e=Bn(),n=t(e,"DataView");return bh=n,bh}var wh,Sg;function $C(){if(Sg)return wh;Sg=1;var t=Qi(),e=Bn(),n=t(e,"Promise");return wh=n,wh}var xh,Cg;function VC(){if(Cg)return xh;Cg=1;var t=Qi(),e=Bn(),n=t(e,"Set");return xh=n,xh}var Th,Mg;function LC(){if(Mg)return Th;Mg=1;var t=Qi(),e=Bn(),n=t(e,"WeakMap");return Th=n,Th}var Sh,Ag;function jC(){if(Ag)return Sh;Ag=1;var t=FC(),e=Ed(),n=$C(),r=VC(),i=LC(),s=Rc(),o=wy(),a="[object Map]",c="[object Object]",u="[object Promise]",l="[object Set]",h="[object WeakMap]",f="[object DataView]",d=o(t),p=o(e),g=o(n),m=o(r),_=o(i),b=s;return(t&&b(new t(new ArrayBuffer(1)))!=f||e&&b(new e)!=a||n&&b(n.resolve())!=u||r&&b(new r)!=l||i&&b(new i)!=h)&&(b=function(v){var y=s(v),w=y==c?v.constructor:void 0,x=w?o(w):"";if(x)switch(x){case d:return f;case p:return a;case g:return u;case m:return l;case _:return h}return y}),Sh=b,Sh}var Ch,Ng;function zC(){if(Ng)return Ch;Ng=1;var t=sC(),e=iv(),n=pC(),r=qC(),i=jC(),s=Nd(),o=sv(),a=av(),c=1,u="[object Arguments]",l="[object Array]",h="[object Object]",f=Object.prototype,d=f.hasOwnProperty;function p(g,m,_,b,v,y){var w=s(g),x=s(m),C=w?l:i(g),S=x?l:i(m);C=C==u?h:C,S=S==u?h:S;var A=C==h,N=S==h,T=C==S;if(T&&o(g)){if(!o(m))return!1;w=!0,A=!1}if(T&&!A)return y||(y=new t),w||a(g)?e(g,m,_,b,v,y):n(g,m,C,_,b,v,y);if(!(_&c)){var k=A&&d.call(g,"__wrapped__"),I=N&&d.call(m,"__wrapped__");if(k||I){var M=k?g.value():g,E=I?m.value():m;return y||(y=new t),v(M,E,_,b,y)}}return T?(y||(y=new t),r(g,m,_,b,v,y)):!1}return Ch=p,Ch}var Mh,kg;function BC(){if(kg)return Mh;kg=1;var t=zC(),e=Ic();function n(r,i,s,o,a){return r===i?!0:r==null||i==null||!e(r)&&!e(i)?r!==r&&i!==i:t(r,i,s,o,n,a)}return Mh=n,Mh}function Oe(t,e){return t==null||e==null?NaN:t<e?-1:t>e?1:t>=e?0:NaN}function cv(t,e){return t==null||e==null?NaN:e<t?-1:e>t?1:e>=t?0:NaN}function Bc(t){let e,n,r;t.length!==2?(e=Oe,n=(a,c)=>Oe(t(a),c),r=(a,c)=>t(a)-c):(e=t===Oe||t===cv?t:WC,n=t,r=t);function i(a,c,u=0,l=a.length){if(u<l){if(e(c,c)!==0)return l;do{const h=u+l>>>1;n(a[h],c)<0?u=h+1:l=h}while(u<l)}return u}function s(a,c,u=0,l=a.length){if(u<l){if(e(c,c)!==0)return l;do{const h=u+l>>>1;n(a[h],c)<=0?u=h+1:l=h}while(u<l)}return u}function o(a,c,u=0,l=a.length){const h=i(a,c,u,l-1);return h>u&&r(a[h-1],c)>-r(a[h],c)?h-1:h}return{left:i,center:o,right:s}}function WC(){return 0}function Da(t){return t===null?NaN:+t}function*UC(t,e){if(e===void 0)for(let n of t)n!=null&&(n=+n)>=n&&(yield n);else{let n=-1;for(let r of t)(r=e(r,++n,t))!=null&&(r=+r)>=r&&(yield r)}}const uv=Bc(Oe),cr=uv.right,GC=uv.left,HC=Bc(Da).center;function YC(t,e){if(!((e=+e)>=0))throw new RangeError("invalid r");let n=t.length;if(!((n=Math.floor(n))>=0))throw new RangeError("invalid length");if(!n||!e)return t;const r=Ld(e),i=t.slice();return r(t,i,0,n,1),r(i,t,0,n,1),r(t,i,0,n,1),t}const lv=hv(Ld),XC=hv(ZC);function hv(t){return function(e,n,r=n){if(!((n=+n)>=0))throw new RangeError("invalid rx");if(!((r=+r)>=0))throw new RangeError("invalid ry");let{data:i,width:s,height:o}=e;if(!((s=Math.floor(s))>=0))throw new RangeError("invalid width");if(!((o=Math.floor(o!==void 0?o:i.length/s))>=0))throw new RangeError("invalid height");if(!s||!o||!n&&!r)return e;const a=n&&t(n),c=r&&t(r),u=i.slice();return a&&c?(si(a,u,i,s,o),si(a,i,u,s,o),si(a,u,i,s,o),oi(c,i,u,s,o),oi(c,u,i,s,o),oi(c,i,u,s,o)):a?(si(a,i,u,s,o),si(a,u,i,s,o),si(a,i,u,s,o)):c&&(oi(c,i,u,s,o),oi(c,u,i,s,o),oi(c,i,u,s,o)),e}}function si(t,e,n,r,i){for(let s=0,o=r*i;s<o;)t(e,n,s,s+=r,1)}function oi(t,e,n,r,i){for(let s=0,o=r*i;s<r;++s)t(e,n,s,s+o,r)}function ZC(t){const e=Ld(t);return(n,r,i,s,o)=>{i<<=2,s<<=2,o<<=2,e(n,r,i+0,s+0,o),e(n,r,i+1,s+1,o),e(n,r,i+2,s+2,o),e(n,r,i+3,s+3,o)}}function Ld(t){const e=Math.floor(t);if(e===t)return KC(t);const n=t-e,r=2*t+1;return(i,s,o,a,c)=>{if(!((a-=c)>=o))return;let u=e*s[o];const l=c*e,h=l+c;for(let f=o,d=o+l;f<d;f+=c)u+=s[Math.min(a,f)];for(let f=o,d=a;f<=d;f+=c)u+=s[Math.min(a,f+l)],i[f]=(u+n*(s[Math.max(o,f-h)]+s[Math.min(a,f+h)]))/r,u-=s[Math.max(o,f-l)]}}function KC(t){const e=2*t+1;return(n,r,i,s,o)=>{if(!((s-=o)>=i))return;let a=t*r[i];const c=o*t;for(let u=i,l=i+c;u<l;u+=o)a+=r[Math.min(s,u)];for(let u=i,l=s;u<=l;u+=o)a+=r[Math.min(s,u+c)],n[u]=a/e,a-=r[Math.max(i,u-c)]}}function Wc(t,e){let n=0;if(e===void 0)for(let r of t)r!=null&&(r=+r)>=r&&++n;else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(i=+i)>=i&&++n}return n}function QC(t){return t.length|0}function JC(t){return!(t>0)}function eM(t){return typeof t!="object"||"length"in t?t:Array.from(t)}function tM(t){return e=>t(...e)}function nM(...t){const e=typeof t[t.length-1]=="function"&&tM(t.pop());t=t.map(eM);const n=t.map(QC),r=t.length-1,i=new Array(r+1).fill(0),s=[];if(r<0||n.some(JC))return s;for(;;){s.push(i.map((a,c)=>t[c][a]));let o=r;for(;++i[o]===n[o];){if(o===0)return e?s.map(e):s;i[o--]=0}}}function rM(t,e){var n=0,r=0;return Float64Array.from(t,e===void 0?i=>n+=+i||0:i=>n+=+e(i,r++,t)||0)}function fv(t,e){let n=0,r,i=0,s=0;if(e===void 0)for(let o of t)o!=null&&(o=+o)>=o&&(r=o-i,i+=r/++n,s+=r*(o-i));else{let o=-1;for(let a of t)(a=e(a,++o,t))!=null&&(a=+a)>=a&&(r=a-i,i+=r/++n,s+=r*(a-i))}if(n>1)return s/(n-1)}function dv(t,e){const n=fv(t,e);return n&&Math.sqrt(n)}function Fs(t,e){let n,r;if(e===void 0)for(const i of t)i!=null&&(n===void 0?i>=i&&(n=r=i):(n>i&&(n=i),r<i&&(r=i)));else{let i=-1;for(let s of t)(s=e(s,++i,t))!=null&&(n===void 0?s>=s&&(n=r=s):(n>s&&(n=s),r<s&&(r=s)))}return[n,r]}class We{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const n=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const s=n[i],o=e+s,a=Math.abs(e)<Math.abs(s)?e-(o-s):s-(o-e);a&&(n[r++]=a),e=o}return n[r]=e,this._n=r+1,this}valueOf(){const e=this._partials;let n=this._n,r,i,s,o=0;if(n>0){for(o=e[--n];n>0&&(r=o,i=e[--n],o=r+i,s=i-(o-r),!s););n>0&&(s<0&&e[n-1]<0||s>0&&e[n-1]>0)&&(i=s*2,r=o+i,i==r-o&&(o=r))}return o}}function iM(t,e){const n=new We;if(e===void 0)for(let r of t)(r=+r)&&n.add(r);else{let r=-1;for(let i of t)(i=+e(i,++r,t))&&n.add(i)}return+n}function sM(t,e){const n=new We;let r=-1;return Float64Array.from(t,e===void 0?i=>n.add(+i||0):i=>n.add(+e(i,++r,t)||0))}class Gs extends Map{constructor(e,n=gv){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const[r,i]of e)this.set(r,i)}get(e){return super.get(wf(this,e))}has(e){return super.has(wf(this,e))}set(e,n){return super.set(pv(this,e),n)}delete(e){return super.delete(mv(this,e))}}class qr extends Set{constructor(e,n=gv){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:n}}),e!=null)for(const r of e)this.add(r)}has(e){return super.has(wf(this,e))}add(e){return super.add(pv(this,e))}delete(e){return super.delete(mv(this,e))}}function wf({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):n}function pv({_intern:t,_key:e},n){const r=e(n);return t.has(r)?t.get(r):(t.set(r,n),n)}function mv({_intern:t,_key:e},n){const r=e(n);return t.has(r)&&(n=t.get(r),t.delete(r)),n}function gv(t){return t!==null&&typeof t=="object"?t.valueOf():t}function Ri(t){return t}function _v(t,...e){return Ji(t,Ri,Ri,e)}function yv(t,...e){return Ji(t,Array.from,Ri,e)}function vv(t,e){for(let n=1,r=e.length;n<r;++n)t=t.flatMap(i=>i.pop().map(([s,o])=>[...i,s,o]));return t}function oM(t,...e){return vv(yv(t,...e),e)}function aM(t,e,...n){return vv(wv(t,e,...n),n)}function bv(t,e,...n){return Ji(t,Ri,e,n)}function wv(t,e,...n){return Ji(t,Array.from,e,n)}function cM(t,...e){return Ji(t,Ri,xv,e)}function uM(t,...e){return Ji(t,Array.from,xv,e)}function xv(t){if(t.length!==1)throw new Error("duplicate key");return t[0]}function Ji(t,e,n,r){return(function i(s,o){if(o>=r.length)return n(s);const a=new Gs,c=r[o++];let u=-1;for(const l of s){const h=c(l,++u,s),f=a.get(h);f?f.push(l):a.set(h,[l])}for(const[l,h]of a)a.set(l,i(h,o));return e(a)})(t,0)}function Tv(t,e){return Array.from(e,n=>t[n])}function xf(t,...e){if(typeof t[Symbol.iterator]!="function")throw new TypeError("values is not iterable");t=Array.from(t);let[n]=e;if(n&&n.length!==2||e.length>1){const r=Uint32Array.from(t,(i,s)=>s);return e.length>1?(e=e.map(i=>t.map(i)),r.sort((i,s)=>{for(const o of e){const a=Ii(o[i],o[s]);if(a)return a}})):(n=t.map(n),r.sort((i,s)=>Ii(n[i],n[s]))),Tv(t,r)}return t.sort(jd(n))}function jd(t=Oe){if(t===Oe)return Ii;if(typeof t!="function")throw new TypeError("compare is not a function");return(e,n)=>{const r=t(e,n);return r||r===0?r:(t(n,n)===0)-(t(e,e)===0)}}function Ii(t,e){return(t==null||!(t>=t))-(e==null||!(e>=e))||(t<e?-1:t>e?1:0)}function lM(t,e,n){return(e.length!==2?xf(bv(t,e,n),(([r,i],[s,o])=>Oe(i,o)||Oe(r,s))):xf(_v(t,n),(([r,i],[s,o])=>e(i,o)||Oe(r,s)))).map(([r])=>r)}var hM=Array.prototype,fM=hM.slice;function Ah(t){return()=>t}const dM=Math.sqrt(50),pM=Math.sqrt(10),mM=Math.sqrt(2);function Pa(t,e,n){const r=(e-t)/Math.max(0,n),i=Math.floor(Math.log10(r)),s=r/Math.pow(10,i),o=s>=dM?10:s>=pM?5:s>=mM?2:1;let a,c,u;return i<0?(u=Math.pow(10,-i)/o,a=Math.round(t*u),c=Math.round(e*u),a/u<t&&++a,c/u>e&&--c,u=-u):(u=Math.pow(10,i)*o,a=Math.round(t/u),c=Math.round(e/u),a*u<t&&++a,c*u>e&&--c),c<a&&.5<=n&&n<2?Pa(t,e,n*2):[a,c,u]}function Fr(t,e,n){if(e=+e,t=+t,n=+n,!(n>0))return[];if(t===e)return[t];const r=e<t,[i,s,o]=r?Pa(e,t,n):Pa(t,e,n);if(!(s>=i))return[];const a=s-i+1,c=new Array(a);if(r)if(o<0)for(let u=0;u<a;++u)c[u]=(s-u)/-o;else for(let u=0;u<a;++u)c[u]=(s-u)*o;else if(o<0)for(let u=0;u<a;++u)c[u]=(i+u)/-o;else for(let u=0;u<a;++u)c[u]=(i+u)*o;return c}function $r(t,e,n){return e=+e,t=+t,n=+n,Pa(t,e,n)[2]}function qa(t,e,n){e=+e,t=+t,n=+n;const r=e<t,i=r?$r(e,t,n):$r(t,e,n);return(r?-1:1)*(i<0?1/-i:i)}function zd(t,e,n){let r;for(;;){const i=$r(t,e,n);if(i===r||i===0||!isFinite(i))return[t,e];i>0?(t=Math.floor(t/i)*i,e=Math.ceil(e/i)*i):i<0&&(t=Math.ceil(t*i)/i,e=Math.floor(e*i)/i),r=i}}function Bd(t){return Math.max(1,Math.ceil(Math.log(Wc(t))/Math.LN2)+1)}function Eg(){var t=Ri,e=Fs,n=Bd;function r(i){Array.isArray(i)||(i=Array.from(i));var s,o=i.length,a,c,u=new Array(o);for(s=0;s<o;++s)u[s]=t(i[s],s,i);var l=e(u),h=l[0],f=l[1],d=n(u,h,f);if(!Array.isArray(d)){const v=f,y=+d;if(e===Fs&&([h,f]=zd(h,f,y)),d=Fr(h,f,y),d[0]<=h&&(c=$r(h,f,y)),d[d.length-1]>=f)if(v>=f&&e===Fs){const w=$r(h,f,y);isFinite(w)&&(w>0?f=(Math.floor(f/w)+1)*w:w<0&&(f=(Math.ceil(f*-w)+1)/-w))}else d.pop()}for(var p=d.length,g=0,m=p;d[g]<=h;)++g;for(;d[m-1]>f;)--m;(g||m<p)&&(d=d.slice(g,m),p=m-g);var _=new Array(p+1),b;for(s=0;s<=p;++s)b=_[s]=[],b.x0=s>0?d[s-1]:h,b.x1=s<p?d[s]:f;if(isFinite(c)){if(c>0)for(s=0;s<o;++s)(a=u[s])!=null&&h<=a&&a<=f&&_[Math.min(p,Math.floor((a-h)/c))].push(i[s]);else if(c<0){for(s=0;s<o;++s)if((a=u[s])!=null&&h<=a&&a<=f){const v=Math.floor((h-a)*c);_[Math.min(p,v+(d[v]<=a))].push(i[s])}}}else for(s=0;s<o;++s)(a=u[s])!=null&&h<=a&&a<=f&&_[cr(d,a,0,p)].push(i[s]);return _}return r.value=function(i){return arguments.length?(t=typeof i=="function"?i:Ah(i),r):t},r.domain=function(i){return arguments.length?(e=typeof i=="function"?i:Ah([i[0],i[1]]),r):e},r.thresholds=function(i){return arguments.length?(n=typeof i=="function"?i:Ah(Array.isArray(i)?fM.call(i):i),r):n},r}function Hs(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n<r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n<i||n===void 0&&i>=i)&&(n=i)}return n}function Wd(t,e){let n,r=-1,i=-1;if(e===void 0)for(const s of t)++i,s!=null&&(n<s||n===void 0&&s>=s)&&(n=s,r=i);else for(let s of t)(s=e(s,++i,t))!=null&&(n<s||n===void 0&&s>=s)&&(n=s,r=i);return r}function Fa(t,e){let n;if(e===void 0)for(const r of t)r!=null&&(n>r||n===void 0&&r>=r)&&(n=r);else{let r=-1;for(let i of t)(i=e(i,++r,t))!=null&&(n>i||n===void 0&&i>=i)&&(n=i)}return n}function Ud(t,e){let n,r=-1,i=-1;if(e===void 0)for(const s of t)++i,s!=null&&(n>s||n===void 0&&s>=s)&&(n=s,r=i);else for(let s of t)(s=e(s,++i,t))!=null&&(n>s||n===void 0&&s>=s)&&(n=s,r=i);return r}function Uc(t,e,n=0,r=1/0,i){if(e=Math.floor(e),n=Math.floor(Math.max(0,n)),r=Math.floor(Math.min(t.length-1,r)),!(n<=e&&e<=r))return t;for(i=i===void 0?Ii:jd(i);r>n;){if(r-n>600){const c=r-n+1,u=e-n+1,l=Math.log(c),h=.5*Math.exp(2*l/3),f=.5*Math.sqrt(l*h*(c-h)/c)*(u-c/2<0?-1:1),d=Math.max(n,Math.floor(e-u*h/c+f)),p=Math.min(r,Math.floor(e+(c-u)*h/c+f));Uc(t,e,d,p,i)}const s=t[e];let o=n,a=r;for(hs(t,n,e),i(t[r],s)>0&&hs(t,n,r);o<a;){for(hs(t,o,a),++o,--a;i(t[o],s)<0;)++o;for(;i(t[a],s)>0;)--a}i(t[n],s)===0?hs(t,n,a):(++a,hs(t,a,r)),a<=e&&(n=a+1),e<=a&&(r=a-1)}return t}function hs(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function Sv(t,e=Oe){let n,r=!1;if(e.length===1){let i;for(const s of t){const o=e(s);(r?Oe(o,i)>0:Oe(o,o)===0)&&(n=s,i=o,r=!0)}}else for(const i of t)(r?e(i,n)>0:e(i,i)===0)&&(n=i,r=!0);return n}function Ys(t,e,n){if(t=Float64Array.from(UC(t,n)),!(!(r=t.length)||isNaN(e=+e))){if(e<=0||r<2)return Fa(t);if(e>=1)return Hs(t);var r,i=(r-1)*e,s=Math.floor(i),o=Hs(Uc(t,s).subarray(0,s+1)),a=Fa(t.subarray(s+1));return o+(a-o)*(i-s)}}function Cv(t,e,n=Da){if(!(!(r=t.length)||isNaN(e=+e))){if(e<=0||r<2)return+n(t[0],0,t);if(e>=1)return+n(t[r-1],r-1,t);var r,i=(r-1)*e,s=Math.floor(i),o=+n(t[s],s,t),a=+n(t[s+1],s+1,t);return o+(a-o)*(i-s)}}function Mv(t,e,n=Da){if(!isNaN(e=+e)){if(r=Float64Array.from(t,(a,c)=>Da(n(t[c],c,t))),e<=0)return Ud(r);if(e>=1)return Wd(r);var r,i=Uint32Array.from(t,(a,c)=>c),s=r.length-1,o=Math.floor(s*e);return Uc(i,o,0,s,(a,c)=>Ii(r[a],r[c])),o=Sv(i.subarray(0,o+1),a=>r[a]),o>=0?o:-1}}function gM(t,e,n){const r=Wc(t),i=Ys(t,.75)-Ys(t,.25);return r&&i?Math.ceil((n-e)/(2*i*Math.pow(r,-1/3))):1}function _M(t,e,n){const r=Wc(t),i=dv(t);return r&&i?Math.ceil((n-e)*Math.cbrt(r)/(3.49*i)):1}function yM(t,e){let n=0,r=0;if(e===void 0)for(let i of t)i!=null&&(i=+i)>=i&&(++n,r+=i);else{let i=-1;for(let s of t)(s=e(s,++i,t))!=null&&(s=+s)>=s&&(++n,r+=s)}if(n)return r/n}function vM(t,e){return Ys(t,.5,e)}function bM(t,e){return Mv(t,.5,e)}function*wM(t){for(const e of t)yield*e}function Gd(t){return Array.from(wM(t))}function xM(t,e){const n=new Gs;if(e===void 0)for(let s of t)s!=null&&s>=s&&n.set(s,(n.get(s)||0)+1);else{let s=-1;for(let o of t)(o=e(o,++s,t))!=null&&o>=o&&n.set(o,(n.get(o)||0)+1)}let r,i=0;for(const[s,o]of n)o>i&&(i=o,r=s);return r}function TM(t,e=SM){const n=[];let r,i=!1;for(const s of t)i&&n.push(e(r,s)),r=s,i=!0;return n}function SM(t,e){return[t,e]}function nr(t,e,n){t=+t,e=+e,n=(i=arguments.length)<2?(e=t,t=0,1):i<3?1:+n;for(var r=-1,i=Math.max(0,Math.ceil((e-t)/n))|0,s=new Array(i);++r<i;)s[r]=t+r*n;return s}function CM(t,e=Oe){if(typeof t[Symbol.iterator]!="function")throw new TypeError("values is not iterable");let n=Array.from(t);const r=new Float64Array(n.length);e.length!==2&&(n=n.map(e),e=Oe);const i=(a,c)=>e(n[a],n[c]);let s,o;return t=Uint32Array.from(n,(a,c)=>c),t.sort(e===Oe?(a,c)=>Ii(n[a],n[c]):jd(i)),t.forEach((a,c)=>{const u=i(a,s===void 0?a:s);u>=0?((s===void 0||u>0)&&(s=a,o=c),r[a]=o):r[a]=NaN}),r}function MM(t,e=Oe){let n,r=!1;if(e.length===1){let i;for(const s of t){const o=e(s);(r?Oe(o,i)<0:Oe(o,o)===0)&&(n=s,i=o,r=!0)}}else for(const i of t)(r?e(i,n)<0:e(i,i)===0)&&(n=i,r=!0);return n}function Av(t,e=Oe){if(e.length===1)return Ud(t,e);let n,r=-1,i=-1;for(const s of t)++i,(r<0?e(s,s)===0:e(s,n)<0)&&(n=s,r=i);return r}function AM(t,e=Oe){if(e.length===1)return Wd(t,e);let n,r=-1,i=-1;for(const s of t)++i,(r<0?e(s,s)===0:e(s,n)>0)&&(n=s,r=i);return r}function NM(t,e){const n=Av(t,e);return n<0?void 0:n}const kM=Nv(Math.random);function Nv(t){return function(n,r=0,i=n.length){let s=i-(r=+r);for(;s;){const o=t()*s--|0,a=n[s+r];n[s+r]=n[o+r],n[o+r]=a}return n}}function EM(t,e){let n=0;if(e===void 0)for(let r of t)(r=+r)&&(n+=r);else{let r=-1;for(let i of t)(i=+e(i,++r,t))&&(n+=i)}return n}function kv(t){if(!(s=t.length))return[];for(var e=-1,n=Fa(t,RM),r=new Array(n);++e<n;)for(var i=-1,s,o=r[e]=new Array(s);++i<s;)o[i]=t[i][e];return r}function RM(t){return t.length}function IM(){return kv(arguments)}function OM(t,e){if(typeof e!="function")throw new TypeError("test is not a function");let n=-1;for(const r of t)if(!e(r,++n,t))return!1;return!0}function DM(t,e){if(typeof e!="function")throw new TypeError("test is not a function");let n=-1;for(const r of t)if(e(r,++n,t))return!0;return!1}function PM(t,e){if(typeof e!="function")throw new TypeError("test is not a function");const n=[];let r=-1;for(const i of t)e(i,++r,t)&&n.push(i);return n}function qM(t,e){if(typeof t[Symbol.iterator]!="function")throw new TypeError("values is not iterable");if(typeof e!="function")throw new TypeError("mapper is not a function");return Array.from(t,(n,r)=>e(n,r,t))}function FM(t,e,n){if(typeof e!="function")throw new TypeError("reducer is not a function");const r=t[Symbol.iterator]();let i,s,o=-1;if(arguments.length<3){if({done:i,value:n}=r.next(),i)return;++o}for(;{done:i,value:s}=r.next(),!i;)n=e(n,s,++o,t);return n}function $M(t){if(typeof t[Symbol.iterator]!="function")throw new TypeError("values is not iterable");return Array.from(t).reverse()}function VM(t,...e){t=new qr(t);for(const n of e)for(const r of n)t.delete(r);return t}function LM(t,e){const n=e[Symbol.iterator](),r=new qr;for(const i of t){if(r.has(i))return!1;let s,o;for(;({value:s,done:o}=n.next())&&!o;){if(Object.is(i,s))return!1;r.add(s)}}return!0}function jM(t,...e){t=new qr(t),e=e.map(zM);e:for(const n of t)for(const r of e)if(!r.has(n)){t.delete(n);continue e}return t}function zM(t){return t instanceof qr?t:new qr(t)}function Ev(t,e){const n=t[Symbol.iterator](),r=new Set;for(const i of e){const s=Rg(i);if(r.has(s))continue;let o,a;for(;{value:o,done:a}=n.next();){if(a)return!1;const c=Rg(o);if(r.add(c),Object.is(s,c))break}}return!0}function Rg(t){return t!==null&&typeof t=="object"?t.valueOf():t}function BM(t,e){return Ev(e,t)}function WM(...t){const e=new qr;for(const n of t)for(const r of n)e.add(r);return e}function Xt(t,e){switch(arguments.length){case 0:break;case 1:this.range(t);break;default:this.range(e).domain(t);break}return this}function Wn(t,e){switch(arguments.length){case 0:break;case 1:{typeof t=="function"?this.interpolator(t):this.range(t);break}default:{this.domain(t),typeof e=="function"?this.interpolator(e):this.range(e);break}}return this}const Tf=Symbol("implicit");function Hd(){var t=new Gs,e=[],n=[],r=Tf;function i(s){let o=t.get(s);if(o===void 0){if(r!==Tf)return r;t.set(s,o=e.push(s)-1)}return n[o%n.length]}return i.domain=function(s){if(!arguments.length)return e.slice();e=[],t=new Gs;for(const o of s)t.has(o)||t.set(o,e.push(o)-1);return i},i.range=function(s){return arguments.length?(n=Array.from(s),i):n.slice()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return Hd(e,n).unknown(r)},Xt.apply(i,arguments),i}function Yd(){var t=Hd().unknown(void 0),e=t.domain,n=t.range,r=0,i=1,s,o,a=!1,c=0,u=0,l=.5;delete t.unknown;function h(){var f=e().length,d=i<r,p=d?i:r,g=d?r:i;s=(g-p)/Math.max(1,f-c+u*2),a&&(s=Math.floor(s)),p+=(g-p-s*(f-c))*l,o=s*(1-c),a&&(p=Math.round(p),o=Math.round(o));var m=nr(f).map(function(_){return p+s*_});return n(d?m.reverse():m)}return t.domain=function(f){return arguments.length?(e(f),h()):e()},t.range=function(f){return arguments.length?([r,i]=f,r=+r,i=+i,h()):[r,i]},t.rangeRound=function(f){return[r,i]=f,r=+r,i=+i,a=!0,h()},t.bandwidth=function(){return o},t.step=function(){return s},t.round=function(f){return arguments.length?(a=!!f,h()):a},t.padding=function(f){return arguments.length?(c=Math.min(1,u=+f),h()):c},t.paddingInner=function(f){return arguments.length?(c=Math.min(1,f),h()):c},t.paddingOuter=function(f){return arguments.length?(u=+f,h()):u},t.align=function(f){return arguments.length?(l=Math.max(0,Math.min(1,f)),h()):l},t.copy=function(){return Yd(e(),[r,i]).round(a).paddingInner(c).paddingOuter(u).align(l)},Xt.apply(h(),arguments)}function Rv(t){var e=t.copy;return t.padding=t.paddingOuter,delete t.paddingInner,delete t.paddingOuter,t.copy=function(){return Rv(e())},t}function UM(){return Rv(Yd.apply(null,arguments).paddingInner(1))}function es(t,e,n){t.prototype=e.prototype=n,n.constructor=t}function go(t,e){var n=Object.create(t.prototype);for(var r in e)n[r]=e[r];return n}function mr(){}var Vr=.7,Oi=1/Vr,Ti="\\s*([+-]?\\d+)\\s*",Xs="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",mn="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",GM=/^#([0-9a-f]{3,8})$/,HM=new RegExp(`^rgb\\(${Ti},${Ti},${Ti}\\)$`),YM=new RegExp(`^rgb\\(${mn},${mn},${mn}\\)$`),XM=new RegExp(`^rgba\\(${Ti},${Ti},${Ti},${Xs}\\)$`),ZM=new RegExp(`^rgba\\(${mn},${mn},${mn},${Xs}\\)$`),KM=new RegExp(`^hsl\\(${Xs},${mn},${mn}\\)$`),QM=new RegExp(`^hsla\\(${Xs},${mn},${mn},${Xs}\\)$`),Ig={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};es(mr,ur,{copy(t){return Object.assign(new this.constructor,this,t)},displayable(){return this.rgb().displayable()},hex:Og,formatHex:Og,formatHex8:JM,formatHsl:eA,formatRgb:Dg,toString:Dg});function Og(){return this.rgb().formatHex()}function JM(){return this.rgb().formatHex8()}function eA(){return Iv(this).formatHsl()}function Dg(){return this.rgb().formatRgb()}function ur(t){var e,n;return t=(t+"").trim().toLowerCase(),(e=GM.exec(t))?(n=e[1].length,e=parseInt(e[1],16),n===6?Pg(e):n===3?new Ge(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):n===8?Wo(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):n===4?Wo(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=HM.exec(t))?new Ge(e[1],e[2],e[3],1):(e=YM.exec(t))?new Ge(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=XM.exec(t))?Wo(e[1],e[2],e[3],e[4]):(e=ZM.exec(t))?Wo(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=KM.exec(t))?$g(e[1],e[2]/100,e[3]/100,1):(e=QM.exec(t))?$g(e[1],e[2]/100,e[3]/100,e[4]):Ig.hasOwnProperty(t)?Pg(Ig[t]):t==="transparent"?new Ge(NaN,NaN,NaN,0):null}function Pg(t){return new Ge(t>>16&255,t>>8&255,t&255,1)}function Wo(t,e,n,r){return r<=0&&(t=e=n=NaN),new Ge(t,e,n,r)}function Xd(t){return t instanceof mr||(t=ur(t)),t?(t=t.rgb(),new Ge(t.r,t.g,t.b,t.opacity)):new Ge}function Di(t,e,n,r){return arguments.length===1?Xd(t):new Ge(t,e,n,r??1)}function Ge(t,e,n,r){this.r=+t,this.g=+e,this.b=+n,this.opacity=+r}es(Ge,Di,go(mr,{brighter(t){return t=t==null?Oi:Math.pow(Oi,t),new Ge(this.r*t,this.g*t,this.b*t,this.opacity)},darker(t){return t=t==null?Vr:Math.pow(Vr,t),new Ge(this.r*t,this.g*t,this.b*t,this.opacity)},rgb(){return this},clamp(){return new Ge(Rr(this.r),Rr(this.g),Rr(this.b),$a(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:qg,formatHex:qg,formatHex8:tA,formatRgb:Fg,toString:Fg}));function qg(){return`#${Ar(this.r)}${Ar(this.g)}${Ar(this.b)}`}function tA(){return`#${Ar(this.r)}${Ar(this.g)}${Ar(this.b)}${Ar((isNaN(this.opacity)?1:this.opacity)*255)}`}function Fg(){const t=$a(this.opacity);return`${t===1?"rgb(":"rgba("}${Rr(this.r)}, ${Rr(this.g)}, ${Rr(this.b)}${t===1?")":`, ${t})`}`}function $a(t){return isNaN(t)?1:Math.max(0,Math.min(1,t))}function Rr(t){return Math.max(0,Math.min(255,Math.round(t)||0))}function Ar(t){return t=Rr(t),(t<16?"0":"")+t.toString(16)}function $g(t,e,n,r){return r<=0?t=e=n=NaN:n<=0||n>=1?t=e=NaN:e<=0&&(t=NaN),new Qt(t,e,n,r)}function Iv(t){if(t instanceof Qt)return new Qt(t.h,t.s,t.l,t.opacity);if(t instanceof mr||(t=ur(t)),!t)return new Qt;if(t instanceof Qt)return t;t=t.rgb();var e=t.r/255,n=t.g/255,r=t.b/255,i=Math.min(e,n,r),s=Math.max(e,n,r),o=NaN,a=s-i,c=(s+i)/2;return a?(e===s?o=(n-r)/a+(n<r)*6:n===s?o=(r-e)/a+2:o=(e-n)/a+4,a/=c<.5?s+i:2-s-i,o*=60):a=c>0&&c<1?0:o,new Qt(o,a,c,t.opacity)}function Va(t,e,n,r){return arguments.length===1?Iv(t):new Qt(t,e,n,r??1)}function Qt(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}es(Qt,Va,go(mr,{brighter(t){return t=t==null?Oi:Math.pow(Oi,t),new Qt(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Vr:Math.pow(Vr,t),new Qt(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=this.h%360+(this.h<0)*360,e=isNaN(t)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*e,i=2*n-r;return new Ge(Nh(t>=240?t-240:t+120,i,r),Nh(t,i,r),Nh(t<120?t+240:t-120,i,r),this.opacity)},clamp(){return new Qt(Vg(this.h),Uo(this.s),Uo(this.l),$a(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const t=$a(this.opacity);return`${t===1?"hsl(":"hsla("}${Vg(this.h)}, ${Uo(this.s)*100}%, ${Uo(this.l)*100}%${t===1?")":`, ${t})`}`}}));function Vg(t){return t=(t||0)%360,t<0?t+360:t}function Uo(t){return Math.max(0,Math.min(1,t||0))}function Nh(t,e,n){return(t<60?e+(n-e)*t/60:t<180?n:t<240?e+(n-e)*(240-t)/60:e)*255}const Ov=Math.PI/180,Dv=180/Math.PI,La=18,Pv=.96422,qv=1,Fv=.82521,$v=4/29,Si=6/29,Vv=3*Si*Si,nA=Si*Si*Si;function Lv(t){if(t instanceof nn)return new nn(t.l,t.a,t.b,t.opacity);if(t instanceof dn)return zv(t);t instanceof Ge||(t=Xd(t));var e=Ih(t.r),n=Ih(t.g),r=Ih(t.b),i=kh((.2225045*e+.7168786*n+.0606169*r)/qv),s,o;return e===n&&n===r?s=o=i:(s=kh((.4360747*e+.3850649*n+.1430804*r)/Pv),o=kh((.0139322*e+.0971045*n+.7141733*r)/Fv)),new nn(116*i-16,500*(s-i),200*(i-o),t.opacity)}function rA(t,e){return new nn(t,0,0,e??1)}function ja(t,e,n,r){return arguments.length===1?Lv(t):new nn(t,e,n,r??1)}function nn(t,e,n,r){this.l=+t,this.a=+e,this.b=+n,this.opacity=+r}es(nn,ja,go(mr,{brighter(t){return new nn(this.l+La*(t??1),this.a,this.b,this.opacity)},darker(t){return new nn(this.l-La*(t??1),this.a,this.b,this.opacity)},rgb(){var t=(this.l+16)/116,e=isNaN(this.a)?t:t+this.a/500,n=isNaN(this.b)?t:t-this.b/200;return e=Pv*Eh(e),t=qv*Eh(t),n=Fv*Eh(n),new Ge(Rh(3.1338561*e-1.6168667*t-.4906146*n),Rh(-.9787684*e+1.9161415*t+.033454*n),Rh(.0719453*e-.2289914*t+1.4052427*n),this.opacity)}}));function kh(t){return t>nA?Math.pow(t,1/3):t/Vv+$v}function Eh(t){return t>Si?t*t*t:Vv*(t-$v)}function Rh(t){return 255*(t<=.0031308?12.92*t:1.055*Math.pow(t,1/2.4)-.055)}function Ih(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function jv(t){if(t instanceof dn)return new dn(t.h,t.c,t.l,t.opacity);if(t instanceof nn||(t=Lv(t)),t.a===0&&t.b===0)return new dn(NaN,0<t.l&&t.l<100?0:NaN,t.l,t.opacity);var e=Math.atan2(t.b,t.a)*Dv;return new dn(e<0?e+360:e,Math.sqrt(t.a*t.a+t.b*t.b),t.l,t.opacity)}function iA(t,e,n,r){return arguments.length===1?jv(t):new dn(n,e,t,r??1)}function za(t,e,n,r){return arguments.length===1?jv(t):new dn(t,e,n,r??1)}function dn(t,e,n,r){this.h=+t,this.c=+e,this.l=+n,this.opacity=+r}function zv(t){if(isNaN(t.h))return new nn(t.l,0,0,t.opacity);var e=t.h*Ov;return new nn(t.l,Math.cos(e)*t.c,Math.sin(e)*t.c,t.opacity)}es(dn,za,go(mr,{brighter(t){return new dn(this.h,this.c,this.l+La*(t??1),this.opacity)},darker(t){return new dn(this.h,this.c,this.l-La*(t??1),this.opacity)},rgb(){return zv(this).rgb()}}));var Bv=-.14861,Zd=1.78277,Kd=-.29227,Gc=-.90649,Zs=1.97294,Lg=Zs*Gc,jg=Zs*Zd,zg=Zd*Kd-Gc*Bv;function sA(t){if(t instanceof Ir)return new Ir(t.h,t.s,t.l,t.opacity);t instanceof Ge||(t=Xd(t));var e=t.r/255,n=t.g/255,r=t.b/255,i=(zg*r+Lg*e-jg*n)/(zg+Lg-jg),s=r-i,o=(Zs*(n-i)-Kd*s)/Gc,a=Math.sqrt(o*o+s*s)/(Zs*i*(1-i)),c=a?Math.atan2(o,s)*Dv-120:NaN;return new Ir(c<0?c+360:c,a,i,t.opacity)}function rn(t,e,n,r){return arguments.length===1?sA(t):new Ir(t,e,n,r??1)}function Ir(t,e,n,r){this.h=+t,this.s=+e,this.l=+n,this.opacity=+r}es(Ir,rn,go(mr,{brighter(t){return t=t==null?Oi:Math.pow(Oi,t),new Ir(this.h,this.s,this.l*t,this.opacity)},darker(t){return t=t==null?Vr:Math.pow(Vr,t),new Ir(this.h,this.s,this.l*t,this.opacity)},rgb(){var t=isNaN(this.h)?0:(this.h+120)*Ov,e=+this.l,n=isNaN(this.s)?0:this.s*e*(1-e),r=Math.cos(t),i=Math.sin(t);return new Ge(255*(e+n*(Bv*r+Zd*i)),255*(e+n*(Kd*r+Gc*i)),255*(e+n*(Zs*r)),this.opacity)}}));function Wv(t,e,n,r,i){var s=t*t,o=s*t;return((1-3*t+3*s-o)*e+(4-6*s+3*o)*n+(1+3*t+3*s-3*o)*r+o*i)/6}function Uv(t){var e=t.length-1;return function(n){var r=n<=0?n=0:n>=1?(n=1,e-1):Math.floor(n*e),i=t[r],s=t[r+1],o=r>0?t[r-1]:2*i-s,a=r<e-1?t[r+2]:2*s-i;return Wv((n-r/e)*e,o,i,s,a)}}function Gv(t){var e=t.length;return function(n){var r=Math.floor(((n%=1)<0?++n:n)*e),i=t[(r+e-1)%e],s=t[r%e],o=t[(r+1)%e],a=t[(r+2)%e];return Wv((n-r/e)*e,i,s,o,a)}}const Hc=t=>()=>t;function Hv(t,e){return function(n){return t+n*e}}function oA(t,e,n){return t=Math.pow(t,n),e=Math.pow(e,n)-t,n=1/n,function(r){return Math.pow(t+r*e,n)}}function Yc(t,e){var n=e-t;return n?Hv(t,n>180||n<-180?n-360*Math.round(n/360):n):Hc(isNaN(t)?e:t)}function aA(t){return(t=+t)==1?He:function(e,n){return n-e?oA(e,n,t):Hc(isNaN(e)?n:e)}}function He(t,e){var n=e-t;return n?Hv(t,n):Hc(isNaN(t)?e:t)}const Ks=(function t(e){var n=aA(e);function r(i,s){var o=n((i=Di(i)).r,(s=Di(s)).r),a=n(i.g,s.g),c=n(i.b,s.b),u=He(i.opacity,s.opacity);return function(l){return i.r=o(l),i.g=a(l),i.b=c(l),i.opacity=u(l),i+""}}return r.gamma=t,r})(1);function Yv(t){return function(e){var n=e.length,r=new Array(n),i=new Array(n),s=new Array(n),o,a;for(o=0;o<n;++o)a=Di(e[o]),r[o]=a.r||0,i[o]=a.g||0,s[o]=a.b||0;return r=t(r),i=t(i),s=t(s),a.opacity=1,function(c){return a.r=r(c),a.g=i(c),a.b=s(c),a+""}}}var Xv=Yv(Uv),cA=Yv(Gv);function Qd(t,e){e||(e=[]);var n=t?Math.min(e.length,t.length):0,r=e.slice(),i;return function(s){for(i=0;i<n;++i)r[i]=t[i]*(1-s)+e[i]*s;return r}}function Zv(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)}function uA(t,e){return(Zv(e)?Qd:Kv)(t,e)}function Kv(t,e){var n=e?e.length:0,r=t?Math.min(n,t.length):0,i=new Array(r),s=new Array(n),o;for(o=0;o<r;++o)i[o]=gr(t[o],e[o]);for(;o<n;++o)s[o]=e[o];return function(a){for(o=0;o<r;++o)s[o]=i[o](a);return s}}function Qv(t,e){var n=new Date;return t=+t,e=+e,function(r){return n.setTime(t*(1-r)+e*r),n}}function zt(t,e){return t=+t,e=+e,function(n){return t*(1-n)+e*n}}function Jv(t,e){var n={},r={},i;(t===null||typeof t!="object")&&(t={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in t?n[i]=gr(t[i],e[i]):r[i]=e[i];return function(s){for(i in n)r[i]=n[i](s);return r}}var Sf=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Oh=new RegExp(Sf.source,"g");function lA(t){return function(){return t}}function hA(t){return function(e){return t(e)+""}}function Jd(t,e){var n=Sf.lastIndex=Oh.lastIndex=0,r,i,s,o=-1,a=[],c=[];for(t=t+"",e=e+"";(r=Sf.exec(t))&&(i=Oh.exec(e));)(s=i.index)>n&&(s=e.slice(n,s),a[o]?a[o]+=s:a[++o]=s),(r=r[0])===(i=i[0])?a[o]?a[o]+=i:a[++o]=i:(a[++o]=null,c.push({i:o,x:zt(r,i)})),n=Oh.lastIndex;return n<e.length&&(s=e.slice(n),a[o]?a[o]+=s:a[++o]=s),a.length<2?c[0]?hA(c[0].x):lA(e):(e=c.length,function(u){for(var l=0,h;l<e;++l)a[(h=c[l]).i]=h.x(u);return a.join("")})}function gr(t,e){var n=typeof e,r;return e==null||n==="boolean"?Hc(e):(n==="number"?zt:n==="string"?(r=ur(e))?(e=r,Ks):Jd:e instanceof ur?Ks:e instanceof Date?Qv:Zv(e)?Qd:Array.isArray(e)?Kv:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?Jv:zt)(t,e)}function fA(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}function dA(t,e){var n=Yc(+t,+e);return function(r){var i=n(r);return i-360*Math.floor(i/360)}}function Xc(t,e){return t=+t,e=+e,function(n){return Math.round(t*(1-n)+e*n)}}var Bg=180/Math.PI,Cf={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function eb(t,e,n,r,i,s){var o,a,c;return(o=Math.sqrt(t*t+e*e))&&(t/=o,e/=o),(c=t*n+e*r)&&(n-=t*c,r-=e*c),(a=Math.sqrt(n*n+r*r))&&(n/=a,r/=a,c/=a),t*r<e*n&&(t=-t,e=-e,c=-c,o=-o),{translateX:i,translateY:s,rotate:Math.atan2(e,t)*Bg,skewX:Math.atan(c)*Bg,scaleX:o,scaleY:a}}var Go;function pA(t){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(t+"");return e.isIdentity?Cf:eb(e.a,e.b,e.c,e.d,e.e,e.f)}function mA(t){return t==null||(Go||(Go=document.createElementNS("http://www.w3.org/2000/svg","g")),Go.setAttribute("transform",t),!(t=Go.transform.baseVal.consolidate()))?Cf:(t=t.matrix,eb(t.a,t.b,t.c,t.d,t.e,t.f))}function tb(t,e,n,r){function i(u){return u.length?u.pop()+" ":""}function s(u,l,h,f,d,p){if(u!==h||l!==f){var g=d.push("translate(",null,e,null,n);p.push({i:g-4,x:zt(u,h)},{i:g-2,x:zt(l,f)})}else(h||f)&&d.push("translate("+h+e+f+n)}function o(u,l,h,f){u!==l?(u-l>180?l+=360:l-u>180&&(u+=360),f.push({i:h.push(i(h)+"rotate(",null,r)-2,x:zt(u,l)})):l&&h.push(i(h)+"rotate("+l+r)}function a(u,l,h,f){u!==l?f.push({i:h.push(i(h)+"skewX(",null,r)-2,x:zt(u,l)}):l&&h.push(i(h)+"skewX("+l+r)}function c(u,l,h,f,d,p){if(u!==h||l!==f){var g=d.push(i(d)+"scale(",null,",",null,")");p.push({i:g-4,x:zt(u,h)},{i:g-2,x:zt(l,f)})}else(h!==1||f!==1)&&d.push(i(d)+"scale("+h+","+f+")")}return function(u,l){var h=[],f=[];return u=t(u),l=t(l),s(u.translateX,u.translateY,l.translateX,l.translateY,h,f),o(u.rotate,l.rotate,h,f),a(u.skewX,l.skewX,h,f),c(u.scaleX,u.scaleY,l.scaleX,l.scaleY,h,f),u=l=null,function(d){for(var p=-1,g=f.length,m;++p<g;)h[(m=f[p]).i]=m.x(d);return h.join("")}}}var nb=tb(pA,"px, ","px)","deg)"),rb=tb(mA,", ",")",")"),gA=1e-12;function Wg(t){return((t=Math.exp(t))+1/t)/2}function _A(t){return((t=Math.exp(t))-1/t)/2}function yA(t){return((t=Math.exp(2*t))-1)/(t+1)}const ib=(function t(e,n,r){function i(s,o){var a=s[0],c=s[1],u=s[2],l=o[0],h=o[1],f=o[2],d=l-a,p=h-c,g=d*d+p*p,m,_;if(g<gA)_=Math.log(f/u)/e,m=function(C){return[a+C*d,c+C*p,u*Math.exp(e*C*_)]};else{var b=Math.sqrt(g),v=(f*f-u*u+r*g)/(2*u*n*b),y=(f*f-u*u-r*g)/(2*f*n*b),w=Math.log(Math.sqrt(v*v+1)-v),x=Math.log(Math.sqrt(y*y+1)-y);_=(x-w)/e,m=function(C){var S=C*_,A=Wg(w),N=u/(n*b)*(A*yA(e*S+w)-_A(w));return[a+N*d,c+N*p,u*A/Wg(e*S+w)]}}return m.duration=_*1e3*e/Math.SQRT2,m}return i.rho=function(s){var o=Math.max(.001,+s),a=o*o,c=a*a;return t(o,a,c)},i})(Math.SQRT2,2,4);function sb(t){return function(e,n){var r=t((e=Va(e)).h,(n=Va(n)).h),i=He(e.s,n.s),s=He(e.l,n.l),o=He(e.opacity,n.opacity);return function(a){return e.h=r(a),e.s=i(a),e.l=s(a),e.opacity=o(a),e+""}}}const vA=sb(Yc);var bA=sb(He);function wA(t,e){var n=He((t=ja(t)).l,(e=ja(e)).l),r=He(t.a,e.a),i=He(t.b,e.b),s=He(t.opacity,e.opacity);return function(o){return t.l=n(o),t.a=r(o),t.b=i(o),t.opacity=s(o),t+""}}function ob(t){return function(e,n){var r=t((e=za(e)).h,(n=za(n)).h),i=He(e.c,n.c),s=He(e.l,n.l),o=He(e.opacity,n.opacity);return function(a){return e.h=r(a),e.c=i(a),e.l=s(a),e.opacity=o(a),e+""}}}const xA=ob(Yc);var TA=ob(He);function ab(t){return(function e(n){n=+n;function r(i,s){var o=t((i=rn(i)).h,(s=rn(s)).h),a=He(i.s,s.s),c=He(i.l,s.l),u=He(i.opacity,s.opacity);return function(l){return i.h=o(l),i.s=a(l),i.l=c(Math.pow(l,n)),i.opacity=u(l),i+""}}return r.gamma=e,r})(1)}const SA=ab(Yc);var Zc=ab(He);function cb(t,e){e===void 0&&(e=t,t=gr);for(var n=0,r=e.length-1,i=e[0],s=new Array(r<0?0:r);n<r;)s[n]=t(i,i=e[++n]);return function(o){var a=Math.max(0,Math.min(r-1,Math.floor(o*=r)));return s[a](o-a)}}function CA(t,e){for(var n=new Array(e),r=0;r<e;++r)n[r]=t(r/(e-1));return n}function MA(t){return function(){return t}}function Ba(t){return+t}var Ug=[0,1];function _t(t){return t}function Mf(t,e){return(e-=t=+t)?function(n){return(n-t)/e}:MA(isNaN(e)?NaN:.5)}function AA(t,e){var n;return t>e&&(n=t,t=e,e=n),function(r){return Math.max(t,Math.min(e,r))}}function NA(t,e,n){var r=t[0],i=t[1],s=e[0],o=e[1];return i<r?(r=Mf(i,r),s=n(o,s)):(r=Mf(r,i),s=n(s,o)),function(a){return s(r(a))}}function kA(t,e,n){var r=Math.min(t.length,e.length)-1,i=new Array(r),s=new Array(r),o=-1;for(t[r]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++o<r;)i[o]=Mf(t[o],t[o+1]),s[o]=n(e[o],e[o+1]);return function(a){var c=cr(t,a,1,r)-1;return s[c](i[c](a))}}function _o(t,e){return e.domain(t.domain()).range(t.range()).interpolate(t.interpolate()).clamp(t.clamp()).unknown(t.unknown())}function Kc(){var t=Ug,e=Ug,n=gr,r,i,s,o=_t,a,c,u;function l(){var f=Math.min(t.length,e.length);return o!==_t&&(o=AA(t[0],t[f-1])),a=f>2?kA:NA,c=u=null,h}function h(f){return f==null||isNaN(f=+f)?s:(c||(c=a(t.map(r),e,n)))(r(o(f)))}return h.invert=function(f){return o(i((u||(u=a(e,t.map(r),zt)))(f)))},h.domain=function(f){return arguments.length?(t=Array.from(f,Ba),l()):t.slice()},h.range=function(f){return arguments.length?(e=Array.from(f),l()):e.slice()},h.rangeRound=function(f){return e=Array.from(f),n=Xc,l()},h.clamp=function(f){return arguments.length?(o=f?!0:_t,l()):o!==_t},h.interpolate=function(f){return arguments.length?(n=f,l()):n},h.unknown=function(f){return arguments.length?(s=f,h):s},function(f,d){return r=f,i=d,l()}}function ep(){return Kc()(_t,_t)}function EA(t){return Math.abs(t=Math.round(t))>=1e21?t.toLocaleString("en").replace(/,/g,""):t.toString(10)}function Wa(t,e){if((n=(t=e?t.toExponential(e-1):t.toExponential()).indexOf("e"))<0)return null;var n,r=t.slice(0,n);return[r.length>1?r[0]+r.slice(2):r,+t.slice(n+1)]}function Pi(t){return t=Wa(Math.abs(t)),t?t[1]:NaN}function RA(t,e){return function(n,r){for(var i=n.length,s=[],o=0,a=t[0],c=0;i>0&&a>0&&(c+a+1>r&&(a=Math.max(1,r-c)),s.push(n.substring(i-=a,i+a)),!((c+=a+1)>r));)a=t[o=(o+1)%t.length];return s.reverse().join(e)}}function IA(t){return function(e){return e.replace(/[0-9]/g,function(n){return t[+n]})}}var OA=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function qi(t){if(!(e=OA.exec(t)))throw new Error("invalid format: "+t);var e;return new Qc({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}qi.prototype=Qc.prototype;function Qc(t){this.fill=t.fill===void 0?" ":t.fill+"",this.align=t.align===void 0?">":t.align+"",this.sign=t.sign===void 0?"-":t.sign+"",this.symbol=t.symbol===void 0?"":t.symbol+"",this.zero=!!t.zero,this.width=t.width===void 0?void 0:+t.width,this.comma=!!t.comma,this.precision=t.precision===void 0?void 0:+t.precision,this.trim=!!t.trim,this.type=t.type===void 0?"":t.type+""}Qc.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function DA(t){e:for(var e=t.length,n=1,r=-1,i;n<e;++n)switch(t[n]){case".":r=i=n;break;case"0":r===0&&(r=n),i=n;break;default:if(!+t[n])break e;r>0&&(r=0);break}return r>0?t.slice(0,r)+t.slice(i+1):t}var ub;function PA(t,e){var n=Wa(t,e);if(!n)return t+"";var r=n[0],i=n[1],s=i-(ub=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,o=r.length;return s===o?r:s>o?r+new Array(s-o+1).join("0"):s>0?r.slice(0,s)+"."+r.slice(s):"0."+new Array(1-s).join("0")+Wa(t,Math.max(0,e+s-1))[0]}function Gg(t,e){var n=Wa(t,e);if(!n)return t+"";var r=n[0],i=n[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Hg={"%":(t,e)=>(t*100).toFixed(e),b:t=>Math.round(t).toString(2),c:t=>t+"",d:EA,e:(t,e)=>t.toExponential(e),f:(t,e)=>t.toFixed(e),g:(t,e)=>t.toPrecision(e),o:t=>Math.round(t).toString(8),p:(t,e)=>Gg(t*100,e),r:Gg,s:PA,X:t=>Math.round(t).toString(16).toUpperCase(),x:t=>Math.round(t).toString(16)};function Yg(t){return t}var Xg=Array.prototype.map,Zg=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function lb(t){var e=t.grouping===void 0||t.thousands===void 0?Yg:RA(Xg.call(t.grouping,Number),t.thousands+""),n=t.currency===void 0?"":t.currency[0]+"",r=t.currency===void 0?"":t.currency[1]+"",i=t.decimal===void 0?".":t.decimal+"",s=t.numerals===void 0?Yg:IA(Xg.call(t.numerals,String)),o=t.percent===void 0?"%":t.percent+"",a=t.minus===void 0?"":t.minus+"",c=t.nan===void 0?"NaN":t.nan+"";function u(h){h=qi(h);var f=h.fill,d=h.align,p=h.sign,g=h.symbol,m=h.zero,_=h.width,b=h.comma,v=h.precision,y=h.trim,w=h.type;w==="n"?(b=!0,w="g"):Hg[w]||(v===void 0&&(v=12),y=!0,w="g"),(m||f==="0"&&d==="=")&&(m=!0,f="0",d="=");var x=g==="$"?n:g==="#"&&/[boxX]/.test(w)?"0"+w.toLowerCase():"",C=g==="$"?r:/[%p]/.test(w)?o:"",S=Hg[w],A=/[defgprs%]/.test(w);v=v===void 0?6:/[gprs]/.test(w)?Math.max(1,Math.min(21,v)):Math.max(0,Math.min(20,v));function N(T){var k=x,I=C,M,E,R;if(w==="c")I=S(T)+I,T="";else{T=+T;var O=T<0||1/T<0;if(T=isNaN(T)?c:S(Math.abs(T),v),y&&(T=DA(T)),O&&+T==0&&p!=="+"&&(O=!1),k=(O?p==="("?p:a:p==="-"||p==="("?"":p)+k,I=(w==="s"?Zg[8+ub/3]:"")+I+(O&&p==="("?")":""),A){for(M=-1,E=T.length;++M<E;)if(R=T.charCodeAt(M),48>R||R>57){I=(R===46?i+T.slice(M+1):T.slice(M))+I,T=T.slice(0,M);break}}}b&&!m&&(T=e(T,1/0));var q=k.length+T.length+I.length,D=q<_?new Array(_-q+1).join(f):"";switch(b&&m&&(T=e(D+T,D.length?_-I.length:1/0),D=""),d){case"<":T=k+T+I+D;break;case"=":T=k+D+T+I;break;case"^":T=D.slice(0,q=D.length>>1)+k+T+I+D.slice(q);break;default:T=D+k+T+I;break}return s(T)}return N.toString=function(){return h+""},N}function l(h,f){var d=u((h=qi(h),h.type="f",h)),p=Math.max(-8,Math.min(8,Math.floor(Pi(f)/3)))*3,g=Math.pow(10,-p),m=Zg[8+p/3];return function(_){return d(g*_)+m}}return{format:u,formatPrefix:l}}var Ho,Jc,tp;hb({thousands:",",grouping:[3],currency:["$",""]});function hb(t){return Ho=lb(t),Jc=Ho.format,tp=Ho.formatPrefix,Ho}function fb(t){return Math.max(0,-Pi(Math.abs(t)))}function db(t,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Pi(e)/3)))*3-Pi(Math.abs(t)))}function pb(t,e){return t=Math.abs(t),e=Math.abs(e)-t,Math.max(0,Pi(e)-Pi(t))+1}function mb(t,e,n,r){var i=qa(t,e,n),s;switch(r=qi(r??",f"),r.type){case"s":{var o=Math.max(Math.abs(t),Math.abs(e));return r.precision==null&&!isNaN(s=db(i,o))&&(r.precision=s),tp(r,o)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(s=pb(i,Math.max(Math.abs(t),Math.abs(e))))&&(r.precision=s-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(s=fb(i))&&(r.precision=s-(r.type==="%")*2);break}}return Jc(r)}function _r(t){var e=t.domain;return t.ticks=function(n){var r=e();return Fr(r[0],r[r.length-1],n??10)},t.tickFormat=function(n,r){var i=e();return mb(i[0],i[i.length-1],n??10,r)},t.nice=function(n){n==null&&(n=10);var r=e(),i=0,s=r.length-1,o=r[i],a=r[s],c,u,l=10;for(a<o&&(u=o,o=a,a=u,u=i,i=s,s=u);l-- >0;){if(u=$r(o,a,n),u===c)return r[i]=o,r[s]=a,e(r);if(u>0)o=Math.floor(o/u)*u,a=Math.ceil(a/u)*u;else if(u<0)o=Math.ceil(o*u)/u,a=Math.floor(a*u)/u;else break;c=u}return t},t}function gb(){var t=ep();return t.copy=function(){return _o(t,gb())},Xt.apply(t,arguments),_r(t)}function _b(t){var e;function n(r){return r==null||isNaN(r=+r)?e:r}return n.invert=n,n.domain=n.range=function(r){return arguments.length?(t=Array.from(r,Ba),n):t.slice()},n.unknown=function(r){return arguments.length?(e=r,n):e},n.copy=function(){return _b(t).unknown(e)},t=arguments.length?Array.from(t,Ba):[0,1],_r(n)}function yb(t,e){t=t.slice();var n=0,r=t.length-1,i=t[n],s=t[r],o;return s<i&&(o=n,n=r,r=o,o=i,i=s,s=o),t[n]=e.floor(i),t[r]=e.ceil(s),t}function Kg(t){return Math.log(t)}function Qg(t){return Math.exp(t)}function qA(t){return-Math.log(-t)}function FA(t){return-Math.exp(-t)}function $A(t){return isFinite(t)?+("1e"+t):t<0?0:t}function VA(t){return t===10?$A:t===Math.E?Math.exp:e=>Math.pow(t,e)}function LA(t){return t===Math.E?Math.log:t===10&&Math.log10||t===2&&Math.log2||(t=Math.log(t),e=>Math.log(e)/t)}function Jg(t){return(e,n)=>-t(-e,n)}function np(t){const e=t(Kg,Qg),n=e.domain;let r=10,i,s;function o(){return i=LA(r),s=VA(r),n()[0]<0?(i=Jg(i),s=Jg(s),t(qA,FA)):t(Kg,Qg),e}return e.base=function(a){return arguments.length?(r=+a,o()):r},e.domain=function(a){return arguments.length?(n(a),o()):n()},e.ticks=a=>{const c=n();let u=c[0],l=c[c.length-1];const h=l<u;h&&([u,l]=[l,u]);let f=i(u),d=i(l),p,g;const m=a==null?10:+a;let _=[];if(!(r%1)&&d-f<m){if(f=Math.floor(f),d=Math.ceil(d),u>0){for(;f<=d;++f)for(p=1;p<r;++p)if(g=f<0?p/s(-f):p*s(f),!(g<u)){if(g>l)break;_.push(g)}}else for(;f<=d;++f)for(p=r-1;p>=1;--p)if(g=f>0?p/s(-f):p*s(f),!(g<u)){if(g>l)break;_.push(g)}_.length*2<m&&(_=Fr(u,l,m))}else _=Fr(f,d,Math.min(d-f,m)).map(s);return h?_.reverse():_},e.tickFormat=(a,c)=>{if(a==null&&(a=10),c==null&&(c=r===10?"s":","),typeof c!="function"&&(!(r%1)&&(c=qi(c)).precision==null&&(c.trim=!0),c=Jc(c)),a===1/0)return c;const u=Math.max(1,r*a/e.ticks().length);return l=>{let h=l/s(Math.round(i(l)));return h*r<r-.5&&(h*=r),h<=u?c(l):""}},e.nice=()=>n(yb(n(),{floor:a=>s(Math.floor(i(a))),ceil:a=>s(Math.ceil(i(a)))})),e}function vb(){const t=np(Kc()).domain([1,10]);return t.copy=()=>_o(t,vb()).base(t.base()),Xt.apply(t,arguments),t}function e1(t){return function(e){return Math.sign(e)*Math.log1p(Math.abs(e/t))}}function t1(t){return function(e){return Math.sign(e)*Math.expm1(Math.abs(e))*t}}function rp(t){var e=1,n=t(e1(e),t1(e));return n.constant=function(r){return arguments.length?t(e1(e=+r),t1(e)):e},_r(n)}function bb(){var t=rp(Kc());return t.copy=function(){return _o(t,bb()).constant(t.constant())},Xt.apply(t,arguments)}function n1(t){return function(e){return e<0?-Math.pow(-e,t):Math.pow(e,t)}}function jA(t){return t<0?-Math.sqrt(-t):Math.sqrt(t)}function zA(t){return t<0?-t*t:t*t}function ip(t){var e=t(_t,_t),n=1;function r(){return n===1?t(_t,_t):n===.5?t(jA,zA):t(n1(n),n1(1/n))}return e.exponent=function(i){return arguments.length?(n=+i,r()):n},_r(e)}function sp(){var t=ip(Kc());return t.copy=function(){return _o(t,sp()).exponent(t.exponent())},Xt.apply(t,arguments),t}function BA(){return sp.apply(null,arguments).exponent(.5)}function r1(t){return Math.sign(t)*t*t}function WA(t){return Math.sign(t)*Math.sqrt(Math.abs(t))}function wb(){var t=ep(),e=[0,1],n=!1,r;function i(s){var o=WA(t(s));return isNaN(o)?r:n?Math.round(o):o}return i.invert=function(s){return t.invert(r1(s))},i.domain=function(s){return arguments.length?(t.domain(s),i):t.domain()},i.range=function(s){return arguments.length?(t.range((e=Array.from(s,Ba)).map(r1)),i):e.slice()},i.rangeRound=function(s){return i.range(s).round(!0)},i.round=function(s){return arguments.length?(n=!!s,i):n},i.clamp=function(s){return arguments.length?(t.clamp(s),i):t.clamp()},i.unknown=function(s){return arguments.length?(r=s,i):r},i.copy=function(){return wb(t.domain(),e).round(n).clamp(t.clamp()).unknown(r)},Xt.apply(i,arguments),_r(i)}function xb(){var t=[],e=[],n=[],r;function i(){var o=0,a=Math.max(1,e.length);for(n=new Array(a-1);++o<a;)n[o-1]=Cv(t,o/a);return s}function s(o){return o==null||isNaN(o=+o)?r:e[cr(n,o)]}return s.invertExtent=function(o){var a=e.indexOf(o);return a<0?[NaN,NaN]:[a>0?n[a-1]:t[0],a<n.length?n[a]:t[t.length-1]]},s.domain=function(o){if(!arguments.length)return t.slice();t=[];for(let a of o)a!=null&&!isNaN(a=+a)&&t.push(a);return t.sort(Oe),i()},s.range=function(o){return arguments.length?(e=Array.from(o),i()):e.slice()},s.unknown=function(o){return arguments.length?(r=o,s):r},s.quantiles=function(){return n.slice()},s.copy=function(){return xb().domain(t).range(e).unknown(r)},Xt.apply(s,arguments)}function Tb(){var t=0,e=1,n=1,r=[.5],i=[0,1],s;function o(c){return c!=null&&c<=c?i[cr(r,c,0,n)]:s}function a(){var c=-1;for(r=new Array(n);++c<n;)r[c]=((c+1)*e-(c-n)*t)/(n+1);return o}return o.domain=function(c){return arguments.length?([t,e]=c,t=+t,e=+e,a()):[t,e]},o.range=function(c){return arguments.length?(n=(i=Array.from(c)).length-1,a()):i.slice()},o.invertExtent=function(c){var u=i.indexOf(c);return u<0?[NaN,NaN]:u<1?[t,r[0]]:u>=n?[r[n-1],e]:[r[u-1],r[u]]},o.unknown=function(c){return arguments.length&&(s=c),o},o.thresholds=function(){return r.slice()},o.copy=function(){return Tb().domain([t,e]).range(i).unknown(s)},Xt.apply(_r(o),arguments)}function Sb(){var t=[.5],e=[0,1],n,r=1;function i(s){return s!=null&&s<=s?e[cr(t,s,0,r)]:n}return i.domain=function(s){return arguments.length?(t=Array.from(s),r=Math.min(t.length,e.length-1),i):t.slice()},i.range=function(s){return arguments.length?(e=Array.from(s),r=Math.min(t.length,e.length-1),i):e.slice()},i.invertExtent=function(s){var o=e.indexOf(s);return[t[o-1],t[o]]},i.unknown=function(s){return arguments.length?(n=s,i):n},i.copy=function(){return Sb().domain(t).range(e).unknown(n)},Xt.apply(i,arguments)}const Dh=new Date,Ph=new Date;function ze(t,e,n,r){function i(s){return t(s=arguments.length===0?new Date:new Date(+s)),s}return i.floor=s=>(t(s=new Date(+s)),s),i.ceil=s=>(t(s=new Date(s-1)),e(s,1),t(s),s),i.round=s=>{const o=i(s),a=i.ceil(s);return s-o<a-s?o:a},i.offset=(s,o)=>(e(s=new Date(+s),o==null?1:Math.floor(o)),s),i.range=(s,o,a)=>{const c=[];if(s=i.ceil(s),a=a==null?1:Math.floor(a),!(s<o)||!(a>0))return c;let u;do c.push(u=new Date(+s)),e(s,a),t(s);while(u<s&&s<o);return c},i.filter=s=>ze(o=>{if(o>=o)for(;t(o),!s(o);)o.setTime(o-1)},(o,a)=>{if(o>=o)if(a<0)for(;++a<=0;)for(;e(o,-1),!s(o););else for(;--a>=0;)for(;e(o,1),!s(o););}),n&&(i.count=(s,o)=>(Dh.setTime(+s),Ph.setTime(+o),t(Dh),t(Ph),Math.floor(n(Dh,Ph))),i.every=s=>(s=Math.floor(s),!isFinite(s)||!(s>0)?null:s>1?i.filter(r?o=>r(o)%s===0:o=>i.count(0,o)%s===0):i)),i}const Fi=ze(()=>{},(t,e)=>{t.setTime(+t+e)},(t,e)=>e-t);Fi.every=t=>(t=Math.floor(t),!isFinite(t)||!(t>0)?null:t>1?ze(e=>{e.setTime(Math.floor(e/t)*t)},(e,n)=>{e.setTime(+e+n*t)},(e,n)=>(n-e)/t):Fi);const i1=Fi.range,Dn=1e3,Ut=Dn*60,Pn=Ut*60,Vn=Pn*24,op=Vn*7,s1=Vn*30,qh=Vn*365,qn=ze(t=>{t.setTime(t-t.getMilliseconds())},(t,e)=>{t.setTime(+t+e*Dn)},(t,e)=>(e-t)/Dn,t=>t.getUTCSeconds()),o1=qn.range,eu=ze(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Dn)},(t,e)=>{t.setTime(+t+e*Ut)},(t,e)=>(e-t)/Ut,t=>t.getMinutes()),UA=eu.range,tu=ze(t=>{t.setUTCSeconds(0,0)},(t,e)=>{t.setTime(+t+e*Ut)},(t,e)=>(e-t)/Ut,t=>t.getUTCMinutes()),GA=tu.range,nu=ze(t=>{t.setTime(t-t.getMilliseconds()-t.getSeconds()*Dn-t.getMinutes()*Ut)},(t,e)=>{t.setTime(+t+e*Pn)},(t,e)=>(e-t)/Pn,t=>t.getHours()),HA=nu.range,ru=ze(t=>{t.setUTCMinutes(0,0,0)},(t,e)=>{t.setTime(+t+e*Pn)},(t,e)=>(e-t)/Pn,t=>t.getUTCHours()),YA=ru.range,ts=ze(t=>t.setHours(0,0,0,0),(t,e)=>t.setDate(t.getDate()+e),(t,e)=>(e-t-(e.getTimezoneOffset()-t.getTimezoneOffset())*Ut)/Vn,t=>t.getDate()-1),XA=ts.range,yo=ze(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Vn,t=>t.getUTCDate()-1),ZA=yo.range,ap=ze(t=>{t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCDate(t.getUTCDate()+e)},(t,e)=>(e-t)/Vn,t=>Math.floor(t/Vn)),KA=ap.range;function Zr(t){return ze(e=>{e.setDate(e.getDate()-(e.getDay()+7-t)%7),e.setHours(0,0,0,0)},(e,n)=>{e.setDate(e.getDate()+n*7)},(e,n)=>(n-e-(n.getTimezoneOffset()-e.getTimezoneOffset())*Ut)/op)}const $i=Zr(0),Qs=Zr(1),Cb=Zr(2),Mb=Zr(3),Lr=Zr(4),Ab=Zr(5),Nb=Zr(6),a1=$i.range,QA=Qs.range,JA=Cb.range,e5=Mb.range,t5=Lr.range,n5=Ab.range,r5=Nb.range;function Kr(t){return ze(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-t)%7),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCDate(e.getUTCDate()+n*7)},(e,n)=>(n-e)/op)}const Vi=Kr(0),Js=Kr(1),kb=Kr(2),Eb=Kr(3),jr=Kr(4),Rb=Kr(5),Ib=Kr(6),c1=Vi.range,i5=Js.range,s5=kb.range,o5=Eb.range,a5=jr.range,c5=Rb.range,u5=Ib.range,iu=ze(t=>{t.setDate(1),t.setHours(0,0,0,0)},(t,e)=>{t.setMonth(t.getMonth()+e)},(t,e)=>e.getMonth()-t.getMonth()+(e.getFullYear()-t.getFullYear())*12,t=>t.getMonth()),l5=iu.range,su=ze(t=>{t.setUTCDate(1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCMonth(t.getUTCMonth()+e)},(t,e)=>e.getUTCMonth()-t.getUTCMonth()+(e.getUTCFullYear()-t.getUTCFullYear())*12,t=>t.getUTCMonth()),h5=su.range,gn=ze(t=>{t.setMonth(0,1),t.setHours(0,0,0,0)},(t,e)=>{t.setFullYear(t.getFullYear()+e)},(t,e)=>e.getFullYear()-t.getFullYear(),t=>t.getFullYear());gn.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:ze(e=>{e.setFullYear(Math.floor(e.getFullYear()/t)*t),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,n)=>{e.setFullYear(e.getFullYear()+n*t)});const f5=gn.range,_n=ze(t=>{t.setUTCMonth(0,1),t.setUTCHours(0,0,0,0)},(t,e)=>{t.setUTCFullYear(t.getUTCFullYear()+e)},(t,e)=>e.getUTCFullYear()-t.getUTCFullYear(),t=>t.getUTCFullYear());_n.every=t=>!isFinite(t=Math.floor(t))||!(t>0)?null:ze(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/t)*t),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,n)=>{e.setUTCFullYear(e.getUTCFullYear()+n*t)});const d5=_n.range;function Ob(t,e,n,r,i,s){const o=[[qn,1,Dn],[qn,5,5*Dn],[qn,15,15*Dn],[qn,30,30*Dn],[s,1,Ut],[s,5,5*Ut],[s,15,15*Ut],[s,30,30*Ut],[i,1,Pn],[i,3,3*Pn],[i,6,6*Pn],[i,12,12*Pn],[r,1,Vn],[r,2,2*Vn],[n,1,op],[e,1,s1],[e,3,3*s1],[t,1,qh]];function a(u,l,h){const f=l<u;f&&([u,l]=[l,u]);const d=h&&typeof h.range=="function"?h:c(u,l,h),p=d?d.range(u,+l+1):[];return f?p.reverse():p}function c(u,l,h){const f=Math.abs(l-u)/h,d=Bc(([,,m])=>m).right(o,f);if(d===o.length)return t.every(qa(u/qh,l/qh,h));if(d===0)return Fi.every(Math.max(qa(u,l,h),1));const[p,g]=o[f/o[d-1][2]<o[d][2]/f?d-1:d];return p.every(g)}return[a,c]}const[Db,Pb]=Ob(_n,su,Vi,ap,ru,tu),[qb,Fb]=Ob(gn,iu,$i,ts,nu,eu);function Fh(t){if(0<=t.y&&t.y<100){var e=new Date(-1,t.m,t.d,t.H,t.M,t.S,t.L);return e.setFullYear(t.y),e}return new Date(t.y,t.m,t.d,t.H,t.M,t.S,t.L)}function $h(t){if(0<=t.y&&t.y<100){var e=new Date(Date.UTC(-1,t.m,t.d,t.H,t.M,t.S,t.L));return e.setUTCFullYear(t.y),e}return new Date(Date.UTC(t.y,t.m,t.d,t.H,t.M,t.S,t.L))}function fs(t,e,n){return{y:t,m:e,d:n,H:0,M:0,S:0,L:0}}function $b(t){var e=t.dateTime,n=t.date,r=t.time,i=t.periods,s=t.days,o=t.shortDays,a=t.months,c=t.shortMonths,u=ds(i),l=ps(i),h=ds(s),f=ps(s),d=ds(o),p=ps(o),g=ds(a),m=ps(a),_=ds(c),b=ps(c),v={a:O,A:q,b:D,B:$,c:null,d:p1,e:p1,f:q5,g:G5,G:Y5,H:O5,I:D5,j:P5,L:Vb,m:F5,M:$5,p:F,q:L,Q:_1,s:y1,S:V5,u:L5,U:j5,V:z5,w:B5,W:W5,x:null,X:null,y:U5,Y:H5,Z:X5,"%":g1},y={a:te,A:Z,b:W,B:ne,c:null,d:m1,e:m1,f:J5,g:u3,G:h3,H:Z5,I:K5,j:Q5,L:jb,m:e3,M:t3,p:J,q:B,Q:_1,s:y1,S:n3,u:r3,U:i3,V:s3,w:o3,W:a3,x:null,X:null,y:c3,Y:l3,Z:f3,"%":g1},w={a:N,A:T,b:k,B:I,c:M,d:f1,e:f1,f:k5,g:h1,G:l1,H:d1,I:d1,j:C5,L:N5,m:S5,M:M5,p:A,q:T5,Q:R5,s:I5,S:A5,u:y5,U:v5,V:b5,w:_5,W:w5,x:E,X:R,y:h1,Y:l1,Z:x5,"%":E5};v.x=x(n,v),v.X=x(r,v),v.c=x(e,v),y.x=x(n,y),y.X=x(r,y),y.c=x(e,y);function x(z,Y){return function(K){var V=[],ve=-1,ge=0,j=z.length,H,U,se;for(K instanceof Date||(K=new Date(+K));++ve<j;)z.charCodeAt(ve)===37&&(V.push(z.slice(ge,ve)),(U=u1[H=z.charAt(++ve)])!=null?H=z.charAt(++ve):U=H==="e"?" ":"0",(se=Y[H])&&(H=se(K,U)),V.push(H),ge=ve+1);return V.push(z.slice(ge,ve)),V.join("")}}function C(z,Y){return function(K){var V=fs(1900,void 0,1),ve=S(V,z,K+="",0),ge,j;if(ve!=K.length)return null;if("Q"in V)return new Date(V.Q);if("s"in V)return new Date(V.s*1e3+("L"in V?V.L:0));if(Y&&!("Z"in V)&&(V.Z=0),"p"in V&&(V.H=V.H%12+V.p*12),V.m===void 0&&(V.m="q"in V?V.q:0),"V"in V){if(V.V<1||V.V>53)return null;"w"in V||(V.w=1),"Z"in V?(ge=$h(fs(V.y,0,1)),j=ge.getUTCDay(),ge=j>4||j===0?Js.ceil(ge):Js(ge),ge=yo.offset(ge,(V.V-1)*7),V.y=ge.getUTCFullYear(),V.m=ge.getUTCMonth(),V.d=ge.getUTCDate()+(V.w+6)%7):(ge=Fh(fs(V.y,0,1)),j=ge.getDay(),ge=j>4||j===0?Qs.ceil(ge):Qs(ge),ge=ts.offset(ge,(V.V-1)*7),V.y=ge.getFullYear(),V.m=ge.getMonth(),V.d=ge.getDate()+(V.w+6)%7)}else("W"in V||"U"in V)&&("w"in V||(V.w="u"in V?V.u%7:"W"in V?1:0),j="Z"in V?$h(fs(V.y,0,1)).getUTCDay():Fh(fs(V.y,0,1)).getDay(),V.m=0,V.d="W"in V?(V.w+6)%7+V.W*7-(j+5)%7:V.w+V.U*7-(j+6)%7);return"Z"in V?(V.H+=V.Z/100|0,V.M+=V.Z%100,$h(V)):Fh(V)}}function S(z,Y,K,V){for(var ve=0,ge=Y.length,j=K.length,H,U;ve<ge;){if(V>=j)return-1;if(H=Y.charCodeAt(ve++),H===37){if(H=Y.charAt(ve++),U=w[H in u1?Y.charAt(ve++):H],!U||(V=U(z,K,V))<0)return-1}else if(H!=K.charCodeAt(V++))return-1}return V}function A(z,Y,K){var V=u.exec(Y.slice(K));return V?(z.p=l.get(V[0].toLowerCase()),K+V[0].length):-1}function N(z,Y,K){var V=d.exec(Y.slice(K));return V?(z.w=p.get(V[0].toLowerCase()),K+V[0].length):-1}function T(z,Y,K){var V=h.exec(Y.slice(K));return V?(z.w=f.get(V[0].toLowerCase()),K+V[0].length):-1}function k(z,Y,K){var V=_.exec(Y.slice(K));return V?(z.m=b.get(V[0].toLowerCase()),K+V[0].length):-1}function I(z,Y,K){var V=g.exec(Y.slice(K));return V?(z.m=m.get(V[0].toLowerCase()),K+V[0].length):-1}function M(z,Y,K){return S(z,e,Y,K)}function E(z,Y,K){return S(z,n,Y,K)}function R(z,Y,K){return S(z,r,Y,K)}function O(z){return o[z.getDay()]}function q(z){return s[z.getDay()]}function D(z){return c[z.getMonth()]}function $(z){return a[z.getMonth()]}function F(z){return i[+(z.getHours()>=12)]}function L(z){return 1+~~(z.getMonth()/3)}function te(z){return o[z.getUTCDay()]}function Z(z){return s[z.getUTCDay()]}function W(z){return c[z.getUTCMonth()]}function ne(z){return a[z.getUTCMonth()]}function J(z){return i[+(z.getUTCHours()>=12)]}function B(z){return 1+~~(z.getUTCMonth()/3)}return{format:function(z){var Y=x(z+="",v);return Y.toString=function(){return z},Y},parse:function(z){var Y=C(z+="",!1);return Y.toString=function(){return z},Y},utcFormat:function(z){var Y=x(z+="",y);return Y.toString=function(){return z},Y},utcParse:function(z){var Y=C(z+="",!0);return Y.toString=function(){return z},Y}}}var u1={"-":"",_:" ",0:"0"},Ke=/^\s*\d+/,p5=/^%/,m5=/[\\^$*+?|[\]().{}]/g;function _e(t,e,n){var r=t<0?"-":"",i=(r?-t:t)+"",s=i.length;return r+(s<n?new Array(n-s+1).join(e)+i:i)}function g5(t){return t.replace(m5,"\\$&")}function ds(t){return new RegExp("^(?:"+t.map(g5).join("|")+")","i")}function ps(t){return new Map(t.map((e,n)=>[e.toLowerCase(),n]))}function _5(t,e,n){var r=Ke.exec(e.slice(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function y5(t,e,n){var r=Ke.exec(e.slice(n,n+1));return r?(t.u=+r[0],n+r[0].length):-1}function v5(t,e,n){var r=Ke.exec(e.slice(n,n+2));return r?(t.U=+r[0],n+r[0].length):-1}function b5(t,e,n){var r=Ke.exec(e.slice(n,n+2));return r?(t.V=+r[0],n+r[0].length):-1}function w5(t,e,n){var r=Ke.exec(e.slice(n,n+2));return r?(t.W=+r[0],n+r[0].length):-1}function l1(t,e,n){var r=Ke.exec(e.slice(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function h1(t,e,n){var r=Ke.exec(e.slice(n,n+2));return r?(t.y=+r[0]+(+r[0]>68?1900:2e3),n+r[0].length):-1}function x5(t,e,n){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(n,n+6));return r?(t.Z=r[1]?0:-(r[2]+(r[3]||"00")),n+r[0].length):-1}function T5(t,e,n){var r=Ke.exec(e.slice(n,n+1));return r?(t.q=r[0]*3-3,n+r[0].length):-1}function S5(t,e,n){var r=Ke.exec(e.slice(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function f1(t,e,n){var r=Ke.exec(e.slice(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function C5(t,e,n){var r=Ke.exec(e.slice(n,n+3));return r?(t.m=0,t.d=+r[0],n+r[0].length):-1}function d1(t,e,n){var r=Ke.exec(e.slice(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function M5(t,e,n){var r=Ke.exec(e.slice(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function A5(t,e,n){var r=Ke.exec(e.slice(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function N5(t,e,n){var r=Ke.exec(e.slice(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function k5(t,e,n){var r=Ke.exec(e.slice(n,n+6));return r?(t.L=Math.floor(r[0]/1e3),n+r[0].length):-1}function E5(t,e,n){var r=p5.exec(e.slice(n,n+1));return r?n+r[0].length:-1}function R5(t,e,n){var r=Ke.exec(e.slice(n));return r?(t.Q=+r[0],n+r[0].length):-1}function I5(t,e,n){var r=Ke.exec(e.slice(n));return r?(t.s=+r[0],n+r[0].length):-1}function p1(t,e){return _e(t.getDate(),e,2)}function O5(t,e){return _e(t.getHours(),e,2)}function D5(t,e){return _e(t.getHours()%12||12,e,2)}function P5(t,e){return _e(1+ts.count(gn(t),t),e,3)}function Vb(t,e){return _e(t.getMilliseconds(),e,3)}function q5(t,e){return Vb(t,e)+"000"}function F5(t,e){return _e(t.getMonth()+1,e,2)}function $5(t,e){return _e(t.getMinutes(),e,2)}function V5(t,e){return _e(t.getSeconds(),e,2)}function L5(t){var e=t.getDay();return e===0?7:e}function j5(t,e){return _e($i.count(gn(t)-1,t),e,2)}function Lb(t){var e=t.getDay();return e>=4||e===0?Lr(t):Lr.ceil(t)}function z5(t,e){return t=Lb(t),_e(Lr.count(gn(t),t)+(gn(t).getDay()===4),e,2)}function B5(t){return t.getDay()}function W5(t,e){return _e(Qs.count(gn(t)-1,t),e,2)}function U5(t,e){return _e(t.getFullYear()%100,e,2)}function G5(t,e){return t=Lb(t),_e(t.getFullYear()%100,e,2)}function H5(t,e){return _e(t.getFullYear()%1e4,e,4)}function Y5(t,e){var n=t.getDay();return t=n>=4||n===0?Lr(t):Lr.ceil(t),_e(t.getFullYear()%1e4,e,4)}function X5(t){var e=t.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+_e(e/60|0,"0",2)+_e(e%60,"0",2)}function m1(t,e){return _e(t.getUTCDate(),e,2)}function Z5(t,e){return _e(t.getUTCHours(),e,2)}function K5(t,e){return _e(t.getUTCHours()%12||12,e,2)}function Q5(t,e){return _e(1+yo.count(_n(t),t),e,3)}function jb(t,e){return _e(t.getUTCMilliseconds(),e,3)}function J5(t,e){return jb(t,e)+"000"}function e3(t,e){return _e(t.getUTCMonth()+1,e,2)}function t3(t,e){return _e(t.getUTCMinutes(),e,2)}function n3(t,e){return _e(t.getUTCSeconds(),e,2)}function r3(t){var e=t.getUTCDay();return e===0?7:e}function i3(t,e){return _e(Vi.count(_n(t)-1,t),e,2)}function zb(t){var e=t.getUTCDay();return e>=4||e===0?jr(t):jr.ceil(t)}function s3(t,e){return t=zb(t),_e(jr.count(_n(t),t)+(_n(t).getUTCDay()===4),e,2)}function o3(t){return t.getUTCDay()}function a3(t,e){return _e(Js.count(_n(t)-1,t),e,2)}function c3(t,e){return _e(t.getUTCFullYear()%100,e,2)}function u3(t,e){return t=zb(t),_e(t.getUTCFullYear()%100,e,2)}function l3(t,e){return _e(t.getUTCFullYear()%1e4,e,4)}function h3(t,e){var n=t.getUTCDay();return t=n>=4||n===0?jr(t):jr.ceil(t),_e(t.getUTCFullYear()%1e4,e,4)}function f3(){return"+0000"}function g1(){return"%"}function _1(t){return+t}function y1(t){return Math.floor(+t/1e3)}var ai,cp,Bb,ou,up;Wb({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function Wb(t){return ai=$b(t),cp=ai.format,Bb=ai.parse,ou=ai.utcFormat,up=ai.utcParse,ai}var Ub="%Y-%m-%dT%H:%M:%S.%LZ";function d3(t){return t.toISOString()}var p3=Date.prototype.toISOString?d3:ou(Ub);function m3(t){var e=new Date(t);return isNaN(e)?null:e}var g3=+new Date("2000-01-01T00:00:00.000Z")?m3:up(Ub);function _3(t){return new Date(t)}function y3(t){return t instanceof Date?+t:+new Date(+t)}function lp(t,e,n,r,i,s,o,a,c,u){var l=ep(),h=l.invert,f=l.domain,d=u(".%L"),p=u(":%S"),g=u("%I:%M"),m=u("%I %p"),_=u("%a %d"),b=u("%b %d"),v=u("%B"),y=u("%Y");function w(x){return(c(x)<x?d:a(x)<x?p:o(x)<x?g:s(x)<x?m:r(x)<x?i(x)<x?_:b:n(x)<x?v:y)(x)}return l.invert=function(x){return new Date(h(x))},l.domain=function(x){return arguments.length?f(Array.from(x,y3)):f().map(_3)},l.ticks=function(x){var C=f();return t(C[0],C[C.length-1],x??10)},l.tickFormat=function(x,C){return C==null?w:u(C)},l.nice=function(x){var C=f();return(!x||typeof x.range!="function")&&(x=e(C[0],C[C.length-1],x??10)),x?f(yb(C,x)):l},l.copy=function(){return _o(l,lp(t,e,n,r,i,s,o,a,c,u))},l}function v3(){return Xt.apply(lp(qb,Fb,gn,iu,$i,ts,nu,eu,qn,cp).domain([new Date(2e3,0,1),new Date(2e3,0,2)]),arguments)}function b3(){return Xt.apply(lp(Db,Pb,_n,su,Vi,yo,ru,tu,qn,ou).domain([Date.UTC(2e3,0,1),Date.UTC(2e3,0,2)]),arguments)}function au(){var t=0,e=1,n,r,i,s,o=_t,a=!1,c;function u(h){return h==null||isNaN(h=+h)?c:o(i===0?.5:(h=(s(h)-n)*i,a?Math.max(0,Math.min(1,h)):h))}u.domain=function(h){return arguments.length?([t,e]=h,n=s(t=+t),r=s(e=+e),i=n===r?0:1/(r-n),u):[t,e]},u.clamp=function(h){return arguments.length?(a=!!h,u):a},u.interpolator=function(h){return arguments.length?(o=h,u):o};function l(h){return function(f){var d,p;return arguments.length?([d,p]=f,o=h(d,p),u):[o(0),o(1)]}}return u.range=l(gr),u.rangeRound=l(Xc),u.unknown=function(h){return arguments.length?(c=h,u):c},function(h){return s=h,n=h(t),r=h(e),i=n===r?0:1/(r-n),u}}function yr(t,e){return e.domain(t.domain()).interpolator(t.interpolator()).clamp(t.clamp()).unknown(t.unknown())}function Gb(){var t=_r(au()(_t));return t.copy=function(){return yr(t,Gb())},Wn.apply(t,arguments)}function Hb(){var t=np(au()).domain([1,10]);return t.copy=function(){return yr(t,Hb()).base(t.base())},Wn.apply(t,arguments)}function Yb(){var t=rp(au());return t.copy=function(){return yr(t,Yb()).constant(t.constant())},Wn.apply(t,arguments)}function hp(){var t=ip(au());return t.copy=function(){return yr(t,hp()).exponent(t.exponent())},Wn.apply(t,arguments)}function w3(){return hp.apply(null,arguments).exponent(.5)}function Xb(){var t=[],e=_t;function n(r){if(r!=null&&!isNaN(r=+r))return e((cr(t,r,1)-1)/(t.length-1))}return n.domain=function(r){if(!arguments.length)return t.slice();t=[];for(let i of r)i!=null&&!isNaN(i=+i)&&t.push(i);return t.sort(Oe),n},n.interpolator=function(r){return arguments.length?(e=r,n):e},n.range=function(){return t.map((r,i)=>e(i/(t.length-1)))},n.quantiles=function(r){return Array.from({length:r+1},(i,s)=>Ys(t,s/r))},n.copy=function(){return Xb(e).domain(t)},Wn.apply(n,arguments)}function cu(){var t=0,e=.5,n=1,r=1,i,s,o,a,c,u=_t,l,h=!1,f;function d(g){return isNaN(g=+g)?f:(g=.5+((g=+l(g))-s)*(r*g<r*s?a:c),u(h?Math.max(0,Math.min(1,g)):g))}d.domain=function(g){return arguments.length?([t,e,n]=g,i=l(t=+t),s=l(e=+e),o=l(n=+n),a=i===s?0:.5/(s-i),c=s===o?0:.5/(o-s),r=s<i?-1:1,d):[t,e,n]},d.clamp=function(g){return arguments.length?(h=!!g,d):h},d.interpolator=function(g){return arguments.length?(u=g,d):u};function p(g){return function(m){var _,b,v;return arguments.length?([_,b,v]=m,u=cb(g,[_,b,v]),d):[u(0),u(.5),u(1)]}}return d.range=p(gr),d.rangeRound=p(Xc),d.unknown=function(g){return arguments.length?(f=g,d):f},function(g){return l=g,i=g(t),s=g(e),o=g(n),a=i===s?0:.5/(s-i),c=s===o?0:.5/(o-s),r=s<i?-1:1,d}}function Zb(){var t=_r(cu()(_t));return t.copy=function(){return yr(t,Zb())},Wn.apply(t,arguments)}function Kb(){var t=np(cu()).domain([.1,1,10]);return t.copy=function(){return yr(t,Kb()).base(t.base())},Wn.apply(t,arguments)}function Qb(){var t=rp(cu());return t.copy=function(){return yr(t,Qb()).constant(t.constant())},Wn.apply(t,arguments)}function fp(){var t=ip(cu());return t.copy=function(){return yr(t,fp()).exponent(t.exponent())},Wn.apply(t,arguments)}function x3(){return fp.apply(null,arguments).exponent(.5)}var Vh,v1;function T3(){if(v1)return Vh;v1=1;var t=BC();function e(n,r){return t(n,r)}return Vh=e,Vh}var Lh={exports:{}},jh,b1;function S3(){if(b1)return jh;b1=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return jh=t,jh}var zh,w1;function C3(){if(w1)return zh;w1=1;var t=S3();function e(){}function n(){}return n.resetWarningCache=e,zh=function(){function r(o,a,c,u,l,h){if(h!==t){var f=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw f.name="Invariant Violation",f}}r.isRequired=r;function i(){return r}var s={array:r,bigint:r,bool:r,func:r,number:r,object:r,string:r,symbol:r,any:r,arrayOf:i,element:r,elementType:r,instanceOf:i,node:r,objectOf:i,oneOf:i,oneOfType:i,shape:i,exact:i,checkPropTypes:n,resetWarningCache:e};return s.PropTypes=s,s},zh}var x1;function M3(){return x1||(x1=1,Lh.exports=C3()()),Lh.exports}class Jb{constructor(){this.midiAccess=null,this.selectedInput=null,this.listeners={noteOn:[],noteOff:[],deviceChange:[],error:[]},this.activeNotes=new Set}async init(){try{return navigator.requestMIDIAccess?(this.midiAccess=await navigator.requestMIDIAccess(),this.midiAccess.addEventListener("statechange",e=>{this.handleStateChange(e)}),this.updateDeviceList(),console.log("MIDI initialized successfully"),!0):(this.emitError("Web MIDI API is not supported in this browser. Try Chrome or Edge."),!1)}catch(e){return console.error("Failed to initialize MIDI:",e),this.emitError("Failed to access MIDI devices. Please check your browser permissions."),!1}}getInputDevices(){if(!this.midiAccess)return[];const e=[];for(const n of this.midiAccess.inputs.values())e.push({id:n.id,name:n.name||"Unknown Device",manufacturer:n.manufacturer||"Unknown",state:n.state,connection:n.connection});return e}connectDevice(e){if(!this.midiAccess)return console.error("MIDI not initialized"),!1;this.disconnectDevice();const n=this.midiAccess.inputs.get(e);return n?(n.onmidimessage=r=>this.handleMidiMessage(r),this.selectedInput=n,this.emitDeviceChange({connected:!0,device:n}),console.log("Connected to MIDI device:",n.name),!0):(console.error("Device not found:",e),!1)}disconnectDevice(){this.selectedInput&&(this.selectedInput.onmidimessage=null,this.selectedInput=null,this.activeNotes.clear(),this.emitDeviceChange({connected:!1,device:null}),console.log("Disconnected MIDI device"))}handleMidiMessage(e){if(!e.data||e.data.length<3)return;const n=e.data[0],r=e.data[1],i=e.data[2];switch(n&240){case 144:i>0?this.handleNoteOn(r,i):this.handleNoteOff(r);break;case 128:this.handleNoteOff(r);break}}handleNoteOn(e,n){this.activeNotes.add(e),this.listeners.noteOn.forEach(r=>{try{r({note:e,velocity:n,noteName:q0(e),frequency:pT(e),timestamp:Date.now()})}catch(i){console.error("Error in noteOn listener:",i)}})}handleNoteOff(e){this.activeNotes.delete(e),this.listeners.noteOff.forEach(n=>{try{n({note:e,noteName:q0(e),timestamp:Date.now()})}catch(r){console.error("Error in noteOff listener:",r)}})}handleStateChange(e){e.port&&(console.log("MIDI device state changed:",e.port.name,e.port.state),this.updateDeviceList(),this.selectedInput&&e.port.id===this.selectedInput.id&&e.port.state==="disconnected"&&this.disconnectDevice(),this.emitDeviceChange({type:"statechange",port:e.port}))}updateDeviceList(){const e=this.getInputDevices();console.log("Available MIDI devices:",e),!this.selectedInput&&e.length>0&&this.connectDevice(e[0].id)}on(e,n){this.listeners[e]?this.listeners[e].push(n):console.warn("Unknown event type:",e)}off(e,n){if(this.listeners[e]){const r=this.listeners[e].indexOf(n);r>-1&&this.listeners[e].splice(r,1)}}emitDeviceChange(e){this.listeners.deviceChange.forEach(n=>{try{n(e)}catch(r){console.error("Error in deviceChange listener:",r)}})}emitError(e){this.listeners.error.forEach(n=>{try{n({message:e})}catch(r){console.error("Error in error listener:",r)}})}isNoteActive(e){return this.activeNotes.has(e)}getActiveNotes(){return Array.from(this.activeNotes)}simulateNote(e,n=64,r=500){this.handleNoteOn(e,n),setTimeout(()=>{this.handleNoteOff(e)},r)}static isSupported(){return typeof navigator<"u"&&!!navigator.requestMIDIAccess}getConnectedDevice(){return this.selectedInput?{id:this.selectedInput.id,name:this.selectedInput.name||"Unknown Device",manufacturer:this.selectedInput.manufacturer||"Unknown",state:this.selectedInput.state,connection:this.selectedInput.connection}:null}}typeof window<"u"&&(window.MidiManager=Jb);class e2{constructor(e){if(this.renderer=null,this.context=null,this.currentNote=null,this.clef="treble",this.containerId=e,this.container=document.getElementById(e),!this.container){console.error("Container not found:",e);return}this.init()}isDarkMode(){return document.documentElement.classList.contains("dark")}getStrokeColor(){return this.isDarkMode()?"#e5e5e5":"#000000"}applyThemeToSVG(e){const n=this.getStrokeColor();e.style.color=n,e.querySelectorAll("path, line, rect, circle, ellipse").forEach(i=>{const s=i;(!s.style.fill||s.style.fill==="black"||s.style.fill==="rgb(0, 0, 0)")&&(s.style.stroke=n,s.style.fill=n)})}init(){try{if(typeof Vex>"u"||typeof window.Vex>"u"){console.error("VexFlow not loaded - waiting..."),setTimeout(()=>this.init(),500);return}if(!this.container){console.error("Container not found, cannot initialize");return}this.container.innerHTML="";const e=Vex.Flow;if(!e||!e.Renderer){console.error("VexFlow.Renderer not available");return}this.renderer=new e.Renderer(this.container,e.Renderer.Backends.SVG),this.renderer.resize(500,200),this.context=this.renderer.getContext(),console.log("StaffRenderer initialized successfully")}catch(e){console.error("Failed to initialize StaffRenderer:",e),this.showError("Unable to initialize music notation renderer")}}setClef(e){this.clef=e}renderNote(e,n={}){var r;if(!this.context&&(console.warn("Renderer not initialized, attempting to initialize..."),this.init(),!this.context)){console.error("Failed to initialize renderer"),this.showError("Unable to display notation - please refresh");return}try{const i=Vex.Flow;if(!this.container)return;this.context.clear(),this.container.innerHTML="",this.renderer=new i.Renderer(this.container,i.Renderer.Backends.SVG),this.renderer.resize(500,200),this.context=this.renderer.getContext();const s=new i.Stave(10,20,400);s.addClef(this.clef),s.setContext(this.context).draw();const o=new i.StaveNote({keys:[e],duration:"w",clef:this.clef}),a=new i.Voice({num_beats:4,beat_value:4});a.addTickable(o),new i.Formatter().joinVoices([a]).format([a],350),a.draw(this.context,s),this.currentNote=e;const c=(r=this.container)==null?void 0:r.querySelector("svg");c&&this.applyThemeToSVG(c),n.highlight&&this.highlightNote()}catch(i){console.error("Failed to render note:",i),this.showError("Unable to display note")}}renderNotes(e){var n;if(!this.context){console.error("Renderer not initialized");return}try{const r=Vex.Flow;if(!this.container)return;this.context.clear(),this.container.innerHTML="",this.renderer=new r.Renderer(this.container,r.Renderer.Backends.SVG),this.renderer.resize(700,200),this.context=this.renderer.getContext();const i=new r.Stave(10,20,650);i.addClef(this.clef),i.setContext(this.context).draw();const s=e.map(c=>new r.StaveNote({keys:[c],duration:"q",clef:this.clef})),o=new r.Voice({num_beats:s.length,beat_value:4});o.addTickables(s),new r.Formatter().joinVoices([o]).format([o],600),o.draw(this.context,i);const a=(n=this.container)==null?void 0:n.querySelector("svg");a&&this.applyThemeToSVG(a)}catch(r){console.error("Failed to render notes:",r),this.showError("Unable to display notes")}}renderScale(e){const n=e.map(r=>mT.midiToVexflow(r,this.clef)).filter(r=>r!==null);n.length>0&&this.renderNotes(n)}highlightNote(){if(!this.container)return;const e=this.container.querySelector("svg");e&&e.querySelectorAll(".vf-notehead").forEach(r=>{r.style.fill="#3b82f6"})}showFeedback(e){if(!this.container)return;const n=this.container.querySelector("svg");if(!n)return;const r=n.querySelectorAll(".vf-notehead"),i=e?"#10b981":"#ef4444";r.forEach(s=>{const o=s;o.style.fill=i,o.style.transition="fill 0.3s ease"}),setTimeout(()=>{r.forEach(s=>{s.style.fill=""})},500)}showError(e){this.container&&(this.container.innerHTML=`
            <div style="
                display: flex;
                align-items: center;
                justify-content: center;
                height: 200px;
                color: var(--text-secondary);
                font-size: 1rem;
            ">
                ${e}
            </div>
        `)}showWelcome(){this.container&&(this.container.innerHTML=`
            <div style="
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                height: 200px;
                color: var(--text-secondary);
                text-align: center;
                padding: 2rem;
            ">
                <p style="font-size: 3rem; margin-bottom: 0.5rem;"></p>
                <p style="font-size: 1.2rem; font-weight: 600; margin-bottom: 0.5rem;">
                    Ready to Practice
                </p>
                <p style="font-size: 0.95rem;">
                    Click "Start Practice" to begin
                </p>
            </div>
        `)}clear(){this.context&&this.context.clear(),this.container&&(this.container.innerHTML=""),this.currentNote=null}getCurrentNote(){return this.currentNote}}typeof window<"u"&&(window.StaffRenderer=e2);class Af{constructor(e,n="guitar"){if(this.renderer=null,this.context=null,this.currentNote=null,this.instrumentId="guitar",this.instrumentId=n,this.container=document.getElementById(e),!this.container){console.error("Container not found:",e);return}this.init()}isDarkMode(){return document.documentElement.classList.contains("dark")}getStrokeColor(){return this.isDarkMode()?"#e5e5e5":"#000000"}applyThemeToSVG(e){const n=this.getStrokeColor();e.style.color=n,e.querySelectorAll("path, line, circle, ellipse").forEach(o=>{const a=o;(!a.style.fill||a.style.fill==="black"||a.style.fill==="rgb(0, 0, 0)")&&(a.style.stroke=n,a.style.fill=n)}),e.querySelectorAll("rect").forEach(o=>{const a=o;a.getAttribute("fill")!=="white"&&(a.style.stroke=n,a.style.fill=n)}),e.querySelectorAll("text").forEach(o=>{const a=o;a.style.stroke=n,a.style.fill=n})}init(){try{if(typeof Vex>"u"||typeof window.Vex>"u"){console.error("VexFlow not loaded - waiting..."),setTimeout(()=>this.init(),500);return}if(!this.container){console.error("Container not found, cannot initialize");return}this.container.innerHTML="";const e=Vex.Flow;if(!e||!e.Renderer){console.error("VexFlow.Renderer not available");return}this.renderer=new e.Renderer(this.container,e.Renderer.Backends.SVG),this.renderer.resize(500,180),this.context=this.renderer.getContext(),console.log("TabRenderer initialized successfully")}catch(e){console.error("Failed to initialize TabRenderer:",e),this.showError("Unable to initialize tablature renderer")}}renderNote(e,n={}){var r;if(!this.context&&(console.warn("Renderer not initialized, attempting to initialize..."),this.init(),!this.context)){console.error("Failed to initialize renderer"),this.showError("Unable to display tablature - please refresh");return}try{const i=Vex.Flow;if(!this.container)return;const s=Gu(e,this.instrumentId);if(!s){console.error("Unable to convert MIDI note to tab position:",e),this.showError("Note out of range for tablature");return}this.context.clear(),this.container.innerHTML="",this.renderer=new i.Renderer(this.container,i.Renderer.Backends.SVG),this.renderer.resize(500,180),this.context=this.renderer.getContext();const o=new i.TabStave(10,20,400);o.addTabGlyph(),o.setContext(this.context).draw();const a=new i.TabNote({positions:[{str:s.string,fret:s.fret}],duration:"w"}),c=new i.Voice({num_beats:4,beat_value:4});c.addTickable(a),new i.Formatter().joinVoices([c]).format([c],350),c.draw(this.context,o),this.currentNote=e;const u=(r=this.container)==null?void 0:r.querySelector("svg");u&&this.applyThemeToSVG(u),n.highlight&&this.highlightNote()}catch(i){console.error("Failed to render tab note:",i),this.showError("Unable to display tab note")}}renderNotes(e){var n;if(!this.context){console.error("Renderer not initialized");return}try{const r=Vex.Flow;if(!this.container)return;const i=e.map(u=>Gu(u,this.instrumentId)).filter(u=>u!==null);if(i.length===0){console.error("No valid tab positions found");return}this.context.clear(),this.container.innerHTML="",this.renderer=new r.Renderer(this.container,r.Renderer.Backends.SVG),this.renderer.resize(700,180),this.context=this.renderer.getContext();const s=new r.TabStave(10,20,650);s.addTabGlyph(),s.setContext(this.context).draw();const o=i.map(u=>new r.TabNote({positions:[{str:u.string,fret:u.fret}],duration:"q"})),a=new r.Voice({num_beats:o.length,beat_value:4});a.addTickables(o),new r.Formatter().joinVoices([a]).format([a],600),a.draw(this.context,s);const c=(n=this.container)==null?void 0:n.querySelector("svg");c&&this.applyThemeToSVG(c)}catch(r){console.error("Failed to render tab notes:",r),this.showError("Unable to display tab notes")}}renderStaffAndTab(e){var n;if(!this.context&&(console.warn("Renderer not initialized, attempting to initialize..."),this.init(),!this.context)){console.error("Failed to initialize renderer"),this.showError("Unable to display notation - please refresh");return}try{const r=Vex.Flow;if(!this.container)return;const i=Gu(e,this.instrumentId);if(!i){console.error("Unable to convert MIDI note to tab position:",e),this.showError("Note out of range for tablature");return}this.context.clear(),this.container.innerHTML="",this.renderer=new r.Renderer(this.container,r.Renderer.Backends.SVG),this.renderer.resize(500,300),this.context=this.renderer.getContext();const s=new r.Stave(10,20,400);s.addClef("treble"),s.setContext(this.context).draw();const o=new r.TabStave(10,140,400);o.addTabGlyph(),o.setContext(this.context).draw();const a=new r.StaveConnector(s,o);a.setType(r.StaveConnector.type.BRACKET),a.setContext(this.context).draw();const c=Math.floor(e/12)-1,u=e%12,l=["c","c#","d","d#","e","f","f#","g","g#","a","a#","b"],h=`${l[u]}/${c}`,f=new r.StaveNote({keys:[h],duration:"w",clef:"treble"});l[u].includes("#")&&f.addModifier(new r.Accidental("#"),0);const d=new r.TabNote({positions:[{str:i.string,fret:i.fret}],duration:"w"}),p=new r.Voice({num_beats:4,beat_value:4});p.addTickable(f);const g=new r.Voice({num_beats:4,beat_value:4});g.addTickable(d),new r.Formatter().joinVoices([p]).format([p],350),new r.Formatter().joinVoices([g]).format([g],350),p.draw(this.context,s),g.draw(this.context,o),this.currentNote=e;const m=(n=this.container)==null?void 0:n.querySelector("svg");m&&this.applyThemeToSVG(m)}catch(r){console.error("Failed to render staff and tab:",r),this.showError("Unable to display notation")}}highlightNote(){if(!this.container)return;const e=this.container.querySelector("svg");e&&e.querySelectorAll("text").forEach(r=>{r.style.fill="#3b82f6"})}showFeedback(e){if(!this.container)return;const n=this.container.querySelector("svg");if(!n)return;const r=n.querySelectorAll("text"),i=e?"#10b981":"#ef4444";r.forEach(s=>{const o=s;o.style.fill=i,o.style.transition="fill 0.3s ease"}),setTimeout(()=>{r.forEach(s=>{s.style.fill=""})},500)}showError(e){this.container&&(this.container.innerHTML=`
            <div style="
                display: flex;
                align-items: center;
                justify-content: center;
                height: 180px;
                color: var(--text-secondary);
                font-size: 1rem;
            ">
                ${e}
            </div>
        `)}showWelcome(){this.container&&(this.container.innerHTML=`
            <div style="
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                height: 180px;
                color: var(--text-secondary);
                text-align: center;
                padding: 2rem;
            ">
                <p style="font-size: 3rem; margin-bottom: 0.5rem;"></p>
                <p style="font-size: 1.2rem; font-weight: 600; margin-bottom: 0.5rem;">
                    Ready to Practice Guitar
                </p>
                <p style="font-size: 0.95rem;">
                    Click "Start Practice" to begin
                </p>
            </div>
        `)}clear(){this.context&&this.context.clear(),this.container&&(this.container.innerHTML=""),this.currentNote=null}getCurrentNote(){return this.currentNote}}typeof window<"u"&&(window.TabRenderer=Af);class A3{constructor(){this.audioContext=null,this.masterGain=null,this.init()}init(){try{this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.masterGain=this.audioContext.createGain(),this.masterGain.gain.value=.12,this.masterGain.connect(this.audioContext.destination)}catch(e){console.error("Failed to initialize audio context:",e)}}playNote(e,n=.5){if(!this.audioContext||!this.masterGain){console.warn("Audio context not initialized");return}this.audioContext.state==="suspended"&&this.audioContext.resume();const r=this.midiToFrequency(e),i=this.audioContext.currentTime,s=this.audioContext.createOscillator();s.type="sine",s.frequency.value=r;const o=this.audioContext.createOscillator();o.type="sine",o.frequency.value=r*2;const a=this.audioContext.createOscillator();a.type="sine",a.frequency.value=r*3;const c=this.audioContext.createGain(),u=this.audioContext.createGain(),l=this.audioContext.createGain();c.gain.value=1,u.gain.value=.15,l.gain.value=.08,s.connect(c),o.connect(u),a.connect(l);const h=this.audioContext.createGain();c.connect(h),u.connect(h),l.connect(h),h.connect(this.masterGain);const f=.02,d=.15,p=.5,g=.4;h.gain.setValueAtTime(0,i),h.gain.exponentialRampToValueAtTime(.8,i+f),h.gain.exponentialRampToValueAtTime(p,i+f+d),h.gain.setValueAtTime(p,i+n-g),h.gain.exponentialRampToValueAtTime(.001,i+n),s.start(i),o.start(i),a.start(i),s.stop(i+n),o.stop(i+n),a.stop(i+n)}midiToFrequency(e){return 440*Math.pow(2,(e-69)/12)}setVolume(e){this.masterGain&&(this.masterGain.gain.value=Math.max(0,Math.min(1,e)))}cleanup(){this.audioContext&&(this.audioContext.close(),this.audioContext=null)}}const T1={piano:{beginner:"c4-c5",intermediate:"c4-g5",advanced:"a3-c6"},"piano-virtual":{beginner:"c4-c5",intermediate:"c4-g5",advanced:"a3-c6"},guitar:{beginner:"e2-e4",intermediate:"e2-a4",advanced:"e2-e5"},violin:{beginner:"g3-g4",intermediate:"g3-c5",advanced:"g3-g5"}};function S1(t,e){var n;return((n=T1[t])==null?void 0:n[e])??T1.piano[e]}function Yo({instrument:t,tabDisplayMode:e,clef:n,midiNote:r,staffRenderer:i,tabRenderer:s}){if(t==="guitar"){if(e==="both"&&s){s.renderStaffAndTab(r);return}if(e==="tab"&&s){s.renderNote(r);return}}if(!i)return;const o=gT(r,n);o&&i.renderNote(o)}const N3={beginner:{duration:45,notesPerRound:6,successThreshold:.75},intermediate:{duration:35,notesPerRound:10,successThreshold:.8},advanced:{duration:25,notesPerRound:12,successThreshold:.85}},Ms={S:{min:120,label:"Perfect!",color:"text-yellow-500"},A:{min:100,label:"Excellent",color:"text-green-500"},B:{min:80,label:"Good",color:"text-blue-500"},C:{min:60,label:"Keep Practicing",color:"text-gray-500"},D:{min:0,label:"Try Again",color:"text-red-500"}};function k3(t,e,n,r,i=0){const s=e>0?t/e:0,o=r>0?n/r:0,a=Math.min(1+i/20,2),c=s*100,u=c*(1+o*.5),l=Math.round(u*a),h=E3(l);return{baseScore:Math.round(c),speedBonus:Math.round(o*100),streakMultiplier:a,finalScore:l,rank:h}}function E3(t){return t>=Ms.S.min?"S":t>=Ms.A.min?"A":t>=Ms.B.min?"B":t>=Ms.C.min?"C":"D"}function R3(t,e,n){return e===0?!1:t/e>=n}function I3(t){return t>=50?`Legendary! ${t} streak! `:t>=25?`Unstoppable! ${t} streak! `:t===20?`On fire! ${t} streak! `:t===10?`Great streak! ${t} in a row! `:t===5?`Nice! ${t} correct! `:""}function O3(t){const{difficulty:e,gameMode:n,onRoundComplete:r,onRoundFail:i,onTimeUp:s,onLifeLost:o,onStreakMilestone:a}=t,c=N3[e],u=3,[l,h]=G.useState({isActive:!1,isComplete:!1,isSuccessful:null,timeLeft:c.duration,maxTime:c.duration,lives:u,maxLives:u,notesCompleted:0,notesRequired:c.notesPerRound,correctCount:0,incorrectCount:0,streak:0,consecutiveWrong:0,currentScore:null}),f=G.useRef(l);f.current=l,G.useEffect(()=>{if(n!=="timed"||!l.isActive||l.isComplete)return;const v=setInterval(()=>{h(y=>{const w=Math.max(0,y.timeLeft-1);return w===0&&y.timeLeft>0?(s&&s(),{...y,timeLeft:0,isActive:!1,isComplete:!0,isSuccessful:!1}):{...y,timeLeft:w}})},1e3);return()=>clearInterval(v)},[l.isActive,l.isComplete,n,s]);const d=G.useCallback(()=>{h({isActive:!0,isComplete:!1,isSuccessful:null,timeLeft:c.duration,maxTime:c.duration,lives:u,maxLives:u,notesCompleted:0,notesRequired:c.notesPerRound,correctCount:0,incorrectCount:0,streak:f.current.streak,consecutiveWrong:0,currentScore:null})},[c.duration,c.notesPerRound,u]),p=G.useCallback(()=>{h(v=>{const y=R3(v.correctCount,v.notesRequired,c.successThreshold),w=k3(v.correctCount,v.notesRequired,v.timeLeft,v.maxTime,v.streak),x={...v,isActive:!1,isComplete:!0,isSuccessful:y,currentScore:w};return y&&r?r(x):!y&&i&&i(x),x})},[c.successThreshold,r,i]),g=G.useCallback(()=>{h(v=>{const y=v.correctCount+1,w=v.notesCompleted+1,x=v.streak+1,C=0;a&&(x===5||x===10||x===20||x%25===0)&&a(x);const S=w>=v.notesRequired;return{...v,correctCount:y,notesCompleted:w,streak:x,consecutiveWrong:C,isComplete:S,isActive:!S}})},[a]),m=G.useCallback(()=>{h(v=>{const y=v.incorrectCount+1,w=v.notesCompleted+1,x=n==="timed"?Math.max(0,v.lives-1):v.lives,C=v.consecutiveWrong+1,S=0;n==="timed"&&x<v.lives&&o&&o(x);const A=n==="timed"&&x===0,N=n==="timed"&&C>=3,T=A||N,k=w>=v.notesRequired||T;return{...v,incorrectCount:y,notesCompleted:w,lives:x,streak:S,consecutiveWrong:C,isComplete:k,isSuccessful:T?!1:null,isActive:!k}})},[n,o]),_=G.useCallback(()=>{h({isActive:!1,isComplete:!1,isSuccessful:null,timeLeft:c.duration,maxTime:c.duration,lives:u,maxLives:u,notesCompleted:0,notesRequired:c.notesPerRound,correctCount:0,incorrectCount:0,streak:0,consecutiveWrong:0,currentScore:null})},[c.duration,c.notesPerRound,u]);return G.useEffect(()=>{l.isComplete&&!l.isSuccessful&&l.notesCompleted>=l.notesRequired&&p()},[l.isComplete,l.isSuccessful,l.notesCompleted,l.notesRequired,p]),[l,{startRound:d,endRound:p,noteCorrect:g,noteIncorrect:m,resetRound:_}]}const t2="15.1.22",C1=(t,e,n)=>({endTime:e,insertTime:n,type:"exponentialRampToValue",value:t}),M1=(t,e,n)=>({endTime:e,insertTime:n,type:"linearRampToValue",value:t}),Nf=(t,e)=>({startTime:e,type:"setValue",value:t}),n2=(t,e,n)=>({duration:n,startTime:e,type:"setValueCurve",values:t}),r2=(t,e,{startTime:n,target:r,timeConstant:i})=>r+(e-r)*Math.exp((n-t)/i),_i=t=>t.type==="exponentialRampToValue",Ua=t=>t.type==="linearRampToValue",Qn=t=>_i(t)||Ua(t),dp=t=>t.type==="setValue",Rn=t=>t.type==="setValueCurve",Ga=(t,e,n,r)=>{const i=t[e];return i===void 0?r:Qn(i)||dp(i)?i.value:Rn(i)?i.values[i.values.length-1]:r2(n,Ga(t,e-1,i.startTime,r),i)},A1=(t,e,n,r,i)=>n===void 0?[r.insertTime,i]:Qn(n)?[n.endTime,n.value]:dp(n)?[n.startTime,n.value]:Rn(n)?[n.startTime+n.duration,n.values[n.values.length-1]]:[n.startTime,Ga(t,e-1,n.startTime,i)],kf=t=>t.type==="cancelAndHold",Ef=t=>t.type==="cancelScheduledValues",Kn=t=>kf(t)||Ef(t)?t.cancelTime:_i(t)||Ua(t)?t.endTime:t.startTime,N1=(t,e,n,{endTime:r,value:i})=>n===i?i:0<n&&0<i||n<0&&i<0?n*(i/n)**((t-e)/(r-e)):0,k1=(t,e,n,{endTime:r,value:i})=>n+(t-e)/(r-e)*(i-n),D3=(t,e)=>{const n=Math.floor(e),r=Math.ceil(e);return n===r?t[n]:(1-(e-n))*t[n]+(1-(r-e))*t[r]},P3=(t,{duration:e,startTime:n,values:r})=>{const i=(t-n)/e*(r.length-1);return D3(r,i)},Xo=t=>t.type==="setTarget";class q3{constructor(e){this._automationEvents=[],this._currenTime=0,this._defaultValue=e}[Symbol.iterator](){return this._automationEvents[Symbol.iterator]()}add(e){const n=Kn(e);if(kf(e)||Ef(e)){const r=this._automationEvents.findIndex(s=>Ef(e)&&Rn(s)?s.startTime+s.duration>=n:Kn(s)>=n),i=this._automationEvents[r];if(r!==-1&&(this._automationEvents=this._automationEvents.slice(0,r)),kf(e)){const s=this._automationEvents[this._automationEvents.length-1];if(i!==void 0&&Qn(i)){if(s!==void 0&&Xo(s))throw new Error("The internal list is malformed.");const o=s===void 0?i.insertTime:Rn(s)?s.startTime+s.duration:Kn(s),a=s===void 0?this._defaultValue:Rn(s)?s.values[s.values.length-1]:s.value,c=_i(i)?N1(n,o,a,i):k1(n,o,a,i),u=_i(i)?C1(c,n,this._currenTime):M1(c,n,this._currenTime);this._automationEvents.push(u)}if(s!==void 0&&Xo(s)&&this._automationEvents.push(Nf(this.getValue(n),n)),s!==void 0&&Rn(s)&&s.startTime+s.duration>n){const o=n-s.startTime,a=(s.values.length-1)/s.duration,c=Math.max(2,1+Math.ceil(o*a)),u=o/(c-1)*a,l=s.values.slice(0,c);if(u<1)for(let h=1;h<c;h+=1){const f=u*h%1;l[h]=s.values[h-1]*(1-f)+s.values[h]*f}this._automationEvents[this._automationEvents.length-1]=n2(l,s.startTime,o)}}}else{const r=this._automationEvents.findIndex(o=>Kn(o)>n),i=r===-1?this._automationEvents[this._automationEvents.length-1]:this._automationEvents[r-1];if(i!==void 0&&Rn(i)&&Kn(i)+i.duration>n)return!1;const s=_i(e)?C1(e.value,e.endTime,this._currenTime):Ua(e)?M1(e.value,n,this._currenTime):e;if(r===-1)this._automationEvents.push(s);else{if(Rn(e)&&n+e.duration>Kn(this._automationEvents[r]))return!1;this._automationEvents.splice(r,0,s)}}return!0}flush(e){const n=this._automationEvents.findIndex(r=>Kn(r)>e);if(n>1){const r=this._automationEvents.slice(n-1),i=r[0];Xo(i)&&r.unshift(Nf(Ga(this._automationEvents,n-2,i.startTime,this._defaultValue),i.startTime)),this._automationEvents=r}}getValue(e){if(this._automationEvents.length===0)return this._defaultValue;const n=this._automationEvents.findIndex(o=>Kn(o)>e),r=this._automationEvents[n],i=(n===-1?this._automationEvents.length:n)-1,s=this._automationEvents[i];if(s!==void 0&&Xo(s)&&(r===void 0||!Qn(r)||r.insertTime>e))return r2(e,Ga(this._automationEvents,i-1,s.startTime,this._defaultValue),s);if(s!==void 0&&dp(s)&&(r===void 0||!Qn(r)))return s.value;if(s!==void 0&&Rn(s)&&(r===void 0||!Qn(r)||s.startTime+s.duration>e))return e<s.startTime+s.duration?P3(e,s):s.values[s.values.length-1];if(s!==void 0&&Qn(s)&&(r===void 0||!Qn(r)))return s.value;if(r!==void 0&&_i(r)){const[o,a]=A1(this._automationEvents,i,s,r,this._defaultValue);return N1(e,o,a,r)}if(r!==void 0&&Ua(r)){const[o,a]=A1(this._automationEvents,i,s,r,this._defaultValue);return k1(e,o,a,r)}return this._defaultValue}}const F3=t=>({cancelTime:t,type:"cancelAndHold"}),$3=t=>({cancelTime:t,type:"cancelScheduledValues"}),V3=(t,e)=>({endTime:e,type:"exponentialRampToValue",value:t}),L3=(t,e)=>({endTime:e,type:"linearRampToValue",value:t}),j3=(t,e,n)=>({startTime:e,target:t,timeConstant:n,type:"setTarget"}),z3=()=>new DOMException("","AbortError"),B3=t=>(e,n,[r,i,s],o)=>{t(e[i],[n,r,s],a=>a[0]===n&&a[1]===r,o)},W3=t=>(e,n,r)=>{const i=[];for(let s=0;s<r.numberOfInputs;s+=1)i.push(new Set);t.set(e,{activeInputs:i,outputs:new Set,passiveInputs:new WeakMap,renderer:n})},U3=t=>(e,n)=>{t.set(e,{activeInputs:new Set,passiveInputs:new WeakMap,renderer:n})},Li=new WeakSet,i2=new WeakMap,pp=new WeakMap,s2=new WeakMap,mp=new WeakMap,uu=new WeakMap,o2=new WeakMap,Rf=new WeakMap,If=new WeakMap,Of=new WeakMap,a2={construct(){return a2}},G3=t=>{try{const e=new Proxy(t,a2);new e}catch{return!1}return!0},E1=/^import(?:(?:[\s]+[\w]+|(?:[\s]+[\w]+[\s]*,)?[\s]*\{[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?(?:[\s]*,[\s]*[\w]+(?:[\s]+as[\s]+[\w]+)?)*[\s]*}|(?:[\s]+[\w]+[\s]*,)?[\s]*\*[\s]+as[\s]+[\w]+)[\s]+from)?(?:[\s]*)("([^"\\]|\\.)+"|'([^'\\]|\\.)+')(?:[\s]*);?/,R1=(t,e)=>{const n=[];let r=t.replace(/^[\s]+/,""),i=r.match(E1);for(;i!==null;){const s=i[1].slice(1,-1),o=i[0].replace(/([\s]+)?;?$/,"").replace(s,new URL(s,e).toString());n.push(o),r=r.slice(i[0].length).replace(/^[\s]+/,""),i=r.match(E1)}return[n.join(";"),r]},I1=t=>{if(t!==void 0&&!Array.isArray(t))throw new TypeError("The parameterDescriptors property of given value for processorCtor is not an array.")},O1=t=>{if(!G3(t))throw new TypeError("The given value for processorCtor should be a constructor.");if(t.prototype===null||typeof t.prototype!="object")throw new TypeError("The given value for processorCtor should have a prototype.")},H3=(t,e,n,r,i,s,o,a,c,u,l,h,f)=>{let d=0;return(p,g,m={credentials:"omit"})=>{const _=l.get(p);if(_!==void 0&&_.has(g))return Promise.resolve();const b=u.get(p);if(b!==void 0){const w=b.get(g);if(w!==void 0)return w}const v=s(p),y=v.audioWorklet===void 0?i(g).then(([w,x])=>{const[C,S]=R1(w,x),A=`${C};((a,b)=>{(a[b]=a[b]||[]).push((AudioWorkletProcessor,global,registerProcessor,sampleRate,self,window)=>{${S}
})})(window,'_AWGS')`;return n(A)}).then(()=>{const w=f._AWGS.pop();if(w===void 0)throw new SyntaxError;r(v.currentTime,v.sampleRate,()=>w(class{},void 0,(x,C)=>{if(x.trim()==="")throw e();const S=If.get(v);if(S!==void 0){if(S.has(x))throw e();O1(C),I1(C.parameterDescriptors),S.set(x,C)}else O1(C),I1(C.parameterDescriptors),If.set(v,new Map([[x,C]]))},v.sampleRate,void 0,void 0))}):Promise.all([i(g),Promise.resolve(t(h,h))]).then(([[w,x],C])=>{const S=d+1;d=S;const[A,N]=R1(w,x),M=`${A};((AudioWorkletProcessor,registerProcessor)=>{${N}
})(${C?"AudioWorkletProcessor":"class extends AudioWorkletProcessor {__b=new WeakSet();constructor(){super();(p=>p.postMessage=(q=>(m,t)=>q.call(p,m,t?t.filter(u=>!this.__b.has(u)):t))(p.postMessage))(this.port)}}"},(n,p)=>registerProcessor(n,class extends p{${C?"":"__c = (a) => a.forEach(e=>this.__b.add(e.buffer));"}process(i,o,p){${C?"":"i.forEach(this.__c);o.forEach(this.__c);this.__c(Object.values(p));"}return super.process(i.map(j=>j.some(k=>k.length===0)?[]:j),o,p)}}));registerProcessor('__sac${S}',class extends AudioWorkletProcessor{process(){return !1}})`,E=new Blob([M],{type:"application/javascript; charset=utf-8"}),R=URL.createObjectURL(E);return v.audioWorklet.addModule(R,m).then(()=>{if(a(v))return v;const O=o(v);return O.audioWorklet.addModule(R,m).then(()=>O)}).then(O=>{if(c===null)throw new SyntaxError;try{new c(O,`__sac${S}`)}catch{throw new SyntaxError}}).finally(()=>URL.revokeObjectURL(R))});return b===void 0?u.set(p,new Map([[g,y]])):b.set(g,y),y.then(()=>{const w=l.get(p);w===void 0?l.set(p,new Set([g])):w.add(g)}).finally(()=>{const w=u.get(p);w!==void 0&&w.delete(g)}),y}},sn=(t,e)=>{const n=t.get(e);if(n===void 0)throw new Error("A value with the given key could not be found.");return n},lu=(t,e)=>{const n=Array.from(t).filter(e);if(n.length>1)throw Error("More than one element was found.");if(n.length===0)throw Error("No element was found.");const[r]=n;return t.delete(r),r},c2=(t,e,n,r)=>{const i=sn(t,e),s=lu(i,o=>o[0]===n&&o[1]===r);return i.size===0&&t.delete(e),s},vo=t=>sn(o2,t),ji=t=>{if(Li.has(t))throw new Error("The AudioNode is already stored.");Li.add(t),vo(t).forEach(e=>e(!0))},u2=t=>"port"in t,bo=t=>{if(!Li.has(t))throw new Error("The AudioNode is not stored.");Li.delete(t),vo(t).forEach(e=>e(!1))},Df=(t,e)=>{!u2(t)&&e.every(n=>n.size===0)&&bo(t)},Y3=(t,e,n,r,i,s,o,a,c,u,l,h,f)=>{const d=new WeakMap;return(p,g,m,_,b)=>{const{activeInputs:v,passiveInputs:y}=s(g),{outputs:w}=s(p),x=a(p),C=S=>{const A=c(g),N=c(p);if(S){const T=c2(y,p,m,_);t(v,p,T,!1),!b&&!h(p)&&n(N,A,m,_),f(g)&&ji(g)}else{const T=r(v,p,m,_);e(y,_,T,!1),!b&&!h(p)&&i(N,A,m,_);const k=o(g);if(k===0)l(g)&&Df(g,v);else{const I=d.get(g);I!==void 0&&clearTimeout(I),d.set(g,setTimeout(()=>{l(g)&&Df(g,v)},k*1e3))}}};return u(w,[g,m,_],S=>S[0]===g&&S[1]===m&&S[2]===_,!0)?(x.add(C),l(p)?t(v,p,[m,_,C],!0):e(y,_,[p,m,C],!0),!0):!1}},X3=t=>(e,n,[r,i,s],o)=>{const a=e.get(r);a===void 0?e.set(r,new Set([[i,n,s]])):t(a,[i,n,s],c=>c[0]===i&&c[1]===n,o)},Z3=t=>(e,n)=>{const r=t(e,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});n.connect(r).connect(e.destination);const i=()=>{n.removeEventListener("ended",i),n.disconnect(r),r.disconnect()};n.addEventListener("ended",i)},K3=t=>(e,n)=>{t(e).add(n)},Q3={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",fftSize:2048,maxDecibels:-30,minDecibels:-100,smoothingTimeConstant:.8},J3=(t,e,n,r,i,s)=>class extends t{constructor(a,c){const u=i(a),l={...Q3,...c},h=r(u,l),f=s(u)?e():null;super(a,!1,h,f),this._nativeAnalyserNode=h}get fftSize(){return this._nativeAnalyserNode.fftSize}set fftSize(a){this._nativeAnalyserNode.fftSize=a}get frequencyBinCount(){return this._nativeAnalyserNode.frequencyBinCount}get maxDecibels(){return this._nativeAnalyserNode.maxDecibels}set maxDecibels(a){const c=this._nativeAnalyserNode.maxDecibels;if(this._nativeAnalyserNode.maxDecibels=a,!(a>this._nativeAnalyserNode.minDecibels))throw this._nativeAnalyserNode.maxDecibels=c,n()}get minDecibels(){return this._nativeAnalyserNode.minDecibels}set minDecibels(a){const c=this._nativeAnalyserNode.minDecibels;if(this._nativeAnalyserNode.minDecibels=a,!(this._nativeAnalyserNode.maxDecibels>a))throw this._nativeAnalyserNode.minDecibels=c,n()}get smoothingTimeConstant(){return this._nativeAnalyserNode.smoothingTimeConstant}set smoothingTimeConstant(a){this._nativeAnalyserNode.smoothingTimeConstant=a}getByteFrequencyData(a){this._nativeAnalyserNode.getByteFrequencyData(a)}getByteTimeDomainData(a){this._nativeAnalyserNode.getByteTimeDomainData(a)}getFloatFrequencyData(a){this._nativeAnalyserNode.getFloatFrequencyData(a)}getFloatTimeDomainData(a){this._nativeAnalyserNode.getFloatTimeDomainData(a)}},ct=(t,e)=>t.context===e,e6=(t,e,n)=>()=>{const r=new WeakMap,i=async(s,o)=>{let a=e(s);if(!ct(a,o)){const u={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,fftSize:a.fftSize,maxDecibels:a.maxDecibels,minDecibels:a.minDecibels,smoothingTimeConstant:a.smoothingTimeConstant};a=t(o,u)}return r.set(o,a),await n(s,o,a),a};return{render(s,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},Ha=t=>{try{t.copyToChannel(new Float32Array(1),0,-1)}catch{return!1}return!0},wn=()=>new DOMException("","IndexSizeError"),gp=t=>{t.getChannelData=(e=>n=>{try{return e.call(t,n)}catch(r){throw r.code===12?wn():r}})(t.getChannelData)},t6={numberOfChannels:1},n6=(t,e,n,r,i,s,o,a)=>{let c=null;return class l2{constructor(l){if(i===null)throw new Error("Missing the native OfflineAudioContext constructor.");const{length:h,numberOfChannels:f,sampleRate:d}={...t6,...l};c===null&&(c=new i(1,1,44100));const p=r!==null&&e(s,s)?new r({length:h,numberOfChannels:f,sampleRate:d}):c.createBuffer(f,h,d);if(p.numberOfChannels===0)throw n();return typeof p.copyFromChannel!="function"?(o(p),gp(p)):e(Ha,()=>Ha(p))||a(p),t.add(p),p}static[Symbol.hasInstance](l){return l!==null&&typeof l=="object"&&Object.getPrototypeOf(l)===l2.prototype||t.has(l)}}},At=-34028234663852886e22,ft=-At,Fn=t=>Li.has(t),r6={buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1},i6=(t,e,n,r,i,s,o,a)=>class extends t{constructor(u,l){const h=s(u),f={...r6,...l},d=i(h,f),p=o(h),g=p?e():null;super(u,!1,d,g),this._audioBufferSourceNodeRenderer=g,this._isBufferNullified=!1,this._isBufferSet=f.buffer!==null,this._nativeAudioBufferSourceNode=d,this._onended=null,this._playbackRate=n(this,p,d.playbackRate,ft,At)}get buffer(){return this._isBufferNullified?null:this._nativeAudioBufferSourceNode.buffer}set buffer(u){if(this._nativeAudioBufferSourceNode.buffer=u,u!==null){if(this._isBufferSet)throw r();this._isBufferSet=!0}}get loop(){return this._nativeAudioBufferSourceNode.loop}set loop(u){this._nativeAudioBufferSourceNode.loop=u}get loopEnd(){return this._nativeAudioBufferSourceNode.loopEnd}set loopEnd(u){this._nativeAudioBufferSourceNode.loopEnd=u}get loopStart(){return this._nativeAudioBufferSourceNode.loopStart}set loopStart(u){this._nativeAudioBufferSourceNode.loopStart=u}get onended(){return this._onended}set onended(u){const l=typeof u=="function"?a(this,u):null;this._nativeAudioBufferSourceNode.onended=l;const h=this._nativeAudioBufferSourceNode.onended;this._onended=h!==null&&h===l?u:h}get playbackRate(){return this._playbackRate}start(u=0,l=0,h){if(this._nativeAudioBufferSourceNode.start(u,l,h),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.start=h===void 0?[u,l]:[u,l,h]),this.context.state!=="closed"){ji(this);const f=()=>{this._nativeAudioBufferSourceNode.removeEventListener("ended",f),Fn(this)&&bo(this)};this._nativeAudioBufferSourceNode.addEventListener("ended",f)}}stop(u=0){this._nativeAudioBufferSourceNode.stop(u),this._audioBufferSourceNodeRenderer!==null&&(this._audioBufferSourceNodeRenderer.stop=u)}},s6=(t,e,n,r,i)=>()=>{const s=new WeakMap;let o=null,a=null;const c=async(u,l)=>{let h=n(u);const f=ct(h,l);if(!f){const d={buffer:h.buffer,channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,loop:h.loop,loopEnd:h.loopEnd,loopStart:h.loopStart,playbackRate:h.playbackRate.value};h=e(l,d),o!==null&&h.start(...o),a!==null&&h.stop(a)}return s.set(l,h),f?await t(l,u.playbackRate,h.playbackRate):await r(l,u.playbackRate,h.playbackRate),await i(u,l,h),h};return{set start(u){o=u},set stop(u){a=u},render(u,l){const h=s.get(l);return h!==void 0?Promise.resolve(h):c(u,l)}}},o6=t=>"playbackRate"in t,a6=t=>"frequency"in t&&"gain"in t,c6=t=>"offset"in t,u6=t=>!("frequency"in t)&&"gain"in t,l6=t=>"detune"in t&&"frequency"in t&&!("gain"in t),h6=t=>"pan"in t,yt=t=>sn(i2,t),wo=t=>sn(s2,t),Pf=(t,e)=>{const{activeInputs:n}=yt(t);n.forEach(i=>i.forEach(([s])=>{e.includes(t)||Pf(s,[...e,t])}));const r=o6(t)?[t.playbackRate]:u2(t)?Array.from(t.parameters.values()):a6(t)?[t.Q,t.detune,t.frequency,t.gain]:c6(t)?[t.offset]:u6(t)?[t.gain]:l6(t)?[t.detune,t.frequency]:h6(t)?[t.pan]:[];for(const i of r){const s=wo(i);s!==void 0&&s.activeInputs.forEach(([o])=>Pf(o,e))}Fn(t)&&bo(t)},h2=t=>{Pf(t.destination,[])},f6=t=>t===void 0||typeof t=="number"||typeof t=="string"&&(t==="balanced"||t==="interactive"||t==="playback"),d6=(t,e,n,r,i,s,o,a,c)=>class extends t{constructor(l={}){if(c===null)throw new Error("Missing the native AudioContext constructor.");let h;try{h=new c(l)}catch(p){throw p.code===12&&p.message==="sampleRate is not in range"?n():p}if(h===null)throw r();if(!f6(l.latencyHint))throw new TypeError(`The provided value '${l.latencyHint}' is not a valid enum value of type AudioContextLatencyCategory.`);if(l.sampleRate!==void 0&&h.sampleRate!==l.sampleRate)throw n();super(h,2);const{latencyHint:f}=l,{sampleRate:d}=h;if(this._baseLatency=typeof h.baseLatency=="number"?h.baseLatency:f==="balanced"?512/d:f==="interactive"||f===void 0?256/d:f==="playback"?1024/d:Math.max(2,Math.min(128,Math.round(f*d/128)))*128/d,this._nativeAudioContext=h,c.name==="webkitAudioContext"?(this._nativeGainNode=h.createGain(),this._nativeOscillatorNode=h.createOscillator(),this._nativeGainNode.gain.value=1e-37,this._nativeOscillatorNode.connect(this._nativeGainNode).connect(h.destination),this._nativeOscillatorNode.start()):(this._nativeGainNode=null,this._nativeOscillatorNode=null),this._state=null,h.state==="running"){this._state="suspended";const p=()=>{this._state==="suspended"&&(this._state=null),h.removeEventListener("statechange",p)};h.addEventListener("statechange",p)}}get baseLatency(){return this._baseLatency}get state(){return this._state!==null?this._state:this._nativeAudioContext.state}close(){return this.state==="closed"?this._nativeAudioContext.close().then(()=>{throw e()}):(this._state==="suspended"&&(this._state=null),this._nativeAudioContext.close().then(()=>{this._nativeGainNode!==null&&this._nativeOscillatorNode!==null&&(this._nativeOscillatorNode.stop(),this._nativeGainNode.disconnect(),this._nativeOscillatorNode.disconnect()),h2(this)}))}createMediaElementSource(l){return new i(this,{mediaElement:l})}createMediaStreamDestination(){return new s(this)}createMediaStreamSource(l){return new o(this,{mediaStream:l})}createMediaStreamTrackSource(l){return new a(this,{mediaStreamTrack:l})}resume(){return this._state==="suspended"?new Promise((l,h)=>{const f=()=>{this._nativeAudioContext.removeEventListener("statechange",f),this._nativeAudioContext.state==="running"?l():this.resume().then(l,h)};this._nativeAudioContext.addEventListener("statechange",f)}):this._nativeAudioContext.resume().catch(l=>{throw l===void 0||l.code===15?e():l})}suspend(){return this._nativeAudioContext.suspend().catch(l=>{throw l===void 0?e():l})}},p6=(t,e,n,r,i,s,o,a)=>class extends t{constructor(u,l){const h=s(u),f=o(h),d=i(h,l,f),p=f?e(a):null;super(u,!1,d,p),this._isNodeOfNativeOfflineAudioContext=f,this._nativeAudioDestinationNode=d}get channelCount(){return this._nativeAudioDestinationNode.channelCount}set channelCount(u){if(this._isNodeOfNativeOfflineAudioContext)throw r();if(u>this._nativeAudioDestinationNode.maxChannelCount)throw n();this._nativeAudioDestinationNode.channelCount=u}get channelCountMode(){return this._nativeAudioDestinationNode.channelCountMode}set channelCountMode(u){if(this._isNodeOfNativeOfflineAudioContext)throw r();this._nativeAudioDestinationNode.channelCountMode=u}get maxChannelCount(){return this._nativeAudioDestinationNode.maxChannelCount}},m6=t=>{const e=new WeakMap,n=async(r,i)=>{const s=i.destination;return e.set(i,s),await t(r,i,s),s};return{render(r,i){const s=e.get(i);return s!==void 0?Promise.resolve(s):n(r,i)}}},g6=(t,e,n,r,i,s,o,a)=>(c,u)=>{const l=u.listener,h=()=>{const w=new Float32Array(1),x=e(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:9}),C=o(u);let S=!1,A=[0,0,-1,0,1,0],N=[0,0,0];const T=()=>{if(S)return;S=!0;const E=r(u,256,9,0);E.onaudioprocess=({inputBuffer:R})=>{const O=[s(R,w,0),s(R,w,1),s(R,w,2),s(R,w,3),s(R,w,4),s(R,w,5)];O.some((D,$)=>D!==A[$])&&(l.setOrientation(...O),A=O);const q=[s(R,w,6),s(R,w,7),s(R,w,8)];q.some((D,$)=>D!==N[$])&&(l.setPosition(...q),N=q)},x.connect(E)},k=E=>R=>{R!==A[E]&&(A[E]=R,l.setOrientation(...A))},I=E=>R=>{R!==N[E]&&(N[E]=R,l.setPosition(...N))},M=(E,R,O)=>{const q=n(u,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:R});q.connect(x,0,E),q.start(),Object.defineProperty(q.offset,"defaultValue",{get(){return R}});const D=t({context:c},C,q.offset,ft,At);return a(D,"value",$=>()=>$.call(D),$=>F=>{try{$.call(D,F)}catch(L){if(L.code!==9)throw L}T(),C&&O(F)}),D.cancelAndHoldAtTime=($=>C?()=>{throw i()}:(...F)=>{const L=$.apply(D,F);return T(),L})(D.cancelAndHoldAtTime),D.cancelScheduledValues=($=>C?()=>{throw i()}:(...F)=>{const L=$.apply(D,F);return T(),L})(D.cancelScheduledValues),D.exponentialRampToValueAtTime=($=>C?()=>{throw i()}:(...F)=>{const L=$.apply(D,F);return T(),L})(D.exponentialRampToValueAtTime),D.linearRampToValueAtTime=($=>C?()=>{throw i()}:(...F)=>{const L=$.apply(D,F);return T(),L})(D.linearRampToValueAtTime),D.setTargetAtTime=($=>C?()=>{throw i()}:(...F)=>{const L=$.apply(D,F);return T(),L})(D.setTargetAtTime),D.setValueAtTime=($=>C?()=>{throw i()}:(...F)=>{const L=$.apply(D,F);return T(),L})(D.setValueAtTime),D.setValueCurveAtTime=($=>C?()=>{throw i()}:(...F)=>{const L=$.apply(D,F);return T(),L})(D.setValueCurveAtTime),D};return{forwardX:M(0,0,k(0)),forwardY:M(1,0,k(1)),forwardZ:M(2,-1,k(2)),positionX:M(6,0,I(0)),positionY:M(7,0,I(1)),positionZ:M(8,0,I(2)),upX:M(3,0,k(3)),upY:M(4,1,k(4)),upZ:M(5,0,k(5))}},{forwardX:f,forwardY:d,forwardZ:p,positionX:g,positionY:m,positionZ:_,upX:b,upY:v,upZ:y}=l.forwardX===void 0?h():l;return{get forwardX(){return f},get forwardY(){return d},get forwardZ(){return p},get positionX(){return g},get positionY(){return m},get positionZ(){return _},get upX(){return b},get upY(){return v},get upZ(){return y}}},Ya=t=>"context"in t,xo=t=>Ya(t[0]),Qr=(t,e,n,r)=>{for(const i of t)if(n(i)){if(r)return!1;throw Error("The set contains at least one similar element.")}return t.add(e),!0},D1=(t,e,[n,r],i)=>{Qr(t,[e,n,r],s=>s[0]===e&&s[1]===n,i)},P1=(t,[e,n,r],i)=>{const s=t.get(e);s===void 0?t.set(e,new Set([[n,r]])):Qr(s,[n,r],o=>o[0]===n,i)},ns=t=>"inputs"in t,Xa=(t,e,n,r)=>{if(ns(e)){const i=e.inputs[r];return t.connect(i,n,0),[i,n,0]}return t.connect(e,n,r),[e,n,r]},f2=(t,e,n)=>{for(const r of t)if(r[0]===e&&r[1]===n)return t.delete(r),r;return null},_6=(t,e,n)=>lu(t,r=>r[0]===e&&r[1]===n),d2=(t,e)=>{if(!vo(t).delete(e))throw new Error("Missing the expected event listener.")},p2=(t,e,n)=>{const r=sn(t,e),i=lu(r,s=>s[0]===n);return r.size===0&&t.delete(e),i},Za=(t,e,n,r)=>{ns(e)?t.disconnect(e.inputs[r],n,0):t.disconnect(e,n,r)},Me=t=>sn(pp,t),eo=t=>sn(mp,t),zr=t=>Rf.has(t),ma=t=>!Li.has(t),q1=(t,e)=>new Promise(n=>{if(e!==null)n(!0);else{const r=t.createScriptProcessor(256,1,1),i=t.createGain(),s=t.createBuffer(1,2,44100),o=s.getChannelData(0);o[0]=1,o[1]=1;const a=t.createBufferSource();a.buffer=s,a.loop=!0,a.connect(r).connect(t.destination),a.connect(i),a.disconnect(i),r.onaudioprocess=c=>{const u=c.inputBuffer.getChannelData(0);Array.prototype.some.call(u,l=>l===1)?n(!0):n(!1),a.stop(),r.onaudioprocess=null,a.disconnect(r),r.disconnect(t.destination)},a.start()}}),Bh=(t,e)=>{const n=new Map;for(const r of t)for(const i of r){const s=n.get(i);n.set(i,s===void 0?1:s+1)}n.forEach((r,i)=>e(i,r))},Ka=t=>"context"in t,y6=t=>{const e=new Map;t.connect=(n=>(r,i=0,s=0)=>{const o=Ka(r)?n(r,i,s):n(r,i),a=e.get(r);return a===void 0?e.set(r,[{input:s,output:i}]):a.every(c=>c.input!==s||c.output!==i)&&a.push({input:s,output:i}),o})(t.connect.bind(t)),t.disconnect=(n=>(r,i,s)=>{if(n.apply(t),r===void 0)e.clear();else if(typeof r=="number")for(const[o,a]of e){const c=a.filter(u=>u.output!==r);c.length===0?e.delete(o):e.set(o,c)}else if(e.has(r))if(i===void 0)e.delete(r);else{const o=e.get(r);if(o!==void 0){const a=o.filter(c=>c.output!==i&&(c.input!==s||s===void 0));a.length===0?e.delete(r):e.set(r,a)}}for(const[o,a]of e)a.forEach(c=>{Ka(o)?t.connect(o,c.output,c.input):t.connect(o,c.output)})})(t.disconnect)},v6=(t,e,n,r)=>{const{activeInputs:i,passiveInputs:s}=wo(e),{outputs:o}=yt(t),a=vo(t),c=u=>{const l=Me(t),h=eo(e);if(u){const f=p2(s,t,n);D1(i,t,f,!1),!r&&!zr(t)&&l.connect(h,n)}else{const f=_6(i,t,n);P1(s,f,!1),!r&&!zr(t)&&l.disconnect(h,n)}};return Qr(o,[e,n],u=>u[0]===e&&u[1]===n,!0)?(a.add(c),Fn(t)?D1(i,t,[n,c],!0):P1(s,[t,n,c],!0),!0):!1},b6=(t,e,n,r)=>{const{activeInputs:i,passiveInputs:s}=yt(e),o=f2(i[r],t,n);return o===null?[c2(s,t,n,r)[2],!1]:[o[2],!0]},w6=(t,e,n)=>{const{activeInputs:r,passiveInputs:i}=wo(e),s=f2(r,t,n);return s===null?[p2(i,t,n)[1],!1]:[s[2],!0]},_p=(t,e,n,r,i)=>{const[s,o]=b6(t,n,r,i);if(s!==null&&(d2(t,s),o&&!e&&!zr(t)&&Za(Me(t),Me(n),r,i)),Fn(n)){const{activeInputs:a}=yt(n);Df(n,a)}},yp=(t,e,n,r)=>{const[i,s]=w6(t,n,r);i!==null&&(d2(t,i),s&&!e&&!zr(t)&&Me(t).disconnect(eo(n),r))},x6=(t,e)=>{const n=yt(t),r=[];for(const i of n.outputs)xo(i)?_p(t,e,...i):yp(t,e,...i),r.push(i[0]);return n.outputs.clear(),r},T6=(t,e,n)=>{const r=yt(t),i=[];for(const s of r.outputs)s[1]===n&&(xo(s)?_p(t,e,...s):yp(t,e,...s),i.push(s[0]),r.outputs.delete(s));return i},S6=(t,e,n,r,i)=>{const s=yt(t);return Array.from(s.outputs).filter(o=>o[0]===n&&(r===void 0||o[1]===r)&&(i===void 0||o[2]===i)).map(o=>(xo(o)?_p(t,e,...o):yp(t,e,...o),s.outputs.delete(o),o[0]))},C6=(t,e,n,r,i,s,o,a,c,u,l,h,f,d,p,g)=>class extends u{constructor(_,b,v,y){super(v),this._context=_,this._nativeAudioNode=v;const w=l(_);h(w)&&n(q1,()=>q1(w,g))!==!0&&y6(v),pp.set(this,v),o2.set(this,new Set),_.state!=="closed"&&b&&ji(this),t(this,y,v)}get channelCount(){return this._nativeAudioNode.channelCount}set channelCount(_){this._nativeAudioNode.channelCount=_}get channelCountMode(){return this._nativeAudioNode.channelCountMode}set channelCountMode(_){this._nativeAudioNode.channelCountMode=_}get channelInterpretation(){return this._nativeAudioNode.channelInterpretation}set channelInterpretation(_){this._nativeAudioNode.channelInterpretation=_}get context(){return this._context}get numberOfInputs(){return this._nativeAudioNode.numberOfInputs}get numberOfOutputs(){return this._nativeAudioNode.numberOfOutputs}connect(_,b=0,v=0){if(b<0||b>=this._nativeAudioNode.numberOfOutputs)throw i();const y=l(this._context),w=p(y);if(f(_)||d(_))throw s();if(Ya(_)){const S=Me(_);try{const N=Xa(this._nativeAudioNode,S,b,v),T=ma(this);(w||T)&&this._nativeAudioNode.disconnect(...N),this.context.state!=="closed"&&!T&&ma(_)&&ji(_)}catch(N){throw N.code===12?s():N}if(e(this,_,b,v,w)){const N=c([this],_);Bh(N,r(w))}return _}const x=eo(_);if(x.name==="playbackRate"&&x.maxValue===1024)throw o();try{this._nativeAudioNode.connect(x,b),(w||ma(this))&&this._nativeAudioNode.disconnect(x,b)}catch(S){throw S.code===12?s():S}if(v6(this,_,b,w)){const S=c([this],_);Bh(S,r(w))}}disconnect(_,b,v){let y;const w=l(this._context),x=p(w);if(_===void 0)y=x6(this,x);else if(typeof _=="number"){if(_<0||_>=this.numberOfOutputs)throw i();y=T6(this,x,_)}else{if(b!==void 0&&(b<0||b>=this.numberOfOutputs)||Ya(_)&&v!==void 0&&(v<0||v>=_.numberOfInputs))throw i();if(y=S6(this,x,_,b,v),y.length===0)throw s()}for(const C of y){const S=c([this],C);Bh(S,a)}}},M6=(t,e,n,r,i,s,o,a,c,u,l,h,f)=>(d,p,g,m=null,_=null)=>{const b=g.value,v=new q3(b),y=p?r(v):null,w={get defaultValue(){return b},get maxValue(){return m===null?g.maxValue:m},get minValue(){return _===null?g.minValue:_},get value(){return g.value},set value(x){g.value=x,w.setValueAtTime(x,d.context.currentTime)},cancelAndHoldAtTime(x){if(typeof g.cancelAndHoldAtTime=="function")y===null&&v.flush(d.context.currentTime),v.add(i(x)),g.cancelAndHoldAtTime(x);else{const C=Array.from(v).pop();y===null&&v.flush(d.context.currentTime),v.add(i(x));const S=Array.from(v).pop();g.cancelScheduledValues(x),C!==S&&S!==void 0&&(S.type==="exponentialRampToValue"?g.exponentialRampToValueAtTime(S.value,S.endTime):S.type==="linearRampToValue"?g.linearRampToValueAtTime(S.value,S.endTime):S.type==="setValue"?g.setValueAtTime(S.value,S.startTime):S.type==="setValueCurve"&&g.setValueCurveAtTime(S.values,S.startTime,S.duration))}return w},cancelScheduledValues(x){return y===null&&v.flush(d.context.currentTime),v.add(s(x)),g.cancelScheduledValues(x),w},exponentialRampToValueAtTime(x,C){if(x===0)throw new RangeError;if(!Number.isFinite(C)||C<0)throw new RangeError;const S=d.context.currentTime;return y===null&&v.flush(S),Array.from(v).length===0&&(v.add(u(b,S)),g.setValueAtTime(b,S)),v.add(o(x,C)),g.exponentialRampToValueAtTime(x,C),w},linearRampToValueAtTime(x,C){const S=d.context.currentTime;return y===null&&v.flush(S),Array.from(v).length===0&&(v.add(u(b,S)),g.setValueAtTime(b,S)),v.add(a(x,C)),g.linearRampToValueAtTime(x,C),w},setTargetAtTime(x,C,S){return y===null&&v.flush(d.context.currentTime),v.add(c(x,C,S)),g.setTargetAtTime(x,C,S),w},setValueAtTime(x,C){return y===null&&v.flush(d.context.currentTime),v.add(u(x,C)),g.setValueAtTime(x,C),w},setValueCurveAtTime(x,C,S){const A=x instanceof Float32Array?x:new Float32Array(x);if(h!==null&&h.name==="webkitAudioContext"){const N=C+S,T=d.context.sampleRate,k=Math.ceil(C*T),I=Math.floor(N*T),M=I-k,E=new Float32Array(M);for(let O=0;O<M;O+=1){const q=(A.length-1)/S*((k+O)/T-C),D=Math.floor(q),$=Math.ceil(q);E[O]=D===$?A[D]:(1-(q-D))*A[D]+(1-($-q))*A[$]}y===null&&v.flush(d.context.currentTime),v.add(l(E,C,S)),g.setValueCurveAtTime(E,C,S);const R=I/T;R<N&&f(w,E[E.length-1],R),f(w,A[A.length-1],N)}else y===null&&v.flush(d.context.currentTime),v.add(l(A,C,S)),g.setValueCurveAtTime(A,C,S);return w}};return n.set(w,g),e.set(w,d),t(w,y),w},A6=t=>({replay(e){for(const n of t)if(n.type==="exponentialRampToValue"){const{endTime:r,value:i}=n;e.exponentialRampToValueAtTime(i,r)}else if(n.type==="linearRampToValue"){const{endTime:r,value:i}=n;e.linearRampToValueAtTime(i,r)}else if(n.type==="setTarget"){const{startTime:r,target:i,timeConstant:s}=n;e.setTargetAtTime(i,r,s)}else if(n.type==="setValue"){const{startTime:r,value:i}=n;e.setValueAtTime(i,r)}else if(n.type==="setValueCurve"){const{duration:r,startTime:i,values:s}=n;e.setValueCurveAtTime(s,i,r)}else throw new Error("Can't apply an unknown automation.")}});class m2{constructor(e){this._map=new Map(e)}get size(){return this._map.size}entries(){return this._map.entries()}forEach(e,n=null){return this._map.forEach((r,i)=>e.call(n,r,i,this))}get(e){return this._map.get(e)}has(e){return this._map.has(e)}keys(){return this._map.keys()}values(){return this._map.values()}}const N6={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:1,numberOfOutputs:1,parameterData:{},processorOptions:{}},k6=(t,e,n,r,i,s,o,a,c,u,l,h,f,d)=>class extends e{constructor(g,m,_){var b;const v=a(g),y=c(v),w=l({...N6,..._});f(w);const x=If.get(v),C=x==null?void 0:x.get(m),S=y||v.state!=="closed"?v:(b=o(v))!==null&&b!==void 0?b:v,A=i(S,y?null:g.baseLatency,u,m,C,w),N=y?r(m,w,C):null;super(g,!0,A,N);const T=[];A.parameters.forEach((I,M)=>{const E=n(this,y,I);T.push([M,E])}),this._nativeAudioWorkletNode=A,this._onprocessorerror=null,this._parameters=new m2(T),y&&t(v,this);const{activeInputs:k}=s(this);h(A,k)}get onprocessorerror(){return this._onprocessorerror}set onprocessorerror(g){const m=typeof g=="function"?d(this,g):null;this._nativeAudioWorkletNode.onprocessorerror=m;const _=this._nativeAudioWorkletNode.onprocessorerror;this._onprocessorerror=_!==null&&_===m?g:_}get parameters(){return this._parameters===null?this._nativeAudioWorkletNode.parameters:this._parameters}get port(){return this._nativeAudioWorkletNode.port}};function Qa(t,e,n,r,i){if(typeof t.copyFromChannel=="function")e[n].byteLength===0&&(e[n]=new Float32Array(128)),t.copyFromChannel(e[n],r,i);else{const s=t.getChannelData(r);if(e[n].byteLength===0)e[n]=s.slice(i,i+128);else{const o=new Float32Array(s.buffer,i*Float32Array.BYTES_PER_ELEMENT,128);e[n].set(o)}}}const g2=(t,e,n,r,i)=>{typeof t.copyToChannel=="function"?e[n].byteLength!==0&&t.copyToChannel(e[n],r,i):e[n].byteLength!==0&&t.getChannelData(r).set(e[n],i)},Ja=(t,e)=>{const n=[];for(let r=0;r<t;r+=1){const i=[],s=typeof e=="number"?e:e[r];for(let o=0;o<s;o+=1)i.push(new Float32Array(128));n.push(i)}return n},E6=(t,e)=>{const n=sn(Of,t),r=Me(e);return sn(n,r)},R6=async(t,e,n,r,i,s,o)=>{const a=e===null?Math.ceil(t.context.length/128)*128:e.length,c=r.channelCount*r.numberOfInputs,u=i.reduce((m,_)=>m+_,0),l=u===0?null:n.createBuffer(u,a,n.sampleRate);if(s===void 0)throw new Error("Missing the processor constructor.");const h=yt(t),f=await E6(n,t),d=Ja(r.numberOfInputs,r.channelCount),p=Ja(r.numberOfOutputs,i),g=Array.from(t.parameters.keys()).reduce((m,_)=>({...m,[_]:new Float32Array(128)}),{});for(let m=0;m<a;m+=128){if(r.numberOfInputs>0&&e!==null)for(let _=0;_<r.numberOfInputs;_+=1)for(let b=0;b<r.channelCount;b+=1)Qa(e,d[_],b,b,m);s.parameterDescriptors!==void 0&&e!==null&&s.parameterDescriptors.forEach(({name:_},b)=>{Qa(e,g,_,c+b,m)});for(let _=0;_<r.numberOfInputs;_+=1)for(let b=0;b<i[_];b+=1)p[_][b].byteLength===0&&(p[_][b]=new Float32Array(128));try{const _=d.map((v,y)=>h.activeInputs[y].size===0?[]:v),b=o(m/n.sampleRate,n.sampleRate,()=>f.process(_,p,g));if(l!==null)for(let v=0,y=0;v<r.numberOfOutputs;v+=1){for(let w=0;w<i[v];w+=1)g2(l,p[v],w,y+w,m);y+=i[v]}if(!b)break}catch(_){t.dispatchEvent(new ErrorEvent("processorerror",{colno:_.colno,filename:_.filename,lineno:_.lineno,message:_.message}));break}}return l},I6=(t,e,n,r,i,s,o,a,c,u,l,h,f,d,p,g)=>(m,_,b)=>{const v=new WeakMap;let y=null;const w=async(x,C)=>{let S=l(x),A=null;const N=ct(S,C),T=Array.isArray(_.outputChannelCount)?_.outputChannelCount:Array.from(_.outputChannelCount);if(h===null){const k=T.reduce((R,O)=>R+O,0),I=i(C,{channelCount:Math.max(1,k),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,k)}),M=[];for(let R=0;R<x.numberOfOutputs;R+=1)M.push(r(C,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:T[R]}));const E=o(C,{channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation,gain:1});E.connect=e.bind(null,M),E.disconnect=c.bind(null,M),A=[I,M,E]}else N||(S=new h(C,m));if(v.set(C,A===null?S:A[2]),A!==null){if(y===null){if(b===void 0)throw new Error("Missing the processor constructor.");if(f===null)throw new Error("Missing the native OfflineAudioContext constructor.");const O=x.channelCount*x.numberOfInputs,q=b.parameterDescriptors===void 0?0:b.parameterDescriptors.length,D=O+q;y=R6(x,D===0?null:await(async()=>{const F=new f(D,Math.ceil(x.context.length/128)*128,C.sampleRate),L=[],te=[];for(let ne=0;ne<_.numberOfInputs;ne+=1)L.push(o(F,{channelCount:_.channelCount,channelCountMode:_.channelCountMode,channelInterpretation:_.channelInterpretation,gain:1})),te.push(i(F,{channelCount:_.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:_.channelCount}));const Z=await Promise.all(Array.from(x.parameters.values()).map(async ne=>{const J=s(F,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:ne.value});return await d(F,ne,J.offset),J})),W=r(F,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,O+q)});for(let ne=0;ne<_.numberOfInputs;ne+=1){L[ne].connect(te[ne]);for(let J=0;J<_.channelCount;J+=1)te[ne].connect(W,J,ne*_.channelCount+J)}for(const[ne,J]of Z.entries())J.connect(W,0,O+ne),J.start(0);return W.connect(F.destination),await Promise.all(L.map(ne=>p(x,F,ne))),g(F)})(),C,_,T,b,u)}const k=await y,I=n(C,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),[M,E,R]=A;k!==null&&(I.buffer=k,I.start(0)),I.connect(M);for(let O=0,q=0;O<x.numberOfOutputs;O+=1){const D=E[O];for(let $=0;$<T[O];$+=1)M.connect(D,q+$,$);q+=T[O]}return R}if(N)for(const[k,I]of x.parameters.entries())await t(C,I,S.parameters.get(k));else for(const[k,I]of x.parameters.entries())await d(C,I,S.parameters.get(k));return await p(x,C,S),S};return{render(x,C){a(C,x);const S=v.get(C);return S!==void 0?Promise.resolve(S):w(x,C)}}},O6=(t,e,n,r,i,s,o,a,c,u,l,h,f,d,p,g,m,_,b,v)=>class extends p{constructor(w,x){super(w,x),this._nativeContext=w,this._audioWorklet=t===void 0?void 0:{addModule:(C,S)=>t(this,C,S)}}get audioWorklet(){return this._audioWorklet}createAnalyser(){return new e(this)}createBiquadFilter(){return new i(this)}createBuffer(w,x,C){return new n({length:x,numberOfChannels:w,sampleRate:C})}createBufferSource(){return new r(this)}createChannelMerger(w=6){return new s(this,{numberOfInputs:w})}createChannelSplitter(w=6){return new o(this,{numberOfOutputs:w})}createConstantSource(){return new a(this)}createConvolver(){return new c(this)}createDelay(w=1){return new l(this,{maxDelayTime:w})}createDynamicsCompressor(){return new h(this)}createGain(){return new f(this)}createIIRFilter(w,x){return new d(this,{feedback:x,feedforward:w})}createOscillator(){return new g(this)}createPanner(){return new m(this)}createPeriodicWave(w,x,C={disableNormalization:!1}){return new _(this,{...C,imag:x,real:w})}createStereoPanner(){return new b(this)}createWaveShaper(){return new v(this)}decodeAudioData(w,x,C){return u(this._nativeContext,w).then(S=>(typeof x=="function"&&x(S),S),S=>{throw typeof C=="function"&&C(S),S})}},D6={Q:1,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:350,gain:0,type:"lowpass"},P6=(t,e,n,r,i,s,o,a)=>class extends t{constructor(u,l){const h=s(u),f={...D6,...l},d=i(h,f),p=o(h),g=p?n():null;super(u,!1,d,g),this._Q=e(this,p,d.Q,ft,At),this._detune=e(this,p,d.detune,1200*Math.log2(ft),-1200*Math.log2(ft)),this._frequency=e(this,p,d.frequency,u.sampleRate/2,0),this._gain=e(this,p,d.gain,40*Math.log10(ft),At),this._nativeBiquadFilterNode=d,a(this,1)}get detune(){return this._detune}get frequency(){return this._frequency}get gain(){return this._gain}get Q(){return this._Q}get type(){return this._nativeBiquadFilterNode.type}set type(u){this._nativeBiquadFilterNode.type=u}getFrequencyResponse(u,l,h){try{this._nativeBiquadFilterNode.getFrequencyResponse(u,l,h)}catch(f){throw f.code===11?r():f}if(u.length!==l.length||l.length!==h.length)throw r()}},q6=(t,e,n,r,i)=>()=>{const s=new WeakMap,o=async(a,c)=>{let u=n(a);const l=ct(u,c);if(!l){const h={Q:u.Q.value,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,detune:u.detune.value,frequency:u.frequency.value,gain:u.gain.value,type:u.type};u=e(c,h)}return s.set(c,u),l?(await t(c,a.Q,u.Q),await t(c,a.detune,u.detune),await t(c,a.frequency,u.frequency),await t(c,a.gain,u.gain)):(await r(c,a.Q,u.Q),await r(c,a.detune,u.detune),await r(c,a.frequency,u.frequency),await r(c,a.gain,u.gain)),await i(a,c,u),u};return{render(a,c){const u=s.get(c);return u!==void 0?Promise.resolve(u):o(a,c)}}},F6=(t,e)=>(n,r)=>{const i=e.get(n);if(i!==void 0)return i;const s=t.get(n);if(s!==void 0)return s;try{const o=r();return o instanceof Promise?(t.set(n,o),o.catch(()=>!1).then(a=>(t.delete(n),e.set(n,a),a))):(e.set(n,o),o)}catch{return e.set(n,!1),!1}},$6={channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6},V6=(t,e,n,r,i)=>class extends t{constructor(o,a){const c=r(o),u={...$6,...a},l=n(c,u),h=i(c)?e():null;super(o,!1,l,h)}},L6=(t,e,n)=>()=>{const r=new WeakMap,i=async(s,o)=>{let a=e(s);if(!ct(a,o)){const u={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfInputs:a.numberOfInputs};a=t(o,u)}return r.set(o,a),await n(s,o,a),a};return{render(s,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},j6={channelCount:6,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:6},z6=(t,e,n,r,i,s)=>class extends t{constructor(a,c){const u=r(a),l=s({...j6,...c}),h=n(u,l),f=i(u)?e():null;super(a,!1,h,f)}},B6=(t,e,n)=>()=>{const r=new WeakMap,i=async(s,o)=>{let a=e(s);if(!ct(a,o)){const u={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,numberOfOutputs:a.numberOfOutputs};a=t(o,u)}return r.set(o,a),await n(s,o,a),a};return{render(s,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},W6=t=>(e,n,r)=>t(n,e,r),U6=t=>(e,n,r=0,i=0)=>{const s=e[r];if(s===void 0)throw t();return Ka(n)?s.connect(n,0,i):s.connect(n,0)},G6=t=>(e,n)=>{const r=t(e,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),i=e.createBuffer(1,2,44100);return r.buffer=i,r.loop=!0,r.connect(n),r.start(),()=>{r.stop(),r.disconnect(n)}},H6={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",offset:1},Y6=(t,e,n,r,i,s,o)=>class extends t{constructor(c,u){const l=i(c),h={...H6,...u},f=r(l,h),d=s(l),p=d?n():null;super(c,!1,f,p),this._constantSourceNodeRenderer=p,this._nativeConstantSourceNode=f,this._offset=e(this,d,f.offset,ft,At),this._onended=null}get offset(){return this._offset}get onended(){return this._onended}set onended(c){const u=typeof c=="function"?o(this,c):null;this._nativeConstantSourceNode.onended=u;const l=this._nativeConstantSourceNode.onended;this._onended=l!==null&&l===u?c:l}start(c=0){if(this._nativeConstantSourceNode.start(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.start=c),this.context.state!=="closed"){ji(this);const u=()=>{this._nativeConstantSourceNode.removeEventListener("ended",u),Fn(this)&&bo(this)};this._nativeConstantSourceNode.addEventListener("ended",u)}}stop(c=0){this._nativeConstantSourceNode.stop(c),this._constantSourceNodeRenderer!==null&&(this._constantSourceNodeRenderer.stop=c)}},X6=(t,e,n,r,i)=>()=>{const s=new WeakMap;let o=null,a=null;const c=async(u,l)=>{let h=n(u);const f=ct(h,l);if(!f){const d={channelCount:h.channelCount,channelCountMode:h.channelCountMode,channelInterpretation:h.channelInterpretation,offset:h.offset.value};h=e(l,d),o!==null&&h.start(o),a!==null&&h.stop(a)}return s.set(l,h),f?await t(l,u.offset,h.offset):await r(l,u.offset,h.offset),await i(u,l,h),h};return{set start(u){o=u},set stop(u){a=u},render(u,l){const h=s.get(l);return h!==void 0?Promise.resolve(h):c(u,l)}}},Z6=t=>e=>(t[0]=e,t[0]),K6={buffer:null,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",disableNormalization:!1},Q6=(t,e,n,r,i,s)=>class extends t{constructor(a,c){const u=r(a),l={...K6,...c},h=n(u,l),d=i(u)?e():null;super(a,!1,h,d),this._isBufferNullified=!1,this._nativeConvolverNode=h,l.buffer!==null&&s(this,l.buffer.duration)}get buffer(){return this._isBufferNullified?null:this._nativeConvolverNode.buffer}set buffer(a){if(this._nativeConvolverNode.buffer=a,a===null&&this._nativeConvolverNode.buffer!==null){const c=this._nativeConvolverNode.context;this._nativeConvolverNode.buffer=c.createBuffer(1,1,c.sampleRate),this._isBufferNullified=!0,s(this,0)}else this._isBufferNullified=!1,s(this,this._nativeConvolverNode.buffer===null?0:this._nativeConvolverNode.buffer.duration)}get normalize(){return this._nativeConvolverNode.normalize}set normalize(a){this._nativeConvolverNode.normalize=a}},J6=(t,e,n)=>()=>{const r=new WeakMap,i=async(s,o)=>{let a=e(s);if(!ct(a,o)){const u={buffer:a.buffer,channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,disableNormalization:!a.normalize};a=t(o,u)}return r.set(o,a),ns(a)?await n(s,o,a.inputs[0]):await n(s,o,a),a};return{render(s,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},eN=(t,e)=>(n,r,i)=>{if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");try{return new e(n,r,i)}catch(s){throw s.name==="SyntaxError"?t():s}},tN=()=>new DOMException("","DataCloneError"),F1=t=>{const{port1:e,port2:n}=new MessageChannel;return new Promise(r=>{const i=()=>{n.onmessage=null,e.close(),n.close(),r()};n.onmessage=()=>i();try{e.postMessage(t,[t])}catch{}finally{i()}})},nN=(t,e,n,r,i,s,o,a,c,u,l)=>(h,f)=>{const d=o(h)?h:s(h);if(i.has(f)){const p=n();return Promise.reject(p)}try{i.add(f)}catch{}return e(c,()=>c(d))?d.decodeAudioData(f).then(p=>(F1(f).catch(()=>{}),e(a,()=>a(p))||l(p),t.add(p),p)):new Promise((p,g)=>{const m=async()=>{try{await F1(f)}catch{}},_=b=>{g(b),m()};try{d.decodeAudioData(f,b=>{typeof b.copyFromChannel!="function"&&(u(b),gp(b)),t.add(b),m().then(()=>p(b))},b=>{_(b===null?r():b)})}catch(b){_(b)}})},rN=(t,e,n,r,i,s,o,a)=>(c,u)=>{const l=e.get(c);if(l===void 0)throw new Error("Missing the expected cycle count.");const h=s(c.context),f=a(h);if(l===u){if(e.delete(c),!f&&o(c)){const d=r(c),{outputs:p}=n(c);for(const g of p)if(xo(g)){const m=r(g[0]);t(d,m,g[1],g[2])}else{const m=i(g[0]);d.connect(m,g[1])}}}else e.set(c,l-u)},iN={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",delayTime:0,maxDelayTime:1},sN=(t,e,n,r,i,s,o)=>class extends t{constructor(c,u){const l=i(c),h={...iN,...u},f=r(l,h),d=s(l),p=d?n(h.maxDelayTime):null;super(c,!1,f,p),this._delayTime=e(this,d,f.delayTime),o(this,h.maxDelayTime)}get delayTime(){return this._delayTime}},oN=(t,e,n,r,i)=>s=>{const o=new WeakMap,a=async(c,u)=>{let l=n(c);const h=ct(l,u);if(!h){const f={channelCount:l.channelCount,channelCountMode:l.channelCountMode,channelInterpretation:l.channelInterpretation,delayTime:l.delayTime.value,maxDelayTime:s};l=e(u,f)}return o.set(u,l),h?await t(u,c.delayTime,l.delayTime):await r(u,c.delayTime,l.delayTime),await i(c,u,l),l};return{render(c,u){const l=o.get(u);return l!==void 0?Promise.resolve(l):a(c,u)}}},aN=t=>(e,n,r,i)=>t(e[i],s=>s[0]===n&&s[1]===r),cN=t=>(e,n)=>{t(e).delete(n)},uN=t=>"delayTime"in t,lN=(t,e,n)=>function r(i,s){const o=Ya(s)?s:n(t,s);if(uN(o))return[];if(i[0]===o)return[i];if(i.includes(o))return[];const{outputs:a}=e(o);return Array.from(a).map(c=>r([...i,o],c[0])).reduce((c,u)=>c.concat(u),[])},Zo=(t,e,n)=>{const r=e[n];if(r===void 0)throw t();return r},hN=t=>(e,n=void 0,r=void 0,i=0)=>n===void 0?e.forEach(s=>s.disconnect()):typeof n=="number"?Zo(t,e,n).disconnect():Ka(n)?r===void 0?e.forEach(s=>s.disconnect(n)):i===void 0?Zo(t,e,r).disconnect(n,0):Zo(t,e,r).disconnect(n,0,i):r===void 0?e.forEach(s=>s.disconnect(n)):Zo(t,e,r).disconnect(n,0),fN={attack:.003,channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",knee:30,ratio:12,release:.25,threshold:-24},dN=(t,e,n,r,i,s,o,a)=>class extends t{constructor(u,l){const h=s(u),f={...fN,...l},d=r(h,f),p=o(h),g=p?n():null;super(u,!1,d,g),this._attack=e(this,p,d.attack),this._knee=e(this,p,d.knee),this._nativeDynamicsCompressorNode=d,this._ratio=e(this,p,d.ratio),this._release=e(this,p,d.release),this._threshold=e(this,p,d.threshold),a(this,.006)}get attack(){return this._attack}get channelCount(){return this._nativeDynamicsCompressorNode.channelCount}set channelCount(u){const l=this._nativeDynamicsCompressorNode.channelCount;if(this._nativeDynamicsCompressorNode.channelCount=u,u>2)throw this._nativeDynamicsCompressorNode.channelCount=l,i()}get channelCountMode(){return this._nativeDynamicsCompressorNode.channelCountMode}set channelCountMode(u){const l=this._nativeDynamicsCompressorNode.channelCountMode;if(this._nativeDynamicsCompressorNode.channelCountMode=u,u==="max")throw this._nativeDynamicsCompressorNode.channelCountMode=l,i()}get knee(){return this._knee}get ratio(){return this._ratio}get reduction(){return typeof this._nativeDynamicsCompressorNode.reduction.value=="number"?this._nativeDynamicsCompressorNode.reduction.value:this._nativeDynamicsCompressorNode.reduction}get release(){return this._release}get threshold(){return this._threshold}},pN=(t,e,n,r,i)=>()=>{const s=new WeakMap,o=async(a,c)=>{let u=n(a);const l=ct(u,c);if(!l){const h={attack:u.attack.value,channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,knee:u.knee.value,ratio:u.ratio.value,release:u.release.value,threshold:u.threshold.value};u=e(c,h)}return s.set(c,u),l?(await t(c,a.attack,u.attack),await t(c,a.knee,u.knee),await t(c,a.ratio,u.ratio),await t(c,a.release,u.release),await t(c,a.threshold,u.threshold)):(await r(c,a.attack,u.attack),await r(c,a.knee,u.knee),await r(c,a.ratio,u.ratio),await r(c,a.release,u.release),await r(c,a.threshold,u.threshold)),await i(a,c,u),u};return{render(a,c){const u=s.get(c);return u!==void 0?Promise.resolve(u):o(a,c)}}},mN=()=>new DOMException("","EncodingError"),gN=t=>e=>new Promise((n,r)=>{if(t===null){r(new SyntaxError);return}const i=t.document.head;if(i===null)r(new SyntaxError);else{const s=t.document.createElement("script"),o=new Blob([e],{type:"application/javascript"}),a=URL.createObjectURL(o),c=t.onerror,u=()=>{t.onerror=c,URL.revokeObjectURL(a)};t.onerror=(l,h,f,d,p)=>{if(h===a||h===t.location.href&&f===1&&d===1)return u(),r(p),!1;if(c!==null)return c(l,h,f,d,p)},s.onerror=()=>{u(),r(new SyntaxError)},s.onload=()=>{u(),n()},s.src=a,s.type="module",i.appendChild(s)}}),_N=t=>class{constructor(n){this._nativeEventTarget=n,this._listeners=new WeakMap}addEventListener(n,r,i){if(r!==null){let s=this._listeners.get(r);s===void 0&&(s=t(this,r),typeof r=="function"&&this._listeners.set(r,s)),this._nativeEventTarget.addEventListener(n,s,i)}}dispatchEvent(n){return this._nativeEventTarget.dispatchEvent(n)}removeEventListener(n,r,i){const s=r===null?void 0:this._listeners.get(r);this._nativeEventTarget.removeEventListener(n,s===void 0?null:s,i)}},yN=t=>(e,n,r)=>{Object.defineProperties(t,{currentFrame:{configurable:!0,get(){return Math.round(e*n)}},currentTime:{configurable:!0,get(){return e}}});try{return r()}finally{t!==null&&(delete t.currentFrame,delete t.currentTime)}},vN=t=>async e=>{try{const n=await fetch(e);if(n.ok)return[await n.text(),n.url]}catch{}throw t()},bN={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",gain:1},wN=(t,e,n,r,i,s)=>class extends t{constructor(a,c){const u=i(a),l={...bN,...c},h=r(u,l),f=s(u),d=f?n():null;super(a,!1,h,d),this._gain=e(this,f,h.gain,ft,At)}get gain(){return this._gain}},xN=(t,e,n,r,i)=>()=>{const s=new WeakMap,o=async(a,c)=>{let u=n(a);const l=ct(u,c);if(!l){const h={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,gain:u.gain.value};u=e(c,h)}return s.set(c,u),l?await t(c,a.gain,u.gain):await r(c,a.gain,u.gain),await i(a,c,u),u};return{render(a,c){const u=s.get(c);return u!==void 0?Promise.resolve(u):o(a,c)}}},TN=(t,e)=>n=>e(t,n),SN=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioNode in the audio graph.");return n.renderer},CN=t=>e=>{var n;return(n=t.get(e))!==null&&n!==void 0?n:0},MN=t=>e=>{const n=t(e);if(n.renderer===null)throw new Error("Missing the renderer of the given AudioParam in the audio graph.");return n.renderer},AN=t=>e=>t.get(e),Ye=()=>new DOMException("","InvalidStateError"),NN=t=>e=>{const n=t.get(e);if(n===void 0)throw Ye();return n},kN=(t,e)=>n=>{let r=t.get(n);if(r!==void 0)return r;if(e===null)throw new Error("Missing the native OfflineAudioContext constructor.");return r=new e(1,1,44100),t.set(n,r),r},EN=t=>e=>{const n=t.get(e);if(n===void 0)throw new Error("The context has no set of AudioWorkletNodes.");return n},hu=()=>new DOMException("","InvalidAccessError"),RN=t=>{t.getFrequencyResponse=(e=>(n,r,i)=>{if(n.length!==r.length||r.length!==i.length)throw hu();return e.call(t,n,r,i)})(t.getFrequencyResponse)},IN={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers"},ON=(t,e,n,r,i,s)=>class extends t{constructor(a,c){const u=r(a),l=i(u),h={...IN,...c},f=e(u,l?null:a.baseLatency,h),d=l?n(h.feedback,h.feedforward):null;super(a,!1,f,d),RN(f),this._nativeIIRFilterNode=f,s(this,1)}getFrequencyResponse(a,c,u){return this._nativeIIRFilterNode.getFrequencyResponse(a,c,u)}},_2=(t,e,n,r,i,s,o,a,c,u,l)=>{const h=u.length;let f=a;for(let d=0;d<h;d+=1){let p=n[0]*u[d];for(let g=1;g<i;g+=1){const m=f-g&c-1;p+=n[g]*s[m],p-=t[g]*o[m]}for(let g=i;g<r;g+=1)p+=n[g]*s[f-g&c-1];for(let g=i;g<e;g+=1)p-=t[g]*o[f-g&c-1];s[f]=u[d],o[f]=p,f=f+1&c-1,l[d]=p}return f},DN=(t,e,n,r)=>{const i=n instanceof Float64Array?n:new Float64Array(n),s=r instanceof Float64Array?r:new Float64Array(r),o=i.length,a=s.length,c=Math.min(o,a);if(i[0]!==1){for(let p=0;p<o;p+=1)s[p]/=i[0];for(let p=1;p<a;p+=1)i[p]/=i[0]}const u=32,l=new Float32Array(u),h=new Float32Array(u),f=e.createBuffer(t.numberOfChannels,t.length,t.sampleRate),d=t.numberOfChannels;for(let p=0;p<d;p+=1){const g=t.getChannelData(p),m=f.getChannelData(p);l.fill(0),h.fill(0),_2(i,o,s,a,c,l,h,0,u,g,m)}return f},PN=(t,e,n,r,i)=>(s,o)=>{const a=new WeakMap;let c=null;const u=async(l,h)=>{let f=null,d=e(l);const p=ct(d,h);if(h.createIIRFilter===void 0?f=t(h,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}):p||(d=h.createIIRFilter(o,s)),a.set(h,f===null?d:f),f!==null){if(c===null){if(n===null)throw new Error("Missing the native OfflineAudioContext constructor.");const m=new n(l.context.destination.channelCount,l.context.length,h.sampleRate);c=(async()=>{await r(l,m,m.destination);const _=await i(m);return DN(_,h,s,o)})()}const g=await c;return f.buffer=g,f.start(0),f}return await r(l,h,d),d};return{render(l,h){const f=a.get(h);return f!==void 0?Promise.resolve(f):u(l,h)}}},qN=(t,e,n,r,i,s)=>o=>(a,c)=>{const u=t.get(a);if(u===void 0){if(!o&&s(a)){const l=r(a),{outputs:h}=n(a);for(const f of h)if(xo(f)){const d=r(f[0]);e(l,d,f[1],f[2])}else{const d=i(f[0]);l.disconnect(d,f[1])}}t.set(a,c)}else t.set(a,u+c)},FN=(t,e)=>n=>{const r=t.get(n);return e(r)||e(n)},$N=(t,e)=>n=>t.has(n)||e(n),VN=(t,e)=>n=>t.has(n)||e(n),LN=(t,e)=>n=>{const r=t.get(n);return e(r)||e(n)},jN=t=>e=>t!==null&&e instanceof t,zN=t=>e=>t!==null&&typeof t.AudioNode=="function"&&e instanceof t.AudioNode,BN=t=>e=>t!==null&&typeof t.AudioParam=="function"&&e instanceof t.AudioParam,WN=(t,e)=>n=>t(n)||e(n),UN=t=>e=>t!==null&&e instanceof t,GN=t=>t!==null&&t.isSecureContext,HN=(t,e,n,r)=>class extends t{constructor(s,o){const a=n(s),c=e(a,o);if(r(a))throw TypeError();super(s,!0,c,null),this._nativeMediaElementAudioSourceNode=c}get mediaElement(){return this._nativeMediaElementAudioSourceNode.mediaElement}},YN={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers"},XN=(t,e,n,r)=>class extends t{constructor(s,o){const a=n(s);if(r(a))throw new TypeError;const c={...YN,...o},u=e(a,c);super(s,!1,u,null),this._nativeMediaStreamAudioDestinationNode=u}get stream(){return this._nativeMediaStreamAudioDestinationNode.stream}},ZN=(t,e,n,r)=>class extends t{constructor(s,o){const a=n(s),c=e(a,o);if(r(a))throw new TypeError;super(s,!0,c,null),this._nativeMediaStreamAudioSourceNode=c}get mediaStream(){return this._nativeMediaStreamAudioSourceNode.mediaStream}},KN=(t,e,n)=>class extends t{constructor(i,s){const o=n(i),a=e(o,s);super(i,!0,a,null)}},QN=(t,e,n,r,i,s)=>class extends n{constructor(a,c){super(a),this._nativeContext=a,uu.set(this,a),r(a)&&i.set(a,new Set),this._destination=new t(this,c),this._listener=e(this,a),this._onstatechange=null}get currentTime(){return this._nativeContext.currentTime}get destination(){return this._destination}get listener(){return this._listener}get onstatechange(){return this._onstatechange}set onstatechange(a){const c=typeof a=="function"?s(this,a):null;this._nativeContext.onstatechange=c;const u=this._nativeContext.onstatechange;this._onstatechange=u!==null&&u===c?a:u}get sampleRate(){return this._nativeContext.sampleRate}get state(){return this._nativeContext.state}},to=t=>{const e=new Uint32Array([1179011410,40,1163280727,544501094,16,131073,44100,176400,1048580,1635017060,4,0]);try{const n=t.decodeAudioData(e.buffer,()=>{});return n===void 0?!1:(n.catch(()=>{}),!0)}catch{}return!1},JN=(t,e)=>(n,r,i)=>{const s=new Set;return n.connect=(o=>(a,c=0,u=0)=>{const l=s.size===0;if(e(a))return o.call(n,a,c,u),t(s,[a,c,u],h=>h[0]===a&&h[1]===c&&h[2]===u,!0),l&&r(),a;o.call(n,a,c),t(s,[a,c],h=>h[0]===a&&h[1]===c,!0),l&&r()})(n.connect),n.disconnect=(o=>(a,c,u)=>{const l=s.size>0;if(a===void 0)o.apply(n),s.clear();else if(typeof a=="number"){o.call(n,a);for(const f of s)f[1]===a&&s.delete(f)}else{e(a)?o.call(n,a,c,u):o.call(n,a,c);for(const f of s)f[0]===a&&(c===void 0||f[1]===c)&&(u===void 0||f[2]===u)&&s.delete(f)}const h=s.size===0;l&&h&&i()})(n.disconnect),n},ke=(t,e,n)=>{const r=e[n];r!==void 0&&r!==t[n]&&(t[n]=r)},Ue=(t,e)=>{ke(t,e,"channelCount"),ke(t,e,"channelCountMode"),ke(t,e,"channelInterpretation")},$1=t=>typeof t.getFloatTimeDomainData=="function",e4=t=>{t.getFloatTimeDomainData=e=>{const n=new Uint8Array(e.length);t.getByteTimeDomainData(n);const r=Math.max(n.length,t.fftSize);for(let i=0;i<r;i+=1)e[i]=(n[i]-128)*.0078125;return e}},t4=(t,e)=>(n,r)=>{const i=n.createAnalyser();if(Ue(i,r),!(r.maxDecibels>r.minDecibels))throw e();return ke(i,r,"fftSize"),ke(i,r,"maxDecibels"),ke(i,r,"minDecibels"),ke(i,r,"smoothingTimeConstant"),t($1,()=>$1(i))||e4(i),i},n4=t=>t===null?null:t.hasOwnProperty("AudioBuffer")?t.AudioBuffer:null,Pe=(t,e,n)=>{const r=e[n];r!==void 0&&r!==t[n].value&&(t[n].value=r)},r4=t=>{t.start=(e=>{let n=!1;return(r=0,i=0,s)=>{if(n)throw Ye();e.call(t,r,i,s),n=!0}})(t.start)},vp=t=>{t.start=(e=>(n=0,r=0,i)=>{if(typeof i=="number"&&i<0||r<0||n<0)throw new RangeError("The parameters can't be negative.");e.call(t,n,r,i)})(t.start)},bp=t=>{t.stop=(e=>(n=0)=>{if(n<0)throw new RangeError("The parameter can't be negative.");e.call(t,n)})(t.stop)},i4=(t,e,n,r,i,s,o,a,c,u,l)=>(h,f)=>{const d=h.createBufferSource();return Ue(d,f),Pe(d,f,"playbackRate"),ke(d,f,"buffer"),ke(d,f,"loop"),ke(d,f,"loopEnd"),ke(d,f,"loopStart"),e(n,()=>n(h))||r4(d),e(r,()=>r(h))||c(d),e(i,()=>i(h))||u(d,h),e(s,()=>s(h))||vp(d),e(o,()=>o(h))||l(d,h),e(a,()=>a(h))||bp(d),t(h,d),d},s4=t=>t===null?null:t.hasOwnProperty("AudioContext")?t.AudioContext:t.hasOwnProperty("webkitAudioContext")?t.webkitAudioContext:null,o4=(t,e)=>(n,r,i)=>{const s=n.destination;if(s.channelCount!==r)try{s.channelCount=r}catch{}i&&s.channelCountMode!=="explicit"&&(s.channelCountMode="explicit"),s.maxChannelCount===0&&Object.defineProperty(s,"maxChannelCount",{value:r});const o=t(n,{channelCount:r,channelCountMode:s.channelCountMode,channelInterpretation:s.channelInterpretation,gain:1});return e(o,"channelCount",a=>()=>a.call(o),a=>c=>{a.call(o,c);try{s.channelCount=c}catch(u){if(c>s.maxChannelCount)throw u}}),e(o,"channelCountMode",a=>()=>a.call(o),a=>c=>{a.call(o,c),s.channelCountMode=c}),e(o,"channelInterpretation",a=>()=>a.call(o),a=>c=>{a.call(o,c),s.channelInterpretation=c}),Object.defineProperty(o,"maxChannelCount",{get:()=>s.maxChannelCount}),o.connect(s),o},a4=t=>t===null?null:t.hasOwnProperty("AudioWorkletNode")?t.AudioWorkletNode:null,c4=t=>{const{port1:e}=new MessageChannel;try{e.postMessage(t)}finally{e.close()}},u4=(t,e,n,r,i)=>(s,o,a,c,u,l)=>{if(a!==null)try{const h=new a(s,c,l),f=new Map;let d=null;if(Object.defineProperties(h,{channelCount:{get:()=>l.channelCount,set:()=>{throw t()}},channelCountMode:{get:()=>"explicit",set:()=>{throw t()}},onprocessorerror:{get:()=>d,set:p=>{typeof d=="function"&&h.removeEventListener("processorerror",d),d=typeof p=="function"?p:null,typeof d=="function"&&h.addEventListener("processorerror",d)}}}),h.addEventListener=(p=>(...g)=>{if(g[0]==="processorerror"){const m=typeof g[1]=="function"?g[1]:typeof g[1]=="object"&&g[1]!==null&&typeof g[1].handleEvent=="function"?g[1].handleEvent:null;if(m!==null){const _=f.get(g[1]);_!==void 0?g[1]=_:(g[1]=b=>{b.type==="error"?(Object.defineProperties(b,{type:{value:"processorerror"}}),m(b)):m(new ErrorEvent(g[0],{...b}))},f.set(m,g[1]))}}return p.call(h,"error",g[1],g[2]),p.call(h,...g)})(h.addEventListener),h.removeEventListener=(p=>(...g)=>{if(g[0]==="processorerror"){const m=f.get(g[1]);m!==void 0&&(f.delete(g[1]),g[1]=m)}return p.call(h,"error",g[1],g[2]),p.call(h,g[0],g[1],g[2])})(h.removeEventListener),l.numberOfOutputs!==0){const p=n(s,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return h.connect(p).connect(s.destination),i(h,()=>p.disconnect(),()=>p.connect(s.destination))}return h}catch(h){throw h.code===11?r():h}if(u===void 0)throw r();return c4(l),e(s,o,u,l)},y2=(t,e)=>t===null?512:Math.max(512,Math.min(16384,Math.pow(2,Math.round(Math.log2(t*e))))),l4=t=>new Promise((e,n)=>{const{port1:r,port2:i}=new MessageChannel;r.onmessage=({data:s})=>{r.close(),i.close(),e(s)},r.onmessageerror=({data:s})=>{r.close(),i.close(),n(s)},i.postMessage(t)}),h4=async(t,e)=>{const n=await l4(e);return new t(n)},f4=(t,e,n,r)=>{let i=Of.get(t);i===void 0&&(i=new WeakMap,Of.set(t,i));const s=h4(n,r);return i.set(e,s),s},d4=(t,e,n,r,i,s,o,a,c,u,l,h,f)=>(d,p,g,m)=>{if(m.numberOfInputs===0&&m.numberOfOutputs===0)throw c();const _=Array.isArray(m.outputChannelCount)?m.outputChannelCount:Array.from(m.outputChannelCount);if(_.some(j=>j<1))throw c();if(_.length!==m.numberOfOutputs)throw e();if(m.channelCountMode!=="explicit")throw c();const b=m.channelCount*m.numberOfInputs,v=_.reduce((j,H)=>j+H,0),y=g.parameterDescriptors===void 0?0:g.parameterDescriptors.length;if(b+y>6||v>6)throw c();const w=new MessageChannel,x=[],C=[];for(let j=0;j<m.numberOfInputs;j+=1)x.push(o(d,{channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation,gain:1})),C.push(i(d,{channelCount:m.channelCount,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:m.channelCount}));const S=[];if(g.parameterDescriptors!==void 0)for(const{defaultValue:j,maxValue:H,minValue:U,name:se}of g.parameterDescriptors){const le=s(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:m.parameterData[se]!==void 0?m.parameterData[se]:j===void 0?0:j});Object.defineProperties(le.offset,{defaultValue:{get:()=>j===void 0?0:j},maxValue:{get:()=>H===void 0?ft:H},minValue:{get:()=>U===void 0?At:U}}),S.push(le)}const A=r(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:Math.max(1,b+y)}),N=y2(p,d.sampleRate),T=a(d,N,b+y,Math.max(1,v)),k=i(d,{channelCount:Math.max(1,v),channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:Math.max(1,v)}),I=[];for(let j=0;j<m.numberOfOutputs;j+=1)I.push(r(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:_[j]}));for(let j=0;j<m.numberOfInputs;j+=1){x[j].connect(C[j]);for(let H=0;H<m.channelCount;H+=1)C[j].connect(A,H,j*m.channelCount+H)}const M=new m2(g.parameterDescriptors===void 0?[]:g.parameterDescriptors.map(({name:j},H)=>{const U=S[H];return U.connect(A,0,b+H),U.start(0),[j,U.offset]}));A.connect(T);let E=m.channelInterpretation,R=null;const O=m.numberOfOutputs===0?[T]:I,q={get bufferSize(){return N},get channelCount(){return m.channelCount},set channelCount(j){throw n()},get channelCountMode(){return m.channelCountMode},set channelCountMode(j){throw n()},get channelInterpretation(){return E},set channelInterpretation(j){for(const H of x)H.channelInterpretation=j;E=j},get context(){return T.context},get inputs(){return x},get numberOfInputs(){return m.numberOfInputs},get numberOfOutputs(){return m.numberOfOutputs},get onprocessorerror(){return R},set onprocessorerror(j){typeof R=="function"&&q.removeEventListener("processorerror",R),R=typeof j=="function"?j:null,typeof R=="function"&&q.addEventListener("processorerror",R)},get parameters(){return M},get port(){return w.port2},addEventListener(...j){return T.addEventListener(j[0],j[1],j[2])},connect:t.bind(null,O),disconnect:u.bind(null,O),dispatchEvent(...j){return T.dispatchEvent(j[0])},removeEventListener(...j){return T.removeEventListener(j[0],j[1],j[2])}},D=new Map;w.port1.addEventListener=(j=>(...H)=>{if(H[0]==="message"){const U=typeof H[1]=="function"?H[1]:typeof H[1]=="object"&&H[1]!==null&&typeof H[1].handleEvent=="function"?H[1].handleEvent:null;if(U!==null){const se=D.get(H[1]);se!==void 0?H[1]=se:(H[1]=le=>{l(d.currentTime,d.sampleRate,()=>U(le))},D.set(U,H[1]))}}return j.call(w.port1,H[0],H[1],H[2])})(w.port1.addEventListener),w.port1.removeEventListener=(j=>(...H)=>{if(H[0]==="message"){const U=D.get(H[1]);U!==void 0&&(D.delete(H[1]),H[1]=U)}return j.call(w.port1,H[0],H[1],H[2])})(w.port1.removeEventListener);let $=null;Object.defineProperty(w.port1,"onmessage",{get:()=>$,set:j=>{typeof $=="function"&&w.port1.removeEventListener("message",$),$=typeof j=="function"?j:null,typeof $=="function"&&(w.port1.addEventListener("message",$),w.port1.start())}}),g.prototype.port=w.port1;let F=null;f4(d,q,g,m).then(j=>F=j);const te=Ja(m.numberOfInputs,m.channelCount),Z=Ja(m.numberOfOutputs,_),W=g.parameterDescriptors===void 0?[]:g.parameterDescriptors.reduce((j,{name:H})=>({...j,[H]:new Float32Array(128)}),{});let ne=!0;const J=()=>{m.numberOfOutputs>0&&T.disconnect(k);for(let j=0,H=0;j<m.numberOfOutputs;j+=1){const U=I[j];for(let se=0;se<_[j];se+=1)k.disconnect(U,H+se,se);H+=_[j]}},B=new Map;T.onaudioprocess=({inputBuffer:j,outputBuffer:H})=>{if(F!==null){const U=h(q);for(let se=0;se<N;se+=128){for(let le=0;le<m.numberOfInputs;le+=1)for(let me=0;me<m.channelCount;me+=1)Qa(j,te[le],me,me,se);g.parameterDescriptors!==void 0&&g.parameterDescriptors.forEach(({name:le},me)=>{Qa(j,W,le,b+me,se)});for(let le=0;le<m.numberOfInputs;le+=1)for(let me=0;me<_[le];me+=1)Z[le][me].byteLength===0&&(Z[le][me]=new Float32Array(128));try{const le=te.map((ut,ln)=>{if(U[ln].size>0)return B.set(ln,N/128),ut;const ee=B.get(ln);return ee===void 0?[]:(ut.every(ye=>ye.every(Ae=>Ae===0))&&(ee===1?B.delete(ln):B.set(ln,ee-1)),ut)});ne=l(d.currentTime+se/d.sampleRate,d.sampleRate,()=>F.process(le,Z,W));for(let ut=0,ln=0;ut<m.numberOfOutputs;ut+=1){for(let Yn=0;Yn<_[ut];Yn+=1)g2(H,Z[ut],Yn,ln+Yn,se);ln+=_[ut]}}catch(le){ne=!1,q.dispatchEvent(new ErrorEvent("processorerror",{colno:le.colno,filename:le.filename,lineno:le.lineno,message:le.message}))}if(!ne){for(let le=0;le<m.numberOfInputs;le+=1){x[le].disconnect(C[le]);for(let me=0;me<m.channelCount;me+=1)C[se].disconnect(A,me,le*m.channelCount+me)}if(g.parameterDescriptors!==void 0){const le=g.parameterDescriptors.length;for(let me=0;me<le;me+=1){const ut=S[me];ut.disconnect(A,0,b+me),ut.stop()}}A.disconnect(T),T.onaudioprocess=null,z?J():V();break}}}};let z=!1;const Y=o(d,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0}),K=()=>T.connect(Y).connect(d.destination),V=()=>{T.disconnect(Y),Y.disconnect()},ve=()=>{if(ne){V(),m.numberOfOutputs>0&&T.connect(k);for(let j=0,H=0;j<m.numberOfOutputs;j+=1){const U=I[j];for(let se=0;se<_[j];se+=1)k.connect(U,H+se,se);H+=_[j]}}z=!0},ge=()=>{ne&&(K(),J()),z=!1};return K(),f(q,ve,ge)},v2=(t,e)=>{const n=t.createBiquadFilter();return Ue(n,e),Pe(n,e,"Q"),Pe(n,e,"detune"),Pe(n,e,"frequency"),Pe(n,e,"gain"),ke(n,e,"type"),n},p4=(t,e)=>(n,r)=>{const i=n.createChannelMerger(r.numberOfInputs);return t!==null&&t.name==="webkitAudioContext"&&e(n,i),Ue(i,r),i},m4=t=>{const e=t.numberOfOutputs;Object.defineProperty(t,"channelCount",{get:()=>e,set:n=>{if(n!==e)throw Ye()}}),Object.defineProperty(t,"channelCountMode",{get:()=>"explicit",set:n=>{if(n!=="explicit")throw Ye()}}),Object.defineProperty(t,"channelInterpretation",{get:()=>"discrete",set:n=>{if(n!=="discrete")throw Ye()}})},To=(t,e)=>{const n=t.createChannelSplitter(e.numberOfOutputs);return Ue(n,e),m4(n),n},g4=(t,e,n,r,i)=>(s,o)=>{if(s.createConstantSource===void 0)return n(s,o);const a=s.createConstantSource();return Ue(a,o),Pe(a,o,"offset"),e(r,()=>r(s))||vp(a),e(i,()=>i(s))||bp(a),t(s,a),a},rs=(t,e)=>(t.connect=e.connect.bind(e),t.disconnect=e.disconnect.bind(e),t),_4=(t,e,n,r)=>(i,{offset:s,...o})=>{const a=i.createBuffer(1,2,44100),c=e(i,{buffer:null,channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",loop:!1,loopEnd:0,loopStart:0,playbackRate:1}),u=n(i,{...o,gain:s}),l=a.getChannelData(0);l[0]=1,l[1]=1,c.buffer=a,c.loop=!0;const h={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(p){u.channelCount=p},get channelCountMode(){return u.channelCountMode},set channelCountMode(p){u.channelCountMode=p},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(p){u.channelInterpretation=p},get context(){return u.context},get inputs(){return[]},get numberOfInputs(){return c.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get offset(){return u.gain},get onended(){return c.onended},set onended(p){c.onended=p},addEventListener(...p){return c.addEventListener(p[0],p[1],p[2])},dispatchEvent(...p){return c.dispatchEvent(p[0])},removeEventListener(...p){return c.removeEventListener(p[0],p[1],p[2])},start(p=0){c.start.call(c,p)},stop(p=0){c.stop.call(c,p)}},f=()=>c.connect(u),d=()=>c.disconnect(u);return t(i,c),r(rs(h,u),f,d)},y4=(t,e)=>(n,r)=>{const i=n.createConvolver();if(Ue(i,r),r.disableNormalization===i.normalize&&(i.normalize=!r.disableNormalization),ke(i,r,"buffer"),r.channelCount>2||(e(i,"channelCount",s=>()=>s.call(i),s=>o=>{if(o>2)throw t();return s.call(i,o)}),r.channelCountMode==="max"))throw t();return e(i,"channelCountMode",s=>()=>s.call(i),s=>o=>{if(o==="max")throw t();return s.call(i,o)}),i},b2=(t,e)=>{const n=t.createDelay(e.maxDelayTime);return Ue(n,e),Pe(n,e,"delayTime"),n},v4=t=>(e,n)=>{const r=e.createDynamicsCompressor();if(Ue(r,n),n.channelCount>2||n.channelCountMode==="max")throw t();return Pe(r,n,"attack"),Pe(r,n,"knee"),Pe(r,n,"ratio"),Pe(r,n,"release"),Pe(r,n,"threshold"),r},Rt=(t,e)=>{const n=t.createGain();return Ue(n,e),Pe(n,e,"gain"),n},b4=t=>(e,n,r)=>{if(e.createIIRFilter===void 0)return t(e,n,r);const i=e.createIIRFilter(r.feedforward,r.feedback);return Ue(i,r),i};function w4(t,e){const n=e[0]*e[0]+e[1]*e[1];return[(t[0]*e[0]+t[1]*e[1])/n,(t[1]*e[0]-t[0]*e[1])/n]}function x4(t,e){return[t[0]*e[0]-t[1]*e[1],t[0]*e[1]+t[1]*e[0]]}function V1(t,e){let n=[0,0];for(let r=t.length-1;r>=0;r-=1)n=x4(n,e),n[0]+=t[r];return n}const T4=(t,e,n,r)=>(i,s,{channelCount:o,channelCountMode:a,channelInterpretation:c,feedback:u,feedforward:l})=>{const h=y2(s,i.sampleRate),f=u instanceof Float64Array?u:new Float64Array(u),d=l instanceof Float64Array?l:new Float64Array(l),p=f.length,g=d.length,m=Math.min(p,g);if(p===0||p>20)throw r();if(f[0]===0)throw e();if(g===0||g>20)throw r();if(d[0]===0)throw e();if(f[0]!==1){for(let S=0;S<g;S+=1)d[S]/=f[0];for(let S=1;S<p;S+=1)f[S]/=f[0]}const _=n(i,h,o,o);_.channelCount=o,_.channelCountMode=a,_.channelInterpretation=c;const b=32,v=[],y=[],w=[];for(let S=0;S<o;S+=1){v.push(0);const A=new Float32Array(b),N=new Float32Array(b);A.fill(0),N.fill(0),y.push(A),w.push(N)}_.onaudioprocess=S=>{const A=S.inputBuffer,N=S.outputBuffer,T=A.numberOfChannels;for(let k=0;k<T;k+=1){const I=A.getChannelData(k),M=N.getChannelData(k);v[k]=_2(f,p,d,g,m,y[k],w[k],v[k],b,I,M)}};const x=i.sampleRate/2;return rs({get bufferSize(){return h},get channelCount(){return _.channelCount},set channelCount(S){_.channelCount=S},get channelCountMode(){return _.channelCountMode},set channelCountMode(S){_.channelCountMode=S},get channelInterpretation(){return _.channelInterpretation},set channelInterpretation(S){_.channelInterpretation=S},get context(){return _.context},get inputs(){return[_]},get numberOfInputs(){return _.numberOfInputs},get numberOfOutputs(){return _.numberOfOutputs},addEventListener(...S){return _.addEventListener(S[0],S[1],S[2])},dispatchEvent(...S){return _.dispatchEvent(S[0])},getFrequencyResponse(S,A,N){if(S.length!==A.length||A.length!==N.length)throw t();const T=S.length;for(let k=0;k<T;k+=1){const I=-Math.PI*(S[k]/x),M=[Math.cos(I),Math.sin(I)],E=V1(d,M),R=V1(f,M),O=w4(E,R);A[k]=Math.sqrt(O[0]*O[0]+O[1]*O[1]),N[k]=Math.atan2(O[1],O[0])}},removeEventListener(...S){return _.removeEventListener(S[0],S[1],S[2])}},_)},S4=(t,e)=>t.createMediaElementSource(e.mediaElement),C4=(t,e)=>{const n=t.createMediaStreamDestination();return Ue(n,e),n.numberOfOutputs===1&&Object.defineProperty(n,"numberOfOutputs",{get:()=>0}),n},M4=(t,{mediaStream:e})=>{const n=e.getAudioTracks();n.sort((s,o)=>s.id<o.id?-1:s.id>o.id?1:0);const r=n.slice(0,1),i=t.createMediaStreamSource(new MediaStream(r));return Object.defineProperty(i,"mediaStream",{value:e}),i},A4=(t,e)=>(n,{mediaStreamTrack:r})=>{if(typeof n.createMediaStreamTrackSource=="function")return n.createMediaStreamTrackSource(r);const i=new MediaStream([r]),s=n.createMediaStreamSource(i);if(r.kind!=="audio")throw t();if(e(n))throw new TypeError;return s},N4=t=>t===null?null:t.hasOwnProperty("OfflineAudioContext")?t.OfflineAudioContext:t.hasOwnProperty("webkitOfflineAudioContext")?t.webkitOfflineAudioContext:null,k4=(t,e,n,r,i,s)=>(o,a)=>{const c=o.createOscillator();return Ue(c,a),Pe(c,a,"detune"),Pe(c,a,"frequency"),a.periodicWave!==void 0?c.setPeriodicWave(a.periodicWave):ke(c,a,"type"),e(n,()=>n(o))||vp(c),e(r,()=>r(o))||s(c,o),e(i,()=>i(o))||bp(c),t(o,c),c},E4=t=>(e,n)=>{const r=e.createPanner();return r.orientationX===void 0?t(e,n):(Ue(r,n),Pe(r,n,"orientationX"),Pe(r,n,"orientationY"),Pe(r,n,"orientationZ"),Pe(r,n,"positionX"),Pe(r,n,"positionY"),Pe(r,n,"positionZ"),ke(r,n,"coneInnerAngle"),ke(r,n,"coneOuterAngle"),ke(r,n,"coneOuterGain"),ke(r,n,"distanceModel"),ke(r,n,"maxDistance"),ke(r,n,"panningModel"),ke(r,n,"refDistance"),ke(r,n,"rolloffFactor"),r)},R4=(t,e,n,r,i,s,o,a,c,u)=>(l,{coneInnerAngle:h,coneOuterAngle:f,coneOuterGain:d,distanceModel:p,maxDistance:g,orientationX:m,orientationY:_,orientationZ:b,panningModel:v,positionX:y,positionY:w,positionZ:x,refDistance:C,rolloffFactor:S,...A})=>{const N=l.createPanner();if(A.channelCount>2||A.channelCountMode==="max")throw o();Ue(N,A);const T={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},k=n(l,{...T,channelInterpretation:"speakers",numberOfInputs:6}),I=r(l,{...A,gain:1}),M=r(l,{...T,gain:1}),E=r(l,{...T,gain:0}),R=r(l,{...T,gain:0}),O=r(l,{...T,gain:0}),q=r(l,{...T,gain:0}),D=r(l,{...T,gain:0}),$=i(l,256,6,1),F=s(l,{...T,curve:new Float32Array([1,1]),oversample:"none"});let L=[m,_,b],te=[y,w,x];const Z=new Float32Array(1);$.onaudioprocess=({inputBuffer:B})=>{const z=[c(B,Z,0),c(B,Z,1),c(B,Z,2)];z.some((K,V)=>K!==L[V])&&(N.setOrientation(...z),L=z);const Y=[c(B,Z,3),c(B,Z,4),c(B,Z,5)];Y.some((K,V)=>K!==te[V])&&(N.setPosition(...Y),te=Y)},Object.defineProperty(E.gain,"defaultValue",{get:()=>0}),Object.defineProperty(R.gain,"defaultValue",{get:()=>0}),Object.defineProperty(O.gain,"defaultValue",{get:()=>0}),Object.defineProperty(q.gain,"defaultValue",{get:()=>0}),Object.defineProperty(D.gain,"defaultValue",{get:()=>0});const W={get bufferSize(){},get channelCount(){return N.channelCount},set channelCount(B){if(B>2)throw o();I.channelCount=B,N.channelCount=B},get channelCountMode(){return N.channelCountMode},set channelCountMode(B){if(B==="max")throw o();I.channelCountMode=B,N.channelCountMode=B},get channelInterpretation(){return N.channelInterpretation},set channelInterpretation(B){I.channelInterpretation=B,N.channelInterpretation=B},get coneInnerAngle(){return N.coneInnerAngle},set coneInnerAngle(B){N.coneInnerAngle=B},get coneOuterAngle(){return N.coneOuterAngle},set coneOuterAngle(B){N.coneOuterAngle=B},get coneOuterGain(){return N.coneOuterGain},set coneOuterGain(B){if(B<0||B>1)throw e();N.coneOuterGain=B},get context(){return N.context},get distanceModel(){return N.distanceModel},set distanceModel(B){N.distanceModel=B},get inputs(){return[I]},get maxDistance(){return N.maxDistance},set maxDistance(B){if(B<0)throw new RangeError;N.maxDistance=B},get numberOfInputs(){return N.numberOfInputs},get numberOfOutputs(){return N.numberOfOutputs},get orientationX(){return M.gain},get orientationY(){return E.gain},get orientationZ(){return R.gain},get panningModel(){return N.panningModel},set panningModel(B){N.panningModel=B},get positionX(){return O.gain},get positionY(){return q.gain},get positionZ(){return D.gain},get refDistance(){return N.refDistance},set refDistance(B){if(B<0)throw new RangeError;N.refDistance=B},get rolloffFactor(){return N.rolloffFactor},set rolloffFactor(B){if(B<0)throw new RangeError;N.rolloffFactor=B},addEventListener(...B){return I.addEventListener(B[0],B[1],B[2])},dispatchEvent(...B){return I.dispatchEvent(B[0])},removeEventListener(...B){return I.removeEventListener(B[0],B[1],B[2])}};h!==W.coneInnerAngle&&(W.coneInnerAngle=h),f!==W.coneOuterAngle&&(W.coneOuterAngle=f),d!==W.coneOuterGain&&(W.coneOuterGain=d),p!==W.distanceModel&&(W.distanceModel=p),g!==W.maxDistance&&(W.maxDistance=g),m!==W.orientationX.value&&(W.orientationX.value=m),_!==W.orientationY.value&&(W.orientationY.value=_),b!==W.orientationZ.value&&(W.orientationZ.value=b),v!==W.panningModel&&(W.panningModel=v),y!==W.positionX.value&&(W.positionX.value=y),w!==W.positionY.value&&(W.positionY.value=w),x!==W.positionZ.value&&(W.positionZ.value=x),C!==W.refDistance&&(W.refDistance=C),S!==W.rolloffFactor&&(W.rolloffFactor=S),(L[0]!==1||L[1]!==0||L[2]!==0)&&N.setOrientation(...L),(te[0]!==0||te[1]!==0||te[2]!==0)&&N.setPosition(...te);const ne=()=>{I.connect(N),t(I,F,0,0),F.connect(M).connect(k,0,0),F.connect(E).connect(k,0,1),F.connect(R).connect(k,0,2),F.connect(O).connect(k,0,3),F.connect(q).connect(k,0,4),F.connect(D).connect(k,0,5),k.connect($).connect(l.destination)},J=()=>{I.disconnect(N),a(I,F,0,0),F.disconnect(M),M.disconnect(k),F.disconnect(E),E.disconnect(k),F.disconnect(R),R.disconnect(k),F.disconnect(O),O.disconnect(k),F.disconnect(q),q.disconnect(k),F.disconnect(D),D.disconnect(k),k.disconnect($),$.disconnect(l.destination)};return u(rs(W,N),ne,J)},I4=t=>(e,{disableNormalization:n,imag:r,real:i})=>{const s=r instanceof Float32Array?r:new Float32Array(r),o=i instanceof Float32Array?i:new Float32Array(i),a=e.createPeriodicWave(o,s,{disableNormalization:n});if(Array.from(r).length<2)throw t();return a},So=(t,e,n,r)=>t.createScriptProcessor(e,n,r),O4=(t,e)=>(n,r)=>{const i=r.channelCountMode;if(i==="clamped-max")throw e();if(n.createStereoPanner===void 0)return t(n,r);const s=n.createStereoPanner();return Ue(s,r),Pe(s,r,"pan"),Object.defineProperty(s,"channelCountMode",{get:()=>i,set:o=>{if(o!==i)throw e()}}),s},D4=(t,e,n,r,i,s)=>{const a=new Float32Array([1,1]),c=Math.PI/2,u={channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete"},l={...u,oversample:"none"},h=(p,g,m,_)=>{const b=new Float32Array(16385),v=new Float32Array(16385);for(let A=0;A<16385;A+=1){const N=A/16384*c;b[A]=Math.cos(N),v[A]=Math.sin(N)}const y=n(p,{...u,gain:0}),w=r(p,{...l,curve:b}),x=r(p,{...l,curve:a}),C=n(p,{...u,gain:0}),S=r(p,{...l,curve:v});return{connectGraph(){g.connect(y),g.connect(x.inputs===void 0?x:x.inputs[0]),g.connect(C),x.connect(m),m.connect(w.inputs===void 0?w:w.inputs[0]),m.connect(S.inputs===void 0?S:S.inputs[0]),w.connect(y.gain),S.connect(C.gain),y.connect(_,0,0),C.connect(_,0,1)},disconnectGraph(){g.disconnect(y),g.disconnect(x.inputs===void 0?x:x.inputs[0]),g.disconnect(C),x.disconnect(m),m.disconnect(w.inputs===void 0?w:w.inputs[0]),m.disconnect(S.inputs===void 0?S:S.inputs[0]),w.disconnect(y.gain),S.disconnect(C.gain),y.disconnect(_,0,0),C.disconnect(_,0,1)}}},f=(p,g,m,_)=>{const b=new Float32Array(16385),v=new Float32Array(16385),y=new Float32Array(16385),w=new Float32Array(16385),x=Math.floor(16385/2);for(let O=0;O<16385;O+=1)if(O>x){const q=(O-x)/(16384-x)*c;b[O]=Math.cos(q),v[O]=Math.sin(q),y[O]=0,w[O]=1}else{const q=O/(16384-x)*c;b[O]=1,v[O]=0,y[O]=Math.cos(q),w[O]=Math.sin(q)}const C=e(p,{channelCount:2,channelCountMode:"explicit",channelInterpretation:"discrete",numberOfOutputs:2}),S=n(p,{...u,gain:0}),A=r(p,{...l,curve:b}),N=n(p,{...u,gain:0}),T=r(p,{...l,curve:v}),k=r(p,{...l,curve:a}),I=n(p,{...u,gain:0}),M=r(p,{...l,curve:y}),E=n(p,{...u,gain:0}),R=r(p,{...l,curve:w});return{connectGraph(){g.connect(C),g.connect(k.inputs===void 0?k:k.inputs[0]),C.connect(S,0),C.connect(N,0),C.connect(I,1),C.connect(E,1),k.connect(m),m.connect(A.inputs===void 0?A:A.inputs[0]),m.connect(T.inputs===void 0?T:T.inputs[0]),m.connect(M.inputs===void 0?M:M.inputs[0]),m.connect(R.inputs===void 0?R:R.inputs[0]),A.connect(S.gain),T.connect(N.gain),M.connect(I.gain),R.connect(E.gain),S.connect(_,0,0),I.connect(_,0,0),N.connect(_,0,1),E.connect(_,0,1)},disconnectGraph(){g.disconnect(C),g.disconnect(k.inputs===void 0?k:k.inputs[0]),C.disconnect(S,0),C.disconnect(N,0),C.disconnect(I,1),C.disconnect(E,1),k.disconnect(m),m.disconnect(A.inputs===void 0?A:A.inputs[0]),m.disconnect(T.inputs===void 0?T:T.inputs[0]),m.disconnect(M.inputs===void 0?M:M.inputs[0]),m.disconnect(R.inputs===void 0?R:R.inputs[0]),A.disconnect(S.gain),T.disconnect(N.gain),M.disconnect(I.gain),R.disconnect(E.gain),S.disconnect(_,0,0),I.disconnect(_,0,0),N.disconnect(_,0,1),E.disconnect(_,0,1)}}},d=(p,g,m,_,b)=>{if(g===1)return h(p,m,_,b);if(g===2)return f(p,m,_,b);throw i()};return(p,{channelCount:g,channelCountMode:m,pan:_,...b})=>{if(m==="max")throw i();const v=t(p,{...b,channelCount:1,channelCountMode:m,numberOfInputs:2}),y=n(p,{...b,channelCount:g,channelCountMode:m,gain:1}),w=n(p,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:_});let{connectGraph:x,disconnectGraph:C}=d(p,g,y,w,v);Object.defineProperty(w.gain,"defaultValue",{get:()=>0}),Object.defineProperty(w.gain,"maxValue",{get:()=>1}),Object.defineProperty(w.gain,"minValue",{get:()=>-1});const S={get bufferSize(){},get channelCount(){return y.channelCount},set channelCount(k){y.channelCount!==k&&(A&&C(),{connectGraph:x,disconnectGraph:C}=d(p,k,y,w,v),A&&x()),y.channelCount=k},get channelCountMode(){return y.channelCountMode},set channelCountMode(k){if(k==="clamped-max"||k==="max")throw i();y.channelCountMode=k},get channelInterpretation(){return y.channelInterpretation},set channelInterpretation(k){y.channelInterpretation=k},get context(){return y.context},get inputs(){return[y]},get numberOfInputs(){return y.numberOfInputs},get numberOfOutputs(){return y.numberOfOutputs},get pan(){return w.gain},addEventListener(...k){return y.addEventListener(k[0],k[1],k[2])},dispatchEvent(...k){return y.dispatchEvent(k[0])},removeEventListener(...k){return y.removeEventListener(k[0],k[1],k[2])}};let A=!1;const N=()=>{x(),A=!0},T=()=>{C(),A=!1};return s(rs(S,v),N,T)}},P4=(t,e,n,r,i,s,o)=>(a,c)=>{const u=a.createWaveShaper();if(s!==null&&s.name==="webkitAudioContext"&&a.createGain().gain.automationRate===void 0)return n(a,c);Ue(u,c);const l=c.curve===null||c.curve instanceof Float32Array?c.curve:new Float32Array(c.curve);if(l!==null&&l.length<2)throw e();ke(u,{curve:l},"curve"),ke(u,c,"oversample");let h=null,f=!1;return o(u,"curve",g=>()=>g.call(u),g=>m=>(g.call(u,m),f&&(r(m)&&h===null?h=t(a,u):!r(m)&&h!==null&&(h(),h=null)),m)),i(u,()=>{f=!0,r(u.curve)&&(h=t(a,u))},()=>{f=!1,h!==null&&(h(),h=null)})},q4=(t,e,n,r,i)=>(s,{curve:o,oversample:a,...c})=>{const u=s.createWaveShaper(),l=s.createWaveShaper();Ue(u,c),Ue(l,c);const h=n(s,{...c,gain:1}),f=n(s,{...c,gain:-1}),d=n(s,{...c,gain:1}),p=n(s,{...c,gain:-1});let g=null,m=!1,_=null;const b={get bufferSize(){},get channelCount(){return u.channelCount},set channelCount(w){h.channelCount=w,f.channelCount=w,u.channelCount=w,d.channelCount=w,l.channelCount=w,p.channelCount=w},get channelCountMode(){return u.channelCountMode},set channelCountMode(w){h.channelCountMode=w,f.channelCountMode=w,u.channelCountMode=w,d.channelCountMode=w,l.channelCountMode=w,p.channelCountMode=w},get channelInterpretation(){return u.channelInterpretation},set channelInterpretation(w){h.channelInterpretation=w,f.channelInterpretation=w,u.channelInterpretation=w,d.channelInterpretation=w,l.channelInterpretation=w,p.channelInterpretation=w},get context(){return u.context},get curve(){return _},set curve(w){if(w!==null&&w.length<2)throw e();if(w===null)u.curve=w,l.curve=w;else{const x=w.length,C=new Float32Array(x+2-x%2),S=new Float32Array(x+2-x%2);C[0]=w[0],S[0]=-w[x-1];const A=Math.ceil((x+1)/2),N=(x+1)/2-1;for(let T=1;T<A;T+=1){const k=T/A*N,I=Math.floor(k),M=Math.ceil(k);C[T]=I===M?w[I]:(1-(k-I))*w[I]+(1-(M-k))*w[M],S[T]=I===M?-w[x-1-I]:-((1-(k-I))*w[x-1-I])-(1-(M-k))*w[x-1-M]}C[A]=x%2===1?w[A-1]:(w[A-2]+w[A-1])/2,u.curve=C,l.curve=S}_=w,m&&(r(_)&&g===null?g=t(s,h):g!==null&&(g(),g=null))},get inputs(){return[h]},get numberOfInputs(){return u.numberOfInputs},get numberOfOutputs(){return u.numberOfOutputs},get oversample(){return u.oversample},set oversample(w){u.oversample=w,l.oversample=w},addEventListener(...w){return h.addEventListener(w[0],w[1],w[2])},dispatchEvent(...w){return h.dispatchEvent(w[0])},removeEventListener(...w){return h.removeEventListener(w[0],w[1],w[2])}};o!==null&&(b.curve=o instanceof Float32Array?o:new Float32Array(o)),a!==b.oversample&&(b.oversample=a);const v=()=>{h.connect(u).connect(d),h.connect(f).connect(l).connect(p).connect(d),m=!0,r(_)&&(g=t(s,h))},y=()=>{h.disconnect(u),u.disconnect(d),h.disconnect(f),f.disconnect(l),l.disconnect(p),p.disconnect(d),m=!1,g!==null&&(g(),g=null)};return i(rs(b,d),v,y)},Tt=()=>new DOMException("","NotSupportedError"),F4={numberOfChannels:1},$4=(t,e,n,r,i)=>class extends t{constructor(o,a,c){let u;if(typeof o=="number"&&a!==void 0&&c!==void 0)u={length:a,numberOfChannels:o,sampleRate:c};else if(typeof o=="object")u=o;else throw new Error("The given parameters are not valid.");const{length:l,numberOfChannels:h,sampleRate:f}={...F4,...u},d=r(h,l,f);e(to,()=>to(d))||d.addEventListener("statechange",(()=>{let p=0;const g=m=>{this._state==="running"&&(p>0?(d.removeEventListener("statechange",g),m.stopImmediatePropagation(),this._waitForThePromiseToSettle(m)):p+=1)};return g})()),super(d,h),this._length=l,this._nativeOfflineAudioContext=d,this._state=null}get length(){return this._nativeOfflineAudioContext.length===void 0?this._length:this._nativeOfflineAudioContext.length}get state(){return this._state===null?this._nativeOfflineAudioContext.state:this._state}startRendering(){return this._state==="running"?Promise.reject(n()):(this._state="running",i(this.destination,this._nativeOfflineAudioContext).finally(()=>{this._state=null,h2(this)}))}_waitForThePromiseToSettle(o){this._state===null?this._nativeOfflineAudioContext.dispatchEvent(o):setTimeout(()=>this._waitForThePromiseToSettle(o))}},V4={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",detune:0,frequency:440,periodicWave:void 0,type:"sine"},L4=(t,e,n,r,i,s,o)=>class extends t{constructor(c,u){const l=i(c),h={...V4,...u},f=n(l,h),d=s(l),p=d?r():null,g=c.sampleRate/2;super(c,!1,f,p),this._detune=e(this,d,f.detune,153600,-153600),this._frequency=e(this,d,f.frequency,g,-g),this._nativeOscillatorNode=f,this._onended=null,this._oscillatorNodeRenderer=p,this._oscillatorNodeRenderer!==null&&h.periodicWave!==void 0&&(this._oscillatorNodeRenderer.periodicWave=h.periodicWave)}get detune(){return this._detune}get frequency(){return this._frequency}get onended(){return this._onended}set onended(c){const u=typeof c=="function"?o(this,c):null;this._nativeOscillatorNode.onended=u;const l=this._nativeOscillatorNode.onended;this._onended=l!==null&&l===u?c:l}get type(){return this._nativeOscillatorNode.type}set type(c){this._nativeOscillatorNode.type=c,this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=null)}setPeriodicWave(c){this._nativeOscillatorNode.setPeriodicWave(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.periodicWave=c)}start(c=0){if(this._nativeOscillatorNode.start(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.start=c),this.context.state!=="closed"){ji(this);const u=()=>{this._nativeOscillatorNode.removeEventListener("ended",u),Fn(this)&&bo(this)};this._nativeOscillatorNode.addEventListener("ended",u)}}stop(c=0){this._nativeOscillatorNode.stop(c),this._oscillatorNodeRenderer!==null&&(this._oscillatorNodeRenderer.stop=c)}},j4=(t,e,n,r,i)=>()=>{const s=new WeakMap;let o=null,a=null,c=null;const u=async(l,h)=>{let f=n(l);const d=ct(f,h);if(!d){const p={channelCount:f.channelCount,channelCountMode:f.channelCountMode,channelInterpretation:f.channelInterpretation,detune:f.detune.value,frequency:f.frequency.value,periodicWave:o===null?void 0:o,type:f.type};f=e(h,p),a!==null&&f.start(a),c!==null&&f.stop(c)}return s.set(h,f),d?(await t(h,l.detune,f.detune),await t(h,l.frequency,f.frequency)):(await r(h,l.detune,f.detune),await r(h,l.frequency,f.frequency)),await i(l,h,f),f};return{set periodicWave(l){o=l},set start(l){a=l},set stop(l){c=l},render(l,h){const f=s.get(h);return f!==void 0?Promise.resolve(f):u(l,h)}}},z4={channelCount:2,channelCountMode:"clamped-max",channelInterpretation:"speakers",coneInnerAngle:360,coneOuterAngle:360,coneOuterGain:0,distanceModel:"inverse",maxDistance:1e4,orientationX:1,orientationY:0,orientationZ:0,panningModel:"equalpower",positionX:0,positionY:0,positionZ:0,refDistance:1,rolloffFactor:1},B4=(t,e,n,r,i,s,o)=>class extends t{constructor(c,u){const l=i(c),h={...z4,...u},f=n(l,h),d=s(l),p=d?r():null;super(c,!1,f,p),this._nativePannerNode=f,this._orientationX=e(this,d,f.orientationX,ft,At),this._orientationY=e(this,d,f.orientationY,ft,At),this._orientationZ=e(this,d,f.orientationZ,ft,At),this._positionX=e(this,d,f.positionX,ft,At),this._positionY=e(this,d,f.positionY,ft,At),this._positionZ=e(this,d,f.positionZ,ft,At),o(this,1)}get coneInnerAngle(){return this._nativePannerNode.coneInnerAngle}set coneInnerAngle(c){this._nativePannerNode.coneInnerAngle=c}get coneOuterAngle(){return this._nativePannerNode.coneOuterAngle}set coneOuterAngle(c){this._nativePannerNode.coneOuterAngle=c}get coneOuterGain(){return this._nativePannerNode.coneOuterGain}set coneOuterGain(c){this._nativePannerNode.coneOuterGain=c}get distanceModel(){return this._nativePannerNode.distanceModel}set distanceModel(c){this._nativePannerNode.distanceModel=c}get maxDistance(){return this._nativePannerNode.maxDistance}set maxDistance(c){this._nativePannerNode.maxDistance=c}get orientationX(){return this._orientationX}get orientationY(){return this._orientationY}get orientationZ(){return this._orientationZ}get panningModel(){return this._nativePannerNode.panningModel}set panningModel(c){this._nativePannerNode.panningModel=c}get positionX(){return this._positionX}get positionY(){return this._positionY}get positionZ(){return this._positionZ}get refDistance(){return this._nativePannerNode.refDistance}set refDistance(c){this._nativePannerNode.refDistance=c}get rolloffFactor(){return this._nativePannerNode.rolloffFactor}set rolloffFactor(c){this._nativePannerNode.rolloffFactor=c}},W4=(t,e,n,r,i,s,o,a,c,u)=>()=>{const l=new WeakMap;let h=null;const f=async(d,p)=>{let g=null,m=s(d);const _={channelCount:m.channelCount,channelCountMode:m.channelCountMode,channelInterpretation:m.channelInterpretation},b={..._,coneInnerAngle:m.coneInnerAngle,coneOuterAngle:m.coneOuterAngle,coneOuterGain:m.coneOuterGain,distanceModel:m.distanceModel,maxDistance:m.maxDistance,panningModel:m.panningModel,refDistance:m.refDistance,rolloffFactor:m.rolloffFactor},v=ct(m,p);if("bufferSize"in m)g=r(p,{..._,gain:1});else if(!v){const y={...b,orientationX:m.orientationX.value,orientationY:m.orientationY.value,orientationZ:m.orientationZ.value,positionX:m.positionX.value,positionY:m.positionY.value,positionZ:m.positionZ.value};m=i(p,y)}if(l.set(p,g===null?m:g),g!==null){if(h===null){if(o===null)throw new Error("Missing the native OfflineAudioContext constructor.");const T=new o(6,d.context.length,p.sampleRate),k=e(T,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"speakers",numberOfInputs:6});k.connect(T.destination),h=(async()=>{const I=await Promise.all([d.orientationX,d.orientationY,d.orientationZ,d.positionX,d.positionY,d.positionZ].map(async(M,E)=>{const R=n(T,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",offset:E===0?1:0});return await a(T,M,R.offset),R}));for(let M=0;M<6;M+=1)I[M].connect(k,0,M),I[M].start(0);return u(T)})()}const y=await h,w=r(p,{..._,gain:1});await c(d,p,w);const x=[];for(let T=0;T<y.numberOfChannels;T+=1)x.push(y.getChannelData(T));let C=[x[0][0],x[1][0],x[2][0]],S=[x[3][0],x[4][0],x[5][0]],A=r(p,{..._,gain:1}),N=i(p,{...b,orientationX:C[0],orientationY:C[1],orientationZ:C[2],positionX:S[0],positionY:S[1],positionZ:S[2]});w.connect(A).connect(N.inputs[0]),N.connect(g);for(let T=128;T<y.length;T+=128){const k=[x[0][T],x[1][T],x[2][T]],I=[x[3][T],x[4][T],x[5][T]];if(k.some((M,E)=>M!==C[E])||I.some((M,E)=>M!==S[E])){C=k,S=I;const M=T/p.sampleRate;A.gain.setValueAtTime(0,M),A=r(p,{..._,gain:0}),N=i(p,{...b,orientationX:C[0],orientationY:C[1],orientationZ:C[2],positionX:S[0],positionY:S[1],positionZ:S[2]}),A.gain.setValueAtTime(1,M),w.connect(A).connect(N.inputs[0]),N.connect(g)}}return g}return v?(await t(p,d.orientationX,m.orientationX),await t(p,d.orientationY,m.orientationY),await t(p,d.orientationZ,m.orientationZ),await t(p,d.positionX,m.positionX),await t(p,d.positionY,m.positionY),await t(p,d.positionZ,m.positionZ)):(await a(p,d.orientationX,m.orientationX),await a(p,d.orientationY,m.orientationY),await a(p,d.orientationZ,m.orientationZ),await a(p,d.positionX,m.positionX),await a(p,d.positionY,m.positionY),await a(p,d.positionZ,m.positionZ)),ns(m)?await c(d,p,m.inputs[0]):await c(d,p,m),m};return{render(d,p){const g=l.get(p);return g!==void 0?Promise.resolve(g):f(d,p)}}},U4={disableNormalization:!1},G4=(t,e,n,r)=>class w2{constructor(s,o){const a=e(s),c=r({...U4,...o}),u=t(a,c);return n.add(u),u}static[Symbol.hasInstance](s){return s!==null&&typeof s=="object"&&Object.getPrototypeOf(s)===w2.prototype||n.has(s)}},H4=(t,e)=>(n,r,i)=>(t(r).replay(i),e(r,n,i)),Y4=(t,e,n)=>async(r,i,s)=>{const o=t(r);await Promise.all(o.activeInputs.map((a,c)=>Array.from(a).map(async([u,l])=>{const f=await e(u).render(u,i),d=r.context.destination;!n(u)&&(r!==d||!n(r))&&f.connect(s,l,c)})).reduce((a,c)=>[...a,...c],[]))},X4=(t,e,n)=>async(r,i,s)=>{const o=e(r);await Promise.all(Array.from(o.activeInputs).map(async([a,c])=>{const l=await t(a).render(a,i);n(a)||l.connect(s,c)}))},Z4=(t,e,n,r)=>i=>t(to,()=>to(i))?Promise.resolve(t(r,r)).then(s=>{if(!s){const o=n(i,512,0,1);i.oncomplete=()=>{o.onaudioprocess=null,o.disconnect()},o.onaudioprocess=()=>i.currentTime,o.connect(i.destination)}return i.startRendering()}):new Promise(s=>{const o=e(i,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});i.oncomplete=a=>{o.disconnect(),s(a.renderedBuffer)},o.connect(i.destination),i.startRendering()}),K4=t=>(e,n)=>{t.set(e,n)},Q4=t=>(e,n)=>t.set(e,n),J4=(t,e,n,r,i,s,o,a)=>(c,u)=>n(c).render(c,u).then(()=>Promise.all(Array.from(r(u)).map(l=>n(l).render(l,u)))).then(()=>i(u)).then(l=>(typeof l.copyFromChannel!="function"?(o(l),gp(l)):e(s,()=>s(l))||a(l),t.add(l),l)),ek={channelCount:2,channelCountMode:"explicit",channelInterpretation:"speakers",pan:0},tk=(t,e,n,r,i,s)=>class extends t{constructor(a,c){const u=i(a),l={...ek,...c},h=n(u,l),f=s(u),d=f?r():null;super(a,!1,h,d),this._pan=e(this,f,h.pan)}get pan(){return this._pan}},nk=(t,e,n,r,i)=>()=>{const s=new WeakMap,o=async(a,c)=>{let u=n(a);const l=ct(u,c);if(!l){const h={channelCount:u.channelCount,channelCountMode:u.channelCountMode,channelInterpretation:u.channelInterpretation,pan:u.pan.value};u=e(c,h)}return s.set(c,u),l?await t(c,a.pan,u.pan):await r(c,a.pan,u.pan),ns(u)?await i(a,c,u.inputs[0]):await i(a,c,u),u};return{render(a,c){const u=s.get(c);return u!==void 0?Promise.resolve(u):o(a,c)}}},rk=t=>()=>{if(t===null)return!1;try{new t({length:1,sampleRate:44100})}catch{return!1}return!0},ik=(t,e)=>async()=>{if(t===null)return!0;if(e===null)return!1;const n=new Blob(['class A extends AudioWorkletProcessor{process(i){this.port.postMessage(i,[i[0][0].buffer])}}registerProcessor("a",A)'],{type:"application/javascript; charset=utf-8"}),r=new e(1,128,44100),i=URL.createObjectURL(n);let s=!1,o=!1;try{await r.audioWorklet.addModule(i);const a=new t(r,"a",{numberOfOutputs:0}),c=r.createOscillator();a.port.onmessage=()=>s=!0,a.onprocessorerror=()=>o=!0,c.connect(a),c.start(0),await r.startRendering(),await new Promise(u=>setTimeout(u))}catch{}finally{URL.revokeObjectURL(i)}return s&&!o},sk=(t,e)=>()=>{if(e===null)return Promise.resolve(!1);const n=new e(1,1,44100),r=t(n,{channelCount:1,channelCountMode:"explicit",channelInterpretation:"discrete",gain:0});return new Promise(i=>{n.oncomplete=()=>{r.disconnect(),i(n.currentTime!==0)},n.startRendering()})},ok=()=>new DOMException("","UnknownError"),ak={channelCount:2,channelCountMode:"max",channelInterpretation:"speakers",curve:null,oversample:"none"},ck=(t,e,n,r,i,s,o)=>class extends t{constructor(c,u){const l=i(c),h={...ak,...u},f=n(l,h),p=s(l)?r():null;super(c,!0,f,p),this._isCurveNullified=!1,this._nativeWaveShaperNode=f,o(this,1)}get curve(){return this._isCurveNullified?null:this._nativeWaveShaperNode.curve}set curve(c){if(c===null)this._isCurveNullified=!0,this._nativeWaveShaperNode.curve=new Float32Array([0,0]);else{if(c.length<2)throw e();this._isCurveNullified=!1,this._nativeWaveShaperNode.curve=c}}get oversample(){return this._nativeWaveShaperNode.oversample}set oversample(c){this._nativeWaveShaperNode.oversample=c}},uk=(t,e,n)=>()=>{const r=new WeakMap,i=async(s,o)=>{let a=e(s);if(!ct(a,o)){const u={channelCount:a.channelCount,channelCountMode:a.channelCountMode,channelInterpretation:a.channelInterpretation,curve:a.curve,oversample:a.oversample};a=t(o,u)}return r.set(o,a),ns(a)?await n(s,o,a.inputs[0]):await n(s,o,a),a};return{render(s,o){const a=r.get(o);return a!==void 0?Promise.resolve(a):i(s,o)}}},lk=()=>typeof window>"u"?null:window,hk=(t,e)=>n=>{n.copyFromChannel=(r,i,s=0)=>{const o=t(s),a=t(i);if(a>=n.numberOfChannels)throw e();const c=n.length,u=n.getChannelData(a),l=r.length;for(let h=o<0?-o:0;h+o<c&&h<l;h+=1)r[h]=u[h+o]},n.copyToChannel=(r,i,s=0)=>{const o=t(s),a=t(i);if(a>=n.numberOfChannels)throw e();const c=n.length,u=n.getChannelData(a),l=r.length;for(let h=o<0?-o:0;h+o<c&&h<l;h+=1)u[h+o]=r[h]}},fk=t=>e=>{e.copyFromChannel=(n=>(r,i,s=0)=>{const o=t(s),a=t(i);if(o<e.length)return n.call(e,r,a,o)})(e.copyFromChannel),e.copyToChannel=(n=>(r,i,s=0)=>{const o=t(s),a=t(i);if(o<e.length)return n.call(e,r,a,o)})(e.copyToChannel)},dk=t=>(e,n)=>{const r=n.createBuffer(1,1,44100);e.buffer===null&&(e.buffer=r),t(e,"buffer",i=>()=>{const s=i.call(e);return s===r?null:s},i=>s=>i.call(e,s===null?r:s))},pk=(t,e)=>(n,r)=>{r.channelCount=1,r.channelCountMode="explicit",Object.defineProperty(r,"channelCount",{get:()=>1,set:()=>{throw t()}}),Object.defineProperty(r,"channelCountMode",{get:()=>"explicit",set:()=>{throw t()}});const i=n.createBufferSource();e(r,()=>{const a=r.numberOfInputs;for(let c=0;c<a;c+=1)i.connect(r,0,c)},()=>i.disconnect(r))},x2=(t,e,n)=>t.copyFromChannel===void 0?t.getChannelData(n)[0]:(t.copyFromChannel(e,n),e[0]),T2=t=>{if(t===null)return!1;const e=t.length;return e%2!==0?t[Math.floor(e/2)]!==0:t[e/2-1]+t[e/2]!==0},Co=(t,e,n,r)=>{let i=t;for(;!i.hasOwnProperty(e);)i=Object.getPrototypeOf(i);const{get:s,set:o}=Object.getOwnPropertyDescriptor(i,e);Object.defineProperty(t,e,{get:n(s),set:r(o)})},mk=t=>({...t,outputChannelCount:t.outputChannelCount!==void 0?t.outputChannelCount:t.numberOfInputs===1&&t.numberOfOutputs===1?[t.channelCount]:Array.from({length:t.numberOfOutputs},()=>1)}),gk=t=>({...t,channelCount:t.numberOfOutputs}),_k=t=>{const{imag:e,real:n}=t;return e===void 0?n===void 0?{...t,imag:[0,0],real:[0,0]}:{...t,imag:Array.from(n,()=>0),real:n}:n===void 0?{...t,imag:e,real:Array.from(e,()=>0)}:{...t,imag:e,real:n}},S2=(t,e,n)=>{try{t.setValueAtTime(e,n)}catch(r){if(r.code!==9)throw r;S2(t,e,n+1e-7)}},yk=t=>{const e=t.createBufferSource();e.start();try{e.start()}catch{return!0}return!1},vk=t=>{const e=t.createBufferSource(),n=t.createBuffer(1,1,44100);e.buffer=n;try{e.start(0,1)}catch{return!1}return!0},bk=t=>{const e=t.createBufferSource();e.start();try{e.stop()}catch{return!1}return!0},wp=t=>{const e=t.createOscillator();try{e.start(-1)}catch(n){return n instanceof RangeError}return!1},C2=t=>{const e=t.createBuffer(1,1,44100),n=t.createBufferSource();n.buffer=e,n.start(),n.stop();try{return n.stop(),!0}catch{return!1}},xp=t=>{const e=t.createOscillator();try{e.stop(-1)}catch(n){return n instanceof RangeError}return!1},wk=t=>{const{port1:e,port2:n}=new MessageChannel;try{e.postMessage(t)}finally{e.close(),n.close()}},xk=t=>{t.start=(e=>(n=0,r=0,i)=>{const s=t.buffer,o=s===null?r:Math.min(s.duration,r);s!==null&&o>s.duration-.5/t.context.sampleRate?e.call(t,n,0,0):e.call(t,n,o,i)})(t.start)},M2=(t,e)=>{const n=e.createGain();t.connect(n);const r=(i=>()=>{i.call(t,n),t.removeEventListener("ended",r)})(t.disconnect);t.addEventListener("ended",r),rs(t,n),t.stop=(i=>{let s=!1;return(o=0)=>{if(s)try{i.call(t,o)}catch{n.gain.setValueAtTime(0,o)}else i.call(t,o),s=!0}})(t.stop)},is=(t,e)=>n=>{const r={value:t};return Object.defineProperties(n,{currentTarget:r,target:r}),typeof e=="function"?e.call(t,n):e.handleEvent.call(t,n)},Tk=B3(Qr),Sk=X3(Qr),Ck=aN(lu),A2=new WeakMap,Mk=CN(A2),an=F6(new Map,new WeakMap),yn=lk(),N2=t4(an,wn),Tp=SN(yt),Qe=Y4(yt,Tp,zr),Ak=e6(N2,Me,Qe),Se=NN(uu),Un=N4(yn),we=UN(Un),k2=new WeakMap,E2=_N(is),Mo=s4(yn),Sp=jN(Mo),Cp=zN(yn),R2=BN(yn),no=a4(yn),$e=C6(W3(i2),Y3(Tk,Sk,Xa,Ck,Za,yt,Mk,vo,Me,Qr,Fn,zr,ma),an,qN(Rf,Za,yt,Me,eo,Fn),wn,hu,Tt,rN(Xa,Rf,yt,Me,eo,Se,Fn,we),lN(k2,yt,sn),E2,Se,Sp,Cp,R2,we,no),Nk=J3($e,Ak,wn,N2,Se,we),Mp=new WeakSet,L1=n4(yn),I2=Z6(new Uint32Array(1)),Ap=hk(I2,wn),Np=fk(I2),O2=n6(Mp,an,Tt,L1,Un,rk(L1),Ap,Np),fu=Z3(Rt),D2=X4(Tp,wo,zr),xn=W6(D2),ss=i4(fu,an,yk,vk,bk,wp,C2,xp,xk,dk(Co),M2),Tn=H4(MN(wo),D2),kk=s6(xn,ss,Me,Tn,Qe),cn=M6(U3(s2),k2,mp,A6,F3,$3,V3,L3,j3,Nf,n2,Mo,S2),Ek=i6($e,kk,cn,Ye,ss,Se,we,is),Rk=p6($e,m6,wn,Ye,o4(Rt,Co),Se,we,Qe),Ik=q6(xn,v2,Me,Tn,Qe),Jr=Q4(A2),Ok=P6($e,cn,Ik,hu,v2,Se,we,Jr),vr=JN(Qr,Cp),Dk=pk(Ye,vr),br=p4(Mo,Dk),Pk=L6(br,Me,Qe),qk=V6($e,Pk,br,Se,we),Fk=B6(To,Me,Qe),$k=z6($e,Fk,To,Se,we,gk),Vk=_4(fu,ss,Rt,vr),os=g4(fu,an,Vk,wp,xp),Lk=X6(xn,os,Me,Tn,Qe),jk=Y6($e,cn,Lk,os,Se,we,is),P2=y4(Tt,Co),zk=J6(P2,Me,Qe),Bk=Q6($e,zk,P2,Se,we,Jr),Wk=oN(xn,b2,Me,Tn,Qe),Uk=sN($e,cn,Wk,b2,Se,we,Jr),q2=v4(Tt),Gk=pN(xn,q2,Me,Tn,Qe),Hk=dN($e,cn,Gk,q2,Tt,Se,we,Jr),Yk=xN(xn,Rt,Me,Tn,Qe),Xk=wN($e,cn,Yk,Rt,Se,we),Zk=T4(hu,Ye,So,Tt),du=Z4(an,Rt,So,sk(Rt,Un)),Kk=PN(ss,Me,Un,Qe,du),Qk=b4(Zk),Jk=ON($e,Qk,Kk,Se,we,Jr),e8=g6(cn,br,os,So,Tt,x2,we,Co),F2=new WeakMap,t8=QN(Rk,e8,E2,we,F2,is),$2=k4(fu,an,wp,C2,xp,M2),n8=j4(xn,$2,Me,Tn,Qe),r8=L4($e,cn,$2,n8,Se,we,is),V2=G6(ss),i8=q4(V2,Ye,Rt,T2,vr),pu=P4(V2,Ye,i8,T2,vr,Mo,Co),s8=R4(Xa,Ye,br,Rt,So,pu,Tt,Za,x2,vr),L2=E4(s8),o8=W4(xn,br,os,Rt,L2,Me,Un,Tn,Qe,du),a8=B4($e,cn,L2,o8,Se,we,Jr),c8=I4(wn),u8=G4(c8,Se,new WeakSet,_k),l8=D4(br,To,Rt,pu,Tt,vr),j2=O4(l8,Tt),h8=nk(xn,j2,Me,Tn,Qe),f8=tk($e,cn,j2,h8,Se,we),d8=uk(pu,Me,Qe),p8=ck($e,Ye,pu,d8,Se,we,Jr),z2=GN(yn),kp=yN(yn),B2=new WeakMap,m8=kN(B2,Un),g8=z2?H3(an,Tt,gN(yn),kp,vN(z3),Se,m8,we,no,new WeakMap,new WeakMap,ik(no,Un),yn):void 0,_8=WN(Sp,we),y8=nN(Mp,an,tN,mN,new WeakSet,Se,_8,Ha,to,Ap,Np),W2=O6(g8,Nk,O2,Ek,Ok,qk,$k,jk,Bk,y8,Uk,Hk,Xk,Jk,t8,r8,a8,u8,f8,p8),v8=HN($e,S4,Se,we),b8=XN($e,C4,Se,we),w8=ZN($e,M4,Se,we),x8=A4(Ye,we),T8=KN($e,x8,Se),S8=d6(W2,Ye,Tt,ok,v8,b8,w8,T8,Mo),Ep=EN(F2),C8=K3(Ep),U2=U6(wn),M8=cN(Ep),G2=hN(wn),H2=new WeakMap,A8=TN(H2,sn),N8=d4(U2,wn,Ye,br,To,os,Rt,So,Tt,G2,kp,A8,vr),k8=u4(Ye,N8,Rt,Tt,vr),E8=I6(xn,U2,ss,br,To,os,Rt,M8,G2,kp,Me,no,Un,Tn,Qe,du),R8=AN(B2),I8=K4(H2),j1=z2?k6(C8,$e,cn,E8,k8,yt,R8,Se,we,no,mk,I8,wk,is):void 0,O8=eN(Tt,Un),D8=J4(Mp,an,Tp,Ep,du,Ha,Ap,Np),P8=$4(W2,an,Ye,O8,D8),q8=FN(uu,Sp),F8=$N(pp,Cp),$8=VN(mp,R2),V8=LN(uu,we);function Ht(t){return t===void 0}function de(t){return t!==void 0}function L8(t){return typeof t=="function"}function lr(t){return typeof t=="number"}function Or(t){return Object.prototype.toString.call(t)==="[object Object]"&&t.constructor===Object}function j8(t){return typeof t=="boolean"}function $t(t){return Array.isArray(t)}function Ln(t){return typeof t=="string"}function Ko(t){return Ln(t)&&/^([a-g]{1}(?:b|#|x|bb)?)(-?[0-9]+)/i.test(t)}function oe(t,e){if(!t)throw new Error(e)}function hr(t,e,n=1/0){if(!(e<=t&&t<=n))throw new RangeError(`Value must be within [${e}, ${n}], got: ${t}`)}function Y2(t){!t.isOffline&&t.state!=="running"&&mu('The AudioContext is "suspended". Invoke Tone.start() from a user action to start the audio.')}let X2=!1,z1=!1;function B1(t){X2=t}function z8(t){Ht(t)&&X2&&!z1&&(z1=!0,mu("Events scheduled inside of scheduled callbacks should use the passed in scheduling time. See https://github.com/Tonejs/Tone.js/wiki/Accurate-Timing"))}let Z2=console;function B8(...t){Z2.log(...t)}function mu(...t){Z2.warn(...t)}function W8(t){return new S8(t)}function U8(t,e,n){return new P8(t,e,n)}const Pt=typeof self=="object"?self:null,G8=Pt&&(Pt.hasOwnProperty("AudioContext")||Pt.hasOwnProperty("webkitAudioContext"));function H8(t,e,n){return oe(de(j1),"AudioWorkletNode only works in a secure context (https or localhost)"),new(t instanceof(Pt==null?void 0:Pt.BaseAudioContext)?Pt==null?void 0:Pt.AudioWorkletNode:j1)(t,e,n)}class Y8{constructor(e,n,r,i){this._callback=e,this._type=n,this._minimumUpdateInterval=Math.max(128/(i||44100),.001),this.updateInterval=r,this._createClock()}_createWorker(){const e=new Blob([`
			// the initial timeout time
			let timeoutTime =  ${(this._updateInterval*1e3).toFixed(1)};
			// onmessage callback
			self.onmessage = function(msg){
				timeoutTime = parseInt(msg.data);
			};
			// the tick function which posts a message
			// and schedules a new tick
			function tick(){
				setTimeout(tick, timeoutTime);
				self.postMessage('tick');
			}
			// call tick initially
			tick();
			`],{type:"text/javascript"}),n=URL.createObjectURL(e),r=new Worker(n);r.onmessage=this._callback.bind(this),this._worker=r}_createTimeout(){this._timeout=setTimeout(()=>{this._createTimeout(),this._callback()},this._updateInterval*1e3)}_createClock(){if(this._type==="worker")try{this._createWorker()}catch{this._type="timeout",this._createClock()}else this._type==="timeout"&&this._createTimeout()}_disposeClock(){this._timeout&&clearTimeout(this._timeout),this._worker&&(this._worker.terminate(),this._worker.onmessage=null)}get updateInterval(){return this._updateInterval}set updateInterval(e){var n;this._updateInterval=Math.max(e,this._minimumUpdateInterval),this._type==="worker"&&((n=this._worker)===null||n===void 0||n.postMessage(this._updateInterval*1e3))}get type(){return this._type}set type(e){this._disposeClock(),this._type=e,this._createClock()}dispose(){this._disposeClock()}}function Br(t){return $8(t)}function sr(t){return F8(t)}function ga(t){return V8(t)}function mi(t){return q8(t)}function X8(t){return t instanceof O2}function Z8(t,e){return t==="value"||Br(e)||sr(e)||X8(e)}function Dr(t,...e){if(!e.length)return t;const n=e.shift();if(Or(t)&&Or(n))for(const r in n)Z8(r,n[r])?t[r]=n[r]:Or(n[r])?(t[r]||Object.assign(t,{[r]:{}}),Dr(t[r],n[r])):Object.assign(t,{[r]:n[r]});return Dr(t,...e)}function K8(t,e){return t.length===e.length&&t.every((n,r)=>e[r]===n)}function ce(t,e,n=[],r){const i={},s=Array.from(e);if(Or(s[0])&&r&&!Reflect.has(s[0],r)&&(Object.keys(s[0]).some(a=>Reflect.has(t,a))||(Dr(i,{[r]:s[0]}),n.splice(n.indexOf(r),1),s.shift())),s.length===1&&Or(s[0]))Dr(i,s[0]);else for(let o=0;o<n.length;o++)de(s[o])&&(i[n[o]]=s[o]);return Dr(t,i)}function Q8(t){return t.constructor.getDefaults()}function Ci(t,e){return Ht(t)?e:t}function qf(t,e){return e.forEach(n=>{Reflect.has(t,n)&&delete t[n]}),t}/**
 * Tone.js
 * @author Yotam Mann
 * @license http://opensource.org/licenses/MIT MIT License
 * @copyright 2014-2024 Yotam Mann
 */class Gn{constructor(){this.debug=!1,this._wasDisposed=!1}static getDefaults(){return{}}log(...e){(this.debug||Pt&&this.toString()===Pt.TONE_DEBUG_CLASS)&&B8(this,...e)}dispose(){return this._wasDisposed=!0,this}get disposed(){return this._wasDisposed}toString(){return this.name}}Gn.version=t2;const Rp=1e-6;function zi(t,e){return t>e+Rp}function Ff(t,e){return zi(t,e)||Kt(t,e)}function ec(t,e){return t+Rp<e}function Kt(t,e){return Math.abs(t-e)<Rp}function J8(t,e,n){return Math.max(Math.min(t,n),e)}class Yt extends Gn{constructor(){super(),this.name="Timeline",this._timeline=[];const e=ce(Yt.getDefaults(),arguments,["memory"]);this.memory=e.memory,this.increasing=e.increasing}static getDefaults(){return{memory:1/0,increasing:!1}}get length(){return this._timeline.length}add(e){if(oe(Reflect.has(e,"time"),"Timeline: events must have a time attribute"),e.time=e.time.valueOf(),this.increasing&&this.length){const n=this._timeline[this.length-1];oe(Ff(e.time,n.time),"The time must be greater than or equal to the last scheduled time"),this._timeline.push(e)}else{const n=this._search(e.time);this._timeline.splice(n+1,0,e)}if(this.length>this.memory){const n=this.length-this.memory;this._timeline.splice(0,n)}return this}remove(e){const n=this._timeline.indexOf(e);return n!==-1&&this._timeline.splice(n,1),this}get(e,n="time"){const r=this._search(e,n);return r!==-1?this._timeline[r]:null}peek(){return this._timeline[0]}shift(){return this._timeline.shift()}getAfter(e,n="time"){const r=this._search(e,n);return r+1<this._timeline.length?this._timeline[r+1]:null}getBefore(e){const n=this._timeline.length;if(n>0&&this._timeline[n-1].time<e)return this._timeline[n-1];const r=this._search(e);return r-1>=0?this._timeline[r-1]:null}cancel(e){if(this._timeline.length>1){let n=this._search(e);if(n>=0)if(Kt(this._timeline[n].time,e)){for(let r=n;r>=0&&Kt(this._timeline[r].time,e);r--)n=r;this._timeline=this._timeline.slice(0,n)}else this._timeline=this._timeline.slice(0,n+1);else this._timeline=[]}else this._timeline.length===1&&Ff(this._timeline[0].time,e)&&(this._timeline=[]);return this}cancelBefore(e){const n=this._search(e);return n>=0&&(this._timeline=this._timeline.slice(n+1)),this}previousEvent(e){const n=this._timeline.indexOf(e);return n>0?this._timeline[n-1]:null}_search(e,n="time"){if(this._timeline.length===0)return-1;let r=0;const i=this._timeline.length;let s=i;if(i>0&&this._timeline[i-1][n]<=e)return i-1;for(;r<s;){let o=Math.floor(r+(s-r)/2);const a=this._timeline[o],c=this._timeline[o+1];if(Kt(a[n],e)){for(let u=o;u<this._timeline.length;u++){const l=this._timeline[u];if(Kt(l[n],e))o=u;else break}return o}else{if(ec(a[n],e)&&zi(c[n],e))return o;zi(a[n],e)?s=o:r=o+1}}return-1}_iterate(e,n=0,r=this._timeline.length-1){this._timeline.slice(n,r+1).forEach(e)}forEach(e){return this._iterate(e),this}forEachBefore(e,n){const r=this._search(e);return r!==-1&&this._iterate(n,0,r),this}forEachAfter(e,n){const r=this._search(e);return this._iterate(n,r+1),this}forEachBetween(e,n,r){let i=this._search(e),s=this._search(n);return i!==-1&&s!==-1?(this._timeline[i].time!==e&&(i+=1),this._timeline[s].time===n&&(s-=1),this._iterate(r,i,s)):i===-1&&this._iterate(r,0,s),this}forEachFrom(e,n){let r=this._search(e);for(;r>=0&&this._timeline[r].time>=e;)r--;return this._iterate(n,r+1),this}forEachAtTime(e,n){const r=this._search(e);if(r!==-1&&Kt(this._timeline[r].time,e)){let i=r;for(let s=r;s>=0&&Kt(this._timeline[s].time,e);s--)i=s;this._iterate(s=>{n(s)},i,r)}return this}dispose(){return super.dispose(),this._timeline=[],this}}const K2=[];function gu(t){K2.push(t)}function e7(t){K2.forEach(e=>e(t))}const Q2=[];function _u(t){Q2.push(t)}function t7(t){Q2.forEach(e=>e(t))}class Ao extends Gn{constructor(){super(...arguments),this.name="Emitter"}on(e,n){return e.split(/\W+/).forEach(i=>{Ht(this._events)&&(this._events={}),this._events.hasOwnProperty(i)||(this._events[i]=[]),this._events[i].push(n)}),this}once(e,n){const r=(...i)=>{n(...i),this.off(e,r)};return this.on(e,r),this}off(e,n){return e.split(/\W+/).forEach(i=>{if(Ht(this._events)&&(this._events={}),this._events.hasOwnProperty(i))if(Ht(n))this._events[i]=[];else{const s=this._events[i];for(let o=s.length-1;o>=0;o--)s[o]===n&&s.splice(o,1)}}),this}emit(e,...n){if(this._events&&this._events.hasOwnProperty(e)){const r=this._events[e].slice(0);for(let i=0,s=r.length;i<s;i++)r[i].apply(this,n)}return this}static mixin(e){["on","once","off","emit"].forEach(n=>{const r=Object.getOwnPropertyDescriptor(Ao.prototype,n);Object.defineProperty(e.prototype,n,r)})}dispose(){return super.dispose(),this._events=void 0,this}}class J2 extends Ao{constructor(){super(...arguments),this.isOffline=!1}toJSON(){return{}}}class No extends J2{constructor(){var e,n;super(),this.name="Context",this._constants=new Map,this._timeouts=new Yt,this._timeoutIds=0,this._initialized=!1,this._closeStarted=!1,this.isOffline=!1,this._workletPromise=null;const r=ce(No.getDefaults(),arguments,["context"]);r.context?(this._context=r.context,this._latencyHint=((e=arguments[0])===null||e===void 0?void 0:e.latencyHint)||""):(this._context=W8({latencyHint:r.latencyHint}),this._latencyHint=r.latencyHint),this._ticker=new Y8(this.emit.bind(this,"tick"),r.clockSource,r.updateInterval,this._context.sampleRate),this.on("tick",this._timeoutLoop.bind(this)),this._context.onstatechange=()=>{this.emit("statechange",this.state)},this[!((n=arguments[0])===null||n===void 0)&&n.hasOwnProperty("updateInterval")?"_lookAhead":"lookAhead"]=r.lookAhead}static getDefaults(){return{clockSource:"worker",latencyHint:"interactive",lookAhead:.1,updateInterval:.05}}initialize(){return this._initialized||(e7(this),this._initialized=!0),this}createAnalyser(){return this._context.createAnalyser()}createOscillator(){return this._context.createOscillator()}createBufferSource(){return this._context.createBufferSource()}createBiquadFilter(){return this._context.createBiquadFilter()}createBuffer(e,n,r){return this._context.createBuffer(e,n,r)}createChannelMerger(e){return this._context.createChannelMerger(e)}createChannelSplitter(e){return this._context.createChannelSplitter(e)}createConstantSource(){return this._context.createConstantSource()}createConvolver(){return this._context.createConvolver()}createDelay(e){return this._context.createDelay(e)}createDynamicsCompressor(){return this._context.createDynamicsCompressor()}createGain(){return this._context.createGain()}createIIRFilter(e,n){return this._context.createIIRFilter(e,n)}createPanner(){return this._context.createPanner()}createPeriodicWave(e,n,r){return this._context.createPeriodicWave(e,n,r)}createStereoPanner(){return this._context.createStereoPanner()}createWaveShaper(){return this._context.createWaveShaper()}createMediaStreamSource(e){return oe(mi(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamSource(e)}createMediaElementSource(e){return oe(mi(this._context),"Not available if OfflineAudioContext"),this._context.createMediaElementSource(e)}createMediaStreamDestination(){return oe(mi(this._context),"Not available if OfflineAudioContext"),this._context.createMediaStreamDestination()}decodeAudioData(e){return this._context.decodeAudioData(e)}get currentTime(){return this._context.currentTime}get state(){return this._context.state}get sampleRate(){return this._context.sampleRate}get listener(){return this.initialize(),this._listener}set listener(e){oe(!this._initialized,"The listener cannot be set after initialization."),this._listener=e}get transport(){return this.initialize(),this._transport}set transport(e){oe(!this._initialized,"The transport cannot be set after initialization."),this._transport=e}get draw(){return this.initialize(),this._draw}set draw(e){oe(!this._initialized,"Draw cannot be set after initialization."),this._draw=e}get destination(){return this.initialize(),this._destination}set destination(e){oe(!this._initialized,"The destination cannot be set after initialization."),this._destination=e}createAudioWorkletNode(e,n){return H8(this.rawContext,e,n)}addAudioWorkletModule(e){return je(this,void 0,void 0,function*(){oe(de(this.rawContext.audioWorklet),"AudioWorkletNode is only available in a secure context (https or localhost)"),this._workletPromise||(this._workletPromise=this.rawContext.audioWorklet.addModule(e)),yield this._workletPromise})}workletsAreReady(){return je(this,void 0,void 0,function*(){(yield this._workletPromise)?this._workletPromise:Promise.resolve()})}get updateInterval(){return this._ticker.updateInterval}set updateInterval(e){this._ticker.updateInterval=e}get clockSource(){return this._ticker.type}set clockSource(e){this._ticker.type=e}get lookAhead(){return this._lookAhead}set lookAhead(e){this._lookAhead=e,this.updateInterval=e?e/2:.01}get latencyHint(){return this._latencyHint}get rawContext(){return this._context}now(){return this._context.currentTime+this._lookAhead}immediate(){return this._context.currentTime}resume(){return mi(this._context)?this._context.resume():Promise.resolve()}close(){return je(this,void 0,void 0,function*(){mi(this._context)&&this.state!=="closed"&&!this._closeStarted&&(this._closeStarted=!0,yield this._context.close()),this._initialized&&t7(this)})}getConstant(e){if(this._constants.has(e))return this._constants.get(e);{const n=this._context.createBuffer(1,128,this._context.sampleRate),r=n.getChannelData(0);for(let s=0;s<r.length;s++)r[s]=e;const i=this._context.createBufferSource();return i.channelCount=1,i.channelCountMode="explicit",i.buffer=n,i.loop=!0,i.start(0),this._constants.set(e,i),i}}dispose(){return super.dispose(),this._ticker.dispose(),this._timeouts.dispose(),Object.keys(this._constants).map(e=>this._constants[e].disconnect()),this.close(),this}_timeoutLoop(){const e=this.now();this._timeouts.forEachBefore(e,n=>{n.callback(),this._timeouts.remove(n)})}setTimeout(e,n){this._timeoutIds++;const r=this.now();return this._timeouts.add({callback:e,id:this._timeoutIds,time:r+n}),this._timeoutIds}clearTimeout(e){return this._timeouts.forEach(n=>{n.id===e&&this._timeouts.remove(n)}),this}clearInterval(e){return this.clearTimeout(e)}setInterval(e,n){const r=++this._timeoutIds,i=()=>{const s=this.now();this._timeouts.add({callback:()=>{e(),i()},id:r,time:s+n})};return i(),r}}class n7 extends J2{constructor(){super(...arguments),this.lookAhead=0,this.latencyHint=0,this.isOffline=!1}createAnalyser(){return{}}createOscillator(){return{}}createBufferSource(){return{}}createBiquadFilter(){return{}}createBuffer(e,n,r){return{}}createChannelMerger(e){return{}}createChannelSplitter(e){return{}}createConstantSource(){return{}}createConvolver(){return{}}createDelay(e){return{}}createDynamicsCompressor(){return{}}createGain(){return{}}createIIRFilter(e,n){return{}}createPanner(){return{}}createPeriodicWave(e,n,r){return{}}createStereoPanner(){return{}}createWaveShaper(){return{}}createMediaStreamSource(e){return{}}createMediaElementSource(e){return{}}createMediaStreamDestination(){return{}}decodeAudioData(e){return Promise.resolve({})}createAudioWorkletNode(e,n){return{}}get rawContext(){return{}}addAudioWorkletModule(e){return je(this,void 0,void 0,function*(){return Promise.resolve()})}resume(){return Promise.resolve()}setTimeout(e,n){return 0}clearTimeout(e){return this}setInterval(e,n){return 0}clearInterval(e){return this}getConstant(e){return{}}get currentTime(){return 0}get state(){return{}}get sampleRate(){return 0}get listener(){return{}}get transport(){return{}}get draw(){return{}}set draw(e){}get destination(){return{}}set destination(e){}now(){return 0}immediate(){return 0}}function Fe(t,e){$t(e)?e.forEach(n=>Fe(t,n)):Object.defineProperty(t,e,{enumerable:!0,writable:!1})}function ew(t,e){$t(e)?e.forEach(n=>ew(t,n)):Object.defineProperty(t,e,{writable:!0})}const be=()=>{};class Ne extends Gn{constructor(){super(),this.name="ToneAudioBuffer",this.onload=be;const e=ce(Ne.getDefaults(),arguments,["url","onload","onerror"]);this.reverse=e.reverse,this.onload=e.onload,Ln(e.url)?this.load(e.url).catch(e.onerror):e.url&&this.set(e.url)}static getDefaults(){return{onerror:be,onload:be,reverse:!1}}get sampleRate(){return this._buffer?this._buffer.sampleRate:Ft().sampleRate}set(e){return e instanceof Ne?e.loaded?this._buffer=e.get():e.onload=()=>{this.set(e),this.onload(this)}:this._buffer=e,this._reversed&&this._reverse(),this}get(){return this._buffer}load(e){return je(this,void 0,void 0,function*(){const n=Ne.load(e).then(r=>{this.set(r),this.onload(this)});Ne.downloads.push(n);try{yield n}finally{const r=Ne.downloads.indexOf(n);Ne.downloads.splice(r,1)}return this})}dispose(){return super.dispose(),this._buffer=void 0,this}fromArray(e){const n=$t(e)&&e[0].length>0,r=n?e.length:1,i=n?e[0].length:e.length,s=Ft(),o=s.createBuffer(r,i,s.sampleRate),a=!n&&r===1?[e]:e;for(let c=0;c<r;c++)o.copyToChannel(a[c],c);return this._buffer=o,this}toMono(e){if(lr(e))this.fromArray(this.toArray(e));else{let n=new Float32Array(this.length);const r=this.numberOfChannels;for(let i=0;i<r;i++){const s=this.toArray(i);for(let o=0;o<s.length;o++)n[o]+=s[o]}n=n.map(i=>i/r),this.fromArray(n)}return this}toArray(e){if(lr(e))return this.getChannelData(e);if(this.numberOfChannels===1)return this.toArray(0);{const n=[];for(let r=0;r<this.numberOfChannels;r++)n[r]=this.getChannelData(r);return n}}getChannelData(e){return this._buffer?this._buffer.getChannelData(e):new Float32Array(0)}slice(e,n=this.duration){oe(this.loaded,"Buffer is not loaded");const r=Math.floor(e*this.sampleRate),i=Math.floor(n*this.sampleRate);oe(r<i,"The start time must be less than the end time");const s=i-r,o=Ft().createBuffer(this.numberOfChannels,s,this.sampleRate);for(let a=0;a<this.numberOfChannels;a++)o.copyToChannel(this.getChannelData(a).subarray(r,i),a);return new Ne(o)}_reverse(){if(this.loaded)for(let e=0;e<this.numberOfChannels;e++)this.getChannelData(e).reverse();return this}get loaded(){return this.length>0}get duration(){return this._buffer?this._buffer.duration:0}get length(){return this._buffer?this._buffer.length:0}get numberOfChannels(){return this._buffer?this._buffer.numberOfChannels:0}get reverse(){return this._reversed}set reverse(e){this._reversed!==e&&(this._reversed=e,this._reverse())}static fromArray(e){return new Ne().fromArray(e)}static fromUrl(e){return je(this,void 0,void 0,function*(){return yield new Ne().load(e)})}static load(e){return je(this,void 0,void 0,function*(){const n=Ne.baseUrl===""||Ne.baseUrl.endsWith("/")?Ne.baseUrl:Ne.baseUrl+"/",r=yield fetch(n+e);if(!r.ok)throw new Error(`could not load url: ${e}`);const i=yield r.arrayBuffer();return yield Ft().decodeAudioData(i)})}static supportsType(e){const n=e.split("."),r=n[n.length-1];return document.createElement("audio").canPlayType("audio/"+r)!==""}static loaded(){return je(this,void 0,void 0,function*(){for(yield Promise.resolve();Ne.downloads.length;)yield Ne.downloads[0]})}}Ne.baseUrl="";Ne.downloads=[];class Ip extends No{constructor(){super({clockSource:"offline",context:ga(arguments[0])?arguments[0]:U8(arguments[0],arguments[1]*arguments[2],arguments[2]),lookAhead:0,updateInterval:ga(arguments[0])?128/arguments[0].sampleRate:128/arguments[2]}),this.name="OfflineContext",this._currentTime=0,this.isOffline=!0,this._duration=ga(arguments[0])?arguments[0].length/arguments[0].sampleRate:arguments[1]}now(){return this._currentTime}get currentTime(){return this._currentTime}_renderClock(e){return je(this,void 0,void 0,function*(){let n=0;for(;this._duration-this._currentTime>=0;){this.emit("tick"),this._currentTime+=128/this.sampleRate,n++;const r=Math.floor(this.sampleRate/128);e&&n%r===0&&(yield new Promise(i=>setTimeout(i,1)))}})}render(){return je(this,arguments,void 0,function*(e=!0){yield this.workletsAreReady(),yield this._renderClock(e);const n=yield this._context.startRendering();return new Ne(n)})}close(){return Promise.resolve()}}const tw=new n7;let Nr=tw;function Ft(){return Nr===tw&&G8&&r7(new No),Nr}function r7(t,e=!1){e&&Nr.dispose(),mi(t)?Nr=new No(t):ga(t)?Nr=new Ip(t):Nr=t}function i7(){return Nr.resume()}if(Pt&&!Pt.TONE_SILENCE_LOGGING){const e=` * Tone.js v${t2} * `;console.log(`%c${e}`,"background: #000; color: #fff")}function s7(t){return Math.pow(10,t/20)}function o7(t){return 20*(Math.log(t)/Math.LN10)}function nw(t){return Math.pow(2,t/12)}let yu=440;function a7(){return yu}function c7(t){yu=t}function kr(t){return Math.round(rw(t))}function rw(t){return 69+12*Math.log2(t/yu)}function iw(t){return yu*Math.pow(2,(t-69)/12)}class Op extends Gn{constructor(e,n,r){super(),this.defaultUnits="s",this._val=n,this._units=r,this.context=e,this._expressions=this._getExpressions()}_getExpressions(){return{hz:{method:e=>this._frequencyToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)hz$/i},i:{method:e=>this._ticksToUnits(parseInt(e,10)),regexp:/^(\d+)i$/i},m:{method:e=>this._beatsToUnits(parseInt(e,10)*this._getTimeSignature()),regexp:/^(\d+)m$/i},n:{method:(e,n)=>{const r=parseInt(e,10),i=n==="."?1.5:1;return r===1?this._beatsToUnits(this._getTimeSignature())*i:this._beatsToUnits(4/r)*i},regexp:/^(\d+)n(\.?)$/i},number:{method:e=>this._expressions[this.defaultUnits].method.call(this,e),regexp:/^(\d+(?:\.\d+)?)$/},s:{method:e=>this._secondsToUnits(parseFloat(e)),regexp:/^(\d+(?:\.\d+)?)s$/},samples:{method:e=>parseInt(e,10)/this.context.sampleRate,regexp:/^(\d+)samples$/},t:{method:e=>{const n=parseInt(e,10);return this._beatsToUnits(8/(Math.floor(n)*3))},regexp:/^(\d+)t$/i},tr:{method:(e,n,r)=>{let i=0;return e&&e!=="0"&&(i+=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),n&&n!=="0"&&(i+=this._beatsToUnits(parseFloat(n))),r&&r!=="0"&&(i+=this._beatsToUnits(parseFloat(r)/4)),i},regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?$/}}}valueOf(){if(this._val instanceof Op&&this.fromType(this._val),Ht(this._val))return this._noArg();if(Ln(this._val)&&Ht(this._units)){for(const e in this._expressions)if(this._expressions[e].regexp.test(this._val.trim())){this._units=e;break}}else if(Or(this._val)){let e=0;for(const n in this._val)if(de(this._val[n])){const r=this._val[n],i=new this.constructor(this.context,n).valueOf()*r;e+=i}return e}if(de(this._units)){const e=this._expressions[this._units],n=this._val.toString().trim().match(e.regexp);return n?e.method.apply(this,n.slice(1)):e.method.call(this,this._val)}else return Ln(this._val)?parseFloat(this._val):this._val}_frequencyToUnits(e){return 1/e}_beatsToUnits(e){return 60/this._getBpm()*e}_secondsToUnits(e){return e}_ticksToUnits(e){return e*this._beatsToUnits(1)/this._getPPQ()}_noArg(){return this._now()}_getBpm(){return this.context.transport.bpm.value}_getTimeSignature(){return this.context.transport.timeSignature}_getPPQ(){return this.context.transport.PPQ}fromType(e){switch(this._units=void 0,this.defaultUnits){case"s":this._val=e.toSeconds();break;case"i":this._val=e.toTicks();break;case"hz":this._val=e.toFrequency();break;case"midi":this._val=e.toMidi();break}return this}toFrequency(){return 1/this.toSeconds()}toSamples(){return this.toSeconds()*this.context.sampleRate}toMilliseconds(){return this.toSeconds()*1e3}}class en extends Op{constructor(){super(...arguments),this.name="TimeClass"}_getExpressions(){return Object.assign(super._getExpressions(),{now:{method:e=>this._now()+new this.constructor(this.context,e).valueOf(),regexp:/^\+(.+)/},quantize:{method:e=>{const n=new en(this.context,e).valueOf();return this._secondsToUnits(this.context.transport.nextSubdivision(n))},regexp:/^@(.+)/}})}quantize(e,n=1){const r=new this.constructor(this.context,e).valueOf(),i=this.valueOf(),a=Math.round(i/r)*r-i;return i+a*n}toNotation(){const e=this.toSeconds(),n=["1m"];for(let s=1;s<9;s++){const o=Math.pow(2,s);n.push(o+"n."),n.push(o+"n"),n.push(o+"t")}n.push("0");let r=n[0],i=new en(this.context,n[0]).toSeconds();return n.forEach(s=>{const o=new en(this.context,s).toSeconds();Math.abs(o-e)<Math.abs(i-e)&&(r=s,i=o)}),r}toBarsBeatsSixteenths(){const e=this._beatsToUnits(1);let n=this.valueOf()/e;n=parseFloat(n.toFixed(4));const r=Math.floor(n/this._getTimeSignature());let i=n%1*4;n=Math.floor(n)%this._getTimeSignature();const s=i.toString();return s.length>3&&(i=parseFloat(parseFloat(s).toFixed(3))),[r,n,i].join(":")}toTicks(){const e=this._beatsToUnits(1);return this.valueOf()/e*this._getPPQ()}toSeconds(){return this.valueOf()}toMidi(){return kr(this.toFrequency())}_now(){return this.context.now()}}class kt extends en{constructor(){super(...arguments),this.name="Frequency",this.defaultUnits="hz"}static get A4(){return a7()}static set A4(e){c7(e)}_getExpressions(){return Object.assign({},super._getExpressions(),{midi:{regexp:/^(\d+(?:\.\d+)?midi)/,method(e){return this.defaultUnits==="midi"?e:kt.mtof(e)}},note:{regexp:/^([a-g]{1}(?:b|#|##|x|bb|###|#x|x#|bbb)?)(-?[0-9]+)/i,method(e,n){const i=u7[e.toLowerCase()]+(parseInt(n,10)+1)*12;return this.defaultUnits==="midi"?i:kt.mtof(i)}},tr:{regexp:/^(\d+(?:\.\d+)?):(\d+(?:\.\d+)?):?(\d+(?:\.\d+)?)?/,method(e,n,r){let i=1;return e&&e!=="0"&&(i*=this._beatsToUnits(this._getTimeSignature()*parseFloat(e))),n&&n!=="0"&&(i*=this._beatsToUnits(parseFloat(n))),r&&r!=="0"&&(i*=this._beatsToUnits(parseFloat(r)/4)),i}}})}transpose(e){return new kt(this.context,this.valueOf()*nw(e))}harmonize(e){return e.map(n=>this.transpose(n))}toMidi(){return kr(this.valueOf())}toNote(){const e=this.toFrequency(),n=Math.log2(e/kt.A4);let r=Math.round(12*n)+57;const i=Math.floor(r/12);return i<0&&(r+=-12*i),l7[r%12]+i.toString()}toSeconds(){return 1/super.toSeconds()}toTicks(){const e=this._beatsToUnits(1),n=this.valueOf()/e;return Math.floor(n*this._getPPQ())}_noArg(){return 0}_frequencyToUnits(e){return e}_ticksToUnits(e){return 1/(e*60/(this._getBpm()*this._getPPQ()))}_beatsToUnits(e){return 1/super._beatsToUnits(e)}_secondsToUnits(e){return 1/e}static mtof(e){return iw(e)}static ftom(e){return kr(e)}}const u7={cbbb:-3,cbb:-2,cb:-1,c:0,"c#":1,cx:2,"c##":2,"c###":3,"cx#":3,"c#x":3,dbbb:-1,dbb:0,db:1,d:2,"d#":3,dx:4,"d##":4,"d###":5,"dx#":5,"d#x":5,ebbb:1,ebb:2,eb:3,e:4,"e#":5,ex:6,"e##":6,"e###":7,"ex#":7,"e#x":7,fbbb:2,fbb:3,fb:4,f:5,"f#":6,fx:7,"f##":7,"f###":8,"fx#":8,"f#x":8,gbbb:4,gbb:5,gb:6,g:7,"g#":8,gx:9,"g##":9,"g###":10,"gx#":10,"g#x":10,abbb:6,abb:7,ab:8,a:9,"a#":10,ax:11,"a##":11,"a###":12,"ax#":12,"a#x":12,bbbb:8,bbb:9,bb:10,b:11,"b#":12,bx:13,"b##":13,"b###":14,"bx#":14,"b#x":14},l7=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"];function h7(t,e){return new kt(Ft(),t,e)}class $s extends en{constructor(){super(...arguments),this.name="TransportTime"}_now(){return this.context.transport.seconds}}class Et extends Gn{constructor(){super();const e=ce(Et.getDefaults(),arguments,["context"]);this.defaultContext?this.context=this.defaultContext:this.context=e.context}static getDefaults(){return{context:Ft()}}now(){return this.context.currentTime+this.context.lookAhead}immediate(){return this.context.currentTime}get sampleTime(){return 1/this.context.sampleRate}get blockTime(){return 128/this.context.sampleRate}toSeconds(e){return z8(e),new en(this.context,e).toSeconds()}toFrequency(e){return new kt(this.context,e).toFrequency()}toTicks(e){return new $s(this.context,e).toTicks()}_getPartialProperties(e){const n=this.get();return Object.keys(n).forEach(r=>{Ht(e[r])&&delete n[r]}),n}get(){const e=Q8(this);return Object.keys(e).forEach(n=>{if(Reflect.has(this,n)){const r=this[n];de(r)&&de(r.value)&&de(r.setValueAtTime)?e[n]=r.value:r instanceof Et?e[n]=r._getPartialProperties(e[n]):$t(r)||lr(r)||Ln(r)||j8(r)?e[n]=r:delete e[n]}}),e}set(e){return Object.keys(e).forEach(n=>{Reflect.has(this,n)&&de(this[n])&&(this[n]&&de(this[n].value)&&de(this[n].setValueAtTime)?this[n].value!==e[n]&&(this[n].value=e[n]):this[n]instanceof Et?this[n].set(e[n]):this[n]=e[n])}),this}}class Dp extends Yt{constructor(e="stopped"){super(),this.name="StateTimeline",this._initial=e,this.setStateAtTime(this._initial,0)}getValueAtTime(e){const n=this.get(e);return n!==null?n.state:this._initial}setStateAtTime(e,n,r){return hr(n,0),this.add(Object.assign({},r,{state:e,time:n})),this}getLastState(e,n){const r=this._search(n);for(let i=r;i>=0;i--){const s=this._timeline[i];if(s.state===e)return s}}getNextState(e,n){const r=this._search(n);if(r!==-1)for(let i=r;i<this._timeline.length;i++){const s=this._timeline[i];if(s.state===e)return s}}}class Re extends Et{constructor(){const e=ce(Re.getDefaults(),arguments,["param","units","convert"]);for(super(e),this.name="Param",this.overridden=!1,this._minOutput=1e-7,oe(de(e.param)&&(Br(e.param)||e.param instanceof Re),"param must be an AudioParam");!Br(e.param);)e.param=e.param._param;this._swappable=de(e.swappable)?e.swappable:!1,this._swappable?(this.input=this.context.createGain(),this._param=e.param,this.input.connect(this._param)):this._param=this.input=e.param,this._events=new Yt(1e3),this._initialValue=this._param.defaultValue,this.units=e.units,this.convert=e.convert,this._minValue=e.minValue,this._maxValue=e.maxValue,de(e.value)&&e.value!==this._toType(this._initialValue)&&this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Et.getDefaults(),{convert:!0,units:"number"})}get value(){const e=this.now();return this.getValueAtTime(e)}set value(e){this.cancelScheduledValues(this.now()),this.setValueAtTime(e,this.now())}get minValue(){return de(this._minValue)?this._minValue:this.units==="time"||this.units==="frequency"||this.units==="normalRange"||this.units==="positive"||this.units==="transportTime"||this.units==="ticks"||this.units==="bpm"||this.units==="hertz"||this.units==="samples"?0:this.units==="audioRange"?-1:this.units==="decibels"?-1/0:this._param.minValue}get maxValue(){return de(this._maxValue)?this._maxValue:this.units==="normalRange"||this.units==="audioRange"?1:this._param.maxValue}_is(e,n){return this.units===n}_assertRange(e){return de(this.maxValue)&&de(this.minValue)&&hr(e,this._fromType(this.minValue),this._fromType(this.maxValue)),e}_fromType(e){return this.convert&&!this.overridden?this._is(e,"time")?this.toSeconds(e):this._is(e,"decibels")?s7(e):this._is(e,"frequency")?this.toFrequency(e):e:this.overridden?0:e}_toType(e){return this.convert&&this.units==="decibels"?o7(e):e}setValueAtTime(e,n){const r=this.toSeconds(n),i=this._fromType(e);return oe(isFinite(i)&&isFinite(r),`Invalid argument(s) to setValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(n)}`),this._assertRange(i),this.log(this.units,"setValueAtTime",e,r),this._events.add({time:r,type:"setValueAtTime",value:i}),this._param.setValueAtTime(i,r),this}getValueAtTime(e){const n=Math.max(this.toSeconds(e),0),r=this._events.getAfter(n),i=this._events.get(n);let s=this._initialValue;if(i===null)s=this._initialValue;else if(i.type==="setTargetAtTime"&&(r===null||r.type==="setValueAtTime")){const o=this._events.getBefore(i.time);let a;o===null?a=this._initialValue:a=o.value,i.type==="setTargetAtTime"&&(s=this._exponentialApproach(i.time,a,i.value,i.constant,n))}else if(r===null)s=i.value;else if(r.type==="linearRampToValueAtTime"||r.type==="exponentialRampToValueAtTime"){let o=i.value;if(i.type==="setTargetAtTime"){const a=this._events.getBefore(i.time);a===null?o=this._initialValue:o=a.value}r.type==="linearRampToValueAtTime"?s=this._linearInterpolate(i.time,o,r.time,r.value,n):s=this._exponentialInterpolate(i.time,o,r.time,r.value,n)}else s=i.value;return this._toType(s)}setRampPoint(e){e=this.toSeconds(e);let n=this.getValueAtTime(e);return this.cancelAndHoldAtTime(e),this._fromType(n)===0&&(n=this._toType(this._minOutput)),this.setValueAtTime(n,e),this}linearRampToValueAtTime(e,n){const r=this._fromType(e),i=this.toSeconds(n);return oe(isFinite(r)&&isFinite(i),`Invalid argument(s) to linearRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(n)}`),this._assertRange(r),this._events.add({time:i,type:"linearRampToValueAtTime",value:r}),this.log(this.units,"linearRampToValueAtTime",e,i),this._param.linearRampToValueAtTime(r,i),this}exponentialRampToValueAtTime(e,n){let r=this._fromType(e);r=Kt(r,0)?this._minOutput:r,this._assertRange(r);const i=this.toSeconds(n);return oe(isFinite(r)&&isFinite(i),`Invalid argument(s) to exponentialRampToValueAtTime: ${JSON.stringify(e)}, ${JSON.stringify(n)}`),this._events.add({time:i,type:"exponentialRampToValueAtTime",value:r}),this.log(this.units,"exponentialRampToValueAtTime",e,i),this._param.exponentialRampToValueAtTime(r,i),this}exponentialRampTo(e,n,r){return r=this.toSeconds(r),this.setRampPoint(r),this.exponentialRampToValueAtTime(e,r+this.toSeconds(n)),this}linearRampTo(e,n,r){return r=this.toSeconds(r),this.setRampPoint(r),this.linearRampToValueAtTime(e,r+this.toSeconds(n)),this}targetRampTo(e,n,r){return r=this.toSeconds(r),this.setRampPoint(r),this.exponentialApproachValueAtTime(e,r,n),this}exponentialApproachValueAtTime(e,n,r){n=this.toSeconds(n),r=this.toSeconds(r);const i=Math.log(r+1)/Math.log(200);return this.setTargetAtTime(e,n,i),this.cancelAndHoldAtTime(n+r*.9),this.linearRampToValueAtTime(e,n+r),this}setTargetAtTime(e,n,r){const i=this._fromType(e);oe(isFinite(r)&&r>0,"timeConstant must be a number greater than 0");const s=this.toSeconds(n);return this._assertRange(i),oe(isFinite(i)&&isFinite(s),`Invalid argument(s) to setTargetAtTime: ${JSON.stringify(e)}, ${JSON.stringify(n)}`),this._events.add({constant:r,time:s,type:"setTargetAtTime",value:i}),this.log(this.units,"setTargetAtTime",e,s,r),this._param.setTargetAtTime(i,s,r),this}setValueCurveAtTime(e,n,r,i=1){r=this.toSeconds(r),n=this.toSeconds(n);const s=this._fromType(e[0])*i;this.setValueAtTime(this._toType(s),n);const o=r/(e.length-1);for(let a=1;a<e.length;a++){const c=this._fromType(e[a])*i;this.linearRampToValueAtTime(this._toType(c),n+a*o)}return this}cancelScheduledValues(e){const n=this.toSeconds(e);return oe(isFinite(n),`Invalid argument to cancelScheduledValues: ${JSON.stringify(e)}`),this._events.cancel(n),this._param.cancelScheduledValues(n),this.log(this.units,"cancelScheduledValues",n),this}cancelAndHoldAtTime(e){const n=this.toSeconds(e),r=this._fromType(this.getValueAtTime(n));oe(isFinite(n),`Invalid argument to cancelAndHoldAtTime: ${JSON.stringify(e)}`),this.log(this.units,"cancelAndHoldAtTime",n,"value="+r);const i=this._events.get(n),s=this._events.getAfter(n);return i&&Kt(i.time,n)?s?(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time)):(this._param.cancelAndHoldAtTime(n),this._events.cancel(n+this.sampleTime)):s&&(this._param.cancelScheduledValues(s.time),this._events.cancel(s.time),s.type==="linearRampToValueAtTime"?this.linearRampToValueAtTime(this._toType(r),n):s.type==="exponentialRampToValueAtTime"&&this.exponentialRampToValueAtTime(this._toType(r),n)),this._events.add({time:n,type:"setValueAtTime",value:r}),this._param.setValueAtTime(r,n),this}rampTo(e,n=.1,r){return this.units==="frequency"||this.units==="bpm"||this.units==="decibels"?this.exponentialRampTo(e,n,r):this.linearRampTo(e,n,r),this}apply(e){const n=this.context.currentTime;e.setValueAtTime(this.getValueAtTime(n),n);const r=this._events.get(n);if(r&&r.type==="setTargetAtTime"){const i=this._events.getAfter(r.time),s=i?i.time:n+2,o=(s-n)/10;for(let a=n;a<s;a+=o)e.linearRampToValueAtTime(this.getValueAtTime(a),a)}return this._events.forEachAfter(this.context.currentTime,i=>{i.type==="cancelScheduledValues"?e.cancelScheduledValues(i.time):i.type==="setTargetAtTime"?e.setTargetAtTime(i.value,i.time,i.constant):e[i.type](i.value,i.time)}),this}setParam(e){oe(this._swappable,"The Param must be assigned as 'swappable' in the constructor");const n=this.input;return n.disconnect(this._param),this.apply(e),this._param=e,n.connect(this._param),this}dispose(){return super.dispose(),this._events.dispose(),this}get defaultValue(){return this._toType(this._param.defaultValue)}_exponentialApproach(e,n,r,i,s){return r+(n-r)*Math.exp(-(s-e)/i)}_linearInterpolate(e,n,r,i,s){return n+(i-n)*((s-e)/(r-e))}_exponentialInterpolate(e,n,r,i,s){return n*Math.pow(i/n,(s-e)/(r-e))}}class fe extends Et{constructor(){super(...arguments),this._internalChannels=[]}get numberOfInputs(){return de(this.input)?Br(this.input)||this.input instanceof Re?1:this.input.numberOfInputs:0}get numberOfOutputs(){return de(this.output)?this.output.numberOfOutputs:0}_isAudioNode(e){return de(e)&&(e instanceof fe||sr(e))}_getInternalNodes(){const e=this._internalChannels.slice(0);return this._isAudioNode(this.input)&&e.push(this.input),this._isAudioNode(this.output)&&this.input!==this.output&&e.push(this.output),e}_setChannelProperties(e){this._getInternalNodes().forEach(r=>{r.channelCount=e.channelCount,r.channelCountMode=e.channelCountMode,r.channelInterpretation=e.channelInterpretation})}_getChannelProperties(){const e=this._getInternalNodes();oe(e.length>0,"ToneAudioNode does not have any internal nodes");const n=e[0];return{channelCount:n.channelCount,channelCountMode:n.channelCountMode,channelInterpretation:n.channelInterpretation}}get channelCount(){return this._getChannelProperties().channelCount}set channelCount(e){const n=this._getChannelProperties();this._setChannelProperties(Object.assign(n,{channelCount:e}))}get channelCountMode(){return this._getChannelProperties().channelCountMode}set channelCountMode(e){const n=this._getChannelProperties();this._setChannelProperties(Object.assign(n,{channelCountMode:e}))}get channelInterpretation(){return this._getChannelProperties().channelInterpretation}set channelInterpretation(e){const n=this._getChannelProperties();this._setChannelProperties(Object.assign(n,{channelInterpretation:e}))}connect(e,n=0,r=0){return as(this,e,n,r),this}toDestination(){return this.connect(this.context.destination),this}toMaster(){return mu("toMaster() has been renamed toDestination()"),this.toDestination()}disconnect(e,n=0,r=0){return f7(this,e,n,r),this}chain(...e){return $f(this,...e),this}fan(...e){return e.forEach(n=>this.connect(n)),this}dispose(){return super.dispose(),de(this.input)&&(this.input instanceof fe?this.input.dispose():sr(this.input)&&this.input.disconnect()),de(this.output)&&(this.output instanceof fe?this.output.dispose():sr(this.output)&&this.output.disconnect()),this._internalChannels=[],this}}function $f(...t){const e=t.shift();t.reduce((n,r)=>(n instanceof fe?n.connect(r):sr(n)&&as(n,r),r),e)}function as(t,e,n=0,r=0){for(oe(de(t),"Cannot connect from undefined node"),oe(de(e),"Cannot connect to undefined node"),(e instanceof fe||sr(e))&&oe(e.numberOfInputs>0,"Cannot connect to node with no inputs"),oe(t.numberOfOutputs>0,"Cannot connect from node with no outputs");e instanceof fe||e instanceof Re;)de(e.input)&&(e=e.input);for(;t instanceof fe;)de(t.output)&&(t=t.output);Br(e)?t.connect(e,n):t.connect(e,n,r)}function f7(t,e,n=0,r=0){if(de(e))for(;e instanceof fe;)e=e.input;for(;!sr(t);)de(t.output)&&(t=t.output);Br(e)?t.disconnect(e,n):sr(e)?t.disconnect(e,n,r):t.disconnect()}class at extends fe{constructor(){const e=ce(at.getDefaults(),arguments,["gain","units"]);super(e),this.name="Gain",this._gainNode=this.context.createGain(),this.input=this._gainNode,this.output=this._gainNode,this.gain=new Re({context:this.context,convert:e.convert,param:this._gainNode.gain,units:e.units,value:e.gain,minValue:e.minValue,maxValue:e.maxValue}),Fe(this,"gain")}static getDefaults(){return Object.assign(fe.getDefaults(),{convert:!0,gain:1,units:"gain"})}dispose(){return super.dispose(),this._gainNode.disconnect(),this.gain.dispose(),this}}class Bi extends fe{constructor(e){super(e),this.onended=be,this._startTime=-1,this._stopTime=-1,this._timeout=-1,this.output=new at({context:this.context,gain:0}),this._gainNode=this.output,this.getStateAtTime=function(n){const r=this.toSeconds(n);return this._startTime!==-1&&r>=this._startTime&&(this._stopTime===-1||r<=this._stopTime)?"started":"stopped"},this._fadeIn=e.fadeIn,this._fadeOut=e.fadeOut,this._curve=e.curve,this.onended=e.onended}static getDefaults(){return Object.assign(fe.getDefaults(),{curve:"linear",fadeIn:0,fadeOut:0,onended:be})}_startGain(e,n=1){oe(this._startTime===-1,"Source cannot be started more than once");const r=this.toSeconds(this._fadeIn);return this._startTime=e+r,this._startTime=Math.max(this._startTime,this.context.currentTime),r>0?(this._gainNode.gain.setValueAtTime(0,e),this._curve==="linear"?this._gainNode.gain.linearRampToValueAtTime(n,e+r):this._gainNode.gain.exponentialApproachValueAtTime(n,e,r)):this._gainNode.gain.setValueAtTime(n,e),this}stop(e){return this.log("stop",e),this._stopGain(this.toSeconds(e)),this}_stopGain(e){oe(this._startTime!==-1,"'start' must be called before 'stop'"),this.cancelStop();const n=this.toSeconds(this._fadeOut);return this._stopTime=this.toSeconds(e)+n,this._stopTime=Math.max(this._stopTime,this.now()),n>0?this._curve==="linear"?this._gainNode.gain.linearRampTo(0,n,e):this._gainNode.gain.targetRampTo(0,n,e):(this._gainNode.gain.cancelAndHoldAtTime(e),this._gainNode.gain.setValueAtTime(0,e)),this.context.clearTimeout(this._timeout),this._timeout=this.context.setTimeout(()=>{const r=this._curve==="exponential"?n*2:0;this._stopSource(this.now()+r),this._onended()},this._stopTime-this.context.currentTime),this}_onended(){if(this.onended!==be&&(this.onended(this),this.onended=be,!this.context.isOffline)){const e=()=>this.dispose();typeof requestIdleCallback<"u"?requestIdleCallback(e):setTimeout(e,10)}}get state(){return this.getStateAtTime(this.now())}cancelStop(){return this.log("cancelStop"),oe(this._startTime!==-1,"Source is not started"),this._gainNode.gain.cancelScheduledValues(this._startTime+this.sampleTime),this.context.clearTimeout(this._timeout),this._stopTime=-1,this}dispose(){return super.dispose(),this._gainNode.dispose(),this.onended=be,this}}class Pp extends Bi{constructor(){const e=ce(Pp.getDefaults(),arguments,["offset"]);super(e),this.name="ToneConstantSource",this._source=this.context.createConstantSource(),as(this._source,this._gainNode),this.offset=new Re({context:this.context,convert:e.convert,param:this._source.offset,units:e.units,value:e.offset,minValue:e.minValue,maxValue:e.maxValue})}static getDefaults(){return Object.assign(Bi.getDefaults(),{convert:!0,offset:1,units:"number"})}start(e){const n=this.toSeconds(e);return this.log("start",n),this._startGain(n),this._source.start(n),this}_stopSource(e){this._source.stop(e)}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._source.disconnect(),this.offset.dispose(),this}}class Xe extends fe{constructor(){const e=ce(Xe.getDefaults(),arguments,["value","units"]);super(e),this.name="Signal",this.override=!0,this.output=this._constantSource=new Pp({context:this.context,convert:e.convert,offset:e.value,units:e.units,minValue:e.minValue,maxValue:e.maxValue}),this._constantSource.start(0),this.input=this._param=this._constantSource.offset}static getDefaults(){return Object.assign(fe.getDefaults(),{convert:!0,units:"number",value:0})}connect(e,n=0,r=0){return qp(this,e,n,r),this}dispose(){return super.dispose(),this._param.dispose(),this._constantSource.dispose(),this}setValueAtTime(e,n){return this._param.setValueAtTime(e,n),this}getValueAtTime(e){return this._param.getValueAtTime(e)}setRampPoint(e){return this._param.setRampPoint(e),this}linearRampToValueAtTime(e,n){return this._param.linearRampToValueAtTime(e,n),this}exponentialRampToValueAtTime(e,n){return this._param.exponentialRampToValueAtTime(e,n),this}exponentialRampTo(e,n,r){return this._param.exponentialRampTo(e,n,r),this}linearRampTo(e,n,r){return this._param.linearRampTo(e,n,r),this}targetRampTo(e,n,r){return this._param.targetRampTo(e,n,r),this}exponentialApproachValueAtTime(e,n,r){return this._param.exponentialApproachValueAtTime(e,n,r),this}setTargetAtTime(e,n,r){return this._param.setTargetAtTime(e,n,r),this}setValueCurveAtTime(e,n,r,i){return this._param.setValueCurveAtTime(e,n,r,i),this}cancelScheduledValues(e){return this._param.cancelScheduledValues(e),this}cancelAndHoldAtTime(e){return this._param.cancelAndHoldAtTime(e),this}rampTo(e,n,r){return this._param.rampTo(e,n,r),this}get value(){return this._param.value}set value(e){this._param.value=e}get convert(){return this._param.convert}set convert(e){this._param.convert=e}get units(){return this._param.units}get overridden(){return this._param.overridden}set overridden(e){this._param.overridden=e}get maxValue(){return this._param.maxValue}get minValue(){return this._param.minValue}apply(e){return this._param.apply(e),this}}function qp(t,e,n,r){(e instanceof Re||Br(e)||e instanceof Xe&&e.override)&&(e.cancelScheduledValues(0),e.setValueAtTime(0,0),e instanceof Xe&&(e.overridden=!0)),as(t,e,n,r)}class Fp extends Re{constructor(){const e=ce(Fp.getDefaults(),arguments,["value"]);super(e),this.name="TickParam",this._events=new Yt(1/0),this._multiplier=1,this._multiplier=e.multiplier,this._events.cancel(0),this._events.add({ticks:0,time:0,type:"setValueAtTime",value:this._fromType(e.value)}),this.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Re.getDefaults(),{multiplier:1,units:"hertz",value:1})}setTargetAtTime(e,n,r){n=this.toSeconds(n),this.setRampPoint(n);const i=this._fromType(e),s=this._events.get(n),o=Math.round(Math.max(1/r,1));for(let a=0;a<=o;a++){const c=r*a+n,u=this._exponentialApproach(s.time,s.value,i,r,c);this.linearRampToValueAtTime(this._toType(u),c)}return this}setValueAtTime(e,n){const r=this.toSeconds(n);super.setValueAtTime(e,n);const i=this._events.get(r),s=this._events.previousEvent(i),o=this._getTicksUntilEvent(s,r);return i.ticks=Math.max(o,0),this}linearRampToValueAtTime(e,n){const r=this.toSeconds(n);super.linearRampToValueAtTime(e,n);const i=this._events.get(r),s=this._events.previousEvent(i),o=this._getTicksUntilEvent(s,r);return i.ticks=Math.max(o,0),this}exponentialRampToValueAtTime(e,n){n=this.toSeconds(n);const r=this._fromType(e),i=this._events.get(n),s=Math.round(Math.max((n-i.time)*10,1)),o=(n-i.time)/s;for(let a=0;a<=s;a++){const c=o*a+i.time,u=this._exponentialInterpolate(i.time,i.value,n,r,c);this.linearRampToValueAtTime(this._toType(u),c)}return this}_getTicksUntilEvent(e,n){if(e===null)e={ticks:0,time:0,type:"setValueAtTime",value:0};else if(Ht(e.ticks)){const o=this._events.previousEvent(e);e.ticks=this._getTicksUntilEvent(o,e.time)}const r=this._fromType(this.getValueAtTime(e.time));let i=this._fromType(this.getValueAtTime(n));const s=this._events.get(n);return s&&s.time===n&&s.type==="setValueAtTime"&&(i=this._fromType(this.getValueAtTime(n-this.sampleTime))),.5*(n-e.time)*(r+i)+e.ticks}getTicksAtTime(e){const n=this.toSeconds(e),r=this._events.get(n);return Math.max(this._getTicksUntilEvent(r,n),0)}getDurationOfTicks(e,n){const r=this.toSeconds(n),i=this.getTicksAtTime(n);return this.getTimeOfTick(i+e)-r}getTimeOfTick(e){const n=this._events.get(e,"ticks"),r=this._events.getAfter(e,"ticks");if(n&&n.ticks===e)return n.time;if(n&&r&&r.type==="linearRampToValueAtTime"&&n.value!==r.value){const i=this._fromType(this.getValueAtTime(n.time)),o=(this._fromType(this.getValueAtTime(r.time))-i)/(r.time-n.time),a=Math.sqrt(Math.pow(i,2)-2*o*(n.ticks-e)),c=(-i+a)/o,u=(-i-a)/o;return(c>0?c:u)+n.time}else return n?n.value===0?1/0:n.time+(e-n.ticks)/n.value:e/this._initialValue}ticksToTime(e,n){return this.getDurationOfTicks(e,n)}timeToTicks(e,n){const r=this.toSeconds(n),i=this.toSeconds(e),s=this.getTicksAtTime(r);return this.getTicksAtTime(r+i)-s}_fromType(e){return this.units==="bpm"&&this.multiplier?1/(60/e/this.multiplier):super._fromType(e)}_toType(e){return this.units==="bpm"&&this.multiplier?e/this.multiplier*60:super._toType(e)}get multiplier(){return this._multiplier}set multiplier(e){const n=this.value;this._multiplier=e,this.cancelScheduledValues(0),this.setValueAtTime(n,0)}}class $p extends Xe{constructor(){const e=ce($p.getDefaults(),arguments,["value"]);super(e),this.name="TickSignal",this.input=this._param=new Fp({context:this.context,convert:e.convert,multiplier:e.multiplier,param:this._constantSource.offset,units:e.units,value:e.value})}static getDefaults(){return Object.assign(Xe.getDefaults(),{multiplier:1,units:"hertz",value:1})}ticksToTime(e,n){return this._param.ticksToTime(e,n)}timeToTicks(e,n){return this._param.timeToTicks(e,n)}getTimeOfTick(e){return this._param.getTimeOfTick(e)}getDurationOfTicks(e,n){return this._param.getDurationOfTicks(e,n)}getTicksAtTime(e){return this._param.getTicksAtTime(e)}get multiplier(){return this._param.multiplier}set multiplier(e){this._param.multiplier=e}dispose(){return super.dispose(),this._param.dispose(),this}}class Vp extends Et{constructor(){const e=ce(Vp.getDefaults(),arguments,["frequency"]);super(e),this.name="TickSource",this._state=new Dp,this._tickOffset=new Yt,this._ticksAtTime=new Yt,this._secondsAtTime=new Yt,this.frequency=new $p({context:this.context,units:e.units,value:e.frequency}),Fe(this,"frequency"),this._state.setStateAtTime("stopped",0),this.setTicksAtTime(0,0)}static getDefaults(){return Object.assign({frequency:1,units:"hertz"},Et.getDefaults())}get state(){return this.getStateAtTime(this.now())}start(e,n){const r=this.toSeconds(e);return this._state.getValueAtTime(r)!=="started"&&(this._state.setStateAtTime("started",r),de(n)&&this.setTicksAtTime(n,r),this._ticksAtTime.cancel(r),this._secondsAtTime.cancel(r)),this}stop(e){const n=this.toSeconds(e);if(this._state.getValueAtTime(n)==="stopped"){const r=this._state.get(n);r&&r.time>0&&(this._tickOffset.cancel(r.time),this._state.cancel(r.time))}return this._state.cancel(n),this._state.setStateAtTime("stopped",n),this.setTicksAtTime(0,n),this._ticksAtTime.cancel(n),this._secondsAtTime.cancel(n),this}pause(e){const n=this.toSeconds(e);return this._state.getValueAtTime(n)==="started"&&(this._state.setStateAtTime("paused",n),this._ticksAtTime.cancel(n),this._secondsAtTime.cancel(n)),this}cancel(e){return e=this.toSeconds(e),this._state.cancel(e),this._tickOffset.cancel(e),this._ticksAtTime.cancel(e),this._secondsAtTime.cancel(e),this}getTicksAtTime(e){const n=this.toSeconds(e),r=this._state.getLastState("stopped",n),i=this._ticksAtTime.get(n),s={state:"paused",time:n};this._state.add(s);let o=i||r,a=i?i.ticks:0,c=null;return this._state.forEachBetween(o.time,n+this.sampleTime,u=>{let l=o.time;const h=this._tickOffset.get(u.time);h&&h.time>=o.time&&(a=h.ticks,l=h.time),o.state==="started"&&u.state!=="started"&&(a+=this.frequency.getTicksAtTime(u.time)-this.frequency.getTicksAtTime(l),u.time!==s.time&&(c={state:u.state,time:u.time,ticks:a})),o=u}),this._state.remove(s),c&&this._ticksAtTime.add(c),a}get ticks(){return this.getTicksAtTime(this.now())}set ticks(e){this.setTicksAtTime(e,this.now())}get seconds(){return this.getSecondsAtTime(this.now())}set seconds(e){const n=this.now(),r=this.frequency.timeToTicks(e,n);this.setTicksAtTime(r,n)}getSecondsAtTime(e){e=this.toSeconds(e);const n=this._state.getLastState("stopped",e),r={state:"paused",time:e};this._state.add(r);const i=this._secondsAtTime.get(e);let s=i||n,o=i?i.seconds:0,a=null;return this._state.forEachBetween(s.time,e+this.sampleTime,c=>{let u=s.time;const l=this._tickOffset.get(c.time);l&&l.time>=s.time&&(o=l.seconds,u=l.time),s.state==="started"&&c.state!=="started"&&(o+=c.time-u,c.time!==r.time&&(a={state:c.state,time:c.time,seconds:o})),s=c}),this._state.remove(r),a&&this._secondsAtTime.add(a),o}setTicksAtTime(e,n){return n=this.toSeconds(n),this._tickOffset.cancel(n),this._tickOffset.add({seconds:this.frequency.getDurationOfTicks(e,n),ticks:e,time:n}),this._ticksAtTime.cancel(n),this._secondsAtTime.cancel(n),this}getStateAtTime(e){return e=this.toSeconds(e),this._state.getValueAtTime(e)}getTimeOfTick(e,n=this.now()){const r=this._tickOffset.get(n),i=this._state.get(n),s=Math.max(r.time,i.time),o=this.frequency.getTicksAtTime(s)+e-r.ticks;return this.frequency.getTimeOfTick(o)}forEachTickBetween(e,n,r){let i=this._state.get(e);this._state.forEachBetween(e,n,o=>{i&&i.state==="started"&&o.state!=="started"&&this.forEachTickBetween(Math.max(i.time,e),o.time-this.sampleTime,r),i=o});let s=null;if(i&&i.state==="started"){const o=Math.max(i.time,e),a=this.frequency.getTicksAtTime(o),c=this.frequency.getTicksAtTime(i.time),u=a-c;let l=Math.ceil(u)-u;l=Kt(l,1)?0:l;let h=this.frequency.getTimeOfTick(a+l);for(;h<n;){try{r(h,Math.round(this.getTicksAtTime(h)))}catch(f){s=f;break}h+=this.frequency.getDurationOfTicks(1,h)}}if(s)throw s;return this}dispose(){return super.dispose(),this._state.dispose(),this._tickOffset.dispose(),this._ticksAtTime.dispose(),this._secondsAtTime.dispose(),this.frequency.dispose(),this}}class vu extends Et{constructor(){const e=ce(vu.getDefaults(),arguments,["callback","frequency"]);super(e),this.name="Clock",this.callback=be,this._lastUpdate=0,this._state=new Dp("stopped"),this._boundLoop=this._loop.bind(this),this.callback=e.callback,this._tickSource=new Vp({context:this.context,frequency:e.frequency,units:e.units}),this._lastUpdate=0,this.frequency=this._tickSource.frequency,Fe(this,"frequency"),this._state.setStateAtTime("stopped",0),this.context.on("tick",this._boundLoop)}static getDefaults(){return Object.assign(Et.getDefaults(),{callback:be,frequency:1,units:"hertz"})}get state(){return this._state.getValueAtTime(this.now())}start(e,n){Y2(this.context);const r=this.toSeconds(e);return this.log("start",r),this._state.getValueAtTime(r)!=="started"&&(this._state.setStateAtTime("started",r),this._tickSource.start(r,n),r<this._lastUpdate&&this.emit("start",r,n)),this}stop(e){const n=this.toSeconds(e);return this.log("stop",n),this._state.cancel(n),this._state.setStateAtTime("stopped",n),this._tickSource.stop(n),n<this._lastUpdate&&this.emit("stop",n),this}pause(e){const n=this.toSeconds(e);return this._state.getValueAtTime(n)==="started"&&(this._state.setStateAtTime("paused",n),this._tickSource.pause(n),n<this._lastUpdate&&this.emit("pause",n)),this}get ticks(){return Math.ceil(this.getTicksAtTime(this.now()))}set ticks(e){this._tickSource.ticks=e}get seconds(){return this._tickSource.seconds}set seconds(e){this._tickSource.seconds=e}getSecondsAtTime(e){return this._tickSource.getSecondsAtTime(e)}setTicksAtTime(e,n){return this._tickSource.setTicksAtTime(e,n),this}getTimeOfTick(e,n=this.now()){return this._tickSource.getTimeOfTick(e,n)}getTicksAtTime(e){return this._tickSource.getTicksAtTime(e)}nextTickTime(e,n){const r=this.toSeconds(n),i=this.getTicksAtTime(r);return this._tickSource.getTimeOfTick(i+e,r)}_loop(){const e=this._lastUpdate,n=this.now();this._lastUpdate=n,this.log("loop",e,n),e!==n&&(this._state.forEachBetween(e,n,r=>{switch(r.state){case"started":const i=this._tickSource.getTicksAtTime(r.time);this.emit("start",r.time,i);break;case"stopped":r.time!==0&&this.emit("stop",r.time);break;case"paused":this.emit("pause",r.time);break}}),this._tickSource.forEachTickBetween(e,n,(r,i)=>{this.callback(r,i)}))}getStateAtTime(e){const n=this.toSeconds(e);return this._state.getValueAtTime(n)}dispose(){return super.dispose(),this.context.off("tick",this._boundLoop),this._tickSource.dispose(),this._state.dispose(),this}}Ao.mixin(vu);class cs extends fe{constructor(){const e=ce(cs.getDefaults(),arguments,["volume"]);super(e),this.name="Volume",this.input=this.output=new at({context:this.context,gain:e.volume,units:"decibels"}),this.volume=this.output.gain,Fe(this,"volume"),this._unmutedVolume=e.volume,this.mute=e.mute}static getDefaults(){return Object.assign(fe.getDefaults(),{mute:!1,volume:0})}get mute(){return this.volume.value===-1/0}set mute(e){!this.mute&&e?(this._unmutedVolume=this.volume.value,this.volume.value=-1/0):this.mute&&!e&&(this.volume.value=this._unmutedVolume)}dispose(){return super.dispose(),this.input.dispose(),this.volume.dispose(),this}}class Lp extends fe{constructor(){const e=ce(Lp.getDefaults(),arguments);super(e),this.name="Destination",this.input=new cs({context:this.context}),this.output=new at({context:this.context}),this.volume=this.input.volume,$f(this.input,this.output,this.context.rawContext.destination),this.mute=e.mute,this._internalChannels=[this.input,this.context.rawContext.destination,this.output]}static getDefaults(){return Object.assign(fe.getDefaults(),{mute:!1,volume:0})}get mute(){return this.input.mute}set mute(e){this.input.mute=e}chain(...e){return this.input.disconnect(),e.unshift(this.input),e.push(this.output),$f(...e),this}get maxChannelCount(){return this.context.rawContext.destination.maxChannelCount}dispose(){return super.dispose(),this.volume.dispose(),this}}gu(t=>{t.destination=new Lp({context:t})});_u(t=>{t.destination.dispose()});class d7 extends fe{constructor(){super(...arguments),this.name="Listener",this.positionX=new Re({context:this.context,param:this.context.rawContext.listener.positionX}),this.positionY=new Re({context:this.context,param:this.context.rawContext.listener.positionY}),this.positionZ=new Re({context:this.context,param:this.context.rawContext.listener.positionZ}),this.forwardX=new Re({context:this.context,param:this.context.rawContext.listener.forwardX}),this.forwardY=new Re({context:this.context,param:this.context.rawContext.listener.forwardY}),this.forwardZ=new Re({context:this.context,param:this.context.rawContext.listener.forwardZ}),this.upX=new Re({context:this.context,param:this.context.rawContext.listener.upX}),this.upY=new Re({context:this.context,param:this.context.rawContext.listener.upY}),this.upZ=new Re({context:this.context,param:this.context.rawContext.listener.upZ})}static getDefaults(){return Object.assign(fe.getDefaults(),{positionX:0,positionY:0,positionZ:0,forwardX:0,forwardY:0,forwardZ:-1,upX:0,upY:1,upZ:0})}dispose(){return super.dispose(),this.positionX.dispose(),this.positionY.dispose(),this.positionZ.dispose(),this.forwardX.dispose(),this.forwardY.dispose(),this.forwardZ.dispose(),this.upX.dispose(),this.upY.dispose(),this.upZ.dispose(),this}}gu(t=>{t.listener=new d7({context:t})});_u(t=>{t.listener.dispose()});class jp extends Gn{constructor(){super(),this.name="ToneAudioBuffers",this._buffers=new Map,this._loadingCount=0;const e=ce(jp.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");this.baseUrl=e.baseUrl,Object.keys(e.urls).forEach(n=>{this._loadingCount++;const r=e.urls[n];this.add(n,r,this._bufferLoaded.bind(this,e.onload),e.onerror)})}static getDefaults(){return{baseUrl:"",onerror:be,onload:be,urls:{}}}has(e){return this._buffers.has(e.toString())}get(e){return oe(this.has(e),`ToneAudioBuffers has no buffer named: ${e}`),this._buffers.get(e.toString())}_bufferLoaded(e){this._loadingCount--,this._loadingCount===0&&e&&e()}get loaded(){return Array.from(this._buffers).every(([e,n])=>n.loaded)}add(e,n,r=be,i=be){return Ln(n)?(this.baseUrl&&n.trim().substring(0,11).toLowerCase()==="data:audio/"&&(this.baseUrl=""),this._buffers.set(e.toString(),new Ne(this.baseUrl+n,r,i))):this._buffers.set(e.toString(),new Ne(n,r,i)),this}dispose(){return super.dispose(),this._buffers.forEach(e=>e.dispose()),this._buffers.clear(),this}}class tc extends kt{constructor(){super(...arguments),this.name="MidiClass",this.defaultUnits="midi"}_frequencyToUnits(e){return kr(super._frequencyToUnits(e))}_ticksToUnits(e){return kr(super._ticksToUnits(e))}_beatsToUnits(e){return kr(super._beatsToUnits(e))}_secondsToUnits(e){return kr(super._secondsToUnits(e))}toMidi(){return this.valueOf()}toFrequency(){return iw(this.toMidi())}transpose(e){return new tc(this.context,this.toMidi()+e)}}class yi extends $s{constructor(){super(...arguments),this.name="Ticks",this.defaultUnits="i"}_now(){return this.context.transport.ticks}_beatsToUnits(e){return this._getPPQ()*e}_secondsToUnits(e){return Math.floor(e/(60/this._getBpm())*this._getPPQ())}_ticksToUnits(e){return e}toTicks(){return this.valueOf()}toSeconds(){return this.valueOf()/this._getPPQ()*(60/this._getBpm())}}class p7 extends Et{constructor(){super(...arguments),this.name="Draw",this.expiration=.25,this.anticipation=.008,this._events=new Yt,this._boundDrawLoop=this._drawLoop.bind(this),this._animationFrame=-1}schedule(e,n){return this._events.add({callback:e,time:this.toSeconds(n)}),this._events.length===1&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop)),this}cancel(e){return this._events.cancel(this.toSeconds(e)),this}_drawLoop(){const e=this.context.currentTime;this._events.forEachBefore(e+this.anticipation,n=>{e-n.time<=this.expiration&&n.callback(),this._events.remove(n)}),this._events.length>0&&(this._animationFrame=requestAnimationFrame(this._boundDrawLoop))}dispose(){return super.dispose(),this._events.dispose(),cancelAnimationFrame(this._animationFrame),this}}gu(t=>{t.draw=new p7({context:t})});_u(t=>{t.draw.dispose()});class m7 extends Gn{constructor(){super(...arguments),this.name="IntervalTimeline",this._root=null,this._length=0}add(e){oe(de(e.time),"Events must have a time property"),oe(de(e.duration),"Events must have a duration parameter"),e.time=e.time.valueOf();let n=new g7(e.time,e.time+e.duration,e);for(this._root===null?this._root=n:this._root.insert(n),this._length++;n!==null;)n.updateHeight(),n.updateMax(),this._rebalance(n),n=n.parent;return this}remove(e){if(this._root!==null){const n=[];this._root.search(e.time,n);for(const r of n)if(r.event===e){this._removeNode(r),this._length--;break}}return this}get length(){return this._length}cancel(e){return this.forEachFrom(e,n=>this.remove(n)),this}_setRoot(e){this._root=e,this._root!==null&&(this._root.parent=null)}_replaceNodeInParent(e,n){e.parent!==null?(e.isLeftChild()?e.parent.left=n:e.parent.right=n,this._rebalance(e.parent)):this._setRoot(n)}_removeNode(e){if(e.left===null&&e.right===null)this._replaceNodeInParent(e,null);else if(e.right===null)this._replaceNodeInParent(e,e.left);else if(e.left===null)this._replaceNodeInParent(e,e.right);else{const n=e.getBalance();let r,i=null;if(n>0)if(e.left.right===null)r=e.left,r.right=e.right,i=r;else{for(r=e.left.right;r.right!==null;)r=r.right;r.parent&&(r.parent.right=r.left,i=r.parent,r.left=e.left,r.right=e.right)}else if(e.right.left===null)r=e.right,r.left=e.left,i=r;else{for(r=e.right.left;r.left!==null;)r=r.left;r.parent&&(r.parent.left=r.right,i=r.parent,r.left=e.left,r.right=e.right)}e.parent!==null?e.isLeftChild()?e.parent.left=r:e.parent.right=r:this._setRoot(r),i&&this._rebalance(i)}e.dispose()}_rotateLeft(e){const n=e.parent,r=e.isLeftChild(),i=e.right;i&&(e.right=i.left,i.left=e),n!==null?r?n.left=i:n.right=i:this._setRoot(i)}_rotateRight(e){const n=e.parent,r=e.isLeftChild(),i=e.left;i&&(e.left=i.right,i.right=e),n!==null?r?n.left=i:n.right=i:this._setRoot(i)}_rebalance(e){const n=e.getBalance();n>1&&e.left?e.left.getBalance()<0?this._rotateLeft(e.left):this._rotateRight(e):n<-1&&e.right&&(e.right.getBalance()>0?this._rotateRight(e.right):this._rotateLeft(e))}get(e){if(this._root!==null){const n=[];if(this._root.search(e,n),n.length>0){let r=n[0];for(let i=1;i<n.length;i++)n[i].low>r.low&&(r=n[i]);return r.event}}return null}forEach(e){if(this._root!==null){const n=[];this._root.traverse(r=>n.push(r)),n.forEach(r=>{r.event&&e(r.event)})}return this}forEachAtTime(e,n){if(this._root!==null){const r=[];this._root.search(e,r),r.forEach(i=>{i.event&&n(i.event)})}return this}forEachFrom(e,n){if(this._root!==null){const r=[];this._root.searchAfter(e,r),r.forEach(i=>{i.event&&n(i.event)})}return this}dispose(){return super.dispose(),this._root!==null&&this._root.traverse(e=>e.dispose()),this._root=null,this}}class g7{constructor(e,n,r){this._left=null,this._right=null,this.parent=null,this.height=0,this.event=r,this.low=e,this.high=n,this.max=this.high}insert(e){e.low<=this.low?this.left===null?this.left=e:this.left.insert(e):this.right===null?this.right=e:this.right.insert(e)}search(e,n){e>this.max||(this.left!==null&&this.left.search(e,n),this.low<=e&&this.high>e&&n.push(this),!(this.low>e)&&this.right!==null&&this.right.search(e,n))}searchAfter(e,n){this.low>=e&&(n.push(this),this.left!==null&&this.left.searchAfter(e,n)),this.right!==null&&this.right.searchAfter(e,n)}traverse(e){e(this),this.left!==null&&this.left.traverse(e),this.right!==null&&this.right.traverse(e)}updateHeight(){this.left!==null&&this.right!==null?this.height=Math.max(this.left.height,this.right.height)+1:this.right!==null?this.height=this.right.height+1:this.left!==null?this.height=this.left.height+1:this.height=0}updateMax(){this.max=this.high,this.left!==null&&(this.max=Math.max(this.max,this.left.max)),this.right!==null&&(this.max=Math.max(this.max,this.right.max))}getBalance(){let e=0;return this.left!==null&&this.right!==null?e=this.left.height-this.right.height:this.left!==null?e=this.left.height+1:this.right!==null&&(e=-(this.right.height+1)),e}isLeftChild(){return this.parent!==null&&this.parent.left===this}get left(){return this._left}set left(e){this._left=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}get right(){return this._right}set right(e){this._right=e,e!==null&&(e.parent=this),this.updateHeight(),this.updateMax()}dispose(){this.parent=null,this._left=null,this._right=null,this.event=null}}class _7 extends Gn{constructor(e){super(),this.name="TimelineValue",this._timeline=new Yt({memory:10}),this._initialValue=e}set(e,n){return this._timeline.add({value:e,time:n}),this}get(e){const n=this._timeline.get(e);return n?n.value:this._initialValue}}class Wi extends fe{constructor(){super(ce(Wi.getDefaults(),arguments,["context"]))}connect(e,n=0,r=0){return qp(this,e,n,r),this}}class ko extends Wi{constructor(){const e=ce(ko.getDefaults(),arguments,["mapping","length"]);super(e),this.name="WaveShaper",this._shaper=this.context.createWaveShaper(),this.input=this._shaper,this.output=this._shaper,$t(e.mapping)||e.mapping instanceof Float32Array?this.curve=Float32Array.from(e.mapping):L8(e.mapping)&&this.setMap(e.mapping,e.length)}static getDefaults(){return Object.assign(Xe.getDefaults(),{length:1024})}setMap(e,n=1024){const r=new Float32Array(n);for(let i=0,s=n;i<s;i++){const o=i/(s-1)*2-1;r[i]=e(o,i)}return this.curve=r,this}get curve(){return this._shaper.curve}set curve(e){this._shaper.curve=e}get oversample(){return this._shaper.oversample}set oversample(e){const n=["none","2x","4x"].some(r=>r.includes(e));oe(n,"oversampling must be either 'none', '2x', or '4x'"),this._shaper.oversample=e}dispose(){return super.dispose(),this._shaper.disconnect(),this}}class zp extends Wi{constructor(){const e=ce(zp.getDefaults(),arguments,["value"]);super(e),this.name="Pow",this._exponentScaler=this.input=this.output=new ko({context:this.context,mapping:this._expFunc(e.value),length:8192}),this._exponent=e.value}static getDefaults(){return Object.assign(Wi.getDefaults(),{value:1})}_expFunc(e){return n=>Math.pow(Math.abs(n),e)}get value(){return this._exponent}set value(e){this._exponent=e,this._exponentScaler.setMap(this._expFunc(this._exponent))}dispose(){return super.dispose(),this._exponentScaler.dispose(),this}}class fr{constructor(e,n){this.id=fr._eventId++,this._remainderTime=0;const r=Object.assign(fr.getDefaults(),n);this.transport=e,this.callback=r.callback,this._once=r.once,this.time=Math.floor(r.time),this._remainderTime=r.time-this.time}static getDefaults(){return{callback:be,once:!1,time:0}}get floatTime(){return this.time+this._remainderTime}invoke(e){if(this.callback){const n=this.transport.bpm.getDurationOfTicks(1,e);this.callback(e+this._remainderTime*n),this._once&&this.transport.clear(this.id)}}dispose(){return this.callback=void 0,this}}fr._eventId=0;class Bp extends fr{constructor(e,n){super(e,n),this._currentId=-1,this._nextId=-1,this._nextTick=this.time,this._boundRestart=this._restart.bind(this);const r=Object.assign(Bp.getDefaults(),n);this.duration=r.duration,this._interval=r.interval,this._nextTick=r.time,this.transport.on("start",this._boundRestart),this.transport.on("loopStart",this._boundRestart),this.transport.on("ticks",this._boundRestart),this.context=this.transport.context,this._restart()}static getDefaults(){return Object.assign({},fr.getDefaults(),{duration:1/0,interval:1,once:!1})}invoke(e){this._createEvents(e),super.invoke(e)}_createEvent(){return ec(this._nextTick,this.floatTime+this.duration)?this.transport.scheduleOnce(this.invoke.bind(this),new yi(this.context,this._nextTick).toSeconds()):-1}_createEvents(e){ec(this._nextTick+this._interval,this.floatTime+this.duration)&&(this._nextTick+=this._interval,this._currentId=this._nextId,this._nextId=this.transport.scheduleOnce(this.invoke.bind(this),new yi(this.context,this._nextTick).toSeconds()))}_restart(e){this.transport.clear(this._currentId),this.transport.clear(this._nextId),this._nextTick=this.floatTime;const n=this.transport.getTicksAtTime(e);zi(n,this.time)&&(this._nextTick=this.floatTime+Math.ceil((n-this.floatTime)/this._interval)*this._interval),this._currentId=this._createEvent(),this._nextTick+=this._interval,this._nextId=this._createEvent()}dispose(){return super.dispose(),this.transport.clear(this._currentId),this.transport.clear(this._nextId),this.transport.off("start",this._boundRestart),this.transport.off("loopStart",this._boundRestart),this.transport.off("ticks",this._boundRestart),this}}class bu extends Et{constructor(){const e=ce(bu.getDefaults(),arguments);super(e),this.name="Transport",this._loop=new _7(!1),this._loopStart=0,this._loopEnd=0,this._scheduledEvents={},this._timeline=new Yt,this._repeatedEvents=new m7,this._syncedSignals=[],this._swingAmount=0,this._ppq=e.ppq,this._clock=new vu({callback:this._processTick.bind(this),context:this.context,frequency:0,units:"bpm"}),this._bindClockEvents(),this.bpm=this._clock.frequency,this._clock.frequency.multiplier=e.ppq,this.bpm.setValueAtTime(e.bpm,0),Fe(this,"bpm"),this._timeSignature=e.timeSignature,this._swingTicks=e.ppq/2}static getDefaults(){return Object.assign(Et.getDefaults(),{bpm:120,loopEnd:"4m",loopStart:0,ppq:192,swing:0,swingSubdivision:"8n",timeSignature:4})}_processTick(e,n){if(this._loop.get(e)&&n>=this._loopEnd&&(this.emit("loopEnd",e),this._clock.setTicksAtTime(this._loopStart,e),n=this._loopStart,this.emit("loopStart",e,this._clock.getSecondsAtTime(e)),this.emit("loop",e)),this._swingAmount>0&&n%this._ppq!==0&&n%(this._swingTicks*2)!==0){const r=n%(this._swingTicks*2)/(this._swingTicks*2),i=Math.sin(r*Math.PI)*this._swingAmount;e+=new yi(this.context,this._swingTicks*2/3).toSeconds()*i}B1(!0),this._timeline.forEachAtTime(n,r=>r.invoke(e)),B1(!1)}schedule(e,n){const r=new fr(this,{callback:e,time:new $s(this.context,n).toTicks()});return this._addEvent(r,this._timeline)}scheduleRepeat(e,n,r,i=1/0){const s=new Bp(this,{callback:e,duration:new en(this.context,i).toTicks(),interval:new en(this.context,n).toTicks(),time:new $s(this.context,r).toTicks()});return this._addEvent(s,this._repeatedEvents)}scheduleOnce(e,n){const r=new fr(this,{callback:e,once:!0,time:new $s(this.context,n).toTicks()});return this._addEvent(r,this._timeline)}clear(e){if(this._scheduledEvents.hasOwnProperty(e)){const n=this._scheduledEvents[e.toString()];n.timeline.remove(n.event),n.event.dispose(),delete this._scheduledEvents[e.toString()]}return this}_addEvent(e,n){return this._scheduledEvents[e.id.toString()]={event:e,timeline:n},n.add(e),e.id}cancel(e=0){const n=this.toTicks(e);return this._timeline.forEachFrom(n,r=>this.clear(r.id)),this._repeatedEvents.forEachFrom(n,r=>this.clear(r.id)),this}_bindClockEvents(){this._clock.on("start",(e,n)=>{n=new yi(this.context,n).toSeconds(),this.emit("start",e,n)}),this._clock.on("stop",e=>{this.emit("stop",e)}),this._clock.on("pause",e=>{this.emit("pause",e)})}get state(){return this._clock.getStateAtTime(this.now())}start(e,n){this.context.resume();let r;return de(n)&&(r=this.toTicks(n)),this._clock.start(e,r),this}stop(e){return this._clock.stop(e),this}pause(e){return this._clock.pause(e),this}toggle(e){return e=this.toSeconds(e),this._clock.getStateAtTime(e)!=="started"?this.start(e):this.stop(e),this}get timeSignature(){return this._timeSignature}set timeSignature(e){$t(e)&&(e=e[0]/e[1]*4),this._timeSignature=e}get loopStart(){return new en(this.context,this._loopStart,"i").toSeconds()}set loopStart(e){this._loopStart=this.toTicks(e)}get loopEnd(){return new en(this.context,this._loopEnd,"i").toSeconds()}set loopEnd(e){this._loopEnd=this.toTicks(e)}get loop(){return this._loop.get(this.now())}set loop(e){this._loop.set(e,this.now())}setLoopPoints(e,n){return this.loopStart=e,this.loopEnd=n,this}get swing(){return this._swingAmount}set swing(e){this._swingAmount=e}get swingSubdivision(){return new yi(this.context,this._swingTicks).toNotation()}set swingSubdivision(e){this._swingTicks=this.toTicks(e)}get position(){const e=this.now(),n=this._clock.getTicksAtTime(e);return new yi(this.context,n).toBarsBeatsSixteenths()}set position(e){const n=this.toTicks(e);this.ticks=n}get seconds(){return this._clock.seconds}set seconds(e){const n=this.now(),r=this._clock.frequency.timeToTicks(e,n);this.ticks=r}get progress(){if(this.loop){const e=this.now();return(this._clock.getTicksAtTime(e)-this._loopStart)/(this._loopEnd-this._loopStart)}else return 0}get ticks(){return this._clock.ticks}set ticks(e){if(this._clock.ticks!==e){const n=this.now();if(this.state==="started"){const r=this._clock.getTicksAtTime(n),i=this._clock.frequency.getDurationOfTicks(Math.ceil(r)-r,n),s=n+i;this.emit("stop",s),this._clock.setTicksAtTime(e,s),this.emit("start",s,this._clock.getSecondsAtTime(s))}else this.emit("ticks",n),this._clock.setTicksAtTime(e,n)}}getTicksAtTime(e){return this._clock.getTicksAtTime(e)}getSecondsAtTime(e){return this._clock.getSecondsAtTime(e)}get PPQ(){return this._clock.frequency.multiplier}set PPQ(e){this._clock.frequency.multiplier=e}nextSubdivision(e){if(e=this.toTicks(e),this.state!=="started")return 0;{const n=this.now(),r=this.getTicksAtTime(n),i=e-r%e;return this._clock.nextTickTime(i,n)}}syncSignal(e,n){const r=this.now();let i=this.bpm,s=1/(60/i.getValueAtTime(r)/this.PPQ),o=[];if(e.units==="time"){const c=.015625/s,u=new at(c),l=new zp(-1),h=new at(c);i.chain(u,l,h),i=h,s=1/s,o=[u,l,h]}n||(e.getValueAtTime(r)!==0?n=e.getValueAtTime(r)/s:n=0);const a=new at(n);return i.connect(a),a.connect(e._param),o.push(a),this._syncedSignals.push({initial:e.value,nodes:o,signal:e}),e.value=0,this}unsyncSignal(e){for(let n=this._syncedSignals.length-1;n>=0;n--){const r=this._syncedSignals[n];r.signal===e&&(r.nodes.forEach(i=>i.dispose()),r.signal.value=r.initial,this._syncedSignals.splice(n,1))}return this}dispose(){return super.dispose(),this._clock.dispose(),ew(this,"bpm"),this._timeline.dispose(),this._repeatedEvents.dispose(),this}}Ao.mixin(bu);gu(t=>{t.transport=new bu({context:t})});_u(t=>{t.transport.dispose()});class Vt extends fe{constructor(e){super(e),this.input=void 0,this._state=new Dp("stopped"),this._synced=!1,this._scheduled=[],this._syncedStart=be,this._syncedStop=be,this._state.memory=100,this._state.increasing=!0,this._volume=this.output=new cs({context:this.context,mute:e.mute,volume:e.volume}),this.volume=this._volume.volume,Fe(this,"volume"),this.onstop=e.onstop}static getDefaults(){return Object.assign(fe.getDefaults(),{mute:!1,onstop:be,volume:0})}get state(){return this._synced?this.context.transport.state==="started"?this._state.getValueAtTime(this.context.transport.seconds):"stopped":this._state.getValueAtTime(this.now())}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}_clampToCurrentTime(e){return this._synced?e:Math.max(e,this.context.currentTime)}start(e,n,r){let i=Ht(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(i=this._clampToCurrentTime(i),!this._synced&&this._state.getValueAtTime(i)==="started")oe(zi(i,this._state.get(i).time),"Start time must be strictly greater than previous start time"),this._state.cancel(i),this._state.setStateAtTime("started",i),this.log("restart",i),this.restart(i,n,r);else if(this.log("start",i),this._state.setStateAtTime("started",i),this._synced){const s=this._state.get(i);s&&(s.offset=this.toSeconds(Ci(n,0)),s.duration=r?this.toSeconds(r):void 0);const o=this.context.transport.schedule(a=>{this._start(a,n,r)},i);this._scheduled.push(o),this.context.transport.state==="started"&&this.context.transport.getSecondsAtTime(this.immediate())>i&&this._syncedStart(this.now(),this.context.transport.seconds)}else Y2(this.context),this._start(i,n,r);return this}stop(e){let n=Ht(e)&&this._synced?this.context.transport.seconds:this.toSeconds(e);if(n=this._clampToCurrentTime(n),this._state.getValueAtTime(n)==="started"||de(this._state.getNextState("started",n))){if(this.log("stop",n),!this._synced)this._stop(n);else{const r=this.context.transport.schedule(this._stop.bind(this),n);this._scheduled.push(r)}this._state.cancel(n),this._state.setStateAtTime("stopped",n)}return this}restart(e,n,r){return e=this.toSeconds(e),this._state.getValueAtTime(e)==="started"&&(this._state.cancel(e),this._restart(e,n,r)),this}sync(){return this._synced||(this._synced=!0,this._syncedStart=(e,n)=>{if(zi(n,0)){const r=this._state.get(n);if(r&&r.state==="started"&&r.time!==n){const i=n-this.toSeconds(r.time);let s;r.duration&&(s=this.toSeconds(r.duration)-i),this._start(e,this.toSeconds(r.offset)+i,s)}}},this._syncedStop=e=>{const n=this.context.transport.getSecondsAtTime(Math.max(e-this.sampleTime,0));this._state.getValueAtTime(n)==="started"&&this._stop(e)},this.context.transport.on("start",this._syncedStart),this.context.transport.on("loopStart",this._syncedStart),this.context.transport.on("stop",this._syncedStop),this.context.transport.on("pause",this._syncedStop),this.context.transport.on("loopEnd",this._syncedStop)),this}unsync(){return this._synced&&(this.context.transport.off("stop",this._syncedStop),this.context.transport.off("pause",this._syncedStop),this.context.transport.off("loopEnd",this._syncedStop),this.context.transport.off("start",this._syncedStart),this.context.transport.off("loopStart",this._syncedStart)),this._synced=!1,this._scheduled.forEach(e=>this.context.transport.clear(e)),this._scheduled=[],this._state.cancel(0),this._stop(0),this}dispose(){return super.dispose(),this.onstop=be,this.unsync(),this._volume.dispose(),this._state.dispose(),this}}class wu extends Bi{constructor(){const e=ce(wu.getDefaults(),arguments,["url","onload"]);super(e),this.name="ToneBufferSource",this._source=this.context.createBufferSource(),this._internalChannels=[this._source],this._sourceStarted=!1,this._sourceStopped=!1,as(this._source,this._gainNode),this._source.onended=()=>this._stopSource(),this.playbackRate=new Re({context:this.context,param:this._source.playbackRate,units:"positive",value:e.playbackRate}),this.loop=e.loop,this.loopStart=e.loopStart,this.loopEnd=e.loopEnd,this._buffer=new Ne(e.url,e.onload,e.onerror),this._internalChannels.push(this._source)}static getDefaults(){return Object.assign(Bi.getDefaults(),{url:new Ne,loop:!1,loopEnd:0,loopStart:0,onload:be,onerror:be,playbackRate:1})}get fadeIn(){return this._fadeIn}set fadeIn(e){this._fadeIn=e}get fadeOut(){return this._fadeOut}set fadeOut(e){this._fadeOut=e}get curve(){return this._curve}set curve(e){this._curve=e}start(e,n,r,i=1){oe(this.buffer.loaded,"buffer is either not set or not loaded");const s=this.toSeconds(e);this._startGain(s,i),this.loop?n=Ci(n,this.loopStart):n=Ci(n,0);let o=Math.max(this.toSeconds(n),0);if(this.loop){const a=this.toSeconds(this.loopEnd)||this.buffer.duration,c=this.toSeconds(this.loopStart),u=a-c;Ff(o,a)&&(o=(o-c)%u+c),Kt(o,this.buffer.duration)&&(o=0)}if(this._source.buffer=this.buffer.get(),this._source.loopEnd=this.toSeconds(this.loopEnd)||this.buffer.duration,ec(o,this.buffer.duration)&&(this._sourceStarted=!0,this._source.start(s,o)),de(r)){let a=this.toSeconds(r);a=Math.max(a,0),this.stop(s+a)}return this}_stopSource(e){!this._sourceStopped&&this._sourceStarted&&(this._sourceStopped=!0,this._source.stop(this.toSeconds(e)),this._onended())}get loopStart(){return this._source.loopStart}set loopStart(e){this._source.loopStart=this.toSeconds(e)}get loopEnd(){return this._source.loopEnd}set loopEnd(e){this._source.loopEnd=this.toSeconds(e)}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._source.loop}set loop(e){this._source.loop=e,this._sourceStarted&&this.cancelStop()}dispose(){return super.dispose(),this._source.onended=null,this._source.disconnect(),this._buffer.dispose(),this.playbackRate.dispose(),this}}function ei(t,e){return je(this,void 0,void 0,function*(){const n=e/t.context.sampleRate,r=new Ip(1,n,t.context.sampleRate);return new t.constructor(Object.assign(t.get(),{frequency:2/n,detune:0,context:r})).toDestination().start(0),(yield r.render()).getChannelData(0)})}class Wp extends Bi{constructor(){const e=ce(Wp.getDefaults(),arguments,["frequency","type"]);super(e),this.name="ToneOscillatorNode",this._oscillator=this.context.createOscillator(),this._internalChannels=[this._oscillator],as(this._oscillator,this._gainNode),this.type=e.type,this.frequency=new Re({context:this.context,param:this._oscillator.frequency,units:"frequency",value:e.frequency}),this.detune=new Re({context:this.context,param:this._oscillator.detune,units:"cents",value:e.detune}),Fe(this,["frequency","detune"])}static getDefaults(){return Object.assign(Bi.getDefaults(),{detune:0,frequency:440,type:"sine"})}start(e){const n=this.toSeconds(e);return this.log("start",n),this._startGain(n),this._oscillator.start(n),this}_stopSource(e){this._oscillator.stop(e)}setPeriodicWave(e){return this._oscillator.setPeriodicWave(e),this}get type(){return this._oscillator.type}set type(e){this._oscillator.type=e}dispose(){return super.dispose(),this.state==="started"&&this.stop(),this._oscillator.disconnect(),this.frequency.dispose(),this.detune.dispose(),this}}class Le extends Vt{constructor(){const e=ce(Le.getDefaults(),arguments,["frequency","type"]);super(e),this.name="Oscillator",this._oscillator=null,this.frequency=new Xe({context:this.context,units:"frequency",value:e.frequency}),Fe(this,"frequency"),this.detune=new Xe({context:this.context,units:"cents",value:e.detune}),Fe(this,"detune"),this._partials=e.partials,this._partialCount=e.partialCount,this._type=e.type,e.partialCount&&e.type!=="custom"&&(this._type=this.baseType+e.partialCount.toString()),this.phase=e.phase}static getDefaults(){return Object.assign(Vt.getDefaults(),{detune:0,frequency:440,partialCount:0,partials:[],phase:0,type:"sine"})}_start(e){const n=this.toSeconds(e),r=new Wp({context:this.context,onended:()=>this.onstop(this)});this._oscillator=r,this._wave?this._oscillator.setPeriodicWave(this._wave):this._oscillator.type=this._type,this._oscillator.connect(this.output),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.start(n)}_stop(e){const n=this.toSeconds(e);this._oscillator&&this._oscillator.stop(n)}_restart(e){const n=this.toSeconds(e);return this.log("restart",n),this._oscillator&&this._oscillator.cancelStop(),this._state.cancel(n),this}syncFrequency(){return this.context.transport.syncSignal(this.frequency),this}unsyncFrequency(){return this.context.transport.unsyncSignal(this.frequency),this}_getCachedPeriodicWave(){if(this._type==="custom")return Le._periodicWaveCache.find(n=>n.phase===this._phase&&K8(n.partials,this._partials));{const e=Le._periodicWaveCache.find(n=>n.type===this._type&&n.phase===this._phase);return this._partialCount=e?e.partialCount:this._partialCount,e}}get type(){return this._type}set type(e){this._type=e;const n=["sine","square","sawtooth","triangle"].indexOf(e)!==-1;if(this._phase===0&&n)this._wave=void 0,this._partialCount=0,this._oscillator!==null&&(this._oscillator.type=e);else{const r=this._getCachedPeriodicWave();if(de(r)){const{partials:i,wave:s}=r;this._wave=s,this._partials=i,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave)}else{const[i,s]=this._getRealImaginary(e,this._phase),o=this.context.createPeriodicWave(i,s);this._wave=o,this._oscillator!==null&&this._oscillator.setPeriodicWave(this._wave),Le._periodicWaveCache.push({imag:s,partialCount:this._partialCount,partials:this._partials,phase:this._phase,real:i,type:this._type,wave:this._wave}),Le._periodicWaveCache.length>100&&Le._periodicWaveCache.shift()}}}get baseType(){return this._type.replace(this.partialCount.toString(),"")}set baseType(e){this.partialCount&&this._type!=="custom"&&e!=="custom"?this.type=e+this.partialCount:this.type=e}get partialCount(){return this._partialCount}set partialCount(e){hr(e,0);let n=this._type;const r=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(this._type);if(r&&(n=r[1]),this._type!=="custom")e===0?this.type=n:this.type=n+e.toString();else{const i=new Float32Array(e);this._partials.forEach((s,o)=>i[o]=s),this._partials=Array.from(i),this.type=this._type}}_getRealImaginary(e,n){let i=2048;const s=new Float32Array(i),o=new Float32Array(i);let a=1;if(e==="custom"){if(a=this._partials.length+1,this._partialCount=this._partials.length,i=a,this._partials.length===0)return[s,o]}else{const c=/^(sine|triangle|square|sawtooth)(\d+)$/.exec(e);c?(a=parseInt(c[2],10)+1,this._partialCount=parseInt(c[2],10),e=c[1],a=Math.max(a,2),i=a):this._partialCount=0,this._partials=[]}for(let c=1;c<i;++c){const u=2/(c*Math.PI);let l;switch(e){case"sine":l=c<=a?1:0,this._partials[c-1]=l;break;case"square":l=c&1?2*u:0,this._partials[c-1]=l;break;case"sawtooth":l=u*(c&1?1:-1),this._partials[c-1]=l;break;case"triangle":c&1?l=2*(u*u)*(c-1>>1&1?-1:1):l=0,this._partials[c-1]=l;break;case"custom":l=this._partials[c-1];break;default:throw new TypeError("Oscillator: invalid type: "+e)}l!==0?(s[c]=-l*Math.sin(n*c),o[c]=l*Math.cos(n*c)):(s[c]=0,o[c]=0)}return[s,o]}_inverseFFT(e,n,r){let i=0;const s=e.length;for(let o=0;o<s;o++)i+=e[o]*Math.cos(o*r)+n[o]*Math.sin(o*r);return i}getInitialValue(){const[e,n]=this._getRealImaginary(this._type,0);let r=0;const i=Math.PI*2,s=32;for(let o=0;o<s;o++)r=Math.max(this._inverseFFT(e,n,o/s*i),r);return J8(-this._inverseFFT(e,n,this._phase)/r,-1,1)}get partials(){return this._partials.slice(0,this.partialCount)}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this.type="custom")}get phase(){return this._phase*(180/Math.PI)}set phase(e){this._phase=e*Math.PI/180,this.type=this._type}asArray(){return je(this,arguments,void 0,function*(e=1024){return ei(this,e)})}dispose(){return super.dispose(),this._oscillator!==null&&this._oscillator.dispose(),this._wave=void 0,this.frequency.dispose(),this.detune.dispose(),this}}Le._periodicWaveCache=[];class y7 extends Wi{constructor(){super(...arguments),this.name="AudioToGain",this._norm=new ko({context:this.context,mapping:e=>(e+1)/2}),this.input=this._norm,this.output=this._norm}dispose(){return super.dispose(),this._norm.dispose(),this}}class Ui extends Xe{constructor(){const e=ce(Ui.getDefaults(),arguments,["value"]);super(e),this.name="Multiply",this.override=!1,this._mult=this.input=this.output=new at({context:this.context,minValue:e.minValue,maxValue:e.maxValue}),this.factor=this._param=this._mult.gain,this.factor.setValueAtTime(e.value,0)}static getDefaults(){return Object.assign(Xe.getDefaults(),{value:0})}dispose(){return super.dispose(),this._mult.dispose(),this}}class xu extends Vt{constructor(){const e=ce(xu.getDefaults(),arguments,["frequency","type","modulationType"]);super(e),this.name="AMOscillator",this._modulationScale=new y7({context:this.context}),this._modulationNode=new at({context:this.context}),this._carrier=new Le({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.frequency=this._carrier.frequency,this.detune=this._carrier.detune,this._modulator=new Le({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Ui({context:this.context,units:"positive",value:e.harmonicity}),this.frequency.chain(this.harmonicity,this._modulator.frequency),this._modulator.chain(this._modulationScale,this._modulationNode.gain),this._carrier.chain(this._modulationNode,this.output),Fe(this,["frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Le.getDefaults(),{harmonicity:1,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){this._modulator.restart(e),this._carrier.restart(e)}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(){return je(this,arguments,void 0,function*(e=1024){return ei(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this._modulationScale.dispose(),this}}class Tu extends Vt{constructor(){const e=ce(Tu.getDefaults(),arguments,["frequency","type","modulationType"]);super(e),this.name="FMOscillator",this._modulationNode=new at({context:this.context,gain:0}),this._carrier=new Le({context:this.context,detune:e.detune,frequency:0,onstop:()=>this.onstop(this),phase:e.phase,type:e.type}),this.detune=this._carrier.detune,this.frequency=new Xe({context:this.context,units:"frequency",value:e.frequency}),this._modulator=new Le({context:this.context,phase:e.phase,type:e.modulationType}),this.harmonicity=new Ui({context:this.context,units:"positive",value:e.harmonicity}),this.modulationIndex=new Ui({context:this.context,units:"positive",value:e.modulationIndex}),this.frequency.connect(this._carrier.frequency),this.frequency.chain(this.harmonicity,this._modulator.frequency),this.frequency.chain(this.modulationIndex,this._modulationNode),this._modulator.connect(this._modulationNode.gain),this._modulationNode.connect(this._carrier.frequency),this._carrier.connect(this.output),this.detune.connect(this._modulator.detune),Fe(this,["modulationIndex","frequency","detune","harmonicity"])}static getDefaults(){return Object.assign(Le.getDefaults(),{harmonicity:1,modulationIndex:2,modulationType:"square"})}_start(e){this._modulator.start(e),this._carrier.start(e)}_stop(e){this._modulator.stop(e),this._carrier.stop(e)}_restart(e){return this._modulator.restart(e),this._carrier.restart(e),this}get type(){return this._carrier.type}set type(e){this._carrier.type=e}get baseType(){return this._carrier.baseType}set baseType(e){this._carrier.baseType=e}get partialCount(){return this._carrier.partialCount}set partialCount(e){this._carrier.partialCount=e}get modulationType(){return this._modulator.type}set modulationType(e){this._modulator.type=e}get phase(){return this._carrier.phase}set phase(e){this._carrier.phase=e,this._modulator.phase=e}get partials(){return this._carrier.partials}set partials(e){this._carrier.partials=e}asArray(){return je(this,arguments,void 0,function*(e=1024){return ei(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.harmonicity.dispose(),this._carrier.dispose(),this._modulator.dispose(),this._modulationNode.dispose(),this.modulationIndex.dispose(),this}}class Eo extends Vt{constructor(){const e=ce(Eo.getDefaults(),arguments,["frequency","width"]);super(e),this.name="PulseOscillator",this._widthGate=new at({context:this.context,gain:0}),this._thresh=new ko({context:this.context,mapping:n=>n<=0?-1:1}),this.width=new Xe({context:this.context,units:"audioRange",value:e.width}),this._triangle=new Le({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase,type:"triangle"}),this.frequency=this._triangle.frequency,this.detune=this._triangle.detune,this._triangle.chain(this._thresh,this.output),this.width.chain(this._widthGate,this._thresh),Fe(this,["width","frequency","detune"])}static getDefaults(){return Object.assign(Vt.getDefaults(),{detune:0,frequency:440,phase:0,type:"pulse",width:.2})}_start(e){e=this.toSeconds(e),this._triangle.start(e),this._widthGate.gain.setValueAtTime(1,e)}_stop(e){e=this.toSeconds(e),this._triangle.stop(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(0,e)}_restart(e){this._triangle.restart(e),this._widthGate.gain.cancelScheduledValues(e),this._widthGate.gain.setValueAtTime(1,e)}get phase(){return this._triangle.phase}set phase(e){this._triangle.phase=e}get type(){return"pulse"}get baseType(){return"pulse"}get partials(){return[]}get partialCount(){return 0}set carrierType(e){this._triangle.type=e}asArray(){return je(this,arguments,void 0,function*(e=1024){return ei(this,e)})}dispose(){return super.dispose(),this._triangle.dispose(),this.width.dispose(),this._widthGate.dispose(),this._thresh.dispose(),this}}class Su extends Vt{constructor(){const e=ce(Su.getDefaults(),arguments,["frequency","type","spread"]);super(e),this.name="FatOscillator",this._oscillators=[],this.frequency=new Xe({context:this.context,units:"frequency",value:e.frequency}),this.detune=new Xe({context:this.context,units:"cents",value:e.detune}),this._spread=e.spread,this._type=e.type,this._phase=e.phase,this._partials=e.partials,this._partialCount=e.partialCount,this.count=e.count,Fe(this,["frequency","detune"])}static getDefaults(){return Object.assign(Le.getDefaults(),{count:3,spread:20,type:"sawtooth"})}_start(e){e=this.toSeconds(e),this._forEach(n=>n.start(e))}_stop(e){e=this.toSeconds(e),this._forEach(n=>n.stop(e))}_restart(e){this._forEach(n=>n.restart(e))}_forEach(e){for(let n=0;n<this._oscillators.length;n++)e(this._oscillators[n],n)}get type(){return this._type}set type(e){this._type=e,this._forEach(n=>n.type=e)}get spread(){return this._spread}set spread(e){if(this._spread=e,this._oscillators.length>1){const n=-e/2,r=e/(this._oscillators.length-1);this._forEach((i,s)=>i.detune.value=n+r*s)}}get count(){return this._oscillators.length}set count(e){if(hr(e,1),this._oscillators.length!==e){this._forEach(n=>n.dispose()),this._oscillators=[];for(let n=0;n<e;n++){const r=new Le({context:this.context,volume:-6-e*1.1,type:this._type,phase:this._phase+n/e*360,partialCount:this._partialCount,onstop:n===0?()=>this.onstop(this):be});this.type==="custom"&&(r.partials=this._partials),this.frequency.connect(r.frequency),this.detune.connect(r.detune),r.detune.overridden=!1,r.connect(this.output),this._oscillators[n]=r}this.spread=this._spread,this.state==="started"&&this._forEach(n=>n.start())}}get phase(){return this._phase}set phase(e){this._phase=e,this._forEach((n,r)=>n.phase=this._phase+r/this.count*360)}get baseType(){return this._oscillators[0].baseType}set baseType(e){this._forEach(n=>n.baseType=e),this._type=this._oscillators[0].type}get partials(){return this._oscillators[0].partials}set partials(e){this._partials=e,this._partialCount=this._partials.length,e.length&&(this._type="custom",this._forEach(n=>n.partials=e))}get partialCount(){return this._oscillators[0].partialCount}set partialCount(e){this._partialCount=e,this._forEach(n=>n.partialCount=e),this._type=this._oscillators[0].type}asArray(){return je(this,arguments,void 0,function*(e=1024){return ei(this,e)})}dispose(){return super.dispose(),this.frequency.dispose(),this.detune.dispose(),this._forEach(e=>e.dispose()),this}}class Cu extends Vt{constructor(){const e=ce(Cu.getDefaults(),arguments,["frequency","modulationFrequency"]);super(e),this.name="PWMOscillator",this.sourceType="pwm",this._scale=new Ui({context:this.context,value:2}),this._pulse=new Eo({context:this.context,frequency:e.modulationFrequency}),this._pulse.carrierType="sine",this.modulationFrequency=this._pulse.frequency,this._modulator=new Le({context:this.context,detune:e.detune,frequency:e.frequency,onstop:()=>this.onstop(this),phase:e.phase}),this.frequency=this._modulator.frequency,this.detune=this._modulator.detune,this._modulator.chain(this._scale,this._pulse.width),this._pulse.connect(this.output),Fe(this,["modulationFrequency","frequency","detune"])}static getDefaults(){return Object.assign(Vt.getDefaults(),{detune:0,frequency:440,modulationFrequency:.4,phase:0,type:"pwm"})}_start(e){e=this.toSeconds(e),this._modulator.start(e),this._pulse.start(e)}_stop(e){e=this.toSeconds(e),this._modulator.stop(e),this._pulse.stop(e)}_restart(e){this._modulator.restart(e),this._pulse.restart(e)}get type(){return"pwm"}get baseType(){return"pwm"}get partials(){return[]}get partialCount(){return 0}get phase(){return this._modulator.phase}set phase(e){this._modulator.phase=e}asArray(){return je(this,arguments,void 0,function*(e=1024){return ei(this,e)})}dispose(){return super.dispose(),this._pulse.dispose(),this._scale.dispose(),this._modulator.dispose(),this}}const W1={am:xu,fat:Su,fm:Tu,oscillator:Le,pulse:Eo,pwm:Cu};class nc extends Vt{constructor(){const e=ce(nc.getDefaults(),arguments,["frequency","type"]);super(e),this.name="OmniOscillator",this.frequency=new Xe({context:this.context,units:"frequency",value:e.frequency}),this.detune=new Xe({context:this.context,units:"cents",value:e.detune}),Fe(this,["frequency","detune"]),this.set(e)}static getDefaults(){return Object.assign(Le.getDefaults(),Tu.getDefaults(),xu.getDefaults(),Su.getDefaults(),Eo.getDefaults(),Cu.getDefaults())}_start(e){this._oscillator.start(e)}_stop(e){this._oscillator.stop(e)}_restart(e){return this._oscillator.restart(e),this}get type(){let e="";return["am","fm","fat"].some(n=>this._sourceType===n)&&(e=this._sourceType),e+this._oscillator.type}set type(e){e.substr(0,2)==="fm"?(this._createNewOscillator("fm"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,2)==="am"?(this._createNewOscillator("am"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(2)):e.substr(0,3)==="fat"?(this._createNewOscillator("fat"),this._oscillator=this._oscillator,this._oscillator.type=e.substr(3)):e==="pwm"?(this._createNewOscillator("pwm"),this._oscillator=this._oscillator):e==="pulse"?this._createNewOscillator("pulse"):(this._createNewOscillator("oscillator"),this._oscillator=this._oscillator,this._oscillator.type=e)}get partials(){return this._oscillator.partials}set partials(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partials=e)}get partialCount(){return this._oscillator.partialCount}set partialCount(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&(this._oscillator.partialCount=e)}set(e){return Reflect.has(e,"type")&&e.type&&(this.type=e.type),super.set(e),this}_createNewOscillator(e){if(e!==this._sourceType){this._sourceType=e;const n=W1[e],r=this.now();if(this._oscillator){const i=this._oscillator;i.stop(r),this.context.setTimeout(()=>i.dispose(),this.blockTime)}this._oscillator=new n({context:this.context}),this.frequency.connect(this._oscillator.frequency),this.detune.connect(this._oscillator.detune),this._oscillator.connect(this.output),this._oscillator.onstop=()=>this.onstop(this),this.state==="started"&&this._oscillator.start(r)}}get phase(){return this._oscillator.phase}set phase(e){this._oscillator.phase=e}get sourceType(){return this._sourceType}set sourceType(e){let n="sine";this._oscillator.type!=="pwm"&&this._oscillator.type!=="pulse"&&(n=this._oscillator.type),e==="fm"?this.type="fm"+n:e==="am"?this.type="am"+n:e==="fat"?this.type="fat"+n:e==="oscillator"?this.type=n:e==="pulse"?this.type="pulse":e==="pwm"&&(this.type="pwm")}_getOscType(e,n){return e instanceof W1[n]}get baseType(){return this._oscillator.baseType}set baseType(e){!this._getOscType(this._oscillator,"pulse")&&!this._getOscType(this._oscillator,"pwm")&&e!=="pulse"&&e!=="pwm"&&(this._oscillator.baseType=e)}get width(){if(this._getOscType(this._oscillator,"pulse"))return this._oscillator.width}get count(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.count}set count(e){this._getOscType(this._oscillator,"fat")&&lr(e)&&(this._oscillator.count=e)}get spread(){if(this._getOscType(this._oscillator,"fat"))return this._oscillator.spread}set spread(e){this._getOscType(this._oscillator,"fat")&&lr(e)&&(this._oscillator.spread=e)}get modulationType(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.modulationType}set modulationType(e){(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))&&Ln(e)&&(this._oscillator.modulationType=e)}get modulationIndex(){if(this._getOscType(this._oscillator,"fm"))return this._oscillator.modulationIndex}get harmonicity(){if(this._getOscType(this._oscillator,"fm")||this._getOscType(this._oscillator,"am"))return this._oscillator.harmonicity}get modulationFrequency(){if(this._getOscType(this._oscillator,"pwm"))return this._oscillator.modulationFrequency}asArray(){return je(this,arguments,void 0,function*(e=1024){return ei(this,e)})}dispose(){return super.dispose(),this.detune.dispose(),this.frequency.dispose(),this._oscillator.dispose(),this}}function sw(t,e=1/0){const n=new WeakMap;return function(r,i){Reflect.defineProperty(r,i,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(s){hr(s,t,e),n.set(this,s)}})}}function Hn(t,e=1/0){const n=new WeakMap;return function(r,i){Reflect.defineProperty(r,i,{configurable:!0,enumerable:!0,get:function(){return n.get(this)},set:function(s){hr(this.toSeconds(s),t,e),n.set(this,s)}})}}class Mu extends Vt{constructor(){const e=ce(Mu.getDefaults(),arguments,["url","onload"]);super(e),this.name="Player",this._activeSources=new Set,this._buffer=new Ne({onload:this._onload.bind(this,e.onload),onerror:e.onerror,reverse:e.reverse,url:e.url}),this.autostart=e.autostart,this._loop=e.loop,this._loopStart=e.loopStart,this._loopEnd=e.loopEnd,this._playbackRate=e.playbackRate,this.fadeIn=e.fadeIn,this.fadeOut=e.fadeOut}static getDefaults(){return Object.assign(Vt.getDefaults(),{autostart:!1,fadeIn:0,fadeOut:0,loop:!1,loopEnd:0,loopStart:0,onload:be,onerror:be,playbackRate:1,reverse:!1})}load(e){return je(this,void 0,void 0,function*(){return yield this._buffer.load(e),this._onload(),this})}_onload(e=be){e(),this.autostart&&this.start()}_onSourceEnd(e){this.onstop(this),this._activeSources.delete(e),this._activeSources.size===0&&!this._synced&&this._state.getValueAtTime(this.now())==="started"&&(this._state.cancel(this.now()),this._state.setStateAtTime("stopped",this.now()))}start(e,n,r){return super.start(e,n,r),this}_start(e,n,r){this._loop?n=Ci(n,this._loopStart):n=Ci(n,0);const i=this.toSeconds(n),s=r;r=Ci(r,Math.max(this._buffer.duration-i,0));let o=this.toSeconds(r);o=o/this._playbackRate,e=this.toSeconds(e);const a=new wu({url:this._buffer,context:this.context,fadeIn:this.fadeIn,fadeOut:this.fadeOut,loop:this._loop,loopEnd:this._loopEnd,loopStart:this._loopStart,onended:this._onSourceEnd.bind(this),playbackRate:this._playbackRate}).connect(this.output);!this._loop&&!this._synced&&(this._state.cancel(e+o),this._state.setStateAtTime("stopped",e+o,{implicitEnd:!0})),this._activeSources.add(a),this._loop&&Ht(s)?a.start(e,i):a.start(e,i,o-this.toSeconds(this.fadeOut))}_stop(e){const n=this.toSeconds(e);this._activeSources.forEach(r=>r.stop(n))}restart(e,n,r){return super.restart(e,n,r),this}_restart(e,n,r){var i;(i=[...this._activeSources].pop())===null||i===void 0||i.stop(e),this._start(e,n,r)}seek(e,n){const r=this.toSeconds(n);if(this._state.getValueAtTime(r)==="started"){const i=this.toSeconds(e);this._stop(r),this._start(r,i)}return this}setLoopPoints(e,n){return this.loopStart=e,this.loopEnd=n,this}get loopStart(){return this._loopStart}set loopStart(e){this._loopStart=e,this.buffer.loaded&&hr(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(n=>{n.loopStart=e})}get loopEnd(){return this._loopEnd}set loopEnd(e){this._loopEnd=e,this.buffer.loaded&&hr(this.toSeconds(e),0,this.buffer.duration),this._activeSources.forEach(n=>{n.loopEnd=e})}get buffer(){return this._buffer}set buffer(e){this._buffer.set(e)}get loop(){return this._loop}set loop(e){if(this._loop!==e&&(this._loop=e,this._activeSources.forEach(n=>{n.loop=e}),e)){const n=this._state.getNextState("stopped",this.now());n&&this._state.cancel(n.time)}}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e;const n=this.now(),r=this._state.getNextState("stopped",n);r&&r.implicitEnd&&(this._state.cancel(r.time),this._activeSources.forEach(i=>i.cancelStop())),this._activeSources.forEach(i=>{i.playbackRate.setValueAtTime(e,n)})}get reverse(){return this._buffer.reverse}set reverse(e){this._buffer.reverse=e}get loaded(){return this._buffer.loaded}dispose(){return super.dispose(),this._activeSources.forEach(e=>e.dispose()),this._activeSources.clear(),this._buffer.dispose(),this}}on([Hn(0)],Mu.prototype,"fadeIn",void 0);on([Hn(0)],Mu.prototype,"fadeOut",void 0);class wr extends fe{constructor(){const e=ce(wr.getDefaults(),arguments,["attack","decay","sustain","release"]);super(e),this.name="Envelope",this._sig=new Xe({context:this.context,value:0}),this.output=this._sig,this.input=void 0,this.attack=e.attack,this.decay=e.decay,this.sustain=e.sustain,this.release=e.release,this.attackCurve=e.attackCurve,this.releaseCurve=e.releaseCurve,this.decayCurve=e.decayCurve}static getDefaults(){return Object.assign(fe.getDefaults(),{attack:.01,attackCurve:"linear",decay:.1,decayCurve:"exponential",release:1,releaseCurve:"exponential",sustain:.5})}get value(){return this.getValueAtTime(this.now())}_getCurve(e,n){if(Ln(e))return e;{let r;for(r in Qo)if(Qo[r][n]===e)return r;return e}}_setCurve(e,n,r){if(Ln(r)&&Reflect.has(Qo,r)){const i=Qo[r];Or(i)?e!=="_decayCurve"&&(this[e]=i[n]):this[e]=i}else if($t(r)&&e!=="_decayCurve")this[e]=r;else throw new Error("Envelope: invalid curve: "+r)}get attackCurve(){return this._getCurve(this._attackCurve,"In")}set attackCurve(e){this._setCurve("_attackCurve","In",e)}get releaseCurve(){return this._getCurve(this._releaseCurve,"Out")}set releaseCurve(e){this._setCurve("_releaseCurve","Out",e)}get decayCurve(){return this._getCurve(this._decayCurve,"Out")}set decayCurve(e){this._setCurve("_decayCurve","Out",e)}triggerAttack(e,n=1){this.log("triggerAttack",e,n),e=this.toSeconds(e);let i=this.toSeconds(this.attack);const s=this.toSeconds(this.decay),o=this.getValueAtTime(e);if(o>0){const a=1/i;i=(1-o)/a}if(i<this.sampleTime)this._sig.cancelScheduledValues(e),this._sig.setValueAtTime(n,e);else if(this._attackCurve==="linear")this._sig.linearRampTo(n,i,e);else if(this._attackCurve==="exponential")this._sig.targetRampTo(n,i,e);else{this._sig.cancelAndHoldAtTime(e);let a=this._attackCurve;for(let c=1;c<a.length;c++)if(a[c-1]<=o&&o<=a[c]){a=this._attackCurve.slice(c),a[0]=o;break}this._sig.setValueCurveAtTime(a,e,i,n)}if(s&&this.sustain<1){const a=n*this.sustain,c=e+i;this.log("decay",c),this._decayCurve==="linear"?this._sig.linearRampToValueAtTime(a,s+c):this._sig.exponentialApproachValueAtTime(a,c,s)}return this}triggerRelease(e){this.log("triggerRelease",e),e=this.toSeconds(e);const n=this.getValueAtTime(e);if(n>0){const r=this.toSeconds(this.release);r<this.sampleTime?this._sig.setValueAtTime(0,e):this._releaseCurve==="linear"?this._sig.linearRampTo(0,r,e):this._releaseCurve==="exponential"?this._sig.targetRampTo(0,r,e):(oe($t(this._releaseCurve),"releaseCurve must be either 'linear', 'exponential' or an array"),this._sig.cancelAndHoldAtTime(e),this._sig.setValueCurveAtTime(this._releaseCurve,e,r,n))}return this}getValueAtTime(e){return this._sig.getValueAtTime(e)}triggerAttackRelease(e,n,r=1){return n=this.toSeconds(n),this.triggerAttack(n,r),this.triggerRelease(n+this.toSeconds(e)),this}cancel(e){return this._sig.cancelScheduledValues(this.toSeconds(e)),this}connect(e,n=0,r=0){return qp(this,e,n,r),this}asArray(){return je(this,arguments,void 0,function*(e=1024){const n=e/this.context.sampleRate,r=new Ip(1,n,this.context.sampleRate),i=this.toSeconds(this.attack)+this.toSeconds(this.decay),s=i+this.toSeconds(this.release),o=s*.1,a=s+o,c=new this.constructor(Object.assign(this.get(),{attack:n*this.toSeconds(this.attack)/a,decay:n*this.toSeconds(this.decay)/a,release:n*this.toSeconds(this.release)/a,context:r}));return c._sig.toDestination(),c.triggerAttackRelease(n*(i+o)/a,0),(yield r.render()).getChannelData(0)})}dispose(){return super.dispose(),this._sig.dispose(),this}}on([Hn(0)],wr.prototype,"attack",void 0);on([Hn(0)],wr.prototype,"decay",void 0);on([sw(0,1)],wr.prototype,"sustain",void 0);on([Hn(0)],wr.prototype,"release",void 0);const Qo=(()=>{let e,n;const r=[];for(e=0;e<128;e++)r[e]=Math.sin(e/127*(Math.PI/2));const i=[],s=6.4;for(e=0;e<127;e++){n=e/127;const f=Math.sin(n*(Math.PI*2)*s-Math.PI/2)+1;i[e]=f/10+n*.83}i[127]=1;const o=[],a=5;for(e=0;e<128;e++)o[e]=Math.ceil(e/127*a)/a;const c=[];for(e=0;e<128;e++)n=e/127,c[e]=.5*(1-Math.cos(Math.PI*n));const u=[];for(e=0;e<128;e++){n=e/127;const f=Math.pow(n,3)*4+.2,d=Math.cos(f*Math.PI*2*n);u[e]=Math.abs(d*(1-n))}function l(f){const d=new Array(f.length);for(let p=0;p<f.length;p++)d[p]=1-f[p];return d}function h(f){return f.slice(0).reverse()}return{bounce:{In:l(u),Out:u},cosine:{In:r,Out:h(r)},exponential:"exponential",linear:"linear",ripple:{In:i,Out:l(i)},sine:{In:c,Out:l(c)},step:{In:o,Out:l(o)}}})();class dr extends fe{constructor(){const e=ce(dr.getDefaults(),arguments);super(e),this._scheduledEvents=[],this._synced=!1,this._original_triggerAttack=this.triggerAttack,this._original_triggerRelease=this.triggerRelease,this._syncedRelease=n=>this._original_triggerRelease(n),this._volume=this.output=new cs({context:this.context,volume:e.volume}),this.volume=this._volume.volume,Fe(this,"volume")}static getDefaults(){return Object.assign(fe.getDefaults(),{volume:0})}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",0),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}_syncState(){let e=!1;return this._synced||(this._synced=!0,e=!0),e}_syncMethod(e,n){const r=this["_original_"+e]=this[e];this[e]=(...i)=>{const s=i[n],o=this.context.transport.schedule(a=>{i[n]=a,r.apply(this,i)},s);this._scheduledEvents.push(o)}}unsync(){return this._scheduledEvents.forEach(e=>this.context.transport.clear(e)),this._scheduledEvents=[],this._synced&&(this._synced=!1,this.triggerAttack=this._original_triggerAttack,this.triggerRelease=this._original_triggerRelease,this.context.transport.off("stop",this._syncedRelease),this.context.transport.off("pause",this._syncedRelease),this.context.transport.off("loopEnd",this._syncedRelease)),this}triggerAttackRelease(e,n,r,i){const s=this.toSeconds(r),o=this.toSeconds(n);return this.triggerAttack(e,s,i),this.triggerRelease(s+o),this}dispose(){return super.dispose(),this._volume.dispose(),this.unsync(),this._scheduledEvents=[],this}}class Wr extends dr{constructor(){const e=ce(Wr.getDefaults(),arguments);super(e),this.portamento=e.portamento,this.onsilence=e.onsilence}static getDefaults(){return Object.assign(dr.getDefaults(),{detune:0,onsilence:be,portamento:0})}triggerAttack(e,n,r=1){this.log("triggerAttack",e,n,r);const i=this.toSeconds(n);return this._triggerEnvelopeAttack(i,r),this.setNote(e,i),this}triggerRelease(e){this.log("triggerRelease",e);const n=this.toSeconds(e);return this._triggerEnvelopeRelease(n),this}setNote(e,n){const r=this.toSeconds(n),i=e instanceof kt?e.toFrequency():e;if(this.portamento>0&&this.getLevelAtTime(r)>.05){const s=this.toSeconds(this.portamento);this.frequency.exponentialRampTo(i,s,r)}else this.frequency.setValueAtTime(i,r);return this}}on([Hn(0)],Wr.prototype,"portamento",void 0);class Up extends wr{constructor(){super(ce(Up.getDefaults(),arguments,["attack","decay","sustain","release"])),this.name="AmplitudeEnvelope",this._gainNode=new at({context:this.context,gain:0}),this.output=this._gainNode,this.input=this._gainNode,this._sig.connect(this._gainNode.gain),this.output=this._gainNode,this.input=this._gainNode}dispose(){return super.dispose(),this._gainNode.dispose(),this}}class Gi extends Wr{constructor(){const e=ce(Gi.getDefaults(),arguments);super(e),this.name="Synth",this.oscillator=new nc(Object.assign({context:this.context,detune:e.detune,onstop:()=>this.onsilence(this)},e.oscillator)),this.frequency=this.oscillator.frequency,this.detune=this.oscillator.detune,this.envelope=new Up(Object.assign({context:this.context},e.envelope)),this.oscillator.chain(this.envelope,this.output),Fe(this,["oscillator","frequency","detune","envelope"])}static getDefaults(){return Object.assign(Wr.getDefaults(),{envelope:Object.assign(qf(wr.getDefaults(),Object.keys(fe.getDefaults())),{attack:.005,decay:.1,release:1,sustain:.3}),oscillator:Object.assign(qf(nc.getDefaults(),[...Object.keys(Vt.getDefaults()),"frequency","detune"]),{type:"triangle"})})}_triggerEnvelopeAttack(e,n){if(this.envelope.triggerAttack(e,n),this.oscillator.start(e),this.envelope.sustain===0){const r=this.toSeconds(this.envelope.attack),i=this.toSeconds(this.envelope.decay);this.oscillator.stop(e+r+i)}}_triggerEnvelopeRelease(e){this.envelope.triggerRelease(e),this.oscillator.stop(e+this.toSeconds(this.envelope.release))}getLevelAtTime(e){return e=this.toSeconds(e),this.envelope.getValueAtTime(e)}dispose(){return super.dispose(),this.oscillator.dispose(),this.envelope.dispose(),this}}class Au extends Gi{constructor(){const e=ce(Au.getDefaults(),arguments);super(e),this.name="MembraneSynth",this.portamento=0,this.pitchDecay=e.pitchDecay,this.octaves=e.octaves,Fe(this,["oscillator","envelope"])}static getDefaults(){return Dr(Wr.getDefaults(),Gi.getDefaults(),{envelope:{attack:.001,attackCurve:"exponential",decay:.4,release:1.4,sustain:.01},octaves:10,oscillator:{type:"sine"},pitchDecay:.05})}setNote(e,n){const r=this.toSeconds(n),i=this.toFrequency(e instanceof kt?e.toFrequency():e),s=i*this.octaves;return this.oscillator.frequency.setValueAtTime(s,r),this.oscillator.frequency.exponentialRampToValueAtTime(i,r+this.toSeconds(this.pitchDecay)),this}dispose(){return super.dispose(),this}}on([sw(0)],Au.prototype,"octaves",void 0);on([Hn(0)],Au.prototype,"pitchDecay",void 0);const ow=new Set;function Gp(t){ow.add(t)}function aw(t,e){const n=`registerProcessor("${t}", ${e})`;ow.add(n)}const v7=`
	/**
	 * The base AudioWorkletProcessor for use in Tone.js. Works with the {@link ToneAudioWorklet}. 
	 */
	class ToneAudioWorkletProcessor extends AudioWorkletProcessor {

		constructor(options) {
			
			super(options);
			/**
			 * If the processor was disposed or not. Keep alive until it's disposed.
			 */
			this.disposed = false;
		   	/** 
			 * The number of samples in the processing block
			 */
			this.blockSize = 128;
			/**
			 * the sample rate
			 */
			this.sampleRate = sampleRate;

			this.port.onmessage = (event) => {
				// when it receives a dispose 
				if (event.data === "dispose") {
					this.disposed = true;
				}
			};
		}
	}
`;Gp(v7);const b7=`
	/**
	 * Abstract class for a single input/output processor. 
	 * has a 'generate' function which processes one sample at a time
	 */
	class SingleIOProcessor extends ToneAudioWorkletProcessor {

		constructor(options) {
			super(Object.assign(options, {
				numberOfInputs: 1,
				numberOfOutputs: 1
			}));
			/**
			 * Holds the name of the parameter and a single value of that
			 * parameter at the current sample
			 * @type { [name: string]: number }
			 */
			this.params = {}
		}

		/**
		 * Generate an output sample from the input sample and parameters
		 * @abstract
		 * @param input number
		 * @param channel number
		 * @param parameters { [name: string]: number }
		 * @returns number
		 */
		generate(){}

		/**
		 * Update the private params object with the 
		 * values of the parameters at the given index
		 * @param parameters { [name: string]: Float32Array },
		 * @param index number
		 */
		updateParams(parameters, index) {
			for (const paramName in parameters) {
				const param = parameters[paramName];
				if (param.length > 1) {
					this.params[paramName] = parameters[paramName][index];
				} else {
					this.params[paramName] = parameters[paramName][0];
				}
			}
		}

		/**
		 * Process a single frame of the audio
		 * @param inputs Float32Array[][]
		 * @param outputs Float32Array[][]
		 */
		process(inputs, outputs, parameters) {
			const input = inputs[0];
			const output = outputs[0];
			// get the parameter values
			const channelCount = Math.max(input && input.length || 0, output.length);
			for (let sample = 0; sample < this.blockSize; sample++) {
				this.updateParams(parameters, sample);
				for (let channel = 0; channel < channelCount; channel++) {
					const inputSample = input && input.length ? input[channel][sample] : 0;
					output[channel][sample] = this.generate(inputSample, channel, this.params);
				}
			}
			return !this.disposed;
		}
	};
`;Gp(b7);const w7=`
	/**
	 * A multichannel buffer for use within an AudioWorkletProcessor as a delay line
	 */
	class DelayLine {
		
		constructor(size, channels) {
			this.buffer = [];
			this.writeHead = []
			this.size = size;

			// create the empty channels
			for (let i = 0; i < channels; i++) {
				this.buffer[i] = new Float32Array(this.size);
				this.writeHead[i] = 0;
			}
		}

		/**
		 * Push a value onto the end
		 * @param channel number
		 * @param value number
		 */
		push(channel, value) {
			this.writeHead[channel] += 1;
			if (this.writeHead[channel] > this.size) {
				this.writeHead[channel] = 0;
			}
			this.buffer[channel][this.writeHead[channel]] = value;
		}

		/**
		 * Get the recorded value of the channel given the delay
		 * @param channel number
		 * @param delay number delay samples
		 */
		get(channel, delay) {
			let readHead = this.writeHead[channel] - Math.floor(delay);
			if (readHead < 0) {
				readHead += this.size;
			}
			return this.buffer[channel][readHead];
		}
	}
`;Gp(w7);const x7="feedback-comb-filter",T7=`
	class FeedbackCombFilterWorklet extends SingleIOProcessor {

		constructor(options) {
			super(options);
			this.delayLine = new DelayLine(this.sampleRate, options.channelCount || 2);
		}

		static get parameterDescriptors() {
			return [{
				name: "delayTime",
				defaultValue: 0.1,
				minValue: 0,
				maxValue: 1,
				automationRate: "k-rate"
			}, {
				name: "feedback",
				defaultValue: 0.5,
				minValue: 0,
				maxValue: 0.9999,
				automationRate: "k-rate"
			}];
		}

		generate(input, channel, parameters) {
			const delayedSample = this.delayLine.get(channel, parameters.delayTime * this.sampleRate);
			this.delayLine.push(channel, input + delayedSample * parameters.feedback);
			return delayedSample;
		}
	}
`;aw(x7,T7);class Hp extends dr{constructor(){const e=ce(Hp.getDefaults(),arguments,["voice","options"]);super(e),this.name="PolySynth",this._availableVoices=[],this._activeVoices=[],this._voices=[],this._gcTimeout=-1,this._averageActiveVoices=0,this._syncedRelease=i=>this.releaseAll(i),oe(!lr(e.voice),"DEPRECATED: The polyphony count is no longer the first argument.");const n=e.voice.getDefaults();this.options=Object.assign(n,e.options),this.voice=e.voice,this.maxPolyphony=e.maxPolyphony,this._dummyVoice=this._getNextAvailableVoice();const r=this._voices.indexOf(this._dummyVoice);this._voices.splice(r,1),this._gcTimeout=this.context.setInterval(this._collectGarbage.bind(this),1)}static getDefaults(){return Object.assign(dr.getDefaults(),{maxPolyphony:32,options:{},voice:Gi})}get activeVoices(){return this._activeVoices.length}_makeVoiceAvailable(e){this._availableVoices.push(e);const n=this._activeVoices.findIndex(r=>r.voice===e);this._activeVoices.splice(n,1)}_getNextAvailableVoice(){if(this._availableVoices.length)return this._availableVoices.shift();if(this._voices.length<this.maxPolyphony){const e=new this.voice(Object.assign(this.options,{context:this.context,onsilence:this._makeVoiceAvailable.bind(this)}));return oe(e instanceof Wr,"Voice must extend Monophonic class"),e.connect(this.output),this._voices.push(e),e}else mu("Max polyphony exceeded. Note dropped.")}_collectGarbage(){if(this._averageActiveVoices=Math.max(this._averageActiveVoices*.95,this.activeVoices),this._availableVoices.length&&this._voices.length>Math.ceil(this._averageActiveVoices+1)){const e=this._availableVoices.shift(),n=this._voices.indexOf(e);this._voices.splice(n,1),this.context.isOffline||e.dispose()}}_triggerAttack(e,n,r){e.forEach(i=>{const s=new tc(this.context,i).toMidi(),o=this._getNextAvailableVoice();o&&(o.triggerAttack(i,n,r),this._activeVoices.push({midi:s,voice:o,released:!1}),this.log("triggerAttack",i,n))})}_triggerRelease(e,n){e.forEach(r=>{const i=new tc(this.context,r).toMidi(),s=this._activeVoices.find(({midi:o,released:a})=>o===i&&!a);s&&(s.voice.triggerRelease(n),s.released=!0,this.log("triggerRelease",r,n))})}_scheduleEvent(e,n,r,i){oe(!this.disposed,"Synth was already disposed"),r<=this.now()?e==="attack"?this._triggerAttack(n,r,i):this._triggerRelease(n,r):this.context.setTimeout(()=>{this.disposed||this._scheduleEvent(e,n,r,i)},r-this.now())}triggerAttack(e,n,r){Array.isArray(e)||(e=[e]);const i=this.toSeconds(n);return this._scheduleEvent("attack",e,i,r),this}triggerRelease(e,n){Array.isArray(e)||(e=[e]);const r=this.toSeconds(n);return this._scheduleEvent("release",e,r),this}triggerAttackRelease(e,n,r,i){const s=this.toSeconds(r);if(this.triggerAttack(e,s,i),$t(n)){oe($t(e),"If the duration is an array, the notes must also be an array"),e=e;for(let o=0;o<e.length;o++){const a=n[Math.min(o,n.length-1)],c=this.toSeconds(a);oe(c>0,"The duration must be greater than 0"),this.triggerRelease(e[o],s+c)}}else{const o=this.toSeconds(n);oe(o>0,"The duration must be greater than 0"),this.triggerRelease(e,s+o)}return this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1),this.context.transport.on("stop",this._syncedRelease),this.context.transport.on("pause",this._syncedRelease),this.context.transport.on("loopEnd",this._syncedRelease)),this}set(e){const n=qf(e,["onsilence","context"]);return this.options=Dr(this.options,n),this._voices.forEach(r=>r.set(n)),this._dummyVoice.set(n),this}get(){return this._dummyVoice.get()}releaseAll(e){const n=this.toSeconds(e);return this._activeVoices.forEach(({voice:r})=>{r.triggerRelease(n)}),this}dispose(){return super.dispose(),this._dummyVoice.dispose(),this._voices.forEach(e=>e.dispose()),this._activeVoices=[],this._availableVoices=[],this.context.clearInterval(this._gcTimeout),this}}class Nu extends dr{constructor(){const e=ce(Nu.getDefaults(),arguments,["urls","onload","baseUrl"],"urls");super(e),this.name="Sampler",this._activeSources=new Map;const n={};Object.keys(e.urls).forEach(r=>{const i=parseInt(r,10);if(oe(Ko(r)||lr(i)&&isFinite(i),`url key is neither a note or midi pitch: ${r}`),Ko(r)){const s=new kt(this.context,r).toMidi();n[s]=e.urls[r]}else lr(i)&&isFinite(i)&&(n[i]=e.urls[i])}),this._buffers=new jp({urls:n,onload:e.onload,baseUrl:e.baseUrl,onerror:e.onerror}),this.attack=e.attack,this.release=e.release,this.curve=e.curve,this._buffers.loaded&&Promise.resolve().then(e.onload)}static getDefaults(){return Object.assign(dr.getDefaults(),{attack:0,baseUrl:"",curve:"exponential",onload:be,onerror:be,release:.1,urls:{}})}_findClosest(e){let r=0;for(;r<96;){if(this._buffers.has(e+r))return-r;if(this._buffers.has(e-r))return r;r++}throw new Error(`No available buffers for note: ${e}`)}triggerAttack(e,n,r=1){return this.log("triggerAttack",e,n,r),Array.isArray(e)||(e=[e]),e.forEach(i=>{const s=rw(new kt(this.context,i).toFrequency()),o=Math.round(s),a=s-o,c=this._findClosest(o),u=o-c,l=this._buffers.get(u),h=nw(c+a),f=new wu({url:l,context:this.context,curve:this.curve,fadeIn:this.attack,fadeOut:this.release,playbackRate:h}).connect(this.output);f.start(n,0,l.duration/h,r),$t(this._activeSources.get(o))||this._activeSources.set(o,[]),this._activeSources.get(o).push(f),f.onended=()=>{if(this._activeSources&&this._activeSources.has(o)){const d=this._activeSources.get(o),p=d.indexOf(f);p!==-1&&d.splice(p,1)}}}),this}triggerRelease(e,n){return this.log("triggerRelease",e,n),Array.isArray(e)||(e=[e]),e.forEach(r=>{const i=new kt(this.context,r).toMidi();if(this._activeSources.has(i)&&this._activeSources.get(i).length){const s=this._activeSources.get(i);n=this.toSeconds(n),s.forEach(o=>{o.stop(n)}),this._activeSources.set(i,[])}}),this}releaseAll(e){const n=this.toSeconds(e);return this._activeSources.forEach(r=>{for(;r.length;)r.shift().stop(n)}),this}sync(){return this._syncState()&&(this._syncMethod("triggerAttack",1),this._syncMethod("triggerRelease",1)),this}triggerAttackRelease(e,n,r,i=1){const s=this.toSeconds(r);return this.triggerAttack(e,s,i),$t(n)?(oe($t(e),"notes must be an array when duration is array"),e.forEach((o,a)=>{const c=n[Math.min(a,n.length-1)];this.triggerRelease(o,s+this.toSeconds(c))})):this.triggerRelease(e,s+this.toSeconds(n)),this}add(e,n,r){if(oe(Ko(e)||isFinite(e),`note must be a pitch or midi: ${e}`),Ko(e)){const i=new kt(this.context,e).toMidi();this._buffers.add(i,n,r)}else this._buffers.add(e,n,r);return this}get loaded(){return this._buffers.loaded}dispose(){return super.dispose(),this._buffers.dispose(),this._activeSources.forEach(e=>{e.forEach(n=>n.dispose())}),this._activeSources.clear(),this}}on([Hn(0)],Nu.prototype,"attack",void 0);on([Hn(0)],Nu.prototype,"release",void 0);class Yp extends fe{constructor(){const e=ce(Yp.getDefaults(),arguments,["pan"]);super(e),this.name="Panner",this._panner=this.context.createStereoPanner(),this.input=this._panner,this.output=this._panner,this.pan=new Re({context:this.context,param:this._panner.pan,value:e.pan,minValue:-1,maxValue:1}),this._panner.channelCount=e.channelCount,this._panner.channelCountMode="explicit",Fe(this,"pan")}static getDefaults(){return Object.assign(fe.getDefaults(),{pan:0,channelCount:1})}dispose(){return super.dispose(),this._panner.disconnect(),this.pan.dispose(),this}}const S7="bit-crusher",C7=`
	class BitCrusherWorklet extends SingleIOProcessor {

		static get parameterDescriptors() {
			return [{
				name: "bits",
				defaultValue: 12,
				minValue: 1,
				maxValue: 16,
				automationRate: 'k-rate'
			}];
		}

		generate(input, _channel, parameters) {
			const step = Math.pow(0.5, parameters.bits - 1);
			const val = step * Math.floor(input / step + 0.5);
			return val;
		}
	}
`;aw(S7,C7);class Ve extends fe{constructor(){const e=ce(Ve.getDefaults(),arguments,["solo"]);super(e),this.name="Solo",this.input=this.output=new at({context:this.context}),Ve._allSolos.has(this.context)||Ve._allSolos.set(this.context,new Set),Ve._allSolos.get(this.context).add(this),this.solo=e.solo}static getDefaults(){return Object.assign(fe.getDefaults(),{solo:!1})}get solo(){return this._isSoloed()}set solo(e){e?this._addSolo():this._removeSolo(),Ve._allSolos.get(this.context).forEach(n=>n._updateSolo())}get muted(){return this.input.gain.value===0}_addSolo(){Ve._soloed.has(this.context)||Ve._soloed.set(this.context,new Set),Ve._soloed.get(this.context).add(this)}_removeSolo(){Ve._soloed.has(this.context)&&Ve._soloed.get(this.context).delete(this)}_isSoloed(){return Ve._soloed.has(this.context)&&Ve._soloed.get(this.context).has(this)}_noSolos(){return!Ve._soloed.has(this.context)||Ve._soloed.has(this.context)&&Ve._soloed.get(this.context).size===0}_updateSolo(){this._isSoloed()?this.input.gain.value=1:this._noSolos()?this.input.gain.value=1:this.input.gain.value=0}dispose(){return super.dispose(),Ve._allSolos.get(this.context).delete(this),this._removeSolo(),this}}Ve._allSolos=new Map;Ve._soloed=new Map;class Xp extends fe{constructor(){const e=ce(Xp.getDefaults(),arguments,["pan","volume"]);super(e),this.name="PanVol",this._panner=this.input=new Yp({context:this.context,pan:e.pan,channelCount:e.channelCount}),this.pan=this._panner.pan,this._volume=this.output=new cs({context:this.context,volume:e.volume}),this.volume=this._volume.volume,this._panner.connect(this._volume),this.mute=e.mute,Fe(this,["pan","volume"])}static getDefaults(){return Object.assign(fe.getDefaults(),{mute:!1,pan:0,volume:0,channelCount:1})}get mute(){return this._volume.mute}set mute(e){this._volume.mute=e}dispose(){return super.dispose(),this._panner.dispose(),this.pan.dispose(),this._volume.dispose(),this.volume.dispose(),this}}class vi extends fe{constructor(){const e=ce(vi.getDefaults(),arguments,["volume","pan"]);super(e),this.name="Channel",this._solo=this.input=new Ve({solo:e.solo,context:this.context}),this._panVol=this.output=new Xp({context:this.context,pan:e.pan,volume:e.volume,mute:e.mute,channelCount:e.channelCount}),this.pan=this._panVol.pan,this.volume=this._panVol.volume,this._solo.connect(this._panVol),Fe(this,["pan","volume"])}static getDefaults(){return Object.assign(fe.getDefaults(),{pan:0,volume:0,mute:!1,solo:!1,channelCount:1})}get solo(){return this._solo.solo}set solo(e){this._solo.solo=e}get muted(){return this._solo.muted||this.mute}get mute(){return this._panVol.mute}set mute(e){this._panVol.mute=e}_getBus(e){return vi.buses.has(e)||vi.buses.set(e,new at({context:this.context})),vi.buses.get(e)}send(e,n=0){const r=this._getBus(e),i=new at({context:this.context,units:"decibels",gain:n});return this.connect(i),i.connect(r),i}receive(e){return this._getBus(e).connect(this),this}dispose(){return super.dispose(),this._panVol.dispose(),this.pan.dispose(),this.volume.dispose(),this._solo.dispose(),this}}vi.buses=new Map;Ft().transport;Ft().destination;Ft().destination;Ft().listener;Ft().draw;Ft();const M7=["C","C#","D","D#","E","F","F#","G","G#","A","A#","B"],A7={z:0,x:2,c:4,v:5,b:7,n:9,m:11,s:1,d:3,g:6,h:8,j:10};function N7({onNotePlay:t,enabled:e=!0,startOctave:n=4,octaveCount:r=2}){const[i,s]=G.useState(!1),[o,a]=G.useState(new Set),c=G.useRef(null);G.useEffect(()=>((async()=>{try{c.current=new Hp(Gi,{oscillator:{type:"triangle"},envelope:{attack:.005,decay:.1,sustain:.3,release:1}}).toDestination(),s(!0)}catch(g){console.error("Failed to initialize audio:",g)}})(),()=>{c.current&&c.current.dispose()}),[]);const u=(p,g)=>(p+1)*12+g,l=p=>{const g=p%12,m=Math.floor(p/12)-1;return`${M7[g]}${m}`},h=G.useCallback(async p=>{if(!e||!c.current)return;Ft().state!=="running"&&await i7();const g=l(p),m=h7(p,"midi").toFrequency();c.current.triggerAttackRelease(m,"8n"),a(_=>new Set(_).add(p)),setTimeout(()=>{a(_=>{const b=new Set(_);return b.delete(p),b})},200),t(p,g)},[e,t]);G.useEffect(()=>{if(!e)return;const p=g=>{if(g.repeat)return;const m=g.key.toLowerCase(),_=A7[m];if(_!==void 0){const b=n+Math.floor(r/2),v=u(b,_);h(v),g.preventDefault()}};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[e,n,r,h]);const f=p=>{const g=[{note:0,name:"C"},{note:2,name:"D"},{note:4,name:"E"},{note:5,name:"F"},{note:7,name:"G"},{note:9,name:"A"},{note:11,name:"B"}],m=[{note:1,name:"C#",position:0},{note:3,name:"D#",position:1},{note:6,name:"F#",position:3},{note:8,name:"G#",position:4},{note:10,name:"A#",position:5}],_=48,b=32;return P.jsxs("div",{className:"relative inline-block",children:[P.jsx("div",{className:"flex",children:g.map(({note:v,name:y})=>{const w=u(p,v),x=`${y}${p}`,C=o.has(w);return P.jsx("button",{onClick:()=>void h(w),disabled:!e,className:`h-40 border border-gray-400 flex flex-col items-center justify-end pb-2 disabled:opacity-50 transition-colors ${C?"bg-blue-200":"bg-white hover:bg-gray-50"}`,style:{width:`${_}px`},children:P.jsx("span",{className:"text-xs font-medium text-gray-700",children:x})},`${p}-${v}`)})}),P.jsx("div",{className:"absolute top-0 left-0 right-0 h-24 pointer-events-none",children:m.map(({note:v,name:y,position:w})=>{const x=u(p,v),C=`${y}${p}`,S=o.has(x),A=w*_+_-b/2;return P.jsx("button",{onClick:()=>void h(x),disabled:!e,className:`absolute h-24 border border-gray-800 pointer-events-auto disabled:opacity-50 transition-colors ${S?"bg-gray-600":"bg-black hover:bg-gray-800"}`,style:{width:`${b}px`,left:`${A}px`},children:P.jsx("span",{className:"text-[10px] font-medium text-gray-300 block mt-auto mb-1",children:C})},`${p}-${v}`)})})]},p)},d=Array.from({length:r},(p,g)=>n+g);return P.jsxs(Md,{className:"w-full",children:[P.jsxs(py,{className:"pb-3",children:[P.jsxs("div",{className:"flex items-center justify-between",children:[P.jsxs("div",{className:"flex items-center gap-2",children:[P.jsx(_T,{className:"h-5 w-5"}),P.jsx(my,{className:"text-lg",children:"Virtual Keyboard"})]}),P.jsxs("div",{className:"flex gap-2",children:[P.jsx(Ni,{variant:i?"default":"secondary",children:i?"Audio Ready":"Loading Audio"}),P.jsx(Ni,{variant:e?"default":"secondary",children:e?"Active":"Disabled"})]})]}),P.jsx("p",{className:"text-sm text-muted-foreground mt-2",children:"Click keys or use computer keyboard: Z-M for white keys, S-D-G-H-J for black keys"})]}),P.jsx(Ad,{children:P.jsx("div",{className:"flex overflow-x-auto pb-2",children:d.map(p=>f(p))})})]})}function k7({timeLeft:t,maxTime:e}){const n=t/e*100,r=52,i=2*Math.PI*r,s=i-n/100*i,o=n<30,a=n<60&&n>=30;return P.jsxs("div",{className:"relative",children:[P.jsxs("svg",{width:"130",height:"130",viewBox:"0 0 130 130",className:"transform -rotate-90",children:[P.jsx("circle",{cx:"65",cy:"65",r,fill:"none",stroke:"currentColor",strokeWidth:"10",className:"text-muted/30"}),P.jsx("circle",{cx:"65",cy:"65",r,fill:"none",stroke:"currentColor",strokeWidth:"10",strokeDasharray:i,strokeDashoffset:s,strokeLinecap:"round",className:`transition-all duration-100 ${o?"text-red-500":a?"text-amber-500":"text-emerald-500"}`})]}),P.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:P.jsxs("div",{className:"text-center",children:[P.jsx("div",{className:`text-3xl font-bold tabular-nums ${o?"text-red-500 animate-pulse":""}`,children:Math.ceil(t)}),P.jsx("div",{className:"text-xs text-muted-foreground uppercase tracking-wider",children:"sec"})]})})]})}function E7({lives:t,maxLives:e=3,className:n=""}){return P.jsxs("div",{className:`flex items-center gap-1 ${n}`,children:[[...Array(e)].map((r,i)=>{const s=i<t,o=t===1&&i===0;return P.jsx(Bt.div,{initial:{scale:1},animate:{scale:o?[1,1.2,1]:1,rotate:o?[0,-10,10,0]:0},transition:{duration:.5,repeat:o?1/0:0,repeatDelay:.5},children:P.jsx(Cd,{mode:"wait",children:s?P.jsx(Bt.div,{initial:{scale:1},exit:{scale:0,rotate:-90,opacity:0},transition:{type:"spring",stiffness:500,damping:15},children:P.jsx(V0,{className:`h-6 w-6 ${o?"fill-red-500 text-red-500":"fill-red-400 text-red-400"}`})},"alive"):P.jsx(Bt.div,{initial:{scale:0,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:300,damping:20},children:P.jsx(V0,{className:"h-6 w-6 text-gray-300 dark:text-gray-600"})},"lost")})},i)}),P.jsxs("span",{className:"ml-2 text-sm font-medium text-muted-foreground",children:[t,"/",e]})]})}function R7({gameMode:t,roundState:e,stats:n}){var r;return P.jsxs("div",{className:"flex items-center justify-between px-4",children:[P.jsxs("div",{className:"flex items-center gap-8",children:[P.jsxs("div",{className:"flex items-center gap-3",children:[P.jsx("div",{className:"p-2 rounded-full bg-amber-500/20",children:P.jsx(_y,{className:"h-5 w-5 text-amber-500"})}),P.jsxs("div",{children:[P.jsx("div",{className:"text-xs text-muted-foreground uppercase tracking-wider",children:"Score"}),P.jsx("div",{className:"text-2xl font-bold tabular-nums",children:t==="timed"?((r=e.currentScore)==null?void 0:r.finalScore)||0:n.correct*10})]})]}),P.jsxs("div",{className:"flex items-center gap-3",children:[P.jsx("div",{className:"p-2 rounded-full bg-orange-500/20",children:P.jsx(wT,{className:"h-5 w-5 text-orange-500"})}),P.jsxs("div",{children:[P.jsx("div",{className:"text-xs text-muted-foreground uppercase tracking-wider",children:"Streak"}),P.jsxs("div",{className:"flex items-baseline gap-2",children:[P.jsx("span",{className:"text-2xl font-bold tabular-nums",children:t==="timed"?e.streak:n.streak}),n.streak>=3&&P.jsx("span",{className:"text-xs text-orange-500",children:""})]})]})]})]}),P.jsx("div",{className:"flex items-center gap-8",children:t==="timed"&&e.isActive?P.jsxs(P.Fragment,{children:[P.jsx(E7,{lives:e.lives,maxLives:e.maxLives}),P.jsxs("div",{className:"text-center",children:[P.jsx("div",{className:"text-xs text-muted-foreground uppercase tracking-wider",children:"Progress"}),P.jsxs("div",{className:"text-2xl font-bold text-blue-500",children:[e.notesCompleted,"/",e.notesRequired]})]})]}):P.jsxs(P.Fragment,{children:[P.jsxs("div",{className:"flex items-center gap-3",children:[P.jsx("div",{className:"p-2 rounded-full bg-emerald-500/20",children:P.jsx(gy,{className:"h-5 w-5 text-emerald-500"})}),P.jsxs("div",{children:[P.jsx("div",{className:"text-xs text-muted-foreground uppercase tracking-wider",children:"Correct"}),P.jsx("div",{className:"text-2xl font-bold tabular-nums text-emerald-500",children:n.correct})]})]}),P.jsxs("div",{children:[P.jsx("div",{className:"text-xs text-muted-foreground uppercase tracking-wider",children:"Incorrect"}),P.jsx("div",{className:"text-2xl font-bold tabular-nums text-red-500",children:n.incorrect})]})]})})]})}var ms={},gs={};function I7(t){return t}var _a=1,ya=2,Vf=3,As=4,U1=1e-6;function O7(t){return"translate("+t+",0)"}function D7(t){return"translate(0,"+t+")"}function P7(t){return e=>+t(e)}function q7(t,e){return e=Math.max(0,t.bandwidth()-e*2)/2,t.round()&&(e=Math.round(e)),n=>+t(n)+e}function F7(){return!this.__axis}function ku(t,e){var n=[],r=null,i=null,s=6,o=6,a=3,c=typeof window<"u"&&window.devicePixelRatio>1?0:.5,u=t===_a||t===As?-1:1,l=t===As||t===ya?"x":"y",h=t===_a||t===Vf?O7:D7;function f(d){var p=r??(e.ticks?e.ticks.apply(e,n):e.domain()),g=i??(e.tickFormat?e.tickFormat.apply(e,n):I7),m=Math.max(s,0)+a,_=e.range(),b=+_[0]+c,v=+_[_.length-1]+c,y=(e.bandwidth?q7:P7)(e.copy(),c),w=d.selection?d.selection():d,x=w.selectAll(".domain").data([null]),C=w.selectAll(".tick").data(p,e).order(),S=C.exit(),A=C.enter().append("g").attr("class","tick"),N=C.select("line"),T=C.select("text");x=x.merge(x.enter().insert("path",".tick").attr("class","domain").attr("stroke","currentColor")),C=C.merge(A),N=N.merge(A.append("line").attr("stroke","currentColor").attr(l+"2",u*s)),T=T.merge(A.append("text").attr("fill","currentColor").attr(l,u*m).attr("dy",t===_a?"0em":t===Vf?"0.71em":"0.32em")),d!==w&&(x=x.transition(d),C=C.transition(d),N=N.transition(d),T=T.transition(d),S=S.transition(d).attr("opacity",U1).attr("transform",function(k){return isFinite(k=y(k))?h(k+c):this.getAttribute("transform")}),A.attr("opacity",U1).attr("transform",function(k){var I=this.parentNode.__axis;return h((I&&isFinite(I=I(k))?I:y(k))+c)})),S.remove(),x.attr("d",t===As||t===ya?o?"M"+u*o+","+b+"H"+c+"V"+v+"H"+u*o:"M"+c+","+b+"V"+v:o?"M"+b+","+u*o+"V"+c+"H"+v+"V"+u*o:"M"+b+","+c+"H"+v),C.attr("opacity",1).attr("transform",function(k){return h(y(k)+c)}),N.attr(l+"2",u*s),T.attr(l,u*m).text(g),w.filter(F7).attr("fill","none").attr("font-size",10).attr("font-family","sans-serif").attr("text-anchor",t===ya?"start":t===As?"end":"middle"),w.each(function(){this.__axis=y})}return f.scale=function(d){return arguments.length?(e=d,f):e},f.ticks=function(){return n=Array.from(arguments),f},f.tickArguments=function(d){return arguments.length?(n=d==null?[]:Array.from(d),f):n.slice()},f.tickValues=function(d){return arguments.length?(r=d==null?null:Array.from(d),f):r&&r.slice()},f.tickFormat=function(d){return arguments.length?(i=d,f):i},f.tickSize=function(d){return arguments.length?(s=o=+d,f):s},f.tickSizeInner=function(d){return arguments.length?(s=+d,f):s},f.tickSizeOuter=function(d){return arguments.length?(o=+d,f):o},f.tickPadding=function(d){return arguments.length?(a=+d,f):a},f.offset=function(d){return arguments.length?(c=+d,f):c},f}function $7(t){return ku(_a,t)}function V7(t){return ku(ya,t)}function L7(t){return ku(Vf,t)}function j7(t){return ku(As,t)}var z7={value:()=>{}};function ti(){for(var t=0,e=arguments.length,n={},r;t<e;++t){if(!(r=arguments[t]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new va(n)}function va(t){this._=t}function B7(t,e){return t.trim().split(/^|\s+/).map(function(n){var r="",i=n.indexOf(".");if(i>=0&&(r=n.slice(i+1),n=n.slice(0,i)),n&&!e.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}va.prototype=ti.prototype={constructor:va,on:function(t,e){var n=this._,r=B7(t+"",n),i,s=-1,o=r.length;if(arguments.length<2){for(;++s<o;)if((i=(t=r[s]).type)&&(i=W7(n[i],t.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++s<o;)if(i=(t=r[s]).type)n[i]=G1(n[i],t.name,e);else if(e==null)for(i in n)n[i]=G1(n[i],t.name,null);return this},copy:function(){var t={},e=this._;for(var n in e)t[n]=e[n].slice();return new va(t)},call:function(t,e){if((i=arguments.length-2)>0)for(var n=new Array(i),r=0,i,s;r<i;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(s=this._[t],r=0,i=s.length;r<i;++r)s[r].value.apply(e,n)},apply:function(t,e,n){if(!this._.hasOwnProperty(t))throw new Error("unknown type: "+t);for(var r=this._[t],i=0,s=r.length;i<s;++i)r[i].value.apply(e,n)}};function W7(t,e){for(var n=0,r=t.length,i;n<r;++n)if((i=t[n]).name===e)return i.value}function G1(t,e,n){for(var r=0,i=t.length;r<i;++r)if(t[r].name===e){t[r]=z7,t=t.slice(0,r).concat(t.slice(r+1));break}return n!=null&&t.push({name:e,value:n}),t}var Lf="http://www.w3.org/1999/xhtml";const jf={svg:"http://www.w3.org/2000/svg",xhtml:Lf,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Ro(t){var e=t+="",n=e.indexOf(":");return n>=0&&(e=t.slice(0,n))!=="xmlns"&&(t=t.slice(n+1)),jf.hasOwnProperty(e)?{space:jf[e],local:t}:t}function U7(t){return function(){var e=this.ownerDocument,n=this.namespaceURI;return n===Lf&&e.documentElement.namespaceURI===Lf?e.createElement(t):e.createElementNS(n,t)}}function G7(t){return function(){return this.ownerDocument.createElementNS(t.space,t.local)}}function Eu(t){var e=Ro(t);return(e.local?G7:U7)(e)}function H7(){}function Ru(t){return t==null?H7:function(){return this.querySelector(t)}}function Y7(t){typeof t!="function"&&(t=Ru(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,a=r[i]=new Array(o),c,u,l=0;l<o;++l)(c=s[l])&&(u=t.call(c,c.__data__,l,s))&&("__data__"in c&&(u.__data__=c.__data__),a[l]=u);return new vt(r,this._parents)}function cw(t){return t==null?[]:Array.isArray(t)?t:Array.from(t)}function X7(){return[]}function Zp(t){return t==null?X7:function(){return this.querySelectorAll(t)}}function Z7(t){return function(){return cw(t.apply(this,arguments))}}function K7(t){typeof t=="function"?t=Z7(t):t=Zp(t);for(var e=this._groups,n=e.length,r=[],i=[],s=0;s<n;++s)for(var o=e[s],a=o.length,c,u=0;u<a;++u)(c=o[u])&&(r.push(t.call(c,c.__data__,u,o)),i.push(c));return new vt(r,i)}function Kp(t){return function(){return this.matches(t)}}function uw(t){return function(e){return e.matches(t)}}var Q7=Array.prototype.find;function J7(t){return function(){return Q7.call(this.children,t)}}function eE(){return this.firstElementChild}function tE(t){return this.select(t==null?eE:J7(typeof t=="function"?t:uw(t)))}var nE=Array.prototype.filter;function rE(){return Array.from(this.children)}function iE(t){return function(){return nE.call(this.children,t)}}function sE(t){return this.selectAll(t==null?rE:iE(typeof t=="function"?t:uw(t)))}function oE(t){typeof t!="function"&&(t=Kp(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,a=r[i]=[],c,u=0;u<o;++u)(c=s[u])&&t.call(c,c.__data__,u,s)&&a.push(c);return new vt(r,this._parents)}function lw(t){return new Array(t.length)}function aE(){return new vt(this._enter||this._groups.map(lw),this._parents)}function rc(t,e){this.ownerDocument=t.ownerDocument,this.namespaceURI=t.namespaceURI,this._next=null,this._parent=t,this.__data__=e}rc.prototype={constructor:rc,appendChild:function(t){return this._parent.insertBefore(t,this._next)},insertBefore:function(t,e){return this._parent.insertBefore(t,e)},querySelector:function(t){return this._parent.querySelector(t)},querySelectorAll:function(t){return this._parent.querySelectorAll(t)}};function cE(t){return function(){return t}}function uE(t,e,n,r,i,s){for(var o=0,a,c=e.length,u=s.length;o<u;++o)(a=e[o])?(a.__data__=s[o],r[o]=a):n[o]=new rc(t,s[o]);for(;o<c;++o)(a=e[o])&&(i[o]=a)}function lE(t,e,n,r,i,s,o){var a,c,u=new Map,l=e.length,h=s.length,f=new Array(l),d;for(a=0;a<l;++a)(c=e[a])&&(f[a]=d=o.call(c,c.__data__,a,e)+"",u.has(d)?i[a]=c:u.set(d,c));for(a=0;a<h;++a)d=o.call(t,s[a],a,s)+"",(c=u.get(d))?(r[a]=c,c.__data__=s[a],u.delete(d)):n[a]=new rc(t,s[a]);for(a=0;a<l;++a)(c=e[a])&&u.get(f[a])===c&&(i[a]=c)}function hE(t){return t.__data__}function fE(t,e){if(!arguments.length)return Array.from(this,hE);var n=e?lE:uE,r=this._parents,i=this._groups;typeof t!="function"&&(t=cE(t));for(var s=i.length,o=new Array(s),a=new Array(s),c=new Array(s),u=0;u<s;++u){var l=r[u],h=i[u],f=h.length,d=dE(t.call(l,l&&l.__data__,u,r)),p=d.length,g=a[u]=new Array(p),m=o[u]=new Array(p),_=c[u]=new Array(f);n(l,h,g,m,_,d,e);for(var b=0,v=0,y,w;b<p;++b)if(y=g[b]){for(b>=v&&(v=b+1);!(w=m[v])&&++v<p;);y._next=w||null}}return o=new vt(o,r),o._enter=a,o._exit=c,o}function dE(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function pE(){return new vt(this._exit||this._groups.map(lw),this._parents)}function mE(t,e,n){var r=this.enter(),i=this,s=this.exit();return typeof t=="function"?(r=t(r),r&&(r=r.selection())):r=r.append(t+""),e!=null&&(i=e(i),i&&(i=i.selection())),n==null?s.remove():n(s),r&&i?r.merge(i).order():i}function gE(t){for(var e=t.selection?t.selection():t,n=this._groups,r=e._groups,i=n.length,s=r.length,o=Math.min(i,s),a=new Array(i),c=0;c<o;++c)for(var u=n[c],l=r[c],h=u.length,f=a[c]=new Array(h),d,p=0;p<h;++p)(d=u[p]||l[p])&&(f[p]=d);for(;c<i;++c)a[c]=n[c];return new vt(a,this._parents)}function _E(){for(var t=this._groups,e=-1,n=t.length;++e<n;)for(var r=t[e],i=r.length-1,s=r[i],o;--i>=0;)(o=r[i])&&(s&&o.compareDocumentPosition(s)^4&&s.parentNode.insertBefore(o,s),s=o);return this}function yE(t){t||(t=vE);function e(h,f){return h&&f?t(h.__data__,f.__data__):!h-!f}for(var n=this._groups,r=n.length,i=new Array(r),s=0;s<r;++s){for(var o=n[s],a=o.length,c=i[s]=new Array(a),u,l=0;l<a;++l)(u=o[l])&&(c[l]=u);c.sort(e)}return new vt(i,this._parents).order()}function vE(t,e){return t<e?-1:t>e?1:t>=e?0:NaN}function bE(){var t=arguments[0];return arguments[0]=this,t.apply(null,arguments),this}function wE(){return Array.from(this)}function xE(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length;i<s;++i){var o=r[i];if(o)return o}return null}function TE(){let t=0;for(const e of this)++t;return t}function SE(){return!this.node()}function CE(t){for(var e=this._groups,n=0,r=e.length;n<r;++n)for(var i=e[n],s=0,o=i.length,a;s<o;++s)(a=i[s])&&t.call(a,a.__data__,s,i);return this}function ME(t){return function(){this.removeAttribute(t)}}function AE(t){return function(){this.removeAttributeNS(t.space,t.local)}}function NE(t,e){return function(){this.setAttribute(t,e)}}function kE(t,e){return function(){this.setAttributeNS(t.space,t.local,e)}}function EE(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttribute(t):this.setAttribute(t,n)}}function RE(t,e){return function(){var n=e.apply(this,arguments);n==null?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}}function IE(t,e){var n=Ro(t);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((e==null?n.local?AE:ME:typeof e=="function"?n.local?RE:EE:n.local?kE:NE)(n,e))}function Qp(t){return t.ownerDocument&&t.ownerDocument.defaultView||t.document&&t||t.defaultView}function OE(t){return function(){this.style.removeProperty(t)}}function DE(t,e,n){return function(){this.style.setProperty(t,e,n)}}function PE(t,e,n){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(t):this.style.setProperty(t,r,n)}}function qE(t,e,n){return arguments.length>1?this.each((e==null?OE:typeof e=="function"?PE:DE)(t,e,n??"")):Ur(this.node(),t)}function Ur(t,e){return t.style.getPropertyValue(e)||Qp(t).getComputedStyle(t,null).getPropertyValue(e)}function FE(t){return function(){delete this[t]}}function $E(t,e){return function(){this[t]=e}}function VE(t,e){return function(){var n=e.apply(this,arguments);n==null?delete this[t]:this[t]=n}}function LE(t,e){return arguments.length>1?this.each((e==null?FE:typeof e=="function"?VE:$E)(t,e)):this.node()[t]}function hw(t){return t.trim().split(/^|\s+/)}function Jp(t){return t.classList||new fw(t)}function fw(t){this._node=t,this._names=hw(t.getAttribute("class")||"")}fw.prototype={add:function(t){var e=this._names.indexOf(t);e<0&&(this._names.push(t),this._node.setAttribute("class",this._names.join(" ")))},remove:function(t){var e=this._names.indexOf(t);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(t){return this._names.indexOf(t)>=0}};function dw(t,e){for(var n=Jp(t),r=-1,i=e.length;++r<i;)n.add(e[r])}function pw(t,e){for(var n=Jp(t),r=-1,i=e.length;++r<i;)n.remove(e[r])}function jE(t){return function(){dw(this,t)}}function zE(t){return function(){pw(this,t)}}function BE(t,e){return function(){(e.apply(this,arguments)?dw:pw)(this,t)}}function WE(t,e){var n=hw(t+"");if(arguments.length<2){for(var r=Jp(this.node()),i=-1,s=n.length;++i<s;)if(!r.contains(n[i]))return!1;return!0}return this.each((typeof e=="function"?BE:e?jE:zE)(n,e))}function UE(){this.textContent=""}function GE(t){return function(){this.textContent=t}}function HE(t){return function(){var e=t.apply(this,arguments);this.textContent=e??""}}function YE(t){return arguments.length?this.each(t==null?UE:(typeof t=="function"?HE:GE)(t)):this.node().textContent}function XE(){this.innerHTML=""}function ZE(t){return function(){this.innerHTML=t}}function KE(t){return function(){var e=t.apply(this,arguments);this.innerHTML=e??""}}function QE(t){return arguments.length?this.each(t==null?XE:(typeof t=="function"?KE:ZE)(t)):this.node().innerHTML}function JE(){this.nextSibling&&this.parentNode.appendChild(this)}function eR(){return this.each(JE)}function tR(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function nR(){return this.each(tR)}function rR(t){var e=typeof t=="function"?t:Eu(t);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function iR(){return null}function sR(t,e){var n=typeof t=="function"?t:Eu(t),r=e==null?iR:typeof e=="function"?e:Ru(e);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function oR(){var t=this.parentNode;t&&t.removeChild(this)}function aR(){return this.each(oR)}function cR(){var t=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function uR(){var t=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(t,this.nextSibling):t}function lR(t){return this.select(t?uR:cR)}function hR(t){return arguments.length?this.property("__data__",t):this.node().__data__}function fR(t){return function(e){t.call(this,e,this.__data__)}}function dR(t){return t.trim().split(/^|\s+/).map(function(e){var n="",r=e.indexOf(".");return r>=0&&(n=e.slice(r+1),e=e.slice(0,r)),{type:e,name:n}})}function pR(t){return function(){var e=this.__on;if(e){for(var n=0,r=-1,i=e.length,s;n<i;++n)s=e[n],(!t.type||s.type===t.type)&&s.name===t.name?this.removeEventListener(s.type,s.listener,s.options):e[++r]=s;++r?e.length=r:delete this.__on}}}function mR(t,e,n){return function(){var r=this.__on,i,s=fR(e);if(r){for(var o=0,a=r.length;o<a;++o)if((i=r[o]).type===t.type&&i.name===t.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=s,i.options=n),i.value=e;return}}this.addEventListener(t.type,s,n),i={type:t.type,name:t.name,value:e,listener:s,options:n},r?r.push(i):this.__on=[i]}}function gR(t,e,n){var r=dR(t+""),i,s=r.length,o;if(arguments.length<2){var a=this.node().__on;if(a){for(var c=0,u=a.length,l;c<u;++c)for(i=0,l=a[c];i<s;++i)if((o=r[i]).type===l.type&&o.name===l.name)return l.value}return}for(a=e?mR:pR,i=0;i<s;++i)this.each(a(r[i],e,n));return this}function mw(t,e,n){var r=Qp(t),i=r.CustomEvent;typeof i=="function"?i=new i(e,n):(i=r.document.createEvent("Event"),n?(i.initEvent(e,n.bubbles,n.cancelable),i.detail=n.detail):i.initEvent(e,!1,!1)),t.dispatchEvent(i)}function _R(t,e){return function(){return mw(this,t,e)}}function yR(t,e){return function(){return mw(this,t,e.apply(this,arguments))}}function vR(t,e){return this.each((typeof e=="function"?yR:_R)(t,e))}function*bR(){for(var t=this._groups,e=0,n=t.length;e<n;++e)for(var r=t[e],i=0,s=r.length,o;i<s;++i)(o=r[i])&&(yield o)}var e0=[null];function vt(t,e){this._groups=t,this._parents=e}function ni(){return new vt([[document.documentElement]],e0)}function wR(){return this}vt.prototype=ni.prototype={constructor:vt,select:Y7,selectAll:K7,selectChild:tE,selectChildren:sE,filter:oE,data:fE,enter:aE,exit:pE,join:mE,merge:gE,selection:wR,order:_E,sort:yE,call:bE,nodes:wE,node:xE,size:TE,empty:SE,each:CE,attr:IE,style:qE,property:LE,classed:WE,text:YE,html:QE,raise:eR,lower:nR,append:rR,insert:sR,remove:aR,clone:lR,datum:hR,on:gR,dispatch:vR,[Symbol.iterator]:bR};function ot(t){return typeof t=="string"?new vt([[document.querySelector(t)]],[document.documentElement]):new vt([[t]],e0)}function xR(t){return ot(Eu(t).call(document.documentElement))}var TR=0;function gw(){return new zf}function zf(){this._="@"+(++TR).toString(36)}zf.prototype=gw.prototype={constructor:zf,get:function(t){for(var e=this._;!(e in t);)if(!(t=t.parentNode))return;return t[e]},set:function(t,e){return t[this._]=e},remove:function(t){return this._ in t&&delete t[this._]},toString:function(){return this._}};function _w(t){let e;for(;e=t.sourceEvent;)t=e;return t}function Dt(t,e){if(t=_w(t),e===void 0&&(e=t.currentTarget),e){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=t.clientX,r.y=t.clientY,r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}if(e.getBoundingClientRect){var i=e.getBoundingClientRect();return[t.clientX-i.left-e.clientLeft,t.clientY-i.top-e.clientTop]}}return[t.pageX,t.pageY]}function SR(t,e){return t.target&&(t=_w(t),e===void 0&&(e=t.currentTarget),t=t.touches||[t]),Array.from(t,n=>Dt(n,e))}function CR(t){return typeof t=="string"?new vt([document.querySelectorAll(t)],[document.documentElement]):new vt([cw(t)],e0)}const MR={passive:!1},ro={capture:!0,passive:!1};function Wh(t){t.stopImmediatePropagation()}function Mi(t){t.preventDefault(),t.stopImmediatePropagation()}function Iu(t){var e=t.document.documentElement,n=ot(t).on("dragstart.drag",Mi,ro);"onselectstart"in e?n.on("selectstart.drag",Mi,ro):(e.__noselect=e.style.MozUserSelect,e.style.MozUserSelect="none")}function Ou(t,e){var n=t.document.documentElement,r=ot(t).on("dragstart.drag",null);e&&(r.on("click.drag",Mi,ro),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const Jo=t=>()=>t;function Bf(t,{sourceEvent:e,subject:n,target:r,identifier:i,active:s,x:o,y:a,dx:c,dy:u,dispatch:l}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:i,enumerable:!0,configurable:!0},active:{value:s,enumerable:!0,configurable:!0},x:{value:o,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:u,enumerable:!0,configurable:!0},_:{value:l}})}Bf.prototype.on=function(){var t=this._.on.apply(this._,arguments);return t===this._?this:t};function AR(t){return!t.ctrlKey&&!t.button}function NR(){return this.parentNode}function kR(t,e){return e??{x:t.x,y:t.y}}function ER(){return navigator.maxTouchPoints||"ontouchstart"in this}function RR(){var t=AR,e=NR,n=kR,r=ER,i={},s=ti("start","drag","end"),o=0,a,c,u,l,h=0;function f(y){y.on("mousedown.drag",d).filter(r).on("touchstart.drag",m).on("touchmove.drag",_,MR).on("touchend.drag touchcancel.drag",b).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function d(y,w){if(!(l||!t.call(this,y,w))){var x=v(this,e.call(this,y,w),y,w,"mouse");x&&(ot(y.view).on("mousemove.drag",p,ro).on("mouseup.drag",g,ro),Iu(y.view),Wh(y),u=!1,a=y.clientX,c=y.clientY,x("start",y))}}function p(y){if(Mi(y),!u){var w=y.clientX-a,x=y.clientY-c;u=w*w+x*x>h}i.mouse("drag",y)}function g(y){ot(y.view).on("mousemove.drag mouseup.drag",null),Ou(y.view,u),Mi(y),i.mouse("end",y)}function m(y,w){if(t.call(this,y,w)){var x=y.changedTouches,C=e.call(this,y,w),S=x.length,A,N;for(A=0;A<S;++A)(N=v(this,C,y,w,x[A].identifier,x[A]))&&(Wh(y),N("start",y,x[A]))}}function _(y){var w=y.changedTouches,x=w.length,C,S;for(C=0;C<x;++C)(S=i[w[C].identifier])&&(Mi(y),S("drag",y,w[C]))}function b(y){var w=y.changedTouches,x=w.length,C,S;for(l&&clearTimeout(l),l=setTimeout(function(){l=null},500),C=0;C<x;++C)(S=i[w[C].identifier])&&(Wh(y),S("end",y,w[C]))}function v(y,w,x,C,S,A){var N=s.copy(),T=Dt(A||x,w),k,I,M;if((M=n.call(y,new Bf("beforestart",{sourceEvent:x,target:f,identifier:S,active:o,x:T[0],y:T[1],dx:0,dy:0,dispatch:N}),C))!=null)return k=M.x-T[0]||0,I=M.y-T[1]||0,function E(R,O,q){var D=T,$;switch(R){case"start":i[S]=E,$=o++;break;case"end":delete i[S],--o;case"drag":T=Dt(q||O,w),$=o;break}N.call(R,y,new Bf(R,{sourceEvent:O,subject:M,target:f,identifier:S,active:$,x:T[0]+k,y:T[1]+I,dx:T[0]-D[0],dy:T[1]-D[1],dispatch:N}),C)}}return f.filter=function(y){return arguments.length?(t=typeof y=="function"?y:Jo(!!y),f):t},f.container=function(y){return arguments.length?(e=typeof y=="function"?y:Jo(y),f):e},f.subject=function(y){return arguments.length?(n=typeof y=="function"?y:Jo(y),f):n},f.touchable=function(y){return arguments.length?(r=typeof y=="function"?y:Jo(!!y),f):r},f.on=function(){var y=s.on.apply(s,arguments);return y===s?f:y},f.clickDistance=function(y){return arguments.length?(h=(y=+y)*y,f):Math.sqrt(h)},f}var Hi=0,Ns=0,_s=0,yw=1e3,ic,ks,sc=0,Gr=0,Du=0,io=typeof performance=="object"&&performance.now?performance:Date,vw=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(t){setTimeout(t,17)};function Io(){return Gr||(vw(IR),Gr=io.now()+Du)}function IR(){Gr=0}function so(){this._call=this._time=this._next=null}so.prototype=Pu.prototype={constructor:so,restart:function(t,e,n){if(typeof t!="function")throw new TypeError("callback is not a function");n=(n==null?Io():+n)+(e==null?0:+e),!this._next&&ks!==this&&(ks?ks._next=this:ic=this,ks=this),this._call=t,this._time=n,Wf()},stop:function(){this._call&&(this._call=null,this._time=1/0,Wf())}};function Pu(t,e,n){var r=new so;return r.restart(t,e,n),r}function bw(){Io(),++Hi;for(var t=ic,e;t;)(e=Gr-t._time)>=0&&t._call.call(void 0,e),t=t._next;--Hi}function H1(){Gr=(sc=io.now())+Du,Hi=Ns=0;try{bw()}finally{Hi=0,DR(),Gr=0}}function OR(){var t=io.now(),e=t-sc;e>yw&&(Du-=e,sc=t)}function DR(){for(var t,e=ic,n,r=1/0;e;)e._call?(r>e._time&&(r=e._time),t=e,e=e._next):(n=e._next,e._next=null,e=t?t._next=n:ic=n);ks=t,Wf(r)}function Wf(t){if(!Hi){Ns&&(Ns=clearTimeout(Ns));var e=t-Gr;e>24?(t<1/0&&(Ns=setTimeout(H1,t-io.now()-Du)),_s&&(_s=clearInterval(_s))):(_s||(sc=io.now(),_s=setInterval(OR,yw)),Hi=1,vw(H1))}}function Uf(t,e,n){var r=new so;return e=e==null?0:+e,r.restart(i=>{r.stop(),t(i+e)},e,n),r}function PR(t,e,n){var r=new so,i=e;return e==null?(r.restart(t,e,n),r):(r._restart=r.restart,r.restart=function(s,o,a){o=+o,a=a==null?Io():+a,r._restart(function c(u){u+=i,r._restart(c,i+=o,a),s(u)},o,a)},r.restart(t,e,n),r)}var qR=ti("start","end","cancel","interrupt"),FR=[],ww=0,Gf=1,Hf=2,ba=3,Y1=4,Yf=5,wa=6;function qu(t,e,n,r,i,s){var o=t.__transition;if(!o)t.__transition={};else if(n in o)return;$R(t,n,{name:e,index:r,group:i,on:qR,tween:FR,time:s.time,delay:s.delay,duration:s.duration,ease:s.ease,timer:null,state:ww})}function t0(t,e){var n=un(t,e);if(n.state>ww)throw new Error("too late; already scheduled");return n}function Sn(t,e){var n=un(t,e);if(n.state>ba)throw new Error("too late; already running");return n}function un(t,e){var n=t.__transition;if(!n||!(n=n[e]))throw new Error("transition not found");return n}function $R(t,e,n){var r=t.__transition,i;r[e]=n,n.timer=Pu(s,0,n.time);function s(u){n.state=Gf,n.timer.restart(o,n.delay,n.time),n.delay<=u&&o(u-n.delay)}function o(u){var l,h,f,d;if(n.state!==Gf)return c();for(l in r)if(d=r[l],d.name===n.name){if(d.state===ba)return Uf(o);d.state===Y1?(d.state=wa,d.timer.stop(),d.on.call("interrupt",t,t.__data__,d.index,d.group),delete r[l]):+l<e&&(d.state=wa,d.timer.stop(),d.on.call("cancel",t,t.__data__,d.index,d.group),delete r[l])}if(Uf(function(){n.state===ba&&(n.state=Y1,n.timer.restart(a,n.delay,n.time),a(u))}),n.state=Hf,n.on.call("start",t,t.__data__,n.index,n.group),n.state===Hf){for(n.state=ba,i=new Array(f=n.tween.length),l=0,h=-1;l<f;++l)(d=n.tween[l].value.call(t,t.__data__,n.index,n.group))&&(i[++h]=d);i.length=h+1}}function a(u){for(var l=u<n.duration?n.ease.call(null,u/n.duration):(n.timer.restart(c),n.state=Yf,1),h=-1,f=i.length;++h<f;)i[h].call(t,l);n.state===Yf&&(n.on.call("end",t,t.__data__,n.index,n.group),c())}function c(){n.state=wa,n.timer.stop(),delete r[e];for(var u in r)return;delete t.__transition}}function Pr(t,e){var n=t.__transition,r,i,s=!0,o;if(n){e=e==null?null:e+"";for(o in n){if((r=n[o]).name!==e){s=!1;continue}i=r.state>Hf&&r.state<Yf,r.state=wa,r.timer.stop(),r.on.call(i?"interrupt":"cancel",t,t.__data__,r.index,r.group),delete n[o]}s&&delete t.__transition}}function VR(t){return this.each(function(){Pr(this,t)})}function LR(t,e){var n,r;return function(){var i=Sn(this,t),s=i.tween;if(s!==n){r=n=s;for(var o=0,a=r.length;o<a;++o)if(r[o].name===e){r=r.slice(),r.splice(o,1);break}}i.tween=r}}function jR(t,e,n){var r,i;if(typeof n!="function")throw new Error;return function(){var s=Sn(this,t),o=s.tween;if(o!==r){i=(r=o).slice();for(var a={name:e,value:n},c=0,u=i.length;c<u;++c)if(i[c].name===e){i[c]=a;break}c===u&&i.push(a)}s.tween=i}}function zR(t,e){var n=this._id;if(t+="",arguments.length<2){for(var r=un(this.node(),n).tween,i=0,s=r.length,o;i<s;++i)if((o=r[i]).name===t)return o.value;return null}return this.each((e==null?LR:jR)(n,t,e))}function n0(t,e,n){var r=t._id;return t.each(function(){var i=Sn(this,r);(i.value||(i.value={}))[e]=n.apply(this,arguments)}),function(i){return un(i,r).value[e]}}function xw(t,e){var n;return(typeof e=="number"?zt:e instanceof ur?Ks:(n=ur(e))?(e=n,Ks):Jd)(t,e)}function BR(t){return function(){this.removeAttribute(t)}}function WR(t){return function(){this.removeAttributeNS(t.space,t.local)}}function UR(t,e,n){var r,i=n+"",s;return function(){var o=this.getAttribute(t);return o===i?null:o===r?s:s=e(r=o,n)}}function GR(t,e,n){var r,i=n+"",s;return function(){var o=this.getAttributeNS(t.space,t.local);return o===i?null:o===r?s:s=e(r=o,n)}}function HR(t,e,n){var r,i,s;return function(){var o,a=n(this),c;return a==null?void this.removeAttribute(t):(o=this.getAttribute(t),c=a+"",o===c?null:o===r&&c===i?s:(i=c,s=e(r=o,a)))}}function YR(t,e,n){var r,i,s;return function(){var o,a=n(this),c;return a==null?void this.removeAttributeNS(t.space,t.local):(o=this.getAttributeNS(t.space,t.local),c=a+"",o===c?null:o===r&&c===i?s:(i=c,s=e(r=o,a)))}}function XR(t,e){var n=Ro(t),r=n==="transform"?rb:xw;return this.attrTween(t,typeof e=="function"?(n.local?YR:HR)(n,r,n0(this,"attr."+t,e)):e==null?(n.local?WR:BR)(n):(n.local?GR:UR)(n,r,e))}function ZR(t,e){return function(n){this.setAttribute(t,e.call(this,n))}}function KR(t,e){return function(n){this.setAttributeNS(t.space,t.local,e.call(this,n))}}function QR(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&KR(t,s)),n}return i._value=e,i}function JR(t,e){var n,r;function i(){var s=e.apply(this,arguments);return s!==r&&(n=(r=s)&&ZR(t,s)),n}return i._value=e,i}function e9(t,e){var n="attr."+t;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(e==null)return this.tween(n,null);if(typeof e!="function")throw new Error;var r=Ro(t);return this.tween(n,(r.local?QR:JR)(r,e))}function t9(t,e){return function(){t0(this,t).delay=+e.apply(this,arguments)}}function n9(t,e){return e=+e,function(){t0(this,t).delay=e}}function r9(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?t9:n9)(e,t)):un(this.node(),e).delay}function i9(t,e){return function(){Sn(this,t).duration=+e.apply(this,arguments)}}function s9(t,e){return e=+e,function(){Sn(this,t).duration=e}}function o9(t){var e=this._id;return arguments.length?this.each((typeof t=="function"?i9:s9)(e,t)):un(this.node(),e).duration}function a9(t,e){if(typeof e!="function")throw new Error;return function(){Sn(this,t).ease=e}}function c9(t){var e=this._id;return arguments.length?this.each(a9(e,t)):un(this.node(),e).ease}function u9(t,e){return function(){var n=e.apply(this,arguments);if(typeof n!="function")throw new Error;Sn(this,t).ease=n}}function l9(t){if(typeof t!="function")throw new Error;return this.each(u9(this._id,t))}function h9(t){typeof t!="function"&&(t=Kp(t));for(var e=this._groups,n=e.length,r=new Array(n),i=0;i<n;++i)for(var s=e[i],o=s.length,a=r[i]=[],c,u=0;u<o;++u)(c=s[u])&&t.call(c,c.__data__,u,s)&&a.push(c);return new vn(r,this._parents,this._name,this._id)}function f9(t){if(t._id!==this._id)throw new Error;for(var e=this._groups,n=t._groups,r=e.length,i=n.length,s=Math.min(r,i),o=new Array(r),a=0;a<s;++a)for(var c=e[a],u=n[a],l=c.length,h=o[a]=new Array(l),f,d=0;d<l;++d)(f=c[d]||u[d])&&(h[d]=f);for(;a<r;++a)o[a]=e[a];return new vn(o,this._parents,this._name,this._id)}function d9(t){return(t+"").trim().split(/^|\s+/).every(function(e){var n=e.indexOf(".");return n>=0&&(e=e.slice(0,n)),!e||e==="start"})}function p9(t,e,n){var r,i,s=d9(e)?t0:Sn;return function(){var o=s(this,t),a=o.on;a!==r&&(i=(r=a).copy()).on(e,n),o.on=i}}function m9(t,e){var n=this._id;return arguments.length<2?un(this.node(),n).on.on(t):this.each(p9(n,t,e))}function g9(t){return function(){var e=this.parentNode;for(var n in this.__transition)if(+n!==t)return;e&&e.removeChild(this)}}function _9(){return this.on("end.remove",g9(this._id))}function y9(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Ru(t));for(var r=this._groups,i=r.length,s=new Array(i),o=0;o<i;++o)for(var a=r[o],c=a.length,u=s[o]=new Array(c),l,h,f=0;f<c;++f)(l=a[f])&&(h=t.call(l,l.__data__,f,a))&&("__data__"in l&&(h.__data__=l.__data__),u[f]=h,qu(u[f],e,n,f,u,un(l,n)));return new vn(s,this._parents,e,n)}function v9(t){var e=this._name,n=this._id;typeof t!="function"&&(t=Zp(t));for(var r=this._groups,i=r.length,s=[],o=[],a=0;a<i;++a)for(var c=r[a],u=c.length,l,h=0;h<u;++h)if(l=c[h]){for(var f=t.call(l,l.__data__,h,c),d,p=un(l,n),g=0,m=f.length;g<m;++g)(d=f[g])&&qu(d,e,n,g,f,p);s.push(f),o.push(l)}return new vn(s,o,e,n)}var b9=ni.prototype.constructor;function w9(){return new b9(this._groups,this._parents)}function x9(t,e){var n,r,i;return function(){var s=Ur(this,t),o=(this.style.removeProperty(t),Ur(this,t));return s===o?null:s===n&&o===r?i:i=e(n=s,r=o)}}function Tw(t){return function(){this.style.removeProperty(t)}}function T9(t,e,n){var r,i=n+"",s;return function(){var o=Ur(this,t);return o===i?null:o===r?s:s=e(r=o,n)}}function S9(t,e,n){var r,i,s;return function(){var o=Ur(this,t),a=n(this),c=a+"";return a==null&&(c=a=(this.style.removeProperty(t),Ur(this,t))),o===c?null:o===r&&c===i?s:(i=c,s=e(r=o,a))}}function C9(t,e){var n,r,i,s="style."+e,o="end."+s,a;return function(){var c=Sn(this,t),u=c.on,l=c.value[s]==null?a||(a=Tw(e)):void 0;(u!==n||i!==l)&&(r=(n=u).copy()).on(o,i=l),c.on=r}}function M9(t,e,n){var r=(t+="")=="transform"?nb:xw;return e==null?this.styleTween(t,x9(t,r)).on("end.style."+t,Tw(t)):typeof e=="function"?this.styleTween(t,S9(t,r,n0(this,"style."+t,e))).each(C9(this._id,t)):this.styleTween(t,T9(t,r,e),n).on("end.style."+t,null)}function A9(t,e,n){return function(r){this.style.setProperty(t,e.call(this,r),n)}}function N9(t,e,n){var r,i;function s(){var o=e.apply(this,arguments);return o!==i&&(r=(i=o)&&A9(t,o,n)),r}return s._value=e,s}function k9(t,e,n){var r="style."+(t+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,N9(t,e,n??""))}function E9(t){return function(){this.textContent=t}}function R9(t){return function(){var e=t(this);this.textContent=e??""}}function I9(t){return this.tween("text",typeof t=="function"?R9(n0(this,"text",t)):E9(t==null?"":t+""))}function O9(t){return function(e){this.textContent=t.call(this,e)}}function D9(t){var e,n;function r(){var i=t.apply(this,arguments);return i!==n&&(e=(n=i)&&O9(i)),e}return r._value=t,r}function P9(t){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(t==null)return this.tween(e,null);if(typeof t!="function")throw new Error;return this.tween(e,D9(t))}function q9(){for(var t=this._name,e=this._id,n=Cw(),r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,c,u=0;u<a;++u)if(c=o[u]){var l=un(c,e);qu(c,t,n,u,o,{time:l.time+l.delay+l.duration,delay:0,duration:l.duration,ease:l.ease})}return new vn(r,this._parents,t,n)}function F9(){var t,e,n=this,r=n._id,i=n.size();return new Promise(function(s,o){var a={value:o},c={value:function(){--i===0&&s()}};n.each(function(){var u=Sn(this,r),l=u.on;l!==t&&(e=(t=l).copy(),e._.cancel.push(a),e._.interrupt.push(a),e._.end.push(c)),u.on=e}),i===0&&s()})}var $9=0;function vn(t,e,n,r){this._groups=t,this._parents=e,this._name=n,this._id=r}function Sw(t){return ni().transition(t)}function Cw(){return++$9}var An=ni.prototype;vn.prototype=Sw.prototype={constructor:vn,select:y9,selectAll:v9,selectChild:An.selectChild,selectChildren:An.selectChildren,filter:h9,merge:f9,selection:w9,transition:q9,call:An.call,nodes:An.nodes,node:An.node,size:An.size,empty:An.empty,each:An.each,on:m9,attr:XR,attrTween:e9,style:M9,styleTween:k9,text:I9,textTween:P9,remove:_9,tween:zR,delay:r9,duration:o9,ease:c9,easeVarying:l9,end:F9,[Symbol.iterator]:An[Symbol.iterator]};const V9=t=>+t;function L9(t){return t*t}function j9(t){return t*(2-t)}function X1(t){return((t*=2)<=1?t*t:--t*(2-t)+1)/2}function z9(t){return t*t*t}function B9(t){return--t*t*t+1}function Xf(t){return((t*=2)<=1?t*t*t:(t-=2)*t*t+2)/2}var r0=3,W9=(function t(e){e=+e;function n(r){return Math.pow(r,e)}return n.exponent=t,n})(r0),U9=(function t(e){e=+e;function n(r){return 1-Math.pow(1-r,e)}return n.exponent=t,n})(r0),Z1=(function t(e){e=+e;function n(r){return((r*=2)<=1?Math.pow(r,e):2-Math.pow(2-r,e))/2}return n.exponent=t,n})(r0),Mw=Math.PI,Aw=Mw/2;function G9(t){return+t==1?1:1-Math.cos(t*Aw)}function H9(t){return Math.sin(t*Aw)}function K1(t){return(1-Math.cos(Mw*t))/2}function pr(t){return(Math.pow(2,-10*t)-.0009765625)*1.0009775171065494}function Y9(t){return pr(1-+t)}function X9(t){return 1-pr(t)}function Q1(t){return((t*=2)<=1?pr(1-t):2-pr(t-1))/2}function Z9(t){return 1-Math.sqrt(1-t*t)}function K9(t){return Math.sqrt(1- --t*t)}function J1(t){return((t*=2)<=1?1-Math.sqrt(1-t*t):Math.sqrt(1-(t-=2)*t)+1)/2}var Zf=4/11,Q9=6/11,J9=8/11,eI=3/4,tI=9/11,nI=10/11,rI=15/16,iI=21/22,sI=63/64,ea=1/Zf/Zf;function oI(t){return 1-oo(1-t)}function oo(t){return(t=+t)<Zf?ea*t*t:t<J9?ea*(t-=Q9)*t+eI:t<nI?ea*(t-=tI)*t+rI:ea*(t-=iI)*t+sI}function aI(t){return((t*=2)<=1?1-oo(1-t):oo(t-1)+1)/2}var i0=1.70158,cI=(function t(e){e=+e;function n(r){return(r=+r)*r*(e*(r-1)+r)}return n.overshoot=t,n})(i0),uI=(function t(e){e=+e;function n(r){return--r*r*((r+1)*e+r)+1}return n.overshoot=t,n})(i0),e_=(function t(e){e=+e;function n(r){return((r*=2)<1?r*r*((e+1)*r-e):(r-=2)*r*((e+1)*r+e)+2)/2}return n.overshoot=t,n})(i0),Yi=2*Math.PI,s0=1,o0=.3,lI=(function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Yi);function i(s){return e*pr(- --s)*Math.sin((r-s)/n)}return i.amplitude=function(s){return t(s,n*Yi)},i.period=function(s){return t(e,s)},i})(s0,o0),t_=(function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Yi);function i(s){return 1-e*pr(s=+s)*Math.sin((s+r)/n)}return i.amplitude=function(s){return t(s,n*Yi)},i.period=function(s){return t(e,s)},i})(s0,o0),hI=(function t(e,n){var r=Math.asin(1/(e=Math.max(1,e)))*(n/=Yi);function i(s){return((s=s*2-1)<0?e*pr(-s)*Math.sin((r-s)/n):2-e*pr(s)*Math.sin((r+s)/n))/2}return i.amplitude=function(s){return t(s,n*Yi)},i.period=function(s){return t(e,s)},i})(s0,o0),fI={time:null,delay:0,duration:250,ease:Xf};function dI(t,e){for(var n;!(n=t.__transition)||!(n=n[e]);)if(!(t=t.parentNode))throw new Error(`transition ${e} not found`);return n}function pI(t){var e,n;t instanceof vn?(e=t._id,t=t._name):(e=Cw(),(n=fI).time=Io(),t=t==null?null:t+"");for(var r=this._groups,i=r.length,s=0;s<i;++s)for(var o=r[s],a=o.length,c,u=0;u<a;++u)(c=o[u])&&qu(c,t,e,u,o,n||dI(c,e));return new vn(r,this._parents,t,e)}ni.prototype.interrupt=VR;ni.prototype.transition=pI;var mI=[null];function gI(t,e){var n=t.__transition,r,i;if(n){e=e==null?null:e+"";for(i in n)if((r=n[i]).state>Gf&&r.name===e)return new vn([[t]],mI,e,+i)}return null}const Uh=t=>()=>t;function _I(t,{sourceEvent:e,target:n,selection:r,mode:i,dispatch:s}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},selection:{value:r,enumerable:!0,configurable:!0},mode:{value:i,enumerable:!0,configurable:!0},_:{value:s}})}function yI(t){t.stopImmediatePropagation()}function Gh(t){t.preventDefault(),t.stopImmediatePropagation()}var n_={name:"drag"},Hh={name:"space"},ci={name:"handle"},ui={name:"center"};const{abs:r_,max:nt,min:rt}=Math;function i_(t){return[+t[0],+t[1]]}function Kf(t){return[i_(t[0]),i_(t[1])]}var xa={name:"x",handles:["w","e"].map(ao),input:function(t,e){return t==null?null:[[+t[0],e[0][1]],[+t[1],e[1][1]]]},output:function(t){return t&&[t[0][0],t[1][0]]}},Ta={name:"y",handles:["n","s"].map(ao),input:function(t,e){return t==null?null:[[e[0][0],+t[0]],[e[1][0],+t[1]]]},output:function(t){return t&&[t[0][1],t[1][1]]}},vI={name:"xy",handles:["n","w","e","s","nw","ne","sw","se"].map(ao),input:function(t){return t==null?null:Kf(t)},output:function(t){return t}},Nn={overlay:"crosshair",selection:"move",n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},s_={e:"w",w:"e",nw:"ne",ne:"nw",se:"sw",sw:"se"},o_={n:"s",s:"n",nw:"sw",ne:"se",se:"ne",sw:"nw"},bI={overlay:1,selection:1,n:null,e:1,s:null,w:-1,nw:-1,ne:1,se:1,sw:-1},wI={overlay:1,selection:1,n:-1,e:null,s:1,w:null,nw:-1,ne:-1,se:1,sw:1};function ao(t){return{type:t}}function xI(t){return!t.ctrlKey&&!t.button}function TI(){var t=this.ownerSVGElement||this;return t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]}function SI(){return navigator.maxTouchPoints||"ontouchstart"in this}function Yh(t){for(;!t.__brush;)if(!(t=t.parentNode))return;return t.__brush}function CI(t){return t[0][0]===t[1][0]||t[0][1]===t[1][1]}function MI(t){var e=t.__brush;return e?e.dim.output(e.selection):null}function AI(){return a0(xa)}function NI(){return a0(Ta)}function kI(){return a0(vI)}function a0(t){var e=TI,n=xI,r=SI,i=!0,s=ti("start","brush","end"),o=6,a;function c(m){var _=m.property("__brush",g).selectAll(".overlay").data([ao("overlay")]);_.enter().append("rect").attr("class","overlay").attr("pointer-events","all").attr("cursor",Nn.overlay).merge(_).each(function(){var v=Yh(this).extent;ot(this).attr("x",v[0][0]).attr("y",v[0][1]).attr("width",v[1][0]-v[0][0]).attr("height",v[1][1]-v[0][1])}),m.selectAll(".selection").data([ao("selection")]).enter().append("rect").attr("class","selection").attr("cursor",Nn.selection).attr("fill","#777").attr("fill-opacity",.3).attr("stroke","#fff").attr("shape-rendering","crispEdges");var b=m.selectAll(".handle").data(t.handles,function(v){return v.type});b.exit().remove(),b.enter().append("rect").attr("class",function(v){return"handle handle--"+v.type}).attr("cursor",function(v){return Nn[v.type]}),m.each(u).attr("fill","none").attr("pointer-events","all").on("mousedown.brush",f).filter(r).on("touchstart.brush",f).on("touchmove.brush",d).on("touchend.brush touchcancel.brush",p).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}c.move=function(m,_,b){m.tween?m.on("start.brush",function(v){l(this,arguments).beforestart().start(v)}).on("interrupt.brush end.brush",function(v){l(this,arguments).end(v)}).tween("brush",function(){var v=this,y=v.__brush,w=l(v,arguments),x=y.selection,C=t.input(typeof _=="function"?_.apply(this,arguments):_,y.extent),S=gr(x,C);function A(N){y.selection=N===1&&C===null?null:S(N),u.call(v),w.brush()}return x!==null&&C!==null?A:A(1)}):m.each(function(){var v=this,y=arguments,w=v.__brush,x=t.input(typeof _=="function"?_.apply(v,y):_,w.extent),C=l(v,y).beforestart();Pr(v),w.selection=x===null?null:x,u.call(v),C.start(b).brush(b).end(b)})},c.clear=function(m,_){c.move(m,null,_)};function u(){var m=ot(this),_=Yh(this).selection;_?(m.selectAll(".selection").style("display",null).attr("x",_[0][0]).attr("y",_[0][1]).attr("width",_[1][0]-_[0][0]).attr("height",_[1][1]-_[0][1]),m.selectAll(".handle").style("display",null).attr("x",function(b){return b.type[b.type.length-1]==="e"?_[1][0]-o/2:_[0][0]-o/2}).attr("y",function(b){return b.type[0]==="s"?_[1][1]-o/2:_[0][1]-o/2}).attr("width",function(b){return b.type==="n"||b.type==="s"?_[1][0]-_[0][0]+o:o}).attr("height",function(b){return b.type==="e"||b.type==="w"?_[1][1]-_[0][1]+o:o})):m.selectAll(".selection,.handle").style("display","none").attr("x",null).attr("y",null).attr("width",null).attr("height",null)}function l(m,_,b){var v=m.__brush.emitter;return v&&(!b||!v.clean)?v:new h(m,_,b)}function h(m,_,b){this.that=m,this.args=_,this.state=m.__brush,this.active=0,this.clean=b}h.prototype={beforestart:function(){return++this.active===1&&(this.state.emitter=this,this.starting=!0),this},start:function(m,_){return this.starting?(this.starting=!1,this.emit("start",m,_)):this.emit("brush",m),this},brush:function(m,_){return this.emit("brush",m,_),this},end:function(m,_){return--this.active===0&&(delete this.state.emitter,this.emit("end",m,_)),this},emit:function(m,_,b){var v=ot(this.that).datum();s.call(m,this.that,new _I(m,{sourceEvent:_,target:c,selection:t.output(this.state.selection),mode:b,dispatch:s}),v)}};function f(m){if(a&&!m.touches||!n.apply(this,arguments))return;var _=this,b=m.target.__data__.type,v=(i&&m.metaKey?b="overlay":b)==="selection"?n_:i&&m.altKey?ui:ci,y=t===Ta?null:bI[b],w=t===xa?null:wI[b],x=Yh(_),C=x.extent,S=x.selection,A=C[0][0],N,T,k=C[0][1],I,M,E=C[1][0],R,O,q=C[1][1],D,$,F=0,L=0,te,Z=y&&w&&i&&m.shiftKey,W,ne,J=Array.from(m.touches||[m],U=>{const se=U.identifier;return U=Dt(U,_),U.point0=U.slice(),U.identifier=se,U});Pr(_);var B=l(_,arguments,!0).beforestart();if(b==="overlay"){S&&(te=!0);const U=[J[0],J[1]||J[0]];x.selection=S=[[N=t===Ta?A:rt(U[0][0],U[1][0]),I=t===xa?k:rt(U[0][1],U[1][1])],[R=t===Ta?E:nt(U[0][0],U[1][0]),D=t===xa?q:nt(U[0][1],U[1][1])]],J.length>1&&ve(m)}else N=S[0][0],I=S[0][1],R=S[1][0],D=S[1][1];T=N,M=I,O=R,$=D;var z=ot(_).attr("pointer-events","none"),Y=z.selectAll(".overlay").attr("cursor",Nn[b]);if(m.touches)B.moved=V,B.ended=ge;else{var K=ot(m.view).on("mousemove.brush",V,!0).on("mouseup.brush",ge,!0);i&&K.on("keydown.brush",j,!0).on("keyup.brush",H,!0),Iu(m.view)}u.call(_),B.start(m,v.name);function V(U){for(const se of U.changedTouches||[U])for(const le of J)le.identifier===se.identifier&&(le.cur=Dt(se,_));if(Z&&!W&&!ne&&J.length===1){const se=J[0];r_(se.cur[0]-se[0])>r_(se.cur[1]-se[1])?ne=!0:W=!0}for(const se of J)se.cur&&(se[0]=se.cur[0],se[1]=se.cur[1]);te=!0,Gh(U),ve(U)}function ve(U){const se=J[0],le=se.point0;var me;switch(F=se[0]-le[0],L=se[1]-le[1],v){case Hh:case n_:{y&&(F=nt(A-N,rt(E-R,F)),T=N+F,O=R+F),w&&(L=nt(k-I,rt(q-D,L)),M=I+L,$=D+L);break}case ci:{J[1]?(y&&(T=nt(A,rt(E,J[0][0])),O=nt(A,rt(E,J[1][0])),y=1),w&&(M=nt(k,rt(q,J[0][1])),$=nt(k,rt(q,J[1][1])),w=1)):(y<0?(F=nt(A-N,rt(E-N,F)),T=N+F,O=R):y>0&&(F=nt(A-R,rt(E-R,F)),T=N,O=R+F),w<0?(L=nt(k-I,rt(q-I,L)),M=I+L,$=D):w>0&&(L=nt(k-D,rt(q-D,L)),M=I,$=D+L));break}case ui:{y&&(T=nt(A,rt(E,N-F*y)),O=nt(A,rt(E,R+F*y))),w&&(M=nt(k,rt(q,I-L*w)),$=nt(k,rt(q,D+L*w)));break}}O<T&&(y*=-1,me=N,N=R,R=me,me=T,T=O,O=me,b in s_&&Y.attr("cursor",Nn[b=s_[b]])),$<M&&(w*=-1,me=I,I=D,D=me,me=M,M=$,$=me,b in o_&&Y.attr("cursor",Nn[b=o_[b]])),x.selection&&(S=x.selection),W&&(T=S[0][0],O=S[1][0]),ne&&(M=S[0][1],$=S[1][1]),(S[0][0]!==T||S[0][1]!==M||S[1][0]!==O||S[1][1]!==$)&&(x.selection=[[T,M],[O,$]],u.call(_),B.brush(U,v.name))}function ge(U){if(yI(U),U.touches){if(U.touches.length)return;a&&clearTimeout(a),a=setTimeout(function(){a=null},500)}else Ou(U.view,te),K.on("keydown.brush keyup.brush mousemove.brush mouseup.brush",null);z.attr("pointer-events","all"),Y.attr("cursor",Nn.overlay),x.selection&&(S=x.selection),CI(S)&&(x.selection=null,u.call(_)),B.end(U,v.name)}function j(U){switch(U.keyCode){case 16:{Z=y&&w;break}case 18:{v===ci&&(y&&(R=O-F*y,N=T+F*y),w&&(D=$-L*w,I=M+L*w),v=ui,ve(U));break}case 32:{(v===ci||v===ui)&&(y<0?R=O-F:y>0&&(N=T-F),w<0?D=$-L:w>0&&(I=M-L),v=Hh,Y.attr("cursor",Nn.selection),ve(U));break}default:return}Gh(U)}function H(U){switch(U.keyCode){case 16:{Z&&(W=ne=Z=!1,ve(U));break}case 18:{v===ui&&(y<0?R=O:y>0&&(N=T),w<0?D=$:w>0&&(I=M),v=ci,ve(U));break}case 32:{v===Hh&&(U.altKey?(y&&(R=O-F*y,N=T+F*y),w&&(D=$-L*w,I=M+L*w),v=ui):(y<0?R=O:y>0&&(N=T),w<0?D=$:w>0&&(I=M),v=ci),Y.attr("cursor",Nn[b]),ve(U));break}default:return}Gh(U)}}function d(m){l(this,arguments).moved(m)}function p(m){l(this,arguments).ended(m)}function g(){var m=this.__brush||{selection:null};return m.extent=Kf(e.apply(this,arguments)),m.dim=t,m}return c.extent=function(m){return arguments.length?(e=typeof m=="function"?m:Uh(Kf(m)),c):e},c.filter=function(m){return arguments.length?(n=typeof m=="function"?m:Uh(!!m),c):n},c.touchable=function(m){return arguments.length?(r=typeof m=="function"?m:Uh(!!m),c):r},c.handleSize=function(m){return arguments.length?(o=+m,c):o},c.keyModifiers=function(m){return arguments.length?(i=!!m,c):i},c.on=function(){var m=s.on.apply(s,arguments);return m===s?c:m},c}var a_=Math.abs,li=Math.cos,hi=Math.sin,Nw=Math.PI,ta=Nw/2,c_=Nw*2,u_=Math.max,Xh=1e-12;function Zh(t,e){return Array.from({length:e-t},(n,r)=>t+r)}function EI(t){return function(e,n){return t(e.source.value+e.target.value,n.source.value+n.target.value)}}function RI(){return c0(!1,!1)}function II(){return c0(!1,!0)}function OI(){return c0(!0,!1)}function c0(t,e){var n=0,r=null,i=null,s=null;function o(a){var c=a.length,u=new Array(c),l=Zh(0,c),h=new Array(c*c),f=new Array(c),d=0,p;a=Float64Array.from({length:c*c},e?(g,m)=>a[m%c][m/c|0]:(g,m)=>a[m/c|0][m%c]);for(let g=0;g<c;++g){let m=0;for(let _=0;_<c;++_)m+=a[g*c+_]+t*a[_*c+g];d+=u[g]=m}d=u_(0,c_-n*c)/d,p=d?n:c_/c;{let g=0;r&&l.sort((m,_)=>r(u[m],u[_]));for(const m of l){const _=g;if(t){const b=Zh(~c+1,c).filter(v=>v<0?a[~v*c+m]:a[m*c+v]);i&&b.sort((v,y)=>i(v<0?-a[~v*c+m]:a[m*c+v],y<0?-a[~y*c+m]:a[m*c+y]));for(const v of b)if(v<0){const y=h[~v*c+m]||(h[~v*c+m]={source:null,target:null});y.target={index:m,startAngle:g,endAngle:g+=a[~v*c+m]*d,value:a[~v*c+m]}}else{const y=h[m*c+v]||(h[m*c+v]={source:null,target:null});y.source={index:m,startAngle:g,endAngle:g+=a[m*c+v]*d,value:a[m*c+v]}}f[m]={index:m,startAngle:_,endAngle:g,value:u[m]}}else{const b=Zh(0,c).filter(v=>a[m*c+v]||a[v*c+m]);i&&b.sort((v,y)=>i(a[m*c+v],a[m*c+y]));for(const v of b){let y;if(m<v?(y=h[m*c+v]||(h[m*c+v]={source:null,target:null}),y.source={index:m,startAngle:g,endAngle:g+=a[m*c+v]*d,value:a[m*c+v]}):(y=h[v*c+m]||(h[v*c+m]={source:null,target:null}),y.target={index:m,startAngle:g,endAngle:g+=a[m*c+v]*d,value:a[m*c+v]},m===v&&(y.source=y.target)),y.source&&y.target&&y.source.value<y.target.value){const w=y.source;y.source=y.target,y.target=w}}f[m]={index:m,startAngle:_,endAngle:g,value:u[m]}}g+=p}}return h=Object.values(h),h.groups=f,s?h.sort(s):h}return o.padAngle=function(a){return arguments.length?(n=u_(0,a),o):n},o.sortGroups=function(a){return arguments.length?(r=a,o):r},o.sortSubgroups=function(a){return arguments.length?(i=a,o):i},o.sortChords=function(a){return arguments.length?(a==null?s=null:(s=EI(a))._=a,o):s&&s._},o}var DI=Array.prototype.slice;function xr(t){return function(){return t}}function PI(t){return t.source}function qI(t){return t.target}function l_(t){return t.radius}function FI(t){return t.startAngle}function $I(t){return t.endAngle}function VI(){return 0}function LI(){return 10}function kw(t){var e=PI,n=qI,r=l_,i=l_,s=FI,o=$I,a=VI,c=null;function u(){var l,h=e.apply(this,arguments),f=n.apply(this,arguments),d=a.apply(this,arguments)/2,p=DI.call(arguments),g=+r.apply(this,(p[0]=h,p)),m=s.apply(this,p)-ta,_=o.apply(this,p)-ta,b=+i.apply(this,(p[0]=f,p)),v=s.apply(this,p)-ta,y=o.apply(this,p)-ta;if(c||(c=l=Rd()),d>Xh&&(a_(_-m)>d*2+Xh?_>m?(m+=d,_-=d):(m-=d,_+=d):m=_=(m+_)/2,a_(y-v)>d*2+Xh?y>v?(v+=d,y-=d):(v-=d,y+=d):v=y=(v+y)/2),c.moveTo(g*li(m),g*hi(m)),c.arc(0,0,g,m,_),m!==v||_!==y)if(t){var w=+t.apply(this,arguments),x=b-w,C=(v+y)/2;c.quadraticCurveTo(0,0,x*li(v),x*hi(v)),c.lineTo(b*li(C),b*hi(C)),c.lineTo(x*li(y),x*hi(y))}else c.quadraticCurveTo(0,0,b*li(v),b*hi(v)),c.arc(0,0,b,v,y);if(c.quadraticCurveTo(0,0,g*li(m),g*hi(m)),c.closePath(),l)return c=null,l+""||null}return t&&(u.headRadius=function(l){return arguments.length?(t=typeof l=="function"?l:xr(+l),u):t}),u.radius=function(l){return arguments.length?(r=i=typeof l=="function"?l:xr(+l),u):r},u.sourceRadius=function(l){return arguments.length?(r=typeof l=="function"?l:xr(+l),u):r},u.targetRadius=function(l){return arguments.length?(i=typeof l=="function"?l:xr(+l),u):i},u.startAngle=function(l){return arguments.length?(s=typeof l=="function"?l:xr(+l),u):s},u.endAngle=function(l){return arguments.length?(o=typeof l=="function"?l:xr(+l),u):o},u.padAngle=function(l){return arguments.length?(a=typeof l=="function"?l:xr(+l),u):a},u.source=function(l){return arguments.length?(e=l,u):e},u.target=function(l){return arguments.length?(n=l,u):n},u.context=function(l){return arguments.length?(c=l??null,u):c},u}function jI(){return kw()}function zI(){return kw(LI)}var BI=Array.prototype,Ew=BI.slice;function WI(t,e){return t-e}function UI(t){for(var e=0,n=t.length,r=t[n-1][1]*t[0][0]-t[n-1][0]*t[0][1];++e<n;)r+=t[e-1][1]*t[e][0]-t[e-1][0]*t[e][1];return r}const Jn=t=>()=>t;function GI(t,e){for(var n=-1,r=e.length,i;++n<r;)if(i=HI(t,e[n]))return i;return 0}function HI(t,e){for(var n=e[0],r=e[1],i=-1,s=0,o=t.length,a=o-1;s<o;a=s++){var c=t[s],u=c[0],l=c[1],h=t[a],f=h[0],d=h[1];if(YI(c,h,e))return 0;l>r!=d>r&&n<(f-u)*(r-l)/(d-l)+u&&(i=-i)}return i}function YI(t,e,n){var r;return XI(t,e,n)&&ZI(t[r=+(t[0]===e[0])],n[r],e[r])}function XI(t,e,n){return(e[0]-t[0])*(n[1]-t[1])===(n[0]-t[0])*(e[1]-t[1])}function ZI(t,e,n){return t<=e&&e<=n||n<=e&&e<=t}function KI(){}var kn=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function Qf(){var t=1,e=1,n=Bd,r=c;function i(u){var l=n(u);if(Array.isArray(l))l=l.slice().sort(WI);else{const h=Fs(u,QI);for(l=Fr(...zd(h[0],h[1],l),l);l[l.length-1]>=h[1];)l.pop();for(;l[1]<h[0];)l.shift()}return l.map(h=>s(u,h))}function s(u,l){const h=l==null?NaN:+l;if(isNaN(h))throw new Error(`invalid value: ${l}`);var f=[],d=[];return o(u,h,function(p){r(p,u,h),UI(p)>0?f.push([p]):d.push(p)}),d.forEach(function(p){for(var g=0,m=f.length,_;g<m;++g)if(GI((_=f[g])[0],p)!==-1){_.push(p);return}}),{type:"MultiPolygon",value:l,coordinates:f}}function o(u,l,h){var f=new Array,d=new Array,p,g,m,_,b,v;for(p=g=-1,_=Tr(u[0],l),kn[_<<1].forEach(y);++p<t-1;)m=_,_=Tr(u[p+1],l),kn[m|_<<1].forEach(y);for(kn[_<<0].forEach(y);++g<e-1;){for(p=-1,_=Tr(u[g*t+t],l),b=Tr(u[g*t],l),kn[_<<1|b<<2].forEach(y);++p<t-1;)m=_,_=Tr(u[g*t+t+p+1],l),v=b,b=Tr(u[g*t+p+1],l),kn[m|_<<1|b<<2|v<<3].forEach(y);kn[_|b<<3].forEach(y)}for(p=-1,b=u[g*t]>=l,kn[b<<2].forEach(y);++p<t-1;)v=b,b=Tr(u[g*t+p+1],l),kn[b<<2|v<<3].forEach(y);kn[b<<3].forEach(y);function y(w){var x=[w[0][0]+p,w[0][1]+g],C=[w[1][0]+p,w[1][1]+g],S=a(x),A=a(C),N,T;(N=d[S])?(T=f[A])?(delete d[N.end],delete f[T.start],N===T?(N.ring.push(C),h(N.ring)):f[N.start]=d[T.end]={start:N.start,end:T.end,ring:N.ring.concat(T.ring)}):(delete d[N.end],N.ring.push(C),d[N.end=A]=N):(N=f[A])?(T=d[S])?(delete f[N.start],delete d[T.end],N===T?(N.ring.push(C),h(N.ring)):f[T.start]=d[N.end]={start:T.start,end:N.end,ring:T.ring.concat(N.ring)}):(delete f[N.start],N.ring.unshift(x),f[N.start=S]=N):f[S]=d[A]={start:S,end:A,ring:[x,C]}}}function a(u){return u[0]*2+u[1]*(t+1)*4}function c(u,l,h){u.forEach(function(f){var d=f[0],p=f[1],g=d|0,m=p|0,_=Kh(l[m*t+g]);d>0&&d<t&&g===d&&(f[0]=h_(d,Kh(l[m*t+g-1]),_,h)),p>0&&p<e&&m===p&&(f[1]=h_(p,Kh(l[(m-1)*t+g]),_,h))})}return i.contour=s,i.size=function(u){if(!arguments.length)return[t,e];var l=Math.floor(u[0]),h=Math.floor(u[1]);if(!(l>=0&&h>=0))throw new Error("invalid size");return t=l,e=h,i},i.thresholds=function(u){return arguments.length?(n=typeof u=="function"?u:Array.isArray(u)?Jn(Ew.call(u)):Jn(u),i):n},i.smooth=function(u){return arguments.length?(r=u?c:KI,i):r===c},i}function QI(t){return isFinite(t)?t:NaN}function Tr(t,e){return t==null?!1:+t>=e}function Kh(t){return t==null||isNaN(t=+t)?-1/0:t}function h_(t,e,n,r){const i=r-e,s=n-e,o=isFinite(i)||isFinite(s)?i/s:Math.sign(i)/Math.sign(s);return isNaN(o)?t:t+o-.5}function JI(t){return t[0]}function eO(t){return t[1]}function tO(){return 1}function nO(){var t=JI,e=eO,n=tO,r=960,i=500,s=20,o=2,a=s*3,c=r+a*2>>o,u=i+a*2>>o,l=Jn(20);function h(b){var v=new Float32Array(c*u),y=Math.pow(2,-o),w=-1;for(const I of b){var x=(t(I,++w,b)+a)*y,C=(e(I,w,b)+a)*y,S=+n(I,w,b);if(S&&x>=0&&x<c&&C>=0&&C<u){var A=Math.floor(x),N=Math.floor(C),T=x-A-.5,k=C-N-.5;v[A+N*c]+=(1-T)*(1-k)*S,v[A+1+N*c]+=T*(1-k)*S,v[A+1+(N+1)*c]+=T*k*S,v[A+(N+1)*c]+=(1-T)*k*S}}return lv({data:v,width:c,height:u},s*y),v}function f(b){var v=h(b),y=l(v),w=Math.pow(2,2*o);return Array.isArray(y)||(y=Fr(Number.MIN_VALUE,Hs(v)/w,y)),Qf().size([c,u]).thresholds(y.map(x=>x*w))(v).map((x,C)=>(x.value=+y[C],d(x)))}f.contours=function(b){var v=h(b),y=Qf().size([c,u]),w=Math.pow(2,2*o),x=C=>{C=+C;var S=d(y.contour(v,C*w));return S.value=C,S};return Object.defineProperty(x,"max",{get:()=>Hs(v)/w}),x};function d(b){return b.coordinates.forEach(p),b}function p(b){b.forEach(g)}function g(b){b.forEach(m)}function m(b){b[0]=b[0]*Math.pow(2,o)-a,b[1]=b[1]*Math.pow(2,o)-a}function _(){return a=s*3,c=r+a*2>>o,u=i+a*2>>o,f}return f.x=function(b){return arguments.length?(t=typeof b=="function"?b:Jn(+b),f):t},f.y=function(b){return arguments.length?(e=typeof b=="function"?b:Jn(+b),f):e},f.weight=function(b){return arguments.length?(n=typeof b=="function"?b:Jn(+b),f):n},f.size=function(b){if(!arguments.length)return[r,i];var v=+b[0],y=+b[1];if(!(v>=0&&y>=0))throw new Error("invalid size");return r=v,i=y,_()},f.cellSize=function(b){if(!arguments.length)return 1<<o;if(!((b=+b)>=1))throw new Error("invalid cell size");return o=Math.floor(Math.log(b)/Math.LN2),_()},f.thresholds=function(b){return arguments.length?(l=typeof b=="function"?b:Array.isArray(b)?Jn(Ew.call(b)):Jn(b),f):l},f.bandwidth=function(b){if(!arguments.length)return Math.sqrt(s*(s+1));if(!((b=+b)>=0))throw new Error("invalid bandwidth");return s=(Math.sqrt(4*b*b+1)-1)/2,_()},f}const $n=11102230246251565e-32,it=134217729,rO=(3+8*$n)*$n;function Qh(t,e,n,r,i){let s,o,a,c,u=e[0],l=r[0],h=0,f=0;l>u==l>-u?(s=u,u=e[++h]):(s=l,l=r[++f]);let d=0;if(h<t&&f<n)for(l>u==l>-u?(o=u+s,a=s-(o-u),u=e[++h]):(o=l+s,a=s-(o-l),l=r[++f]),s=o,a!==0&&(i[d++]=a);h<t&&f<n;)l>u==l>-u?(o=s+u,c=o-s,a=s-(o-c)+(u-c),u=e[++h]):(o=s+l,c=o-s,a=s-(o-c)+(l-c),l=r[++f]),s=o,a!==0&&(i[d++]=a);for(;h<t;)o=s+u,c=o-s,a=s-(o-c)+(u-c),u=e[++h],s=o,a!==0&&(i[d++]=a);for(;f<n;)o=s+l,c=o-s,a=s-(o-c)+(l-c),l=r[++f],s=o,a!==0&&(i[d++]=a);return(s!==0||d===0)&&(i[d++]=s),d}function iO(t,e){let n=e[0];for(let r=1;r<t;r++)n+=e[r];return n}function Oo(t){return new Float64Array(t)}const sO=(3+16*$n)*$n,oO=(2+12*$n)*$n,aO=(9+64*$n)*$n*$n,fi=Oo(4),f_=Oo(8),d_=Oo(12),p_=Oo(16),ht=Oo(4);function cO(t,e,n,r,i,s,o){let a,c,u,l,h,f,d,p,g,m,_,b,v,y,w,x,C,S;const A=t-i,N=n-i,T=e-s,k=r-s;y=A*k,f=it*A,d=f-(f-A),p=A-d,f=it*k,g=f-(f-k),m=k-g,w=p*m-(y-d*g-p*g-d*m),x=T*N,f=it*T,d=f-(f-T),p=T-d,f=it*N,g=f-(f-N),m=N-g,C=p*m-(x-d*g-p*g-d*m),_=w-C,h=w-_,fi[0]=w-(_+h)+(h-C),b=y+_,h=b-y,v=y-(b-h)+(_-h),_=v-x,h=v-_,fi[1]=v-(_+h)+(h-x),S=b+_,h=S-b,fi[2]=b-(S-h)+(_-h),fi[3]=S;let I=iO(4,fi),M=oO*o;if(I>=M||-I>=M||(h=t-A,a=t-(A+h)+(h-i),h=n-N,u=n-(N+h)+(h-i),h=e-T,c=e-(T+h)+(h-s),h=r-k,l=r-(k+h)+(h-s),a===0&&c===0&&u===0&&l===0)||(M=aO*o+rO*Math.abs(I),I+=A*l+k*a-(T*u+N*c),I>=M||-I>=M))return I;y=a*k,f=it*a,d=f-(f-a),p=a-d,f=it*k,g=f-(f-k),m=k-g,w=p*m-(y-d*g-p*g-d*m),x=c*N,f=it*c,d=f-(f-c),p=c-d,f=it*N,g=f-(f-N),m=N-g,C=p*m-(x-d*g-p*g-d*m),_=w-C,h=w-_,ht[0]=w-(_+h)+(h-C),b=y+_,h=b-y,v=y-(b-h)+(_-h),_=v-x,h=v-_,ht[1]=v-(_+h)+(h-x),S=b+_,h=S-b,ht[2]=b-(S-h)+(_-h),ht[3]=S;const E=Qh(4,fi,4,ht,f_);y=A*l,f=it*A,d=f-(f-A),p=A-d,f=it*l,g=f-(f-l),m=l-g,w=p*m-(y-d*g-p*g-d*m),x=T*u,f=it*T,d=f-(f-T),p=T-d,f=it*u,g=f-(f-u),m=u-g,C=p*m-(x-d*g-p*g-d*m),_=w-C,h=w-_,ht[0]=w-(_+h)+(h-C),b=y+_,h=b-y,v=y-(b-h)+(_-h),_=v-x,h=v-_,ht[1]=v-(_+h)+(h-x),S=b+_,h=S-b,ht[2]=b-(S-h)+(_-h),ht[3]=S;const R=Qh(E,f_,4,ht,d_);y=a*l,f=it*a,d=f-(f-a),p=a-d,f=it*l,g=f-(f-l),m=l-g,w=p*m-(y-d*g-p*g-d*m),x=c*u,f=it*c,d=f-(f-c),p=c-d,f=it*u,g=f-(f-u),m=u-g,C=p*m-(x-d*g-p*g-d*m),_=w-C,h=w-_,ht[0]=w-(_+h)+(h-C),b=y+_,h=b-y,v=y-(b-h)+(_-h),_=v-x,h=v-_,ht[1]=v-(_+h)+(h-x),S=b+_,h=S-b,ht[2]=b-(S-h)+(_-h),ht[3]=S;const O=Qh(R,d_,4,ht,p_);return p_[O-1]}function na(t,e,n,r,i,s){const o=(e-s)*(n-i),a=(t-i)*(r-s),c=o-a,u=Math.abs(o+a);return Math.abs(c)>=sO*u?c:-cO(t,e,n,r,i,s,u)}const m_=Math.pow(2,-52),ra=new Uint32Array(512);class oc{static from(e,n=dO,r=pO){const i=e.length,s=new Float64Array(i*2);for(let o=0;o<i;o++){const a=e[o];s[2*o]=n(a),s[2*o+1]=r(a)}return new oc(s)}constructor(e){const n=e.length>>1;if(n>0&&typeof e[0]!="number")throw new Error("Expected coords to contain numbers.");this.coords=e;const r=Math.max(2*n-5,0);this._triangles=new Uint32Array(r*3),this._halfedges=new Int32Array(r*3),this._hashSize=Math.ceil(Math.sqrt(n)),this._hullPrev=new Uint32Array(n),this._hullNext=new Uint32Array(n),this._hullTri=new Uint32Array(n),this._hullHash=new Int32Array(this._hashSize),this._ids=new Uint32Array(n),this._dists=new Float64Array(n),this.update()}update(){const{coords:e,_hullPrev:n,_hullNext:r,_hullTri:i,_hullHash:s}=this,o=e.length>>1;let a=1/0,c=1/0,u=-1/0,l=-1/0;for(let A=0;A<o;A++){const N=e[2*A],T=e[2*A+1];N<a&&(a=N),T<c&&(c=T),N>u&&(u=N),T>l&&(l=T),this._ids[A]=A}const h=(a+u)/2,f=(c+l)/2;let d,p,g;for(let A=0,N=1/0;A<o;A++){const T=Jh(h,f,e[2*A],e[2*A+1]);T<N&&(d=A,N=T)}const m=e[2*d],_=e[2*d+1];for(let A=0,N=1/0;A<o;A++){if(A===d)continue;const T=Jh(m,_,e[2*A],e[2*A+1]);T<N&&T>0&&(p=A,N=T)}let b=e[2*p],v=e[2*p+1],y=1/0;for(let A=0;A<o;A++){if(A===d||A===p)continue;const N=hO(m,_,b,v,e[2*A],e[2*A+1]);N<y&&(g=A,y=N)}let w=e[2*g],x=e[2*g+1];if(y===1/0){for(let T=0;T<o;T++)this._dists[T]=e[2*T]-e[0]||e[2*T+1]-e[1];bi(this._ids,this._dists,0,o-1);const A=new Uint32Array(o);let N=0;for(let T=0,k=-1/0;T<o;T++){const I=this._ids[T],M=this._dists[I];M>k&&(A[N++]=I,k=M)}this.hull=A.subarray(0,N),this.triangles=new Uint32Array(0),this.halfedges=new Uint32Array(0);return}if(na(m,_,b,v,w,x)<0){const A=p,N=b,T=v;p=g,b=w,v=x,g=A,w=N,x=T}const C=fO(m,_,b,v,w,x);this._cx=C.x,this._cy=C.y;for(let A=0;A<o;A++)this._dists[A]=Jh(e[2*A],e[2*A+1],C.x,C.y);bi(this._ids,this._dists,0,o-1),this._hullStart=d;let S=3;r[d]=n[g]=p,r[p]=n[d]=g,r[g]=n[p]=d,i[d]=0,i[p]=1,i[g]=2,s.fill(-1),s[this._hashKey(m,_)]=d,s[this._hashKey(b,v)]=p,s[this._hashKey(w,x)]=g,this.trianglesLen=0,this._addTriangle(d,p,g,-1,-1,-1);for(let A=0,N,T;A<this._ids.length;A++){const k=this._ids[A],I=e[2*k],M=e[2*k+1];if(A>0&&Math.abs(I-N)<=m_&&Math.abs(M-T)<=m_||(N=I,T=M,k===d||k===p||k===g))continue;let E=0;for(let $=0,F=this._hashKey(I,M);$<this._hashSize&&(E=s[(F+$)%this._hashSize],!(E!==-1&&E!==r[E]));$++);E=n[E];let R=E,O;for(;O=r[R],na(I,M,e[2*R],e[2*R+1],e[2*O],e[2*O+1])>=0;)if(R=O,R===E){R=-1;break}if(R===-1)continue;let q=this._addTriangle(R,k,r[R],-1,-1,i[R]);i[k]=this._legalize(q+2),i[R]=q,S++;let D=r[R];for(;O=r[D],na(I,M,e[2*D],e[2*D+1],e[2*O],e[2*O+1])<0;)q=this._addTriangle(D,k,O,i[k],-1,i[D]),i[k]=this._legalize(q+2),r[D]=D,S--,D=O;if(R===E)for(;O=n[R],na(I,M,e[2*O],e[2*O+1],e[2*R],e[2*R+1])<0;)q=this._addTriangle(O,k,R,-1,i[R],i[O]),this._legalize(q+2),i[O]=q,r[R]=R,S--,R=O;this._hullStart=n[k]=R,r[R]=n[D]=k,r[k]=D,s[this._hashKey(I,M)]=k,s[this._hashKey(e[2*R],e[2*R+1])]=R}this.hull=new Uint32Array(S);for(let A=0,N=this._hullStart;A<S;A++)this.hull[A]=N,N=r[N];this.triangles=this._triangles.subarray(0,this.trianglesLen),this.halfedges=this._halfedges.subarray(0,this.trianglesLen)}_hashKey(e,n){return Math.floor(uO(e-this._cx,n-this._cy)*this._hashSize)%this._hashSize}_legalize(e){const{_triangles:n,_halfedges:r,coords:i}=this;let s=0,o=0;for(;;){const a=r[e],c=e-e%3;if(o=c+(e+2)%3,a===-1){if(s===0)break;e=ra[--s];continue}const u=a-a%3,l=c+(e+1)%3,h=u+(a+2)%3,f=n[o],d=n[e],p=n[l],g=n[h];if(lO(i[2*f],i[2*f+1],i[2*d],i[2*d+1],i[2*p],i[2*p+1],i[2*g],i[2*g+1])){n[e]=g,n[a]=f;const _=r[h];if(_===-1){let v=this._hullStart;do{if(this._hullTri[v]===h){this._hullTri[v]=e;break}v=this._hullPrev[v]}while(v!==this._hullStart)}this._link(e,_),this._link(a,r[o]),this._link(o,h);const b=u+(a+1)%3;s<ra.length&&(ra[s++]=b)}else{if(s===0)break;e=ra[--s]}}return o}_link(e,n){this._halfedges[e]=n,n!==-1&&(this._halfedges[n]=e)}_addTriangle(e,n,r,i,s,o){const a=this.trianglesLen;return this._triangles[a]=e,this._triangles[a+1]=n,this._triangles[a+2]=r,this._link(a,i),this._link(a+1,s),this._link(a+2,o),this.trianglesLen+=3,a}}function uO(t,e){const n=t/(Math.abs(t)+Math.abs(e));return(e>0?3-n:1+n)/4}function Jh(t,e,n,r){const i=t-n,s=e-r;return i*i+s*s}function lO(t,e,n,r,i,s,o,a){const c=t-o,u=e-a,l=n-o,h=r-a,f=i-o,d=s-a,p=c*c+u*u,g=l*l+h*h,m=f*f+d*d;return c*(h*m-g*d)-u*(l*m-g*f)+p*(l*d-h*f)<0}function hO(t,e,n,r,i,s){const o=n-t,a=r-e,c=i-t,u=s-e,l=o*o+a*a,h=c*c+u*u,f=.5/(o*u-a*c),d=(u*l-a*h)*f,p=(o*h-c*l)*f;return d*d+p*p}function fO(t,e,n,r,i,s){const o=n-t,a=r-e,c=i-t,u=s-e,l=o*o+a*a,h=c*c+u*u,f=.5/(o*u-a*c),d=t+(u*l-a*h)*f,p=e+(o*h-c*l)*f;return{x:d,y:p}}function bi(t,e,n,r){if(r-n<=20)for(let i=n+1;i<=r;i++){const s=t[i],o=e[s];let a=i-1;for(;a>=n&&e[t[a]]>o;)t[a+1]=t[a--];t[a+1]=s}else{const i=n+r>>1;let s=n+1,o=r;ys(t,i,s),e[t[n]]>e[t[r]]&&ys(t,n,r),e[t[s]]>e[t[r]]&&ys(t,s,r),e[t[n]]>e[t[s]]&&ys(t,n,s);const a=t[s],c=e[a];for(;;){do s++;while(e[t[s]]<c);do o--;while(e[t[o]]>c);if(o<s)break;ys(t,s,o)}t[n+1]=t[o],t[o]=a,r-s+1>=o-n?(bi(t,e,s,r),bi(t,e,n,o-1)):(bi(t,e,n,o-1),bi(t,e,s,r))}}function ys(t,e,n){const r=t[e];t[e]=t[n],t[n]=r}function dO(t){return t[0]}function pO(t){return t[1]}const g_=1e-6;class Er{constructor(){this._x0=this._y0=this._x1=this._y1=null,this._=""}moveTo(e,n){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._+="Z")}lineTo(e,n){this._+=`L${this._x1=+e},${this._y1=+n}`}arc(e,n,r){e=+e,n=+n,r=+r;const i=e+r,s=n;if(r<0)throw new Error("negative radius");this._x1===null?this._+=`M${i},${s}`:(Math.abs(this._x1-i)>g_||Math.abs(this._y1-s)>g_)&&(this._+="L"+i+","+s),r&&(this._+=`A${r},${r},0,1,1,${e-r},${n}A${r},${r},0,1,1,${this._x1=i},${this._y1=s}`)}rect(e,n,r,i){this._+=`M${this._x0=this._x1=+e},${this._y0=this._y1=+n}h${+r}v${+i}h${-r}Z`}value(){return this._||null}}class Jf{constructor(){this._=[]}moveTo(e,n){this._.push([e,n])}closePath(){this._.push(this._[0].slice())}lineTo(e,n){this._.push([e,n])}value(){return this._.length?this._:null}}class Rw{constructor(e,[n,r,i,s]=[0,0,960,500]){if(!((i=+i)>=(n=+n))||!((s=+s)>=(r=+r)))throw new Error("invalid bounds");this.delaunay=e,this._circumcenters=new Float64Array(e.points.length*2),this.vectors=new Float64Array(e.points.length*2),this.xmax=i,this.xmin=n,this.ymax=s,this.ymin=r,this._init()}update(){return this.delaunay.update(),this._init(),this}_init(){const{delaunay:{points:e,hull:n,triangles:r},vectors:i}=this;let s,o;const a=this.circumcenters=this._circumcenters.subarray(0,r.length/3*2);for(let g=0,m=0,_=r.length,b,v;g<_;g+=3,m+=2){const y=r[g]*2,w=r[g+1]*2,x=r[g+2]*2,C=e[y],S=e[y+1],A=e[w],N=e[w+1],T=e[x],k=e[x+1],I=A-C,M=N-S,E=T-C,R=k-S,O=(I*R-M*E)*2;if(Math.abs(O)<1e-9){if(s===void 0){s=o=0;for(const D of n)s+=e[D*2],o+=e[D*2+1];s/=n.length,o/=n.length}const q=1e9*Math.sign((s-C)*R-(o-S)*E);b=(C+T)/2-q*R,v=(S+k)/2+q*E}else{const q=1/O,D=I*I+M*M,$=E*E+R*R;b=C+(R*D-M*$)*q,v=S+(I*$-E*D)*q}a[m]=b,a[m+1]=v}let c=n[n.length-1],u,l=c*4,h,f=e[2*c],d,p=e[2*c+1];i.fill(0);for(let g=0;g<n.length;++g)c=n[g],u=l,h=f,d=p,l=c*4,f=e[2*c],p=e[2*c+1],i[u+2]=i[l]=d-p,i[u+3]=i[l+1]=f-h}render(e){const n=e==null?e=new Er:void 0,{delaunay:{halfedges:r,inedges:i,hull:s},circumcenters:o,vectors:a}=this;if(s.length<=1)return null;for(let l=0,h=r.length;l<h;++l){const f=r[l];if(f<l)continue;const d=Math.floor(l/3)*2,p=Math.floor(f/3)*2,g=o[d],m=o[d+1],_=o[p],b=o[p+1];this._renderSegment(g,m,_,b,e)}let c,u=s[s.length-1];for(let l=0;l<s.length;++l){c=u,u=s[l];const h=Math.floor(i[u]/3)*2,f=o[h],d=o[h+1],p=c*4,g=this._project(f,d,a[p+2],a[p+3]);g&&this._renderSegment(f,d,g[0],g[1],e)}return n&&n.value()}renderBounds(e){const n=e==null?e=new Er:void 0;return e.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin),n&&n.value()}renderCell(e,n){const r=n==null?n=new Er:void 0,i=this._clip(e);if(i===null||!i.length)return;n.moveTo(i[0],i[1]);let s=i.length;for(;i[0]===i[s-2]&&i[1]===i[s-1]&&s>1;)s-=2;for(let o=2;o<s;o+=2)(i[o]!==i[o-2]||i[o+1]!==i[o-1])&&n.lineTo(i[o],i[o+1]);return n.closePath(),r&&r.value()}*cellPolygons(){const{delaunay:{points:e}}=this;for(let n=0,r=e.length/2;n<r;++n){const i=this.cellPolygon(n);i&&(i.index=n,yield i)}}cellPolygon(e){const n=new Jf;return this.renderCell(e,n),n.value()}_renderSegment(e,n,r,i,s){let o;const a=this._regioncode(e,n),c=this._regioncode(r,i);a===0&&c===0?(s.moveTo(e,n),s.lineTo(r,i)):(o=this._clipSegment(e,n,r,i,a,c))&&(s.moveTo(o[0],o[1]),s.lineTo(o[2],o[3]))}contains(e,n,r){return n=+n,n!==n||(r=+r,r!==r)?!1:this.delaunay._step(e,n,r)===e}*neighbors(e){const n=this._clip(e);if(n)for(const r of this.delaunay.neighbors(e)){const i=this._clip(r);if(i){e:for(let s=0,o=n.length;s<o;s+=2)for(let a=0,c=i.length;a<c;a+=2)if(n[s]===i[a]&&n[s+1]===i[a+1]&&n[(s+2)%o]===i[(a+c-2)%c]&&n[(s+3)%o]===i[(a+c-1)%c]){yield r;break e}}}}_cell(e){const{circumcenters:n,delaunay:{inedges:r,halfedges:i,triangles:s}}=this,o=r[e];if(o===-1)return null;const a=[];let c=o;do{const u=Math.floor(c/3);if(a.push(n[u*2],n[u*2+1]),c=c%3===2?c-2:c+1,s[c]!==e)break;c=i[c]}while(c!==o&&c!==-1);return a}_clip(e){if(e===0&&this.delaunay.hull.length===1)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];const n=this._cell(e);if(n===null)return null;const{vectors:r}=this,i=e*4;return this._simplify(r[i]||r[i+1]?this._clipInfinite(e,n,r[i],r[i+1],r[i+2],r[i+3]):this._clipFinite(e,n))}_clipFinite(e,n){const r=n.length;let i=null,s,o,a=n[r-2],c=n[r-1],u,l=this._regioncode(a,c),h,f=0;for(let d=0;d<r;d+=2)if(s=a,o=c,a=n[d],c=n[d+1],u=l,l=this._regioncode(a,c),u===0&&l===0)h=f,f=0,i?i.push(a,c):i=[a,c];else{let p,g,m,_,b;if(u===0){if((p=this._clipSegment(s,o,a,c,u,l))===null)continue;[g,m,_,b]=p}else{if((p=this._clipSegment(a,c,s,o,l,u))===null)continue;[_,b,g,m]=p,h=f,f=this._edgecode(g,m),h&&f&&this._edge(e,h,f,i,i.length),i?i.push(g,m):i=[g,m]}h=f,f=this._edgecode(_,b),h&&f&&this._edge(e,h,f,i,i.length),i?i.push(_,b):i=[_,b]}if(i)h=f,f=this._edgecode(i[0],i[1]),h&&f&&this._edge(e,h,f,i,i.length);else if(this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];return i}_clipSegment(e,n,r,i,s,o){const a=s<o;for(a&&([e,n,r,i,s,o]=[r,i,e,n,o,s]);;){if(s===0&&o===0)return a?[r,i,e,n]:[e,n,r,i];if(s&o)return null;let c,u,l=s||o;l&8?(c=e+(r-e)*(this.ymax-n)/(i-n),u=this.ymax):l&4?(c=e+(r-e)*(this.ymin-n)/(i-n),u=this.ymin):l&2?(u=n+(i-n)*(this.xmax-e)/(r-e),c=this.xmax):(u=n+(i-n)*(this.xmin-e)/(r-e),c=this.xmin),s?(e=c,n=u,s=this._regioncode(e,n)):(r=c,i=u,o=this._regioncode(r,i))}}_clipInfinite(e,n,r,i,s,o){let a=Array.from(n),c;if((c=this._project(a[0],a[1],r,i))&&a.unshift(c[0],c[1]),(c=this._project(a[a.length-2],a[a.length-1],s,o))&&a.push(c[0],c[1]),a=this._clipFinite(e,a))for(let u=0,l=a.length,h,f=this._edgecode(a[l-2],a[l-1]);u<l;u+=2)h=f,f=this._edgecode(a[u],a[u+1]),h&&f&&(u=this._edge(e,h,f,a,u),l=a.length);else this.contains(e,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(a=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return a}_edge(e,n,r,i,s){for(;n!==r;){let o,a;switch(n){case 5:n=4;continue;case 4:n=6,o=this.xmax,a=this.ymin;break;case 6:n=2;continue;case 2:n=10,o=this.xmax,a=this.ymax;break;case 10:n=8;continue;case 8:n=9,o=this.xmin,a=this.ymax;break;case 9:n=1;continue;case 1:n=5,o=this.xmin,a=this.ymin;break}(i[s]!==o||i[s+1]!==a)&&this.contains(e,o,a)&&(i.splice(s,0,o,a),s+=2)}return s}_project(e,n,r,i){let s=1/0,o,a,c;if(i<0){if(n<=this.ymin)return null;(o=(this.ymin-n)/i)<s&&(c=this.ymin,a=e+(s=o)*r)}else if(i>0){if(n>=this.ymax)return null;(o=(this.ymax-n)/i)<s&&(c=this.ymax,a=e+(s=o)*r)}if(r>0){if(e>=this.xmax)return null;(o=(this.xmax-e)/r)<s&&(a=this.xmax,c=n+(s=o)*i)}else if(r<0){if(e<=this.xmin)return null;(o=(this.xmin-e)/r)<s&&(a=this.xmin,c=n+(s=o)*i)}return[a,c]}_edgecode(e,n){return(e===this.xmin?1:e===this.xmax?2:0)|(n===this.ymin?4:n===this.ymax?8:0)}_regioncode(e,n){return(e<this.xmin?1:e>this.xmax?2:0)|(n<this.ymin?4:n>this.ymax?8:0)}_simplify(e){if(e&&e.length>4){for(let n=0;n<e.length;n+=2){const r=(n+2)%e.length,i=(n+4)%e.length;(e[n]===e[r]&&e[r]===e[i]||e[n+1]===e[r+1]&&e[r+1]===e[i+1])&&(e.splice(r,2),n-=2)}e.length||(e=null)}return e}}const mO=2*Math.PI,di=Math.pow;function gO(t){return t[0]}function _O(t){return t[1]}function yO(t){const{triangles:e,coords:n}=t;for(let r=0;r<e.length;r+=3){const i=2*e[r],s=2*e[r+1],o=2*e[r+2];if((n[o]-n[i])*(n[s+1]-n[i+1])-(n[s]-n[i])*(n[o+1]-n[i+1])>1e-10)return!1}return!0}function vO(t,e,n){return[t+Math.sin(t+e)*n,e+Math.cos(t-e)*n]}class u0{static from(e,n=gO,r=_O,i){return new u0("length"in e?bO(e,n,r,i):Float64Array.from(wO(e,n,r,i)))}constructor(e){this._delaunator=new oc(e),this.inedges=new Int32Array(e.length/2),this._hullIndex=new Int32Array(e.length/2),this.points=this._delaunator.coords,this._init()}update(){return this._delaunator.update(),this._init(),this}_init(){const e=this._delaunator,n=this.points;if(e.hull&&e.hull.length>2&&yO(e)){this.collinear=Int32Array.from({length:n.length/2},(f,d)=>d).sort((f,d)=>n[2*f]-n[2*d]||n[2*f+1]-n[2*d+1]);const c=this.collinear[0],u=this.collinear[this.collinear.length-1],l=[n[2*c],n[2*c+1],n[2*u],n[2*u+1]],h=1e-8*Math.hypot(l[3]-l[1],l[2]-l[0]);for(let f=0,d=n.length/2;f<d;++f){const p=vO(n[2*f],n[2*f+1],h);n[2*f]=p[0],n[2*f+1]=p[1]}this._delaunator=new oc(n)}else delete this.collinear;const r=this.halfedges=this._delaunator.halfedges,i=this.hull=this._delaunator.hull,s=this.triangles=this._delaunator.triangles,o=this.inedges.fill(-1),a=this._hullIndex.fill(-1);for(let c=0,u=r.length;c<u;++c){const l=s[c%3===2?c-2:c+1];(r[c]===-1||o[l]===-1)&&(o[l]=c)}for(let c=0,u=i.length;c<u;++c)a[i[c]]=c;i.length<=2&&i.length>0&&(this.triangles=new Int32Array(3).fill(-1),this.halfedges=new Int32Array(3).fill(-1),this.triangles[0]=i[0],o[i[0]]=1,i.length===2&&(o[i[1]]=0,this.triangles[1]=i[1],this.triangles[2]=i[1]))}voronoi(e){return new Rw(this,e)}*neighbors(e){const{inedges:n,hull:r,_hullIndex:i,halfedges:s,triangles:o,collinear:a}=this;if(a){const h=a.indexOf(e);h>0&&(yield a[h-1]),h<a.length-1&&(yield a[h+1]);return}const c=n[e];if(c===-1)return;let u=c,l=-1;do{if(yield l=o[u],u=u%3===2?u-2:u+1,o[u]!==e)return;if(u=s[u],u===-1){const h=r[(i[e]+1)%r.length];h!==l&&(yield h);return}}while(u!==c)}find(e,n,r=0){if(e=+e,e!==e||(n=+n,n!==n))return-1;const i=r;let s;for(;(s=this._step(r,e,n))>=0&&s!==r&&s!==i;)r=s;return s}_step(e,n,r){const{inedges:i,hull:s,_hullIndex:o,halfedges:a,triangles:c,points:u}=this;if(i[e]===-1||!u.length)return(e+1)%(u.length>>1);let l=e,h=di(n-u[e*2],2)+di(r-u[e*2+1],2);const f=i[e];let d=f;do{let p=c[d];const g=di(n-u[p*2],2)+di(r-u[p*2+1],2);if(g<h&&(h=g,l=p),d=d%3===2?d-2:d+1,c[d]!==e)break;if(d=a[d],d===-1){if(d=s[(o[e]+1)%s.length],d!==p&&di(n-u[d*2],2)+di(r-u[d*2+1],2)<h)return d;break}}while(d!==f);return l}render(e){const n=e==null?e=new Er:void 0,{points:r,halfedges:i,triangles:s}=this;for(let o=0,a=i.length;o<a;++o){const c=i[o];if(c<o)continue;const u=s[o]*2,l=s[c]*2;e.moveTo(r[u],r[u+1]),e.lineTo(r[l],r[l+1])}return this.renderHull(e),n&&n.value()}renderPoints(e,n){n===void 0&&(!e||typeof e.moveTo!="function")&&(n=e,e=null),n=n==null?2:+n;const r=e==null?e=new Er:void 0,{points:i}=this;for(let s=0,o=i.length;s<o;s+=2){const a=i[s],c=i[s+1];e.moveTo(a+n,c),e.arc(a,c,n,0,mO)}return r&&r.value()}renderHull(e){const n=e==null?e=new Er:void 0,{hull:r,points:i}=this,s=r[0]*2,o=r.length;e.moveTo(i[s],i[s+1]);for(let a=1;a<o;++a){const c=2*r[a];e.lineTo(i[c],i[c+1])}return e.closePath(),n&&n.value()}hullPolygon(){const e=new Jf;return this.renderHull(e),e.value()}renderTriangle(e,n){const r=n==null?n=new Er:void 0,{points:i,triangles:s}=this,o=s[e*=3]*2,a=s[e+1]*2,c=s[e+2]*2;return n.moveTo(i[o],i[o+1]),n.lineTo(i[a],i[a+1]),n.lineTo(i[c],i[c+1]),n.closePath(),r&&r.value()}*trianglePolygons(){const{triangles:e}=this;for(let n=0,r=e.length/3;n<r;++n)yield this.trianglePolygon(n)}trianglePolygon(e){const n=new Jf;return this.renderTriangle(e,n),n.value()}}function bO(t,e,n,r){const i=t.length,s=new Float64Array(i*2);for(let o=0;o<i;++o){const a=t[o];s[o*2]=e.call(r,a,o,t),s[o*2+1]=n.call(r,a,o,t)}return s}function*wO(t,e,n,r){let i=0;for(const s of t)yield e.call(r,s,i,t),yield n.call(r,s,i,t),++i}var __={},ef={},tf=34,vs=10,nf=13;function Iw(t){return new Function("d","return {"+t.map(function(e,n){return JSON.stringify(e)+": d["+n+'] || ""'}).join(",")+"}")}function xO(t,e){var n=Iw(t);return function(r,i){return e(n(r),i,t)}}function y_(t){var e=Object.create(null),n=[];return t.forEach(function(r){for(var i in r)i in e||n.push(e[i]=i)}),n}function Ct(t,e){var n=t+"",r=n.length;return r<e?new Array(e-r+1).join(0)+n:n}function TO(t){return t<0?"-"+Ct(-t,6):t>9999?"+"+Ct(t,6):Ct(t,4)}function SO(t){var e=t.getUTCHours(),n=t.getUTCMinutes(),r=t.getUTCSeconds(),i=t.getUTCMilliseconds();return isNaN(t)?"Invalid Date":TO(t.getUTCFullYear())+"-"+Ct(t.getUTCMonth()+1,2)+"-"+Ct(t.getUTCDate(),2)+(i?"T"+Ct(e,2)+":"+Ct(n,2)+":"+Ct(r,2)+"."+Ct(i,3)+"Z":r?"T"+Ct(e,2)+":"+Ct(n,2)+":"+Ct(r,2)+"Z":n||e?"T"+Ct(e,2)+":"+Ct(n,2)+"Z":"")}function Fu(t){var e=new RegExp('["'+t+`
\r]`),n=t.charCodeAt(0);function r(h,f){var d,p,g=i(h,function(m,_){if(d)return d(m,_-1);p=m,d=f?xO(m,f):Iw(m)});return g.columns=p||[],g}function i(h,f){var d=[],p=h.length,g=0,m=0,_,b=p<=0,v=!1;h.charCodeAt(p-1)===vs&&--p,h.charCodeAt(p-1)===nf&&--p;function y(){if(b)return ef;if(v)return v=!1,__;var x,C=g,S;if(h.charCodeAt(C)===tf){for(;g++<p&&h.charCodeAt(g)!==tf||h.charCodeAt(++g)===tf;);return(x=g)>=p?b=!0:(S=h.charCodeAt(g++))===vs?v=!0:S===nf&&(v=!0,h.charCodeAt(g)===vs&&++g),h.slice(C+1,x-1).replace(/""/g,'"')}for(;g<p;){if((S=h.charCodeAt(x=g++))===vs)v=!0;else if(S===nf)v=!0,h.charCodeAt(g)===vs&&++g;else if(S!==n)continue;return h.slice(C,x)}return b=!0,h.slice(C,p)}for(;(_=y())!==ef;){for(var w=[];_!==__&&_!==ef;)w.push(_),_=y();f&&(w=f(w,m++))==null||d.push(w)}return d}function s(h,f){return h.map(function(d){return f.map(function(p){return l(d[p])}).join(t)})}function o(h,f){return f==null&&(f=y_(h)),[f.map(l).join(t)].concat(s(h,f)).join(`
`)}function a(h,f){return f==null&&(f=y_(h)),s(h,f).join(`
`)}function c(h){return h.map(u).join(`
`)}function u(h){return h.map(l).join(t)}function l(h){return h==null?"":h instanceof Date?SO(h):e.test(h+="")?'"'+h.replace(/"/g,'""')+'"':h}return{parse:r,parseRows:i,format:o,formatBody:a,formatRows:c,formatRow:u,formatValue:l}}var ri=Fu(","),Ow=ri.parse,CO=ri.parseRows,MO=ri.format,AO=ri.formatBody,NO=ri.formatRows,kO=ri.formatRow,EO=ri.formatValue,ii=Fu("	"),Dw=ii.parse,RO=ii.parseRows,IO=ii.format,OO=ii.formatBody,DO=ii.formatRows,PO=ii.formatRow,qO=ii.formatValue;function FO(t){for(var e in t){var n=t[e].trim(),r,i;if(!n)n=null;else if(n==="true")n=!0;else if(n==="false")n=!1;else if(n==="NaN")n=NaN;else if(!isNaN(r=+n))n=r;else if(i=n.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/))$O&&i[4]&&!i[7]&&(n=n.replace(/-/g,"/").replace(/T/," ")),n=new Date(n);else continue;t[e]=n}return t}const $O=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();function VO(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.blob()}function LO(t,e){return fetch(t,e).then(VO)}function jO(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.arrayBuffer()}function zO(t,e){return fetch(t,e).then(jO)}function BO(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);return t.text()}function $u(t,e){return fetch(t,e).then(BO)}function Pw(t){return function(e,n,r){return arguments.length===2&&typeof n=="function"&&(r=n,n=void 0),$u(e,n).then(function(i){return t(i,r)})}}function WO(t,e,n,r){arguments.length===3&&typeof n=="function"&&(r=n,n=void 0);var i=Fu(t);return $u(e,n).then(function(s){return i.parse(s,r)})}var UO=Pw(Ow),GO=Pw(Dw);function HO(t,e){return new Promise(function(n,r){var i=new Image;for(var s in e)i[s]=e[s];i.onerror=r,i.onload=function(){n(i)},i.src=t})}function YO(t){if(!t.ok)throw new Error(t.status+" "+t.statusText);if(!(t.status===204||t.status===205))return t.json()}function XO(t,e){return fetch(t,e).then(YO)}function l0(t){return(e,n)=>$u(e,n).then(r=>new DOMParser().parseFromString(r,t))}const ZO=l0("application/xml");var KO=l0("text/html"),QO=l0("image/svg+xml");function JO(t,e){var n,r=1;t==null&&(t=0),e==null&&(e=0);function i(){var s,o=n.length,a,c=0,u=0;for(s=0;s<o;++s)a=n[s],c+=a.x,u+=a.y;for(c=(c/o-t)*r,u=(u/o-e)*r,s=0;s<o;++s)a=n[s],a.x-=c,a.y-=u}return i.initialize=function(s){n=s},i.x=function(s){return arguments.length?(t=+s,i):t},i.y=function(s){return arguments.length?(e=+s,i):e},i.strength=function(s){return arguments.length?(r=+s,i):r},i}function eD(t){const e=+this._x.call(null,t),n=+this._y.call(null,t);return qw(this.cover(e,n),e,n,t)}function qw(t,e,n,r){if(isNaN(e)||isNaN(n))return t;var i,s=t._root,o={data:r},a=t._x0,c=t._y0,u=t._x1,l=t._y1,h,f,d,p,g,m,_,b;if(!s)return t._root=o,t;for(;s.length;)if((g=e>=(h=(a+u)/2))?a=h:u=h,(m=n>=(f=(c+l)/2))?c=f:l=f,i=s,!(s=s[_=m<<1|g]))return i[_]=o,t;if(d=+t._x.call(null,s.data),p=+t._y.call(null,s.data),e===d&&n===p)return o.next=s,i?i[_]=o:t._root=o,t;do i=i?i[_]=new Array(4):t._root=new Array(4),(g=e>=(h=(a+u)/2))?a=h:u=h,(m=n>=(f=(c+l)/2))?c=f:l=f;while((_=m<<1|g)===(b=(p>=f)<<1|d>=h));return i[b]=s,i[_]=o,t}function tD(t){var e,n,r=t.length,i,s,o=new Array(r),a=new Array(r),c=1/0,u=1/0,l=-1/0,h=-1/0;for(n=0;n<r;++n)isNaN(i=+this._x.call(null,e=t[n]))||isNaN(s=+this._y.call(null,e))||(o[n]=i,a[n]=s,i<c&&(c=i),i>l&&(l=i),s<u&&(u=s),s>h&&(h=s));if(c>l||u>h)return this;for(this.cover(c,u).cover(l,h),n=0;n<r;++n)qw(this,o[n],a[n],t[n]);return this}function nD(t,e){if(isNaN(t=+t)||isNaN(e=+e))return this;var n=this._x0,r=this._y0,i=this._x1,s=this._y1;if(isNaN(n))i=(n=Math.floor(t))+1,s=(r=Math.floor(e))+1;else{for(var o=i-n||1,a=this._root,c,u;n>t||t>=i||r>e||e>=s;)switch(u=(e<r)<<1|t<n,c=new Array(4),c[u]=a,a=c,o*=2,u){case 0:i=n+o,s=r+o;break;case 1:n=i-o,s=r+o;break;case 2:i=n+o,r=s-o;break;case 3:n=i-o,r=s-o;break}this._root&&this._root.length&&(this._root=a)}return this._x0=n,this._y0=r,this._x1=i,this._y1=s,this}function rD(){var t=[];return this.visit(function(e){if(!e.length)do t.push(e.data);while(e=e.next)}),t}function iD(t){return arguments.length?this.cover(+t[0][0],+t[0][1]).cover(+t[1][0],+t[1][1]):isNaN(this._x0)?void 0:[[this._x0,this._y0],[this._x1,this._y1]]}function gt(t,e,n,r,i){this.node=t,this.x0=e,this.y0=n,this.x1=r,this.y1=i}function sD(t,e,n){var r,i=this._x0,s=this._y0,o,a,c,u,l=this._x1,h=this._y1,f=[],d=this._root,p,g;for(d&&f.push(new gt(d,i,s,l,h)),n==null?n=1/0:(i=t-n,s=e-n,l=t+n,h=e+n,n*=n);p=f.pop();)if(!(!(d=p.node)||(o=p.x0)>l||(a=p.y0)>h||(c=p.x1)<i||(u=p.y1)<s))if(d.length){var m=(o+c)/2,_=(a+u)/2;f.push(new gt(d[3],m,_,c,u),new gt(d[2],o,_,m,u),new gt(d[1],m,a,c,_),new gt(d[0],o,a,m,_)),(g=(e>=_)<<1|t>=m)&&(p=f[f.length-1],f[f.length-1]=f[f.length-1-g],f[f.length-1-g]=p)}else{var b=t-+this._x.call(null,d.data),v=e-+this._y.call(null,d.data),y=b*b+v*v;if(y<n){var w=Math.sqrt(n=y);i=t-w,s=e-w,l=t+w,h=e+w,r=d.data}}return r}function oD(t){if(isNaN(l=+this._x.call(null,t))||isNaN(h=+this._y.call(null,t)))return this;var e,n=this._root,r,i,s,o=this._x0,a=this._y0,c=this._x1,u=this._y1,l,h,f,d,p,g,m,_;if(!n)return this;if(n.length)for(;;){if((p=l>=(f=(o+c)/2))?o=f:c=f,(g=h>=(d=(a+u)/2))?a=d:u=d,e=n,!(n=n[m=g<<1|p]))return this;if(!n.length)break;(e[m+1&3]||e[m+2&3]||e[m+3&3])&&(r=e,_=m)}for(;n.data!==t;)if(i=n,!(n=n.next))return this;return(s=n.next)&&delete n.next,i?(s?i.next=s:delete i.next,this):e?(s?e[m]=s:delete e[m],(n=e[0]||e[1]||e[2]||e[3])&&n===(e[3]||e[2]||e[1]||e[0])&&!n.length&&(r?r[_]=n:this._root=n),this):(this._root=s,this)}function aD(t){for(var e=0,n=t.length;e<n;++e)this.remove(t[e]);return this}function cD(){return this._root}function uD(){var t=0;return this.visit(function(e){if(!e.length)do++t;while(e=e.next)}),t}function lD(t){var e=[],n,r=this._root,i,s,o,a,c;for(r&&e.push(new gt(r,this._x0,this._y0,this._x1,this._y1));n=e.pop();)if(!t(r=n.node,s=n.x0,o=n.y0,a=n.x1,c=n.y1)&&r.length){var u=(s+a)/2,l=(o+c)/2;(i=r[3])&&e.push(new gt(i,u,l,a,c)),(i=r[2])&&e.push(new gt(i,s,l,u,c)),(i=r[1])&&e.push(new gt(i,u,o,a,l)),(i=r[0])&&e.push(new gt(i,s,o,u,l))}return this}function hD(t){var e=[],n=[],r;for(this._root&&e.push(new gt(this._root,this._x0,this._y0,this._x1,this._y1));r=e.pop();){var i=r.node;if(i.length){var s,o=r.x0,a=r.y0,c=r.x1,u=r.y1,l=(o+c)/2,h=(a+u)/2;(s=i[0])&&e.push(new gt(s,o,a,l,h)),(s=i[1])&&e.push(new gt(s,l,a,c,h)),(s=i[2])&&e.push(new gt(s,o,h,l,u)),(s=i[3])&&e.push(new gt(s,l,h,c,u))}n.push(r)}for(;r=n.pop();)t(r.node,r.x0,r.y0,r.x1,r.y1);return this}function fD(t){return t[0]}function dD(t){return arguments.length?(this._x=t,this):this._x}function pD(t){return t[1]}function mD(t){return arguments.length?(this._y=t,this):this._y}function Vu(t,e,n){var r=new h0(e??fD,n??pD,NaN,NaN,NaN,NaN);return t==null?r:r.addAll(t)}function h0(t,e,n,r,i,s){this._x=t,this._y=e,this._x0=n,this._y0=r,this._x1=i,this._y1=s,this._root=void 0}function v_(t){for(var e={data:t.data},n=e;t=t.next;)n=n.next={data:t.data};return e}var St=Vu.prototype=h0.prototype;St.copy=function(){var t=new h0(this._x,this._y,this._x0,this._y0,this._x1,this._y1),e=this._root,n,r;if(!e)return t;if(!e.length)return t._root=v_(e),t;for(n=[{source:e,target:t._root=new Array(4)}];e=n.pop();)for(var i=0;i<4;++i)(r=e.source[i])&&(r.length?n.push({source:r,target:e.target[i]=new Array(4)}):e.target[i]=v_(r));return t};St.add=eD;St.addAll=tD;St.cover=nD;St.data=rD;St.extent=iD;St.find=sD;St.remove=oD;St.removeAll=aD;St.root=cD;St.size=uD;St.visit=lD;St.visitAfter=hD;St.x=dD;St.y=mD;function Be(t){return function(){return t}}function rr(t){return(t()-.5)*1e-6}function gD(t){return t.x+t.vx}function _D(t){return t.y+t.vy}function yD(t){var e,n,r,i=1,s=1;typeof t!="function"&&(t=Be(t==null?1:+t));function o(){for(var u,l=e.length,h,f,d,p,g,m,_=0;_<s;++_)for(h=Vu(e,gD,_D).visitAfter(a),u=0;u<l;++u)f=e[u],g=n[f.index],m=g*g,d=f.x+f.vx,p=f.y+f.vy,h.visit(b);function b(v,y,w,x,C){var S=v.data,A=v.r,N=g+A;if(S){if(S.index>f.index){var T=d-S.x-S.vx,k=p-S.y-S.vy,I=T*T+k*k;I<N*N&&(T===0&&(T=rr(r),I+=T*T),k===0&&(k=rr(r),I+=k*k),I=(N-(I=Math.sqrt(I)))/I*i,f.vx+=(T*=I)*(N=(A*=A)/(m+A)),f.vy+=(k*=I)*N,S.vx-=T*(N=1-N),S.vy-=k*N)}return}return y>d+N||x<d-N||w>p+N||C<p-N}}function a(u){if(u.data)return u.r=n[u.data.index];for(var l=u.r=0;l<4;++l)u[l]&&u[l].r>u.r&&(u.r=u[l].r)}function c(){if(e){var u,l=e.length,h;for(n=new Array(l),u=0;u<l;++u)h=e[u],n[h.index]=+t(h,u,e)}}return o.initialize=function(u,l){e=u,r=l,c()},o.iterations=function(u){return arguments.length?(s=+u,o):s},o.strength=function(u){return arguments.length?(i=+u,o):i},o.radius=function(u){return arguments.length?(t=typeof u=="function"?u:Be(+u),c(),o):t},o}function vD(t){return t.index}function b_(t,e){var n=t.get(e);if(!n)throw new Error("node not found: "+e);return n}function bD(t){var e=vD,n=h,r,i=Be(30),s,o,a,c,u,l=1;t==null&&(t=[]);function h(m){return 1/Math.min(a[m.source.index],a[m.target.index])}function f(m){for(var _=0,b=t.length;_<l;++_)for(var v=0,y,w,x,C,S,A,N;v<b;++v)y=t[v],w=y.source,x=y.target,C=x.x+x.vx-w.x-w.vx||rr(u),S=x.y+x.vy-w.y-w.vy||rr(u),A=Math.sqrt(C*C+S*S),A=(A-s[v])/A*m*r[v],C*=A,S*=A,x.vx-=C*(N=c[v]),x.vy-=S*N,w.vx+=C*(N=1-N),w.vy+=S*N}function d(){if(o){var m,_=o.length,b=t.length,v=new Map(o.map((w,x)=>[e(w,x,o),w])),y;for(m=0,a=new Array(_);m<b;++m)y=t[m],y.index=m,typeof y.source!="object"&&(y.source=b_(v,y.source)),typeof y.target!="object"&&(y.target=b_(v,y.target)),a[y.source.index]=(a[y.source.index]||0)+1,a[y.target.index]=(a[y.target.index]||0)+1;for(m=0,c=new Array(b);m<b;++m)y=t[m],c[m]=a[y.source.index]/(a[y.source.index]+a[y.target.index]);r=new Array(b),p(),s=new Array(b),g()}}function p(){if(o)for(var m=0,_=t.length;m<_;++m)r[m]=+n(t[m],m,t)}function g(){if(o)for(var m=0,_=t.length;m<_;++m)s[m]=+i(t[m],m,t)}return f.initialize=function(m,_){o=m,u=_,d()},f.links=function(m){return arguments.length?(t=m,d(),f):t},f.id=function(m){return arguments.length?(e=m,f):e},f.iterations=function(m){return arguments.length?(l=+m,f):l},f.strength=function(m){return arguments.length?(n=typeof m=="function"?m:Be(+m),p(),f):n},f.distance=function(m){return arguments.length?(i=typeof m=="function"?m:Be(+m),g(),f):i},f}const wD=1664525,xD=1013904223,w_=4294967296;function TD(){let t=1;return()=>(t=(wD*t+xD)%w_)/w_}function SD(t){return t.x}function CD(t){return t.y}var MD=10,AD=Math.PI*(3-Math.sqrt(5));function ND(t){var e,n=1,r=.001,i=1-Math.pow(r,1/300),s=0,o=.6,a=new Map,c=Pu(h),u=ti("tick","end"),l=TD();t==null&&(t=[]);function h(){f(),u.call("tick",e),n<r&&(c.stop(),u.call("end",e))}function f(g){var m,_=t.length,b;g===void 0&&(g=1);for(var v=0;v<g;++v)for(n+=(s-n)*i,a.forEach(function(y){y(n)}),m=0;m<_;++m)b=t[m],b.fx==null?b.x+=b.vx*=o:(b.x=b.fx,b.vx=0),b.fy==null?b.y+=b.vy*=o:(b.y=b.fy,b.vy=0);return e}function d(){for(var g=0,m=t.length,_;g<m;++g){if(_=t[g],_.index=g,_.fx!=null&&(_.x=_.fx),_.fy!=null&&(_.y=_.fy),isNaN(_.x)||isNaN(_.y)){var b=MD*Math.sqrt(.5+g),v=g*AD;_.x=b*Math.cos(v),_.y=b*Math.sin(v)}(isNaN(_.vx)||isNaN(_.vy))&&(_.vx=_.vy=0)}}function p(g){return g.initialize&&g.initialize(t,l),g}return d(),e={tick:f,restart:function(){return c.restart(h),e},stop:function(){return c.stop(),e},nodes:function(g){return arguments.length?(t=g,d(),a.forEach(p),e):t},alpha:function(g){return arguments.length?(n=+g,e):n},alphaMin:function(g){return arguments.length?(r=+g,e):r},alphaDecay:function(g){return arguments.length?(i=+g,e):+i},alphaTarget:function(g){return arguments.length?(s=+g,e):s},velocityDecay:function(g){return arguments.length?(o=1-g,e):1-o},randomSource:function(g){return arguments.length?(l=g,a.forEach(p),e):l},force:function(g,m){return arguments.length>1?(m==null?a.delete(g):a.set(g,p(m)),e):a.get(g)},find:function(g,m,_){var b=0,v=t.length,y,w,x,C,S;for(_==null?_=1/0:_*=_,b=0;b<v;++b)C=t[b],y=g-C.x,w=m-C.y,x=y*y+w*w,x<_&&(S=C,_=x);return S},on:function(g,m){return arguments.length>1?(u.on(g,m),e):u.on(g)}}}function kD(){var t,e,n,r,i=Be(-30),s,o=1,a=1/0,c=.81;function u(d){var p,g=t.length,m=Vu(t,SD,CD).visitAfter(h);for(r=d,p=0;p<g;++p)e=t[p],m.visit(f)}function l(){if(t){var d,p=t.length,g;for(s=new Array(p),d=0;d<p;++d)g=t[d],s[g.index]=+i(g,d,t)}}function h(d){var p=0,g,m,_=0,b,v,y;if(d.length){for(b=v=y=0;y<4;++y)(g=d[y])&&(m=Math.abs(g.value))&&(p+=g.value,_+=m,b+=m*g.x,v+=m*g.y);d.x=b/_,d.y=v/_}else{g=d,g.x=g.data.x,g.y=g.data.y;do p+=s[g.data.index];while(g=g.next)}d.value=p}function f(d,p,g,m){if(!d.value)return!0;var _=d.x-e.x,b=d.y-e.y,v=m-p,y=_*_+b*b;if(v*v/c<y)return y<a&&(_===0&&(_=rr(n),y+=_*_),b===0&&(b=rr(n),y+=b*b),y<o&&(y=Math.sqrt(o*y)),e.vx+=_*d.value*r/y,e.vy+=b*d.value*r/y),!0;if(d.length||y>=a)return;(d.data!==e||d.next)&&(_===0&&(_=rr(n),y+=_*_),b===0&&(b=rr(n),y+=b*b),y<o&&(y=Math.sqrt(o*y)));do d.data!==e&&(v=s[d.data.index]*r/y,e.vx+=_*v,e.vy+=b*v);while(d=d.next)}return u.initialize=function(d,p){t=d,n=p,l()},u.strength=function(d){return arguments.length?(i=typeof d=="function"?d:Be(+d),l(),u):i},u.distanceMin=function(d){return arguments.length?(o=d*d,u):Math.sqrt(o)},u.distanceMax=function(d){return arguments.length?(a=d*d,u):Math.sqrt(a)},u.theta=function(d){return arguments.length?(c=d*d,u):Math.sqrt(c)},u}function ED(t,e,n){var r,i=Be(.1),s,o;typeof t!="function"&&(t=Be(+t)),e==null&&(e=0),n==null&&(n=0);function a(u){for(var l=0,h=r.length;l<h;++l){var f=r[l],d=f.x-e||1e-6,p=f.y-n||1e-6,g=Math.sqrt(d*d+p*p),m=(o[l]-g)*s[l]*u/g;f.vx+=d*m,f.vy+=p*m}}function c(){if(r){var u,l=r.length;for(s=new Array(l),o=new Array(l),u=0;u<l;++u)o[u]=+t(r[u],u,r),s[u]=isNaN(o[u])?0:+i(r[u],u,r)}}return a.initialize=function(u){r=u,c()},a.strength=function(u){return arguments.length?(i=typeof u=="function"?u:Be(+u),c(),a):i},a.radius=function(u){return arguments.length?(t=typeof u=="function"?u:Be(+u),c(),a):t},a.x=function(u){return arguments.length?(e=+u,a):e},a.y=function(u){return arguments.length?(n=+u,a):n},a}function RD(t){var e=Be(.1),n,r,i;typeof t!="function"&&(t=Be(t==null?0:+t));function s(a){for(var c=0,u=n.length,l;c<u;++c)l=n[c],l.vx+=(i[c]-l.x)*r[c]*a}function o(){if(n){var a,c=n.length;for(r=new Array(c),i=new Array(c),a=0;a<c;++a)r[a]=isNaN(i[a]=+t(n[a],a,n))?0:+e(n[a],a,n)}}return s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(e=typeof a=="function"?a:Be(+a),o(),s):e},s.x=function(a){return arguments.length?(t=typeof a=="function"?a:Be(+a),o(),s):t},s}function ID(t){var e=Be(.1),n,r,i;typeof t!="function"&&(t=Be(t==null?0:+t));function s(a){for(var c=0,u=n.length,l;c<u;++c)l=n[c],l.vy+=(i[c]-l.y)*r[c]*a}function o(){if(n){var a,c=n.length;for(r=new Array(c),i=new Array(c),a=0;a<c;++a)r[a]=isNaN(i[a]=+t(n[a],a,n))?0:+e(n[a],a,n)}}return s.initialize=function(a){n=a,o()},s.strength=function(a){return arguments.length?(e=typeof a=="function"?a:Be(+a),o(),s):e},s.y=function(a){return arguments.length?(t=typeof a=="function"?a:Be(+a),o(),s):t},s}var re=1e-6,co=1e-12,he=Math.PI,qe=he/2,ac=he/4,bt=he*2,xe=180/he,ie=he/180,pe=Math.abs,us=Math.atan,wt=Math.atan2,Q=Math.cos,ia=Math.ceil,Fw=Math.exp,ed=Math.hypot,cc=Math.log,rf=Math.pow,X=Math.sin,Gt=Math.sign||function(t){return t>0?1:t<0?-1:0},Ze=Math.sqrt,f0=Math.tan;function $w(t){return t>1?0:t<-1?he:Math.acos(t)}function xt(t){return t>1?qe:t<-1?-qe:Math.asin(t)}function x_(t){return(t=X(t/2))*t}function Ie(){}function uc(t,e){t&&S_.hasOwnProperty(t.type)&&S_[t.type](t,e)}var T_={Feature:function(t,e){uc(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)uc(n[r].geometry,e)}},S_={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){td(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)td(n[r],e,0)},Polygon:function(t,e){C_(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)C_(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)uc(n[r],e)}};function td(t,e,n){var r=-1,i=t.length-n,s;for(e.lineStart();++r<i;)s=t[r],e.point(s[0],s[1],s[2]);e.lineEnd()}function C_(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)td(t[n],e,1);e.polygonEnd()}function Jt(t,e){t&&T_.hasOwnProperty(t.type)?T_[t.type](t,e):uc(t,e)}var lc=new We,hc=new We,Vw,Lw,nd,rd,id,bn={point:Ie,lineStart:Ie,lineEnd:Ie,polygonStart:function(){lc=new We,bn.lineStart=OD,bn.lineEnd=DD},polygonEnd:function(){var t=+lc;hc.add(t<0?bt+t:t),this.lineStart=this.lineEnd=this.point=Ie},sphere:function(){hc.add(bt)}};function OD(){bn.point=PD}function DD(){jw(Vw,Lw)}function PD(t,e){bn.point=jw,Vw=t,Lw=e,t*=ie,e*=ie,nd=t,rd=Q(e=e/2+ac),id=X(e)}function jw(t,e){t*=ie,e*=ie,e=e/2+ac;var n=t-nd,r=n>=0?1:-1,i=r*n,s=Q(e),o=X(e),a=id*o,c=rd*s+a*Q(i),u=a*r*X(i);lc.add(wt(u,c)),nd=t,rd=s,id=o}function qD(t){return hc=new We,Jt(t,bn),hc*2}function fc(t){return[wt(t[1],t[0]),xt(t[2])]}function Hr(t){var e=t[0],n=t[1],r=Q(n);return[r*Q(e),r*X(e),X(n)]}function sa(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function Xi(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function sf(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function oa(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function dc(t){var e=Ze(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}var Ee,Nt,De,qt,Cr,zw,Bw,Ai,Vs,er,jn,In={point:sd,lineStart:M_,lineEnd:A_,polygonStart:function(){In.point=Uw,In.lineStart=FD,In.lineEnd=$D,Vs=new We,bn.polygonStart()},polygonEnd:function(){bn.polygonEnd(),In.point=sd,In.lineStart=M_,In.lineEnd=A_,lc<0?(Ee=-(De=180),Nt=-(qt=90)):Vs>re?qt=90:Vs<-re&&(Nt=-90),jn[0]=Ee,jn[1]=De},sphere:function(){Ee=-(De=180),Nt=-(qt=90)}};function sd(t,e){er.push(jn=[Ee=t,De=t]),e<Nt&&(Nt=e),e>qt&&(qt=e)}function Ww(t,e){var n=Hr([t*ie,e*ie]);if(Ai){var r=Xi(Ai,n),i=[r[1],-r[0],0],s=Xi(i,r);dc(s),s=fc(s);var o=t-Cr,a=o>0?1:-1,c=s[0]*xe*a,u,l=pe(o)>180;l^(a*Cr<c&&c<a*t)?(u=s[1]*xe,u>qt&&(qt=u)):(c=(c+360)%360-180,l^(a*Cr<c&&c<a*t)?(u=-s[1]*xe,u<Nt&&(Nt=u)):(e<Nt&&(Nt=e),e>qt&&(qt=e))),l?t<Cr?Ot(Ee,t)>Ot(Ee,De)&&(De=t):Ot(t,De)>Ot(Ee,De)&&(Ee=t):De>=Ee?(t<Ee&&(Ee=t),t>De&&(De=t)):t>Cr?Ot(Ee,t)>Ot(Ee,De)&&(De=t):Ot(t,De)>Ot(Ee,De)&&(Ee=t)}else er.push(jn=[Ee=t,De=t]);e<Nt&&(Nt=e),e>qt&&(qt=e),Ai=n,Cr=t}function M_(){In.point=Ww}function A_(){jn[0]=Ee,jn[1]=De,In.point=sd,Ai=null}function Uw(t,e){if(Ai){var n=t-Cr;Vs.add(pe(n)>180?n+(n>0?360:-360):n)}else zw=t,Bw=e;bn.point(t,e),Ww(t,e)}function FD(){bn.lineStart()}function $D(){Uw(zw,Bw),bn.lineEnd(),pe(Vs)>re&&(Ee=-(De=180)),jn[0]=Ee,jn[1]=De,Ai=null}function Ot(t,e){return(e-=t)<0?e+360:e}function VD(t,e){return t[0]-e[0]}function N_(t,e){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}function LD(t){var e,n,r,i,s,o,a;if(qt=De=-(Ee=Nt=1/0),er=[],Jt(t,In),n=er.length){for(er.sort(VD),e=1,r=er[0],s=[r];e<n;++e)i=er[e],N_(r,i[0])||N_(r,i[1])?(Ot(r[0],i[1])>Ot(r[0],r[1])&&(r[1]=i[1]),Ot(i[0],r[1])>Ot(r[0],r[1])&&(r[0]=i[0])):s.push(r=i);for(o=-1/0,n=s.length-1,e=0,r=s[n];e<=n;r=i,++e)i=s[e],(a=Ot(r[1],i[0]))>o&&(o=a,Ee=i[0],De=r[1])}return er=jn=null,Ee===1/0||Nt===1/0?[[NaN,NaN],[NaN,NaN]]:[[Ee,Nt],[De,qt]]}var Es,pc,mc,gc,_c,yc,vc,bc,od,ad,cd,Gw,Hw,dt,pt,mt,tn={sphere:Ie,point:d0,lineStart:k_,lineEnd:E_,polygonStart:function(){tn.lineStart=BD,tn.lineEnd=WD},polygonEnd:function(){tn.lineStart=k_,tn.lineEnd=E_}};function d0(t,e){t*=ie,e*=ie;var n=Q(e);Do(n*Q(t),n*X(t),X(e))}function Do(t,e,n){++Es,mc+=(t-mc)/Es,gc+=(e-gc)/Es,_c+=(n-_c)/Es}function k_(){tn.point=jD}function jD(t,e){t*=ie,e*=ie;var n=Q(e);dt=n*Q(t),pt=n*X(t),mt=X(e),tn.point=zD,Do(dt,pt,mt)}function zD(t,e){t*=ie,e*=ie;var n=Q(e),r=n*Q(t),i=n*X(t),s=X(e),o=wt(Ze((o=pt*s-mt*i)*o+(o=mt*r-dt*s)*o+(o=dt*i-pt*r)*o),dt*r+pt*i+mt*s);pc+=o,yc+=o*(dt+(dt=r)),vc+=o*(pt+(pt=i)),bc+=o*(mt+(mt=s)),Do(dt,pt,mt)}function E_(){tn.point=d0}function BD(){tn.point=UD}function WD(){Yw(Gw,Hw),tn.point=d0}function UD(t,e){Gw=t,Hw=e,t*=ie,e*=ie,tn.point=Yw;var n=Q(e);dt=n*Q(t),pt=n*X(t),mt=X(e),Do(dt,pt,mt)}function Yw(t,e){t*=ie,e*=ie;var n=Q(e),r=n*Q(t),i=n*X(t),s=X(e),o=pt*s-mt*i,a=mt*r-dt*s,c=dt*i-pt*r,u=ed(o,a,c),l=xt(u),h=u&&-l/u;od.add(h*o),ad.add(h*a),cd.add(h*c),pc+=l,yc+=l*(dt+(dt=r)),vc+=l*(pt+(pt=i)),bc+=l*(mt+(mt=s)),Do(dt,pt,mt)}function GD(t){Es=pc=mc=gc=_c=yc=vc=bc=0,od=new We,ad=new We,cd=new We,Jt(t,tn);var e=+od,n=+ad,r=+cd,i=ed(e,n,r);return i<co&&(e=yc,n=vc,r=bc,pc<re&&(e=mc,n=gc,r=_c),i=ed(e,n,r),i<co)?[NaN,NaN]:[wt(n,e)*xe,xt(r/i)*xe]}function pi(t){return function(){return t}}function ud(t,e){function n(r,i){return r=t(r,i),e(r[0],r[1])}return t.invert&&e.invert&&(n.invert=function(r,i){return r=e.invert(r,i),r&&t.invert(r[0],r[1])}),n}function ld(t,e){return pe(t)>he&&(t-=Math.round(t/bt)*bt),[t,e]}ld.invert=ld;function p0(t,e,n){return(t%=bt)?e||n?ud(I_(t),O_(e,n)):I_(t):e||n?O_(e,n):ld}function R_(t){return function(e,n){return e+=t,pe(e)>he&&(e-=Math.round(e/bt)*bt),[e,n]}}function I_(t){var e=R_(t);return e.invert=R_(-t),e}function O_(t,e){var n=Q(t),r=X(t),i=Q(e),s=X(e);function o(a,c){var u=Q(c),l=Q(a)*u,h=X(a)*u,f=X(c),d=f*n+l*r;return[wt(h*i-d*s,l*n-f*r),xt(d*i+h*s)]}return o.invert=function(a,c){var u=Q(c),l=Q(a)*u,h=X(a)*u,f=X(c),d=f*i-h*s;return[wt(h*i+f*s,l*n+d*r),xt(d*n-l*r)]},o}function Xw(t){t=p0(t[0]*ie,t[1]*ie,t.length>2?t[2]*ie:0);function e(n){return n=t(n[0]*ie,n[1]*ie),n[0]*=xe,n[1]*=xe,n}return e.invert=function(n){return n=t.invert(n[0]*ie,n[1]*ie),n[0]*=xe,n[1]*=xe,n},e}function Zw(t,e,n,r,i,s){if(n){var o=Q(e),a=X(e),c=r*n;i==null?(i=e+r*bt,s=e-c/2):(i=D_(o,i),s=D_(o,s),(r>0?i<s:i>s)&&(i+=r*bt));for(var u,l=i;r>0?l>s:l<s;l-=c)u=fc([o,-a*Q(l),-a*X(l)]),t.point(u[0],u[1])}}function D_(t,e){e=Hr(e),e[0]-=t,dc(e);var n=$w(-e[1]);return((-e[2]<0?-n:n)+bt-re)%bt}function HD(){var t=pi([0,0]),e=pi(90),n=pi(2),r,i,s={point:o};function o(c,u){r.push(c=i(c,u)),c[0]*=xe,c[1]*=xe}function a(){var c=t.apply(this,arguments),u=e.apply(this,arguments)*ie,l=n.apply(this,arguments)*ie;return r=[],i=p0(-c[0]*ie,-c[1]*ie,0).invert,Zw(s,u,l,1),c={type:"Polygon",coordinates:[r]},r=i=null,c}return a.center=function(c){return arguments.length?(t=typeof c=="function"?c:pi([+c[0],+c[1]]),a):t},a.radius=function(c){return arguments.length?(e=typeof c=="function"?c:pi(+c),a):e},a.precision=function(c){return arguments.length?(n=typeof c=="function"?c:pi(+c),a):n},a}function Kw(){var t=[],e;return{point:function(n,r,i){e.push([n,r,i])},lineStart:function(){t.push(e=[])},lineEnd:Ie,rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))},result:function(){var n=t;return t=[],e=null,n}}}function Sa(t,e){return pe(t[0]-e[0])<re&&pe(t[1]-e[1])<re}function aa(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function Qw(t,e,n,r,i){var s=[],o=[],a,c;if(t.forEach(function(p){if(!((g=p.length-1)<=0)){var g,m=p[0],_=p[g],b;if(Sa(m,_)){if(!m[2]&&!_[2]){for(i.lineStart(),a=0;a<g;++a)i.point((m=p[a])[0],m[1]);i.lineEnd();return}_[0]+=2*re}s.push(b=new aa(m,p,null,!0)),o.push(b.o=new aa(m,null,b,!1)),s.push(b=new aa(_,p,null,!1)),o.push(b.o=new aa(_,null,b,!0))}}),!!s.length){for(o.sort(e),P_(s),P_(o),a=0,c=o.length;a<c;++a)o[a].e=n=!n;for(var u=s[0],l,h;;){for(var f=u,d=!0;f.v;)if((f=f.n)===u)return;l=f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(d)for(a=0,c=l.length;a<c;++a)i.point((h=l[a])[0],h[1]);else r(f.x,f.n.x,1,i);f=f.n}else{if(d)for(l=f.p.z,a=l.length-1;a>=0;--a)i.point((h=l[a])[0],h[1]);else r(f.x,f.p.x,-1,i);f=f.p}f=f.o,l=f.z,d=!d}while(!f.v);i.lineEnd()}}}function P_(t){if(e=t.length){for(var e,n=0,r=t[0],i;++n<e;)r.n=i=t[n],i.p=r,r=i;r.n=i=t[0],i.p=r}}function of(t){return pe(t[0])<=he?t[0]:Gt(t[0])*((pe(t[0])+he)%bt-he)}function Jw(t,e){var n=of(e),r=e[1],i=X(r),s=[X(n),-Q(n),0],o=0,a=0,c=new We;i===1?r=qe+re:i===-1&&(r=-qe-re);for(var u=0,l=t.length;u<l;++u)if(f=(h=t[u]).length)for(var h,f,d=h[f-1],p=of(d),g=d[1]/2+ac,m=X(g),_=Q(g),b=0;b<f;++b,p=y,m=x,_=C,d=v){var v=h[b],y=of(v),w=v[1]/2+ac,x=X(w),C=Q(w),S=y-p,A=S>=0?1:-1,N=A*S,T=N>he,k=m*x;if(c.add(wt(k*A*X(N),_*C+k*Q(N))),o+=T?S+A*bt:S,T^p>=n^y>=n){var I=Xi(Hr(d),Hr(v));dc(I);var M=Xi(s,I);dc(M);var E=(T^S>=0?-1:1)*xt(M[2]);(r>E||r===E&&(I[0]||I[1]))&&(a+=T^S>=0?1:-1)}}return(o<-re||o<re&&c<-co)^a&1}function ex(t,e,n,r){return function(i){var s=e(i),o=Kw(),a=e(o),c=!1,u,l,h,f={point:d,lineStart:g,lineEnd:m,polygonStart:function(){f.point=_,f.lineStart=b,f.lineEnd=v,l=[],u=[]},polygonEnd:function(){f.point=d,f.lineStart=g,f.lineEnd=m,l=Gd(l);var y=Jw(u,r);l.length?(c||(i.polygonStart(),c=!0),Qw(l,XD,y,n,i)):y&&(c||(i.polygonStart(),c=!0),i.lineStart(),n(null,null,1,i),i.lineEnd()),c&&(i.polygonEnd(),c=!1),l=u=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}};function d(y,w){t(y,w)&&i.point(y,w)}function p(y,w){s.point(y,w)}function g(){f.point=p,s.lineStart()}function m(){f.point=d,s.lineEnd()}function _(y,w){h.push([y,w]),a.point(y,w)}function b(){a.lineStart(),h=[]}function v(){_(h[0][0],h[0][1]),a.lineEnd();var y=a.clean(),w=o.result(),x,C=w.length,S,A,N;if(h.pop(),u.push(h),h=null,!!C){if(y&1){if(A=w[0],(S=A.length-1)>0){for(c||(i.polygonStart(),c=!0),i.lineStart(),x=0;x<S;++x)i.point((N=A[x])[0],N[1]);i.lineEnd()}return}C>1&&y&2&&w.push(w.pop().concat(w.shift())),l.push(w.filter(YD))}}return f}}function YD(t){return t.length>1}function XD(t,e){return((t=t.x)[0]<0?t[1]-qe-re:qe-t[1])-((e=e.x)[0]<0?e[1]-qe-re:qe-e[1])}const hd=ex(function(){return!0},ZD,QD,[-he,-qe]);function ZD(t){var e=NaN,n=NaN,r=NaN,i;return{lineStart:function(){t.lineStart(),i=1},point:function(s,o){var a=s>0?he:-he,c=pe(s-e);pe(c-he)<re?(t.point(e,n=(n+o)/2>0?qe:-qe),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(a,n),t.point(s,n),i=0):r!==a&&c>=he&&(pe(e-r)<re&&(e-=r*re),pe(s-a)<re&&(s-=a*re),n=KD(e,n,s,o),t.point(r,n),t.lineEnd(),t.lineStart(),t.point(a,n),i=0),t.point(e=s,n=o),r=a},lineEnd:function(){t.lineEnd(),e=n=NaN},clean:function(){return 2-i}}}function KD(t,e,n,r){var i,s,o=X(t-n);return pe(o)>re?us((X(e)*(s=Q(r))*X(n)-X(r)*(i=Q(e))*X(t))/(i*s*o)):(e+r)/2}function QD(t,e,n,r){var i;if(t==null)i=n*qe,r.point(-he,i),r.point(0,i),r.point(he,i),r.point(he,0),r.point(he,-i),r.point(0,-i),r.point(-he,-i),r.point(-he,0),r.point(-he,i);else if(pe(t[0]-e[0])>re){var s=t[0]<e[0]?he:-he;i=n*s/2,r.point(-s,i),r.point(0,i),r.point(s,i)}else r.point(e[0],e[1])}function tx(t){var e=Q(t),n=2*ie,r=e>0,i=pe(e)>re;function s(l,h,f,d){Zw(d,t,n,f,l,h)}function o(l,h){return Q(l)*Q(h)>e}function a(l){var h,f,d,p,g;return{lineStart:function(){p=d=!1,g=1},point:function(m,_){var b=[m,_],v,y=o(m,_),w=r?y?0:u(m,_):y?u(m+(m<0?he:-he),_):0;if(!h&&(p=d=y)&&l.lineStart(),y!==d&&(v=c(h,b),(!v||Sa(h,v)||Sa(b,v))&&(b[2]=1)),y!==d)g=0,y?(l.lineStart(),v=c(b,h),l.point(v[0],v[1])):(v=c(h,b),l.point(v[0],v[1],2),l.lineEnd()),h=v;else if(i&&h&&r^y){var x;!(w&f)&&(x=c(b,h,!0))&&(g=0,r?(l.lineStart(),l.point(x[0][0],x[0][1]),l.point(x[1][0],x[1][1]),l.lineEnd()):(l.point(x[1][0],x[1][1]),l.lineEnd(),l.lineStart(),l.point(x[0][0],x[0][1],3)))}y&&(!h||!Sa(h,b))&&l.point(b[0],b[1]),h=b,d=y,f=w},lineEnd:function(){d&&l.lineEnd(),h=null},clean:function(){return g|(p&&d)<<1}}}function c(l,h,f){var d=Hr(l),p=Hr(h),g=[1,0,0],m=Xi(d,p),_=sa(m,m),b=m[0],v=_-b*b;if(!v)return!f&&l;var y=e*_/v,w=-e*b/v,x=Xi(g,m),C=oa(g,y),S=oa(m,w);sf(C,S);var A=x,N=sa(C,A),T=sa(A,A),k=N*N-T*(sa(C,C)-1);if(!(k<0)){var I=Ze(k),M=oa(A,(-N-I)/T);if(sf(M,C),M=fc(M),!f)return M;var E=l[0],R=h[0],O=l[1],q=h[1],D;R<E&&(D=E,E=R,R=D);var $=R-E,F=pe($-he)<re,L=F||$<re;if(!F&&q<O&&(D=O,O=q,q=D),L?F?O+q>0^M[1]<(pe(M[0]-E)<re?O:q):O<=M[1]&&M[1]<=q:$>he^(E<=M[0]&&M[0]<=R)){var te=oa(A,(-N+I)/T);return sf(te,C),[M,fc(te)]}}}function u(l,h){var f=r?t:he-t,d=0;return l<-f?d|=1:l>f&&(d|=2),h<-f?d|=4:h>f&&(d|=8),d}return ex(o,a,s,r?[0,-t]:[-he,t-he])}function JD(t,e,n,r,i,s){var o=t[0],a=t[1],c=e[0],u=e[1],l=0,h=1,f=c-o,d=u-a,p;if(p=n-o,!(!f&&p>0)){if(p/=f,f<0){if(p<l)return;p<h&&(h=p)}else if(f>0){if(p>h)return;p>l&&(l=p)}if(p=i-o,!(!f&&p<0)){if(p/=f,f<0){if(p>h)return;p>l&&(l=p)}else if(f>0){if(p<l)return;p<h&&(h=p)}if(p=r-a,!(!d&&p>0)){if(p/=d,d<0){if(p<l)return;p<h&&(h=p)}else if(d>0){if(p>h)return;p>l&&(l=p)}if(p=s-a,!(!d&&p<0)){if(p/=d,d<0){if(p>h)return;p>l&&(l=p)}else if(d>0){if(p<l)return;p<h&&(h=p)}return l>0&&(t[0]=o+l*f,t[1]=a+l*d),h<1&&(e[0]=o+h*f,e[1]=a+h*d),!0}}}}}var Rs=1e9,ca=-Rs;function Lu(t,e,n,r){function i(u,l){return t<=u&&u<=n&&e<=l&&l<=r}function s(u,l,h,f){var d=0,p=0;if(u==null||(d=o(u,h))!==(p=o(l,h))||c(u,l)<0^h>0)do f.point(d===0||d===3?t:n,d>1?r:e);while((d=(d+h+4)%4)!==p);else f.point(l[0],l[1])}function o(u,l){return pe(u[0]-t)<re?l>0?0:3:pe(u[0]-n)<re?l>0?2:1:pe(u[1]-e)<re?l>0?1:0:l>0?3:2}function a(u,l){return c(u.x,l.x)}function c(u,l){var h=o(u,1),f=o(l,1);return h!==f?h-f:h===0?l[1]-u[1]:h===1?u[0]-l[0]:h===2?u[1]-l[1]:l[0]-u[0]}return function(u){var l=u,h=Kw(),f,d,p,g,m,_,b,v,y,w,x,C={point:S,lineStart:k,lineEnd:I,polygonStart:N,polygonEnd:T};function S(E,R){i(E,R)&&l.point(E,R)}function A(){for(var E=0,R=0,O=d.length;R<O;++R)for(var q=d[R],D=1,$=q.length,F=q[0],L,te,Z=F[0],W=F[1];D<$;++D)L=Z,te=W,F=q[D],Z=F[0],W=F[1],te<=r?W>r&&(Z-L)*(r-te)>(W-te)*(t-L)&&++E:W<=r&&(Z-L)*(r-te)<(W-te)*(t-L)&&--E;return E}function N(){l=h,f=[],d=[],x=!0}function T(){var E=A(),R=x&&E,O=(f=Gd(f)).length;(R||O)&&(u.polygonStart(),R&&(u.lineStart(),s(null,null,1,u),u.lineEnd()),O&&Qw(f,a,E,s,u),u.polygonEnd()),l=u,f=d=p=null}function k(){C.point=M,d&&d.push(p=[]),w=!0,y=!1,b=v=NaN}function I(){f&&(M(g,m),_&&y&&h.rejoin(),f.push(h.result())),C.point=S,y&&l.lineEnd()}function M(E,R){var O=i(E,R);if(d&&p.push([E,R]),w)g=E,m=R,_=O,w=!1,O&&(l.lineStart(),l.point(E,R));else if(O&&y)l.point(E,R);else{var q=[b=Math.max(ca,Math.min(Rs,b)),v=Math.max(ca,Math.min(Rs,v))],D=[E=Math.max(ca,Math.min(Rs,E)),R=Math.max(ca,Math.min(Rs,R))];JD(q,D,t,e,n,r)?(y||(l.lineStart(),l.point(q[0],q[1])),l.point(D[0],D[1]),O||l.lineEnd(),x=!1):O&&(l.lineStart(),l.point(E,R),x=!1)}b=E,v=R,y=O}return C}}function eP(){var t=0,e=0,n=960,r=500,i,s,o;return o={stream:function(a){return i&&s===a?i:i=Lu(t,e,n,r)(s=a)},extent:function(a){return arguments.length?(t=+a[0][0],e=+a[0][1],n=+a[1][0],r=+a[1][1],i=s=null,o):[[t,e],[n,r]]}}}var fd,dd,Ca,Ma,Zi={sphere:Ie,point:Ie,lineStart:tP,lineEnd:Ie,polygonStart:Ie,polygonEnd:Ie};function tP(){Zi.point=rP,Zi.lineEnd=nP}function nP(){Zi.point=Zi.lineEnd=Ie}function rP(t,e){t*=ie,e*=ie,dd=t,Ca=X(e),Ma=Q(e),Zi.point=iP}function iP(t,e){t*=ie,e*=ie;var n=X(e),r=Q(e),i=pe(t-dd),s=Q(i),o=X(i),a=r*o,c=Ma*n-Ca*r*s,u=Ca*n+Ma*r*s;fd.add(wt(Ze(a*a+c*c),u)),dd=t,Ca=n,Ma=r}function nx(t){return fd=new We,Jt(t,Zi),+fd}var pd=[null,null],sP={type:"LineString",coordinates:pd};function wc(t,e){return pd[0]=t,pd[1]=e,nx(sP)}var q_={Feature:function(t,e){return xc(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)if(xc(n[r].geometry,e))return!0;return!1}},F_={Sphere:function(){return!0},Point:function(t,e){return $_(t.coordinates,e)},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if($_(n[r],e))return!0;return!1},LineString:function(t,e){return V_(t.coordinates,e)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(V_(n[r],e))return!0;return!1},Polygon:function(t,e){return L_(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)if(L_(n[r],e))return!0;return!1},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)if(xc(n[r],e))return!0;return!1}};function xc(t,e){return t&&F_.hasOwnProperty(t.type)?F_[t.type](t,e):!1}function $_(t,e){return wc(t,e)===0}function V_(t,e){for(var n,r,i,s=0,o=t.length;s<o;s++){if(r=wc(t[s],e),r===0||s>0&&(i=wc(t[s],t[s-1]),i>0&&n<=i&&r<=i&&(n+r-i)*(1-Math.pow((n-r)/i,2))<co*i))return!0;n=r}return!1}function L_(t,e){return!!Jw(t.map(oP),rx(e))}function oP(t){return t=t.map(rx),t.pop(),t}function rx(t){return[t[0]*ie,t[1]*ie]}function aP(t,e){return(t&&q_.hasOwnProperty(t.type)?q_[t.type]:xc)(t,e)}function j_(t,e,n){var r=nr(t,e-re,n).concat(e);return function(i){return r.map(function(s){return[i,s]})}}function z_(t,e,n){var r=nr(t,e-re,n).concat(e);return function(i){return r.map(function(s){return[s,i]})}}function ix(){var t,e,n,r,i,s,o,a,c=10,u=c,l=90,h=360,f,d,p,g,m=2.5;function _(){return{type:"MultiLineString",coordinates:b()}}function b(){return nr(ia(r/l)*l,n,l).map(p).concat(nr(ia(a/h)*h,o,h).map(g)).concat(nr(ia(e/c)*c,t,c).filter(function(v){return pe(v%l)>re}).map(f)).concat(nr(ia(s/u)*u,i,u).filter(function(v){return pe(v%h)>re}).map(d))}return _.lines=function(){return b().map(function(v){return{type:"LineString",coordinates:v}})},_.outline=function(){return{type:"Polygon",coordinates:[p(r).concat(g(o).slice(1),p(n).reverse().slice(1),g(a).reverse().slice(1))]}},_.extent=function(v){return arguments.length?_.extentMajor(v).extentMinor(v):_.extentMinor()},_.extentMajor=function(v){return arguments.length?(r=+v[0][0],n=+v[1][0],a=+v[0][1],o=+v[1][1],r>n&&(v=r,r=n,n=v),a>o&&(v=a,a=o,o=v),_.precision(m)):[[r,a],[n,o]]},_.extentMinor=function(v){return arguments.length?(e=+v[0][0],t=+v[1][0],s=+v[0][1],i=+v[1][1],e>t&&(v=e,e=t,t=v),s>i&&(v=s,s=i,i=v),_.precision(m)):[[e,s],[t,i]]},_.step=function(v){return arguments.length?_.stepMajor(v).stepMinor(v):_.stepMinor()},_.stepMajor=function(v){return arguments.length?(l=+v[0],h=+v[1],_):[l,h]},_.stepMinor=function(v){return arguments.length?(c=+v[0],u=+v[1],_):[c,u]},_.precision=function(v){return arguments.length?(m=+v,f=j_(s,i,90),d=z_(e,t,m),p=j_(a,o,90),g=z_(r,n,m),_):m},_.extentMajor([[-180,-90+re],[180,90-re]]).extentMinor([[-180,-80-re],[180,80+re]])}function cP(){return ix()()}function uP(t,e){var n=t[0]*ie,r=t[1]*ie,i=e[0]*ie,s=e[1]*ie,o=Q(r),a=X(r),c=Q(s),u=X(s),l=o*Q(n),h=o*X(n),f=c*Q(i),d=c*X(i),p=2*xt(Ze(x_(s-r)+o*c*x_(i-n))),g=X(p),m=p?function(_){var b=X(_*=p)/g,v=X(p-_)/g,y=v*l+b*f,w=v*h+b*d,x=v*a+b*u;return[wt(w,y)*xe,wt(x,Ze(y*y+w*w))*xe]}:function(){return[n*xe,r*xe]};return m.distance=p,m}const uo=t=>t;var af=new We,md=new We,sx,ox,gd,_d,On={point:Ie,lineStart:Ie,lineEnd:Ie,polygonStart:function(){On.lineStart=lP,On.lineEnd=fP},polygonEnd:function(){On.lineStart=On.lineEnd=On.point=Ie,af.add(pe(md)),md=new We},result:function(){var t=af/2;return af=new We,t}};function lP(){On.point=hP}function hP(t,e){On.point=ax,sx=gd=t,ox=_d=e}function ax(t,e){md.add(_d*t-gd*e),gd=t,_d=e}function fP(){ax(sx,ox)}var Ki=1/0,Tc=Ki,lo=-Ki,Sc=lo,Cc={point:dP,lineStart:Ie,lineEnd:Ie,polygonStart:Ie,polygonEnd:Ie,result:function(){var t=[[Ki,Tc],[lo,Sc]];return lo=Sc=-(Tc=Ki=1/0),t}};function dP(t,e){t<Ki&&(Ki=t),t>lo&&(lo=t),e<Tc&&(Tc=e),e>Sc&&(Sc=e)}var yd=0,vd=0,Is=0,Mc=0,Ac=0,wi=0,bd=0,wd=0,Os=0,cx,ux,hn,fn,Wt={point:Yr,lineStart:B_,lineEnd:W_,polygonStart:function(){Wt.lineStart=gP,Wt.lineEnd=_P},polygonEnd:function(){Wt.point=Yr,Wt.lineStart=B_,Wt.lineEnd=W_},result:function(){var t=Os?[bd/Os,wd/Os]:wi?[Mc/wi,Ac/wi]:Is?[yd/Is,vd/Is]:[NaN,NaN];return yd=vd=Is=Mc=Ac=wi=bd=wd=Os=0,t}};function Yr(t,e){yd+=t,vd+=e,++Is}function B_(){Wt.point=pP}function pP(t,e){Wt.point=mP,Yr(hn=t,fn=e)}function mP(t,e){var n=t-hn,r=e-fn,i=Ze(n*n+r*r);Mc+=i*(hn+t)/2,Ac+=i*(fn+e)/2,wi+=i,Yr(hn=t,fn=e)}function W_(){Wt.point=Yr}function gP(){Wt.point=yP}function _P(){lx(cx,ux)}function yP(t,e){Wt.point=lx,Yr(cx=hn=t,ux=fn=e)}function lx(t,e){var n=t-hn,r=e-fn,i=Ze(n*n+r*r);Mc+=i*(hn+t)/2,Ac+=i*(fn+e)/2,wi+=i,i=fn*t-hn*e,bd+=i*(hn+t),wd+=i*(fn+e),Os+=i*3,Yr(hn=t,fn=e)}function hx(t){this._context=t}hx.prototype={_radius:4.5,pointRadius:function(t){return this._radius=t,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(t,e){switch(this._point){case 0:{this._context.moveTo(t,e),this._point=1;break}case 1:{this._context.lineTo(t,e);break}default:{this._context.moveTo(t+this._radius,e),this._context.arc(t,e,this._radius,0,bt);break}}},result:Ie};var xd=new We,cf,fx,dx,Ds,Ps,ho={point:Ie,lineStart:function(){ho.point=vP},lineEnd:function(){cf&&px(fx,dx),ho.point=Ie},polygonStart:function(){cf=!0},polygonEnd:function(){cf=null},result:function(){var t=+xd;return xd=new We,t}};function vP(t,e){ho.point=px,fx=Ds=t,dx=Ps=e}function px(t,e){Ds-=t,Ps-=e,xd.add(Ze(Ds*Ds+Ps*Ps)),Ds=t,Ps=e}let U_,Nc,G_,H_;class Y_{constructor(e){this._append=e==null?mx:bP(e),this._radius=4.5,this._=""}pointRadius(e){return this._radius=+e,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(e,n){switch(this._point){case 0:{this._append`M${e},${n}`,this._point=1;break}case 1:{this._append`L${e},${n}`;break}default:{if(this._append`M${e},${n}`,this._radius!==G_||this._append!==Nc){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,G_=r,Nc=this._append,H_=this._,this._=i}this._+=H_;break}}}result(){const e=this._;return this._="",e.length?e:null}}function mx(t){let e=1;this._+=t[0];for(const n=t.length;e<n;++e)this._+=arguments[e]+t[e]}function bP(t){const e=Math.floor(t);if(!(e>=0))throw new RangeError(`invalid digits: ${t}`);if(e>15)return mx;if(e!==U_){const n=10**e;U_=e,Nc=function(i){let s=1;this._+=i[0];for(const o=i.length;s<o;++s)this._+=Math.round(arguments[s]*n)/n+i[s]}}return Nc}function wP(t,e){let n=3,r=4.5,i,s;function o(a){return a&&(typeof r=="function"&&s.pointRadius(+r.apply(this,arguments)),Jt(a,i(s))),s.result()}return o.area=function(a){return Jt(a,i(On)),On.result()},o.measure=function(a){return Jt(a,i(ho)),ho.result()},o.bounds=function(a){return Jt(a,i(Cc)),Cc.result()},o.centroid=function(a){return Jt(a,i(Wt)),Wt.result()},o.projection=function(a){return arguments.length?(i=a==null?(t=null,uo):(t=a).stream,o):t},o.context=function(a){return arguments.length?(s=a==null?(e=null,new Y_(n)):new hx(e=a),typeof r!="function"&&s.pointRadius(r),o):e},o.pointRadius=function(a){return arguments.length?(r=typeof a=="function"?a:(s.pointRadius(+a),+a),o):r},o.digits=function(a){if(!arguments.length)return n;if(a==null)n=null;else{const c=Math.floor(a);if(!(c>=0))throw new RangeError(`invalid digits: ${a}`);n=c}return e===null&&(s=new Y_(n)),o},o.projection(t).digits(n).context(e)}function xP(t){return{stream:Po(t)}}function Po(t){return function(e){var n=new Td;for(var r in t)n[r]=t[r];return n.stream=e,n}}function Td(){}Td.prototype={constructor:Td,point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}};function m0(t,e,n){var r=t.clipExtent&&t.clipExtent();return t.scale(150).translate([0,0]),r!=null&&t.clipExtent(null),Jt(n,t.stream(Cc)),e(Cc.result()),r!=null&&t.clipExtent(r),t}function ju(t,e,n){return m0(t,function(r){var i=e[1][0]-e[0][0],s=e[1][1]-e[0][1],o=Math.min(i/(r[1][0]-r[0][0]),s/(r[1][1]-r[0][1])),a=+e[0][0]+(i-o*(r[1][0]+r[0][0]))/2,c=+e[0][1]+(s-o*(r[1][1]+r[0][1]))/2;t.scale(150*o).translate([a,c])},n)}function g0(t,e,n){return ju(t,[[0,0],e],n)}function _0(t,e,n){return m0(t,function(r){var i=+e,s=i/(r[1][0]-r[0][0]),o=(i-s*(r[1][0]+r[0][0]))/2,a=-s*r[0][1];t.scale(150*s).translate([o,a])},n)}function y0(t,e,n){return m0(t,function(r){var i=+e,s=i/(r[1][1]-r[0][1]),o=-s*r[0][0],a=(i-s*(r[1][1]+r[0][1]))/2;t.scale(150*s).translate([o,a])},n)}var X_=16,TP=Q(30*ie);function Z_(t,e){return+e?CP(t,e):SP(t)}function SP(t){return Po({point:function(e,n){e=t(e,n),this.stream.point(e[0],e[1])}})}function CP(t,e){function n(r,i,s,o,a,c,u,l,h,f,d,p,g,m){var _=u-r,b=l-i,v=_*_+b*b;if(v>4*e&&g--){var y=o+f,w=a+d,x=c+p,C=Ze(y*y+w*w+x*x),S=xt(x/=C),A=pe(pe(x)-1)<re||pe(s-h)<re?(s+h)/2:wt(w,y),N=t(A,S),T=N[0],k=N[1],I=T-r,M=k-i,E=b*I-_*M;(E*E/v>e||pe((_*I+b*M)/v-.5)>.3||o*f+a*d+c*p<TP)&&(n(r,i,s,o,a,c,T,k,A,y/=C,w/=C,x,g,m),m.point(T,k),n(T,k,A,y,w,x,u,l,h,f,d,p,g,m))}}return function(r){var i,s,o,a,c,u,l,h,f,d,p,g,m={point:_,lineStart:b,lineEnd:y,polygonStart:function(){r.polygonStart(),m.lineStart=w},polygonEnd:function(){r.polygonEnd(),m.lineStart=b}};function _(S,A){S=t(S,A),r.point(S[0],S[1])}function b(){h=NaN,m.point=v,r.lineStart()}function v(S,A){var N=Hr([S,A]),T=t(S,A);n(h,f,l,d,p,g,h=T[0],f=T[1],l=S,d=N[0],p=N[1],g=N[2],X_,r),r.point(h,f)}function y(){m.point=_,r.lineEnd()}function w(){b(),m.point=x,m.lineEnd=C}function x(S,A){v(i=S,A),s=h,o=f,a=d,c=p,u=g,m.point=v}function C(){n(h,f,l,d,p,g,s,o,i,a,c,u,X_,r),m.lineEnd=y,y()}return m}}var MP=Po({point:function(t,e){this.stream.point(t*ie,e*ie)}});function AP(t){return Po({point:function(e,n){var r=t(e,n);return this.stream.point(r[0],r[1])}})}function NP(t,e,n,r,i){function s(o,a){return o*=r,a*=i,[e+t*o,n-t*a]}return s.invert=function(o,a){return[(o-e)/t*r,(n-a)/t*i]},s}function K_(t,e,n,r,i,s){if(!s)return NP(t,e,n,r,i);var o=Q(s),a=X(s),c=o*t,u=a*t,l=o/t,h=a/t,f=(a*n-o*e)/t,d=(a*e+o*n)/t;function p(g,m){return g*=r,m*=i,[c*g-u*m+e,n-u*g-c*m]}return p.invert=function(g,m){return[r*(l*g-h*m+f),i*(d-h*g-l*m)]},p}function Cn(t){return v0(function(){return t})()}function v0(t){var e,n=150,r=480,i=250,s=0,o=0,a=0,c=0,u=0,l,h=0,f=1,d=1,p=null,g=hd,m=null,_,b,v,y=uo,w=.5,x,C,S,A,N;function T(E){return S(E[0]*ie,E[1]*ie)}function k(E){return E=S.invert(E[0],E[1]),E&&[E[0]*xe,E[1]*xe]}T.stream=function(E){return A&&N===E?A:A=MP(AP(l)(g(x(y(N=E)))))},T.preclip=function(E){return arguments.length?(g=E,p=void 0,M()):g},T.postclip=function(E){return arguments.length?(y=E,m=_=b=v=null,M()):y},T.clipAngle=function(E){return arguments.length?(g=+E?tx(p=E*ie):(p=null,hd),M()):p*xe},T.clipExtent=function(E){return arguments.length?(y=E==null?(m=_=b=v=null,uo):Lu(m=+E[0][0],_=+E[0][1],b=+E[1][0],v=+E[1][1]),M()):m==null?null:[[m,_],[b,v]]},T.scale=function(E){return arguments.length?(n=+E,I()):n},T.translate=function(E){return arguments.length?(r=+E[0],i=+E[1],I()):[r,i]},T.center=function(E){return arguments.length?(s=E[0]%360*ie,o=E[1]%360*ie,I()):[s*xe,o*xe]},T.rotate=function(E){return arguments.length?(a=E[0]%360*ie,c=E[1]%360*ie,u=E.length>2?E[2]%360*ie:0,I()):[a*xe,c*xe,u*xe]},T.angle=function(E){return arguments.length?(h=E%360*ie,I()):h*xe},T.reflectX=function(E){return arguments.length?(f=E?-1:1,I()):f<0},T.reflectY=function(E){return arguments.length?(d=E?-1:1,I()):d<0},T.precision=function(E){return arguments.length?(x=Z_(C,w=E*E),M()):Ze(w)},T.fitExtent=function(E,R){return ju(T,E,R)},T.fitSize=function(E,R){return g0(T,E,R)},T.fitWidth=function(E,R){return _0(T,E,R)},T.fitHeight=function(E,R){return y0(T,E,R)};function I(){var E=K_(n,0,0,f,d,h).apply(null,e(s,o)),R=K_(n,r-E[0],i-E[1],f,d,h);return l=p0(a,c,u),C=ud(e,R),S=ud(l,C),x=Z_(C,w),M()}function M(){return A=N=null,T}return function(){return e=t.apply(this,arguments),T.invert=e.invert&&k,I()}}function b0(t){var e=0,n=he/3,r=v0(t),i=r(e,n);return i.parallels=function(s){return arguments.length?r(e=s[0]*ie,n=s[1]*ie):[e*xe,n*xe]},i}function kP(t){var e=Q(t);function n(r,i){return[r*e,X(i)/e]}return n.invert=function(r,i){return[r/e,xt(i*e)]},n}function gx(t,e){var n=X(t),r=(n+X(e))/2;if(pe(r)<re)return kP(t);var i=1+n*(2*r-n),s=Ze(i)/r;function o(a,c){var u=Ze(i-2*r*X(c))/r;return[u*X(a*=r),s-u*Q(a)]}return o.invert=function(a,c){var u=s-c,l=wt(a,pe(u))*Gt(u);return u*r<0&&(l-=he*Gt(a)*Gt(u)),[l/r,xt((i-(a*a+u*u)*r*r)/(2*r))]},o}function kc(){return b0(gx).scale(155.424).center([0,33.6442])}function _x(){return kc().parallels([29.5,45.5]).scale(1070).translate([480,250]).rotate([96,0]).center([-.6,38.7])}function EP(t){var e=t.length;return{point:function(n,r){for(var i=-1;++i<e;)t[i].point(n,r)},sphere:function(){for(var n=-1;++n<e;)t[n].sphere()},lineStart:function(){for(var n=-1;++n<e;)t[n].lineStart()},lineEnd:function(){for(var n=-1;++n<e;)t[n].lineEnd()},polygonStart:function(){for(var n=-1;++n<e;)t[n].polygonStart()},polygonEnd:function(){for(var n=-1;++n<e;)t[n].polygonEnd()}}}function RP(){var t,e,n=_x(),r,i=kc().rotate([154,0]).center([-2,58.5]).parallels([55,65]),s,o=kc().rotate([157,0]).center([-3,19.9]).parallels([8,18]),a,c,u={point:function(f,d){c=[f,d]}};function l(f){var d=f[0],p=f[1];return c=null,r.point(d,p),c||(s.point(d,p),c)||(a.point(d,p),c)}l.invert=function(f){var d=n.scale(),p=n.translate(),g=(f[0]-p[0])/d,m=(f[1]-p[1])/d;return(m>=.12&&m<.234&&g>=-.425&&g<-.214?i:m>=.166&&m<.234&&g>=-.214&&g<-.115?o:n).invert(f)},l.stream=function(f){return t&&e===f?t:t=EP([n.stream(e=f),i.stream(f),o.stream(f)])},l.precision=function(f){return arguments.length?(n.precision(f),i.precision(f),o.precision(f),h()):n.precision()},l.scale=function(f){return arguments.length?(n.scale(f),i.scale(f*.35),o.scale(f),l.translate(n.translate())):n.scale()},l.translate=function(f){if(!arguments.length)return n.translate();var d=n.scale(),p=+f[0],g=+f[1];return r=n.translate(f).clipExtent([[p-.455*d,g-.238*d],[p+.455*d,g+.238*d]]).stream(u),s=i.translate([p-.307*d,g+.201*d]).clipExtent([[p-.425*d+re,g+.12*d+re],[p-.214*d-re,g+.234*d-re]]).stream(u),a=o.translate([p-.205*d,g+.212*d]).clipExtent([[p-.214*d+re,g+.166*d+re],[p-.115*d-re,g+.234*d-re]]).stream(u),h()},l.fitExtent=function(f,d){return ju(l,f,d)},l.fitSize=function(f,d){return g0(l,f,d)},l.fitWidth=function(f,d){return _0(l,f,d)},l.fitHeight=function(f,d){return y0(l,f,d)};function h(){return t=e=null,l}return l.scale(1070)}function yx(t){return function(e,n){var r=Q(e),i=Q(n),s=t(r*i);return s===1/0?[2,0]:[s*i*X(e),s*X(n)]}}function qo(t){return function(e,n){var r=Ze(e*e+n*n),i=t(r),s=X(i),o=Q(i);return[wt(e*s,r*o),xt(r&&n*s/r)]}}var w0=yx(function(t){return Ze(2/(1+t))});w0.invert=qo(function(t){return 2*xt(t/2)});function IP(){return Cn(w0).scale(124.75).clipAngle(180-.001)}var x0=yx(function(t){return(t=$w(t))&&t/X(t)});x0.invert=qo(function(t){return t});function OP(){return Cn(x0).scale(79.4188).clipAngle(180-.001)}function Fo(t,e){return[t,cc(f0((qe+e)/2))]}Fo.invert=function(t,e){return[t,2*us(Fw(e))-qe]};function DP(){return vx(Fo).scale(961/bt)}function vx(t){var e=Cn(t),n=e.center,r=e.scale,i=e.translate,s=e.clipExtent,o=null,a,c,u;e.scale=function(h){return arguments.length?(r(h),l()):r()},e.translate=function(h){return arguments.length?(i(h),l()):i()},e.center=function(h){return arguments.length?(n(h),l()):n()},e.clipExtent=function(h){return arguments.length?(h==null?o=a=c=u=null:(o=+h[0][0],a=+h[0][1],c=+h[1][0],u=+h[1][1]),l()):o==null?null:[[o,a],[c,u]]};function l(){var h=he*r(),f=e(Xw(e.rotate()).invert([0,0]));return s(o==null?[[f[0]-h,f[1]-h],[f[0]+h,f[1]+h]]:t===Fo?[[Math.max(f[0]-h,o),a],[Math.min(f[0]+h,c),u]]:[[o,Math.max(f[1]-h,a)],[c,Math.min(f[1]+h,u)]])}return l()}function ua(t){return f0((qe+t)/2)}function bx(t,e){var n=Q(t),r=t===e?X(t):cc(n/Q(e))/cc(ua(e)/ua(t)),i=n*rf(ua(t),r)/r;if(!r)return Fo;function s(o,a){i>0?a<-qe+re&&(a=-qe+re):a>qe-re&&(a=qe-re);var c=i/rf(ua(a),r);return[c*X(r*o),i-c*Q(r*o)]}return s.invert=function(o,a){var c=i-a,u=Gt(r)*Ze(o*o+c*c),l=wt(o,pe(c))*Gt(c);return c*r<0&&(l-=he*Gt(o)*Gt(c)),[l/r,2*us(rf(i/u,1/r))-qe]},s}function PP(){return b0(bx).scale(109.5).parallels([30,30])}function fo(t,e){return[t,e]}fo.invert=fo;function qP(){return Cn(fo).scale(152.63)}function wx(t,e){var n=Q(t),r=t===e?X(t):(n-Q(e))/(e-t),i=n/r+t;if(pe(r)<re)return fo;function s(o,a){var c=i-a,u=r*o;return[c*X(u),i-c*Q(u)]}return s.invert=function(o,a){var c=i-a,u=wt(o,pe(c))*Gt(c);return c*r<0&&(u-=he*Gt(o)*Gt(c)),[u/r,i-Gt(r)*Ze(o*o+c*c)]},s}function FP(){return b0(wx).scale(131.154).center([0,13.9389])}var Ls=1.340264,js=-.081106,zs=893e-6,Bs=.003796,Ec=Ze(3)/2,$P=12;function T0(t,e){var n=xt(Ec*X(e)),r=n*n,i=r*r*r;return[t*Q(n)/(Ec*(Ls+3*js*r+i*(7*zs+9*Bs*r))),n*(Ls+js*r+i*(zs+Bs*r))]}T0.invert=function(t,e){for(var n=e,r=n*n,i=r*r*r,s=0,o,a,c;s<$P&&(a=n*(Ls+js*r+i*(zs+Bs*r))-e,c=Ls+3*js*r+i*(7*zs+9*Bs*r),n-=o=a/c,r=n*n,i=r*r*r,!(pe(o)<co));++s);return[Ec*t*(Ls+3*js*r+i*(7*zs+9*Bs*r))/Q(n),xt(X(n)/Ec)]};function VP(){return Cn(T0).scale(177.158)}function S0(t,e){var n=Q(e),r=Q(t)*n;return[n*X(t)/r,X(e)/r]}S0.invert=qo(us);function LP(){return Cn(S0).scale(144.049).clipAngle(60)}function jP(){var t=1,e=0,n=0,r=1,i=1,s=0,o,a,c=null,u,l,h,f=1,d=1,p=Po({point:function(y,w){var x=v([y,w]);this.stream.point(x[0],x[1])}}),g=uo,m,_;function b(){return f=t*r,d=t*i,m=_=null,v}function v(y){var w=y[0]*f,x=y[1]*d;if(s){var C=x*o-w*a;w=w*o+x*a,x=C}return[w+e,x+n]}return v.invert=function(y){var w=y[0]-e,x=y[1]-n;if(s){var C=x*o+w*a;w=w*o-x*a,x=C}return[w/f,x/d]},v.stream=function(y){return m&&_===y?m:m=p(g(_=y))},v.postclip=function(y){return arguments.length?(g=y,c=u=l=h=null,b()):g},v.clipExtent=function(y){return arguments.length?(g=y==null?(c=u=l=h=null,uo):Lu(c=+y[0][0],u=+y[0][1],l=+y[1][0],h=+y[1][1]),b()):c==null?null:[[c,u],[l,h]]},v.scale=function(y){return arguments.length?(t=+y,b()):t},v.translate=function(y){return arguments.length?(e=+y[0],n=+y[1],b()):[e,n]},v.angle=function(y){return arguments.length?(s=y%360*ie,a=X(s),o=Q(s),b()):s*xe},v.reflectX=function(y){return arguments.length?(r=y?-1:1,b()):r<0},v.reflectY=function(y){return arguments.length?(i=y?-1:1,b()):i<0},v.fitExtent=function(y,w){return ju(v,y,w)},v.fitSize=function(y,w){return g0(v,y,w)},v.fitWidth=function(y,w){return _0(v,y,w)},v.fitHeight=function(y,w){return y0(v,y,w)},v}function C0(t,e){var n=e*e,r=n*n;return[t*(.8707-.131979*n+r*(-.013791+r*(.003971*n-.001529*r))),e*(1.007226+n*(.015085+r*(-.044475+.028874*n-.005916*r)))]}C0.invert=function(t,e){var n=e,r=25,i;do{var s=n*n,o=s*s;n-=i=(n*(1.007226+s*(.015085+o*(-.044475+.028874*s-.005916*o)))-e)/(1.007226+s*(.015085*3+o*(-.044475*7+.028874*9*s-.005916*11*o)))}while(pe(i)>re&&--r>0);return[t/(.8707+(s=n*n)*(-.131979+s*(-.013791+s*s*s*(.003971-.001529*s)))),n]};function zP(){return Cn(C0).scale(175.295)}function M0(t,e){return[Q(e)*X(t),X(e)]}M0.invert=qo(xt);function BP(){return Cn(M0).scale(249.5).clipAngle(90+re)}function A0(t,e){var n=Q(e),r=1+Q(t)*n;return[n*X(t)/r,X(e)/r]}A0.invert=qo(function(t){return 2*us(t)});function WP(){return Cn(A0).scale(250).clipAngle(142)}function N0(t,e){return[cc(f0((qe+e)/2)),-t]}N0.invert=function(t,e){return[-e,2*us(Fw(t))-qe]};function UP(){var t=vx(N0),e=t.center,n=t.rotate;return t.center=function(r){return arguments.length?e([-r[1],r[0]]):(r=e(),[r[1],-r[0]])},t.rotate=function(r){return arguments.length?n([r[0],r[1],r.length>2?r[2]+90:90]):(r=n(),[r[0],r[1],r[2]-90])},n([0,0,90]).scale(159.155)}function GP(t,e){return t.parent===e.parent?1:2}function HP(t){return t.reduce(YP,0)/t.length}function YP(t,e){return t+e.x}function XP(t){return 1+t.reduce(ZP,0)}function ZP(t,e){return Math.max(t,e.y)}function KP(t){for(var e;e=t.children;)t=e[0];return t}function QP(t){for(var e;e=t.children;)t=e[e.length-1];return t}function JP(){var t=GP,e=1,n=1,r=!1;function i(s){var o,a=0;s.eachAfter(function(f){var d=f.children;d?(f.x=HP(d),f.y=XP(d)):(f.x=o?a+=t(f,o):0,f.y=0,o=f)});var c=KP(s),u=QP(s),l=c.x-t(c,u)/2,h=u.x+t(u,c)/2;return s.eachAfter(r?function(f){f.x=(f.x-s.x)*e,f.y=(s.y-f.y)*n}:function(f){f.x=(f.x-l)/(h-l)*e,f.y=(1-(s.y?f.y/s.y:1))*n})}return i.separation=function(s){return arguments.length?(t=s,i):t},i.size=function(s){return arguments.length?(r=!1,e=+s[0],n=+s[1],i):r?null:[e,n]},i.nodeSize=function(s){return arguments.length?(r=!0,e=+s[0],n=+s[1],i):r?[e,n]:null},i}function eq(t){var e=0,n=t.children,r=n&&n.length;if(!r)e=1;else for(;--r>=0;)e+=n[r].value;t.value=e}function tq(){return this.eachAfter(eq)}function nq(t,e){let n=-1;for(const r of this)t.call(e,r,++n,this);return this}function rq(t,e){for(var n=this,r=[n],i,s,o=-1;n=r.pop();)if(t.call(e,n,++o,this),i=n.children)for(s=i.length-1;s>=0;--s)r.push(i[s]);return this}function iq(t,e){for(var n=this,r=[n],i=[],s,o,a,c=-1;n=r.pop();)if(i.push(n),s=n.children)for(o=0,a=s.length;o<a;++o)r.push(s[o]);for(;n=i.pop();)t.call(e,n,++c,this);return this}function sq(t,e){let n=-1;for(const r of this)if(t.call(e,r,++n,this))return r}function oq(t){return this.eachAfter(function(e){for(var n=+t(e.data)||0,r=e.children,i=r&&r.length;--i>=0;)n+=r[i].value;e.value=n})}function aq(t){return this.eachBefore(function(e){e.children&&e.children.sort(t)})}function cq(t){for(var e=this,n=uq(e,t),r=[e];e!==n;)e=e.parent,r.push(e);for(var i=r.length;t!==n;)r.splice(i,0,t),t=t.parent;return r}function uq(t,e){if(t===e)return t;var n=t.ancestors(),r=e.ancestors(),i=null;for(t=n.pop(),e=r.pop();t===e;)i=t,t=n.pop(),e=r.pop();return i}function lq(){for(var t=this,e=[t];t=t.parent;)e.push(t);return e}function hq(){return Array.from(this)}function fq(){var t=[];return this.eachBefore(function(e){e.children||t.push(e)}),t}function dq(){var t=this,e=[];return t.each(function(n){n!==t&&e.push({source:n.parent,target:n})}),e}function*pq(){var t=this,e,n=[t],r,i,s;do for(e=n.reverse(),n=[];t=e.pop();)if(yield t,r=t.children)for(i=0,s=r.length;i<s;++i)n.push(r[i]);while(n.length)}function k0(t,e){t instanceof Map?(t=[void 0,t],e===void 0&&(e=_q)):e===void 0&&(e=gq);for(var n=new Xr(t),r,i=[n],s,o,a,c;r=i.pop();)if((o=e(r.data))&&(c=(o=Array.from(o)).length))for(r.children=o,a=c-1;a>=0;--a)i.push(s=o[a]=new Xr(o[a])),s.parent=r,s.depth=r.depth+1;return n.eachBefore(xx)}function mq(){return k0(this).eachBefore(yq)}function gq(t){return t.children}function _q(t){return Array.isArray(t)?t[1]:null}function yq(t){t.data.value!==void 0&&(t.value=t.data.value),t.data=t.data.data}function xx(t){var e=0;do t.height=e;while((t=t.parent)&&t.height<++e)}function Xr(t){this.data=t,this.depth=this.height=0,this.parent=null}Xr.prototype=k0.prototype={constructor:Xr,count:tq,each:nq,eachAfter:iq,eachBefore:rq,find:sq,sum:oq,sort:aq,path:cq,ancestors:lq,descendants:hq,leaves:fq,links:dq,copy:mq,[Symbol.iterator]:pq};function Aa(t){return t==null?null:Tx(t)}function Tx(t){if(typeof t!="function")throw new Error;return t}function Mr(){return 0}function gi(t){return function(){return t}}const vq=1664525,bq=1013904223,Q_=4294967296;function E0(){let t=1;return()=>(t=(vq*t+bq)%Q_)/Q_}function wq(t){return typeof t=="object"&&"length"in t?t:Array.from(t)}function xq(t,e){let n=t.length,r,i;for(;n;)i=e()*n--|0,r=t[n],t[n]=t[i],t[i]=r;return t}function Tq(t){return Sx(t,E0())}function Sx(t,e){for(var n=0,r=(t=xq(Array.from(t),e)).length,i=[],s,o;n<r;)s=t[n],o&&Cx(o,s)?++n:(o=Cq(i=Sq(i,s)),n=0);return o}function Sq(t,e){var n,r;if(uf(e,t))return[e];for(n=0;n<t.length;++n)if(la(e,t[n])&&uf(qs(t[n],e),t))return[t[n],e];for(n=0;n<t.length-1;++n)for(r=n+1;r<t.length;++r)if(la(qs(t[n],t[r]),e)&&la(qs(t[n],e),t[r])&&la(qs(t[r],e),t[n])&&uf(Mx(t[n],t[r],e),t))return[t[n],t[r],e];throw new Error}function la(t,e){var n=t.r-e.r,r=e.x-t.x,i=e.y-t.y;return n<0||n*n<r*r+i*i}function Cx(t,e){var n=t.r-e.r+Math.max(t.r,e.r,1)*1e-9,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function uf(t,e){for(var n=0;n<e.length;++n)if(!Cx(t,e[n]))return!1;return!0}function Cq(t){switch(t.length){case 1:return Mq(t[0]);case 2:return qs(t[0],t[1]);case 3:return Mx(t[0],t[1],t[2])}}function Mq(t){return{x:t.x,y:t.y,r:t.r}}function qs(t,e){var n=t.x,r=t.y,i=t.r,s=e.x,o=e.y,a=e.r,c=s-n,u=o-r,l=a-i,h=Math.sqrt(c*c+u*u);return{x:(n+s+c/h*l)/2,y:(r+o+u/h*l)/2,r:(h+i+a)/2}}function Mx(t,e,n){var r=t.x,i=t.y,s=t.r,o=e.x,a=e.y,c=e.r,u=n.x,l=n.y,h=n.r,f=r-o,d=r-u,p=i-a,g=i-l,m=c-s,_=h-s,b=r*r+i*i-s*s,v=b-o*o-a*a+c*c,y=b-u*u-l*l+h*h,w=d*p-f*g,x=(p*y-g*v)/(w*2)-r,C=(g*m-p*_)/w,S=(d*v-f*y)/(w*2)-i,A=(f*_-d*m)/w,N=C*C+A*A-1,T=2*(s+x*C+S*A),k=x*x+S*S-s*s,I=-(Math.abs(N)>1e-6?(T+Math.sqrt(T*T-4*N*k))/(2*N):k/T);return{x:r+x+C*I,y:i+S+A*I,r:I}}function J_(t,e,n){var r=t.x-e.x,i,s,o=t.y-e.y,a,c,u=r*r+o*o;u?(s=e.r+n.r,s*=s,c=t.r+n.r,c*=c,s>c?(i=(u+c-s)/(2*u),a=Math.sqrt(Math.max(0,c/u-i*i)),n.x=t.x-i*r-a*o,n.y=t.y-i*o+a*r):(i=(u+s-c)/(2*u),a=Math.sqrt(Math.max(0,s/u-i*i)),n.x=e.x+i*r-a*o,n.y=e.y+i*o+a*r)):(n.x=e.x+n.r,n.y=e.y)}function ey(t,e){var n=t.r+e.r-1e-6,r=e.x-t.x,i=e.y-t.y;return n>0&&n*n>r*r+i*i}function ty(t){var e=t._,n=t.next._,r=e.r+n.r,i=(e.x*n.r+n.x*e.r)/r,s=(e.y*n.r+n.y*e.r)/r;return i*i+s*s}function ha(t){this._=t,this.next=null,this.previous=null}function Ax(t,e){if(!(s=(t=wq(t)).length))return 0;var n,r,i,s,o,a,c,u,l,h,f;if(n=t[0],n.x=0,n.y=0,!(s>1))return n.r;if(r=t[1],n.x=-r.r,r.x=n.r,r.y=0,!(s>2))return n.r+r.r;J_(r,n,i=t[2]),n=new ha(n),r=new ha(r),i=new ha(i),n.next=i.previous=r,r.next=n.previous=i,i.next=r.previous=n;e:for(c=3;c<s;++c){J_(n._,r._,i=t[c]),i=new ha(i),u=r.next,l=n.previous,h=r._.r,f=n._.r;do if(h<=f){if(ey(u._,i._)){r=u,n.next=r,r.previous=n,--c;continue e}h+=u._.r,u=u.next}else{if(ey(l._,i._)){n=l,n.next=r,r.previous=n,--c;continue e}f+=l._.r,l=l.previous}while(u!==l.next);for(i.previous=n,i.next=r,n.next=r.previous=r=i,o=ty(n);(i=i.next)!==r;)(a=ty(i))<o&&(n=i,o=a);r=n.next}for(n=[r._],i=r;(i=i.next)!==r;)n.push(i._);for(i=Sx(n,e),c=0;c<s;++c)n=t[c],n.x-=i.x,n.y-=i.y;return i.r}function Aq(t){return Ax(t,E0()),t}function Nq(t){return Math.sqrt(t.value)}function kq(){var t=null,e=1,n=1,r=Mr;function i(s){const o=E0();return s.x=e/2,s.y=n/2,t?s.eachBefore(ny(t)).eachAfter(lf(r,.5,o)).eachBefore(ry(1)):s.eachBefore(ny(Nq)).eachAfter(lf(Mr,1,o)).eachAfter(lf(r,s.r/Math.min(e,n),o)).eachBefore(ry(Math.min(e,n)/(2*s.r))),s}return i.radius=function(s){return arguments.length?(t=Aa(s),i):t},i.size=function(s){return arguments.length?(e=+s[0],n=+s[1],i):[e,n]},i.padding=function(s){return arguments.length?(r=typeof s=="function"?s:gi(+s),i):r},i}function ny(t){return function(e){e.children||(e.r=Math.max(0,+t(e)||0))}}function lf(t,e,n){return function(r){if(i=r.children){var i,s,o=i.length,a=t(r)*e||0,c;if(a)for(s=0;s<o;++s)i[s].r+=a;if(c=Ax(i,n),a)for(s=0;s<o;++s)i[s].r-=a;r.r=c+a}}}function ry(t){return function(e){var n=e.parent;e.r*=t,n&&(e.x=n.x+t*e.x,e.y=n.y+t*e.y)}}function Nx(t){t.x0=Math.round(t.x0),t.y0=Math.round(t.y0),t.x1=Math.round(t.x1),t.y1=Math.round(t.y1)}function $o(t,e,n,r,i){for(var s=t.children,o,a=-1,c=s.length,u=t.value&&(r-e)/t.value;++a<c;)o=s[a],o.y0=n,o.y1=i,o.x0=e,o.x1=e+=o.value*u}function Eq(){var t=1,e=1,n=0,r=!1;function i(o){var a=o.height+1;return o.x0=o.y0=n,o.x1=t,o.y1=e/a,o.eachBefore(s(e,a)),r&&o.eachBefore(Nx),o}function s(o,a){return function(c){c.children&&$o(c,c.x0,o*(c.depth+1)/a,c.x1,o*(c.depth+2)/a);var u=c.x0,l=c.y0,h=c.x1-n,f=c.y1-n;h<u&&(u=h=(u+h)/2),f<l&&(l=f=(l+f)/2),c.x0=u,c.y0=l,c.x1=h,c.y1=f}}return i.round=function(o){return arguments.length?(r=!!o,i):r},i.size=function(o){return arguments.length?(t=+o[0],e=+o[1],i):[t,e]},i.padding=function(o){return arguments.length?(n=+o,i):n},i}var Rq={depth:-1},iy={},hf={};function Iq(t){return t.id}function Oq(t){return t.parentId}function Dq(){var t=Iq,e=Oq,n;function r(i){var s=Array.from(i),o=t,a=e,c,u,l,h,f,d,p,g,m=new Map;if(n!=null){const _=s.map((y,w)=>Pq(n(y,w,i))),b=_.map(sy),v=new Set(_).add("");for(const y of b)v.has(y)||(v.add(y),_.push(y),b.push(sy(y)),s.push(hf));o=(y,w)=>_[w],a=(y,w)=>b[w]}for(l=0,c=s.length;l<c;++l)u=s[l],d=s[l]=new Xr(u),(p=o(u,l,i))!=null&&(p+="")&&(g=d.id=p,m.set(g,m.has(g)?iy:d)),(p=a(u,l,i))!=null&&(p+="")&&(d.parent=p);for(l=0;l<c;++l)if(d=s[l],p=d.parent){if(f=m.get(p),!f)throw new Error("missing: "+p);if(f===iy)throw new Error("ambiguous: "+p);f.children?f.children.push(d):f.children=[d],d.parent=f}else{if(h)throw new Error("multiple roots");h=d}if(!h)throw new Error("no root");if(n!=null){for(;h.data===hf&&h.children.length===1;)h=h.children[0],--c;for(let _=s.length-1;_>=0&&(d=s[_],d.data===hf);--_)d.data=null}if(h.parent=Rq,h.eachBefore(function(_){_.depth=_.parent.depth+1,--c}).eachBefore(xx),h.parent=null,c>0)throw new Error("cycle");return h}return r.id=function(i){return arguments.length?(t=Aa(i),r):t},r.parentId=function(i){return arguments.length?(e=Aa(i),r):e},r.path=function(i){return arguments.length?(n=Aa(i),r):n},r}function Pq(t){t=`${t}`;let e=t.length;return Sd(t,e-1)&&!Sd(t,e-2)&&(t=t.slice(0,-1)),t[0]==="/"?t:`/${t}`}function sy(t){let e=t.length;if(e<2)return"";for(;--e>1&&!Sd(t,e););return t.slice(0,e)}function Sd(t,e){if(t[e]==="/"){let n=0;for(;e>0&&t[--e]==="\\";)++n;if((n&1)===0)return!0}return!1}function qq(t,e){return t.parent===e.parent?1:2}function ff(t){var e=t.children;return e?e[0]:t.t}function df(t){var e=t.children;return e?e[e.length-1]:t.t}function Fq(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function $q(t){for(var e=0,n=0,r=t.children,i=r.length,s;--i>=0;)s=r[i],s.z+=e,s.m+=e,e+=s.s+(n+=s.c)}function Vq(t,e,n){return t.a.parent===e.parent?t.a:n}function Na(t,e){this._=t,this.parent=null,this.children=null,this.A=null,this.a=this,this.z=0,this.m=0,this.c=0,this.s=0,this.t=null,this.i=e}Na.prototype=Object.create(Xr.prototype);function Lq(t){for(var e=new Na(t,0),n,r=[e],i,s,o,a;n=r.pop();)if(s=n._.children)for(n.children=new Array(a=s.length),o=a-1;o>=0;--o)r.push(i=n.children[o]=new Na(s[o],o)),i.parent=n;return(e.parent=new Na(null,0)).children=[e],e}function jq(){var t=qq,e=1,n=1,r=null;function i(u){var l=Lq(u);if(l.eachAfter(s),l.parent.m=-l.z,l.eachBefore(o),r)u.eachBefore(c);else{var h=u,f=u,d=u;u.eachBefore(function(b){b.x<h.x&&(h=b),b.x>f.x&&(f=b),b.depth>d.depth&&(d=b)});var p=h===f?1:t(h,f)/2,g=p-h.x,m=e/(f.x+p+g),_=n/(d.depth||1);u.eachBefore(function(b){b.x=(b.x+g)*m,b.y=b.depth*_})}return u}function s(u){var l=u.children,h=u.parent.children,f=u.i?h[u.i-1]:null;if(l){$q(u);var d=(l[0].z+l[l.length-1].z)/2;f?(u.z=f.z+t(u._,f._),u.m=u.z-d):u.z=d}else f&&(u.z=f.z+t(u._,f._));u.parent.A=a(u,f,u.parent.A||h[0])}function o(u){u._.x=u.z+u.parent.m,u.m+=u.parent.m}function a(u,l,h){if(l){for(var f=u,d=u,p=l,g=f.parent.children[0],m=f.m,_=d.m,b=p.m,v=g.m,y;p=df(p),f=ff(f),p&&f;)g=ff(g),d=df(d),d.a=u,y=p.z+b-f.z-m+t(p._,f._),y>0&&(Fq(Vq(p,u,h),u,y),m+=y,_+=y),b+=p.m,m+=f.m,v+=g.m,_+=d.m;p&&!df(d)&&(d.t=p,d.m+=b-_),f&&!ff(g)&&(g.t=f,g.m+=m-v,h=u)}return h}function c(u){u.x*=e,u.y=u.depth*n}return i.separation=function(u){return arguments.length?(t=u,i):t},i.size=function(u){return arguments.length?(r=!1,e=+u[0],n=+u[1],i):r?null:[e,n]},i.nodeSize=function(u){return arguments.length?(r=!0,e=+u[0],n=+u[1],i):r?[e,n]:null},i}function zu(t,e,n,r,i){for(var s=t.children,o,a=-1,c=s.length,u=t.value&&(i-n)/t.value;++a<c;)o=s[a],o.x0=e,o.x1=r,o.y0=n,o.y1=n+=o.value*u}var kx=(1+Math.sqrt(5))/2;function Ex(t,e,n,r,i,s){for(var o=[],a=e.children,c,u,l=0,h=0,f=a.length,d,p,g=e.value,m,_,b,v,y,w,x;l<f;){d=i-n,p=s-r;do m=a[h++].value;while(!m&&h<f);for(_=b=m,w=Math.max(p/d,d/p)/(g*t),x=m*m*w,y=Math.max(b/x,x/_);h<f;++h){if(m+=u=a[h].value,u<_&&(_=u),u>b&&(b=u),x=m*m*w,v=Math.max(b/x,x/_),v>y){m-=u;break}y=v}o.push(c={value:m,dice:d<p,children:a.slice(l,h)}),c.dice?$o(c,n,r,i,g?r+=p*m/g:s):zu(c,n,r,g?n+=d*m/g:i,s),g-=m,l=h}return o}const Rx=(function t(e){function n(r,i,s,o,a){Ex(e,r,i,s,o,a)}return n.ratio=function(r){return t((r=+r)>1?r:1)},n})(kx);function zq(){var t=Rx,e=!1,n=1,r=1,i=[0],s=Mr,o=Mr,a=Mr,c=Mr,u=Mr;function l(f){return f.x0=f.y0=0,f.x1=n,f.y1=r,f.eachBefore(h),i=[0],e&&f.eachBefore(Nx),f}function h(f){var d=i[f.depth],p=f.x0+d,g=f.y0+d,m=f.x1-d,_=f.y1-d;m<p&&(p=m=(p+m)/2),_<g&&(g=_=(g+_)/2),f.x0=p,f.y0=g,f.x1=m,f.y1=_,f.children&&(d=i[f.depth+1]=s(f)/2,p+=u(f)-d,g+=o(f)-d,m-=a(f)-d,_-=c(f)-d,m<p&&(p=m=(p+m)/2),_<g&&(g=_=(g+_)/2),t(f,p,g,m,_))}return l.round=function(f){return arguments.length?(e=!!f,l):e},l.size=function(f){return arguments.length?(n=+f[0],r=+f[1],l):[n,r]},l.tile=function(f){return arguments.length?(t=Tx(f),l):t},l.padding=function(f){return arguments.length?l.paddingInner(f).paddingOuter(f):l.paddingInner()},l.paddingInner=function(f){return arguments.length?(s=typeof f=="function"?f:gi(+f),l):s},l.paddingOuter=function(f){return arguments.length?l.paddingTop(f).paddingRight(f).paddingBottom(f).paddingLeft(f):l.paddingTop()},l.paddingTop=function(f){return arguments.length?(o=typeof f=="function"?f:gi(+f),l):o},l.paddingRight=function(f){return arguments.length?(a=typeof f=="function"?f:gi(+f),l):a},l.paddingBottom=function(f){return arguments.length?(c=typeof f=="function"?f:gi(+f),l):c},l.paddingLeft=function(f){return arguments.length?(u=typeof f=="function"?f:gi(+f),l):u},l}function Bq(t,e,n,r,i){var s=t.children,o,a=s.length,c,u=new Array(a+1);for(u[0]=c=o=0;o<a;++o)u[o+1]=c+=s[o].value;l(0,a,t.value,e,n,r,i);function l(h,f,d,p,g,m,_){if(h>=f-1){var b=s[h];b.x0=p,b.y0=g,b.x1=m,b.y1=_;return}for(var v=u[h],y=d/2+v,w=h+1,x=f-1;w<x;){var C=w+x>>>1;u[C]<y?w=C+1:x=C}y-u[w-1]<u[w]-y&&h+1<w&&--w;var S=u[w]-v,A=d-S;if(m-p>_-g){var N=d?(p*A+m*S)/d:m;l(h,w,S,p,g,N,_),l(w,f,A,N,g,m,_)}else{var T=d?(g*A+_*S)/d:_;l(h,w,S,p,g,m,T),l(w,f,A,p,T,m,_)}}}function Wq(t,e,n,r,i){(t.depth&1?zu:$o)(t,e,n,r,i)}const Uq=(function t(e){function n(r,i,s,o,a){if((c=r._squarify)&&c.ratio===e)for(var c,u,l,h,f=-1,d,p=c.length,g=r.value;++f<p;){for(u=c[f],l=u.children,h=u.value=0,d=l.length;h<d;++h)u.value+=l[h].value;u.dice?$o(u,i,s,o,g?s+=(a-s)*u.value/g:a):zu(u,i,s,g?i+=(o-i)*u.value/g:o,a),g-=u.value}else r._squarify=c=Ex(e,r,i,s,o,a),c.ratio=e}return n.ratio=function(r){return t((r=+r)>1?r:1)},n})(kx);function Gq(t){for(var e=-1,n=t.length,r,i=t[n-1],s=0;++e<n;)r=i,i=t[e],s+=r[1]*i[0]-r[0]*i[1];return s/2}function Hq(t){for(var e=-1,n=t.length,r=0,i=0,s,o=t[n-1],a,c=0;++e<n;)s=o,o=t[e],c+=a=s[0]*o[1]-o[0]*s[1],r+=(s[0]+o[0])*a,i+=(s[1]+o[1])*a;return c*=3,[r/c,i/c]}function Yq(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}function Xq(t,e){return t[0]-e[0]||t[1]-e[1]}function oy(t){const e=t.length,n=[0,1];let r=2,i;for(i=2;i<e;++i){for(;r>1&&Yq(t[n[r-2]],t[n[r-1]],t[i])<=0;)--r;n[r++]=i}return n.slice(0,r)}function Zq(t){if((n=t.length)<3)return null;var e,n,r=new Array(n),i=new Array(n);for(e=0;e<n;++e)r[e]=[+t[e][0],+t[e][1],e];for(r.sort(Xq),e=0;e<n;++e)i[e]=[r[e][0],-r[e][1]];var s=oy(r),o=oy(i),a=o[0]===s[0],c=o[o.length-1]===s[s.length-1],u=[];for(e=s.length-1;e>=0;--e)u.push(t[r[s[e]][2]]);for(e=+a;e<o.length-c;++e)u.push(t[r[o[e]][2]]);return u}function Kq(t,e){for(var n=t.length,r=t[n-1],i=e[0],s=e[1],o=r[0],a=r[1],c,u,l=!1,h=0;h<n;++h)r=t[h],c=r[0],u=r[1],u>s!=a>s&&i<(o-c)*(s-u)/(a-u)+c&&(l=!l),o=c,a=u;return l}function Qq(t){for(var e=-1,n=t.length,r=t[n-1],i,s,o=r[0],a=r[1],c=0;++e<n;)i=o,s=a,r=t[e],o=r[0],a=r[1],i-=o,s-=a,c+=Math.hypot(i,s);return c}const Je=Math.random,Jq=(function t(e){function n(r,i){return r=r==null?0:+r,i=i==null?1:+i,arguments.length===1?(i=r,r=0):i-=r,function(){return e()*i+r}}return n.source=t,n})(Je),eF=(function t(e){function n(r,i){return arguments.length<2&&(i=r,r=0),r=Math.floor(r),i=Math.floor(i)-r,function(){return Math.floor(e()*i+r)}}return n.source=t,n})(Je),R0=(function t(e){function n(r,i){var s,o;return r=r==null?0:+r,i=i==null?1:+i,function(){var a;if(s!=null)a=s,s=null;else do s=e()*2-1,a=e()*2-1,o=s*s+a*a;while(!o||o>1);return r+i*a*Math.sqrt(-2*Math.log(o)/o)}}return n.source=t,n})(Je),tF=(function t(e){var n=R0.source(e);function r(){var i=n.apply(this,arguments);return function(){return Math.exp(i())}}return r.source=t,r})(Je),Ix=(function t(e){function n(r){return(r=+r)<=0?()=>0:function(){for(var i=0,s=r;s>1;--s)i+=e();return i+s*e()}}return n.source=t,n})(Je),nF=(function t(e){var n=Ix.source(e);function r(i){if((i=+i)==0)return e;var s=n(i);return function(){return s()/i}}return r.source=t,r})(Je),rF=(function t(e){function n(r){return function(){return-Math.log1p(-e())/r}}return n.source=t,n})(Je),iF=(function t(e){function n(r){if((r=+r)<0)throw new RangeError("invalid alpha");return r=1/-r,function(){return Math.pow(1-e(),r)}}return n.source=t,n})(Je),sF=(function t(e){function n(r){if((r=+r)<0||r>1)throw new RangeError("invalid p");return function(){return Math.floor(e()+r)}}return n.source=t,n})(Je),Ox=(function t(e){function n(r){if((r=+r)<0||r>1)throw new RangeError("invalid p");return r===0?()=>1/0:r===1?()=>1:(r=Math.log1p(-r),function(){return 1+Math.floor(Math.log1p(-e())/r)})}return n.source=t,n})(Je),I0=(function t(e){var n=R0.source(e)();function r(i,s){if((i=+i)<0)throw new RangeError("invalid k");if(i===0)return()=>0;if(s=s==null?1:+s,i===1)return()=>-Math.log1p(-e())*s;var o=(i<1?i+1:i)-1/3,a=1/(3*Math.sqrt(o)),c=i<1?()=>Math.pow(e(),1/i):()=>1;return function(){do{do var u=n(),l=1+a*u;while(l<=0);l*=l*l;var h=1-e()}while(h>=1-.0331*u*u*u*u&&Math.log(h)>=.5*u*u+o*(1-l+Math.log(l)));return o*l*c()*s}}return r.source=t,r})(Je),Dx=(function t(e){var n=I0.source(e);function r(i,s){var o=n(i),a=n(s);return function(){var c=o();return c===0?0:c/(c+a())}}return r.source=t,r})(Je),Px=(function t(e){var n=Ox.source(e),r=Dx.source(e);function i(s,o){return s=+s,(o=+o)>=1?()=>s:o<=0?()=>0:function(){for(var a=0,c=s,u=o;c*u>16&&c*(1-u)>16;){var l=Math.floor((c+1)*u),h=r(l,c-l+1)();h<=u?(a+=l,c-=l,u=(u-h)/(1-h)):(c=l-1,u/=h)}for(var f=u<.5,d=f?u:1-u,p=n(d),g=p(),m=0;g<=c;++m)g+=p();return a+(f?m:c-m)}}return i.source=t,i})(Je),oF=(function t(e){function n(r,i,s){var o;return(r=+r)==0?o=a=>-Math.log(a):(r=1/r,o=a=>Math.pow(a,r)),i=i==null?0:+i,s=s==null?1:+s,function(){return i+s*o(-Math.log1p(-e()))}}return n.source=t,n})(Je),aF=(function t(e){function n(r,i){return r=r==null?0:+r,i=i==null?1:+i,function(){return r+i*Math.tan(Math.PI*e())}}return n.source=t,n})(Je),cF=(function t(e){function n(r,i){return r=r==null?0:+r,i=i==null?1:+i,function(){var s=e();return r+i*Math.log(s/(1-s))}}return n.source=t,n})(Je),uF=(function t(e){var n=I0.source(e),r=Px.source(e);function i(s){return function(){for(var o=0,a=s;a>16;){var c=Math.floor(.875*a),u=n(c)();if(u>a)return o+r(c-1,a/u)();o+=c,a-=u}for(var l=-Math.log1p(-e()),h=0;l<=a;++h)l-=Math.log1p(-e());return o+h}}return i.source=t,i})(Je),lF=1664525,hF=1013904223,ay=1/4294967296;function fF(t=Math.random()){let e=(0<=t&&t<1?t/ay:Math.abs(t))|0;return()=>(e=lF*e+hF|0,ay*(e>>>0))}function ue(t){for(var e=t.length/6|0,n=new Array(e),r=0;r<e;)n[r]="#"+t.slice(r*6,++r*6);return n}const dF=ue("1f77b4ff7f0e2ca02cd627289467bd8c564be377c27f7f7fbcbd2217becf"),pF=ue("7fc97fbeaed4fdc086ffff99386cb0f0027fbf5b17666666"),mF=ue("1b9e77d95f027570b3e7298a66a61ee6ab02a6761d666666"),gF=ue("4269d0efb118ff725c6cc5b03ca951ff8ab7a463f297bbf59c6b4e9498a0"),_F=ue("a6cee31f78b4b2df8a33a02cfb9a99e31a1cfdbf6fff7f00cab2d66a3d9affff99b15928"),yF=ue("fbb4aeb3cde3ccebc5decbe4fed9a6ffffcce5d8bdfddaecf2f2f2"),vF=ue("b3e2cdfdcdaccbd5e8f4cae4e6f5c9fff2aef1e2cccccccc"),bF=ue("e41a1c377eb84daf4a984ea3ff7f00ffff33a65628f781bf999999"),wF=ue("66c2a5fc8d628da0cbe78ac3a6d854ffd92fe5c494b3b3b3"),xF=ue("8dd3c7ffffb3bebadafb807280b1d3fdb462b3de69fccde5d9d9d9bc80bdccebc5ffed6f"),TF=ue("4e79a7f28e2ce1575976b7b259a14fedc949af7aa1ff9da79c755fbab0ab"),Te=t=>Xv(t[t.length-1]);var qx=new Array(3).concat("d8b365f5f5f55ab4ac","a6611adfc27d80cdc1018571","a6611adfc27df5f5f580cdc1018571","8c510ad8b365f6e8c3c7eae55ab4ac01665e","8c510ad8b365f6e8c3f5f5f5c7eae55ab4ac01665e","8c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e","8c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e","5430058c510abf812ddfc27df6e8c3c7eae580cdc135978f01665e003c30","5430058c510abf812ddfc27df6e8c3f5f5f5c7eae580cdc135978f01665e003c30").map(ue);const SF=Te(qx);var Fx=new Array(3).concat("af8dc3f7f7f77fbf7b","7b3294c2a5cfa6dba0008837","7b3294c2a5cff7f7f7a6dba0008837","762a83af8dc3e7d4e8d9f0d37fbf7b1b7837","762a83af8dc3e7d4e8f7f7f7d9f0d37fbf7b1b7837","762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b7837","762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b7837","40004b762a839970abc2a5cfe7d4e8d9f0d3a6dba05aae611b783700441b","40004b762a839970abc2a5cfe7d4e8f7f7f7d9f0d3a6dba05aae611b783700441b").map(ue);const CF=Te(Fx);var $x=new Array(3).concat("e9a3c9f7f7f7a1d76a","d01c8bf1b6dab8e1864dac26","d01c8bf1b6daf7f7f7b8e1864dac26","c51b7de9a3c9fde0efe6f5d0a1d76a4d9221","c51b7de9a3c9fde0eff7f7f7e6f5d0a1d76a4d9221","c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221","c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221","8e0152c51b7dde77aef1b6dafde0efe6f5d0b8e1867fbc414d9221276419","8e0152c51b7dde77aef1b6dafde0eff7f7f7e6f5d0b8e1867fbc414d9221276419").map(ue);const MF=Te($x);var Vx=new Array(3).concat("998ec3f7f7f7f1a340","5e3c99b2abd2fdb863e66101","5e3c99b2abd2f7f7f7fdb863e66101","542788998ec3d8daebfee0b6f1a340b35806","542788998ec3d8daebf7f7f7fee0b6f1a340b35806","5427888073acb2abd2d8daebfee0b6fdb863e08214b35806","5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b35806","2d004b5427888073acb2abd2d8daebfee0b6fdb863e08214b358067f3b08","2d004b5427888073acb2abd2d8daebf7f7f7fee0b6fdb863e08214b358067f3b08").map(ue);const AF=Te(Vx);var Lx=new Array(3).concat("ef8a62f7f7f767a9cf","ca0020f4a58292c5de0571b0","ca0020f4a582f7f7f792c5de0571b0","b2182bef8a62fddbc7d1e5f067a9cf2166ac","b2182bef8a62fddbc7f7f7f7d1e5f067a9cf2166ac","b2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac","b2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac","67001fb2182bd6604df4a582fddbc7d1e5f092c5de4393c32166ac053061","67001fb2182bd6604df4a582fddbc7f7f7f7d1e5f092c5de4393c32166ac053061").map(ue);const NF=Te(Lx);var jx=new Array(3).concat("ef8a62ffffff999999","ca0020f4a582bababa404040","ca0020f4a582ffffffbababa404040","b2182bef8a62fddbc7e0e0e09999994d4d4d","b2182bef8a62fddbc7ffffffe0e0e09999994d4d4d","b2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d","b2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d","67001fb2182bd6604df4a582fddbc7e0e0e0bababa8787874d4d4d1a1a1a","67001fb2182bd6604df4a582fddbc7ffffffe0e0e0bababa8787874d4d4d1a1a1a").map(ue);const kF=Te(jx);var zx=new Array(3).concat("fc8d59ffffbf91bfdb","d7191cfdae61abd9e92c7bb6","d7191cfdae61ffffbfabd9e92c7bb6","d73027fc8d59fee090e0f3f891bfdb4575b4","d73027fc8d59fee090ffffbfe0f3f891bfdb4575b4","d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4","d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4","a50026d73027f46d43fdae61fee090e0f3f8abd9e974add14575b4313695","a50026d73027f46d43fdae61fee090ffffbfe0f3f8abd9e974add14575b4313695").map(ue);const EF=Te(zx);var Bx=new Array(3).concat("fc8d59ffffbf91cf60","d7191cfdae61a6d96a1a9641","d7191cfdae61ffffbfa6d96a1a9641","d73027fc8d59fee08bd9ef8b91cf601a9850","d73027fc8d59fee08bffffbfd9ef8b91cf601a9850","d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850","d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850","a50026d73027f46d43fdae61fee08bd9ef8ba6d96a66bd631a9850006837","a50026d73027f46d43fdae61fee08bffffbfd9ef8ba6d96a66bd631a9850006837").map(ue);const RF=Te(Bx);var Wx=new Array(3).concat("fc8d59ffffbf99d594","d7191cfdae61abdda42b83ba","d7191cfdae61ffffbfabdda42b83ba","d53e4ffc8d59fee08be6f59899d5943288bd","d53e4ffc8d59fee08bffffbfe6f59899d5943288bd","d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd","d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd","9e0142d53e4ff46d43fdae61fee08be6f598abdda466c2a53288bd5e4fa2","9e0142d53e4ff46d43fdae61fee08bffffbfe6f598abdda466c2a53288bd5e4fa2").map(ue);const IF=Te(Wx);var Ux=new Array(3).concat("e5f5f999d8c92ca25f","edf8fbb2e2e266c2a4238b45","edf8fbb2e2e266c2a42ca25f006d2c","edf8fbccece699d8c966c2a42ca25f006d2c","edf8fbccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45005824","f7fcfde5f5f9ccece699d8c966c2a441ae76238b45006d2c00441b").map(ue);const OF=Te(Ux);var Gx=new Array(3).concat("e0ecf49ebcda8856a7","edf8fbb3cde38c96c688419d","edf8fbb3cde38c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68856a7810f7c","edf8fbbfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d6e016b","f7fcfde0ecf4bfd3e69ebcda8c96c68c6bb188419d810f7c4d004b").map(ue);const DF=Te(Gx);var Hx=new Array(3).concat("e0f3dba8ddb543a2ca","f0f9e8bae4bc7bccc42b8cbe","f0f9e8bae4bc7bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc443a2ca0868ac","f0f9e8ccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe08589e","f7fcf0e0f3dbccebc5a8ddb57bccc44eb3d32b8cbe0868ac084081").map(ue);const PF=Te(Hx);var Yx=new Array(3).concat("fee8c8fdbb84e34a33","fef0d9fdcc8afc8d59d7301f","fef0d9fdcc8afc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59e34a33b30000","fef0d9fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301f990000","fff7ecfee8c8fdd49efdbb84fc8d59ef6548d7301fb300007f0000").map(ue);const qF=Te(Yx);var Xx=new Array(3).concat("ece2f0a6bddb1c9099","f6eff7bdc9e167a9cf02818a","f6eff7bdc9e167a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf1c9099016c59","f6eff7d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016450","fff7fbece2f0d0d1e6a6bddb67a9cf3690c002818a016c59014636").map(ue);const FF=Te(Xx);var Zx=new Array(3).concat("ece7f2a6bddb2b8cbe","f1eef6bdc9e174a9cf0570b0","f1eef6bdc9e174a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf2b8cbe045a8d","f1eef6d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0034e7b","fff7fbece7f2d0d1e6a6bddb74a9cf3690c00570b0045a8d023858").map(ue);const $F=Te(Zx);var Kx=new Array(3).concat("e7e1efc994c7dd1c77","f1eef6d7b5d8df65b0ce1256","f1eef6d7b5d8df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0dd1c77980043","f1eef6d4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125691003f","f7f4f9e7e1efd4b9dac994c7df65b0e7298ace125698004367001f").map(ue);const VF=Te(Kx);var Qx=new Array(3).concat("fde0ddfa9fb5c51b8a","feebe2fbb4b9f768a1ae017e","feebe2fbb4b9f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1c51b8a7a0177","feebe2fcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a0177","fff7f3fde0ddfcc5c0fa9fb5f768a1dd3497ae017e7a017749006a").map(ue);const LF=Te(Qx);var Jx=new Array(3).concat("edf8b17fcdbb2c7fb8","ffffcca1dab441b6c4225ea8","ffffcca1dab441b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c42c7fb8253494","ffffccc7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea80c2c84","ffffd9edf8b1c7e9b47fcdbb41b6c41d91c0225ea8253494081d58").map(ue);const jF=Te(Jx);var eT=new Array(3).concat("f7fcb9addd8e31a354","ffffccc2e69978c679238443","ffffccc2e69978c67931a354006837","ffffccd9f0a3addd8e78c67931a354006837","ffffccd9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443005a32","ffffe5f7fcb9d9f0a3addd8e78c67941ab5d238443006837004529").map(ue);const zF=Te(eT);var tT=new Array(3).concat("fff7bcfec44fd95f0e","ffffd4fed98efe9929cc4c02","ffffd4fed98efe9929d95f0e993404","ffffd4fee391fec44ffe9929d95f0e993404","ffffd4fee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c028c2d04","ffffe5fff7bcfee391fec44ffe9929ec7014cc4c02993404662506").map(ue);const BF=Te(tT);var nT=new Array(3).concat("ffeda0feb24cf03b20","ffffb2fecc5cfd8d3ce31a1c","ffffb2fecc5cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cf03b20bd0026","ffffb2fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cb10026","ffffccffeda0fed976feb24cfd8d3cfc4e2ae31a1cbd0026800026").map(ue);const WF=Te(nT);var rT=new Array(3).concat("deebf79ecae13182bd","eff3ffbdd7e76baed62171b5","eff3ffbdd7e76baed63182bd08519c","eff3ffc6dbef9ecae16baed63182bd08519c","eff3ffc6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b5084594","f7fbffdeebf7c6dbef9ecae16baed64292c62171b508519c08306b").map(ue);const UF=Te(rT);var iT=new Array(3).concat("e5f5e0a1d99b31a354","edf8e9bae4b374c476238b45","edf8e9bae4b374c47631a354006d2c","edf8e9c7e9c0a1d99b74c47631a354006d2c","edf8e9c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45005a32","f7fcf5e5f5e0c7e9c0a1d99b74c47641ab5d238b45006d2c00441b").map(ue);const GF=Te(iT);var sT=new Array(3).concat("f0f0f0bdbdbd636363","f7f7f7cccccc969696525252","f7f7f7cccccc969696636363252525","f7f7f7d9d9d9bdbdbd969696636363252525","f7f7f7d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525","fffffff0f0f0d9d9d9bdbdbd969696737373525252252525000000").map(ue);const HF=Te(sT);var oT=new Array(3).concat("efedf5bcbddc756bb1","f2f0f7cbc9e29e9ac86a51a3","f2f0f7cbc9e29e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8756bb154278f","f2f0f7dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a34a1486","fcfbfdefedf5dadaebbcbddc9e9ac8807dba6a51a354278f3f007d").map(ue);const YF=Te(oT);var aT=new Array(3).concat("fee0d2fc9272de2d26","fee5d9fcae91fb6a4acb181d","fee5d9fcae91fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4ade2d26a50f15","fee5d9fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181d99000d","fff5f0fee0d2fcbba1fc9272fb6a4aef3b2ccb181da50f1567000d").map(ue);const XF=Te(aT);var cT=new Array(3).concat("fee6cefdae6be6550d","feeddefdbe85fd8d3cd94701","feeddefdbe85fd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3ce6550da63603","feeddefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d948018c2d04","fff5ebfee6cefdd0a2fdae6bfd8d3cf16913d94801a636037f2704").map(ue);const ZF=Te(cT);function KF(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(-4.54-t*(35.34-t*(2381.73-t*(6402.7-t*(7024.72-t*2710.57)))))))+", "+Math.max(0,Math.min(255,Math.round(32.49+t*(170.73+t*(52.82-t*(131.46-t*(176.58-t*67.37)))))))+", "+Math.max(0,Math.min(255,Math.round(81.24+t*(442.36-t*(2482.43-t*(6167.24-t*(6614.94-t*2475.67)))))))+")"}const QF=Zc(rn(300,.5,0),rn(-240,.5,1));var JF=Zc(rn(-100,.75,.35),rn(80,1.5,.8)),e$=Zc(rn(260,.75,.35),rn(80,1.5,.8)),fa=rn();function t$(t){(t<0||t>1)&&(t-=Math.floor(t));var e=Math.abs(t-.5);return fa.h=360*t-100,fa.s=1.5-1.5*e,fa.l=.8-.9*e,fa+""}var da=Di(),n$=Math.PI/3,r$=Math.PI*2/3;function i$(t){var e;return t=(.5-t)*Math.PI,da.r=255*(e=Math.sin(t))*e,da.g=255*(e=Math.sin(t+n$))*e,da.b=255*(e=Math.sin(t+r$))*e,da+""}function s$(t){return t=Math.max(0,Math.min(1,t)),"rgb("+Math.max(0,Math.min(255,Math.round(34.61+t*(1172.33-t*(10793.56-t*(33300.12-t*(38394.49-t*14825.05)))))))+", "+Math.max(0,Math.min(255,Math.round(23.31+t*(557.33+t*(1225.33-t*(3574.96-t*(1073.77+t*707.56)))))))+", "+Math.max(0,Math.min(255,Math.round(27.2+t*(3211.1-t*(15327.97-t*(27814-t*(22569.18-t*6838.66)))))))+")"}function Bu(t){var e=t.length;return function(n){return t[Math.max(0,Math.min(e-1,Math.floor(n*e)))]}}const o$=Bu(ue("44015444025645045745055946075a46085c460a5d460b5e470d60470e6147106347116447136548146748166848176948186a481a6c481b6d481c6e481d6f481f70482071482173482374482475482576482677482878482979472a7a472c7a472d7b472e7c472f7d46307e46327e46337f463480453581453781453882443983443a83443b84433d84433e85423f854240864241864142874144874045884046883f47883f48893e49893e4a893e4c8a3d4d8a3d4e8a3c4f8a3c508b3b518b3b528b3a538b3a548c39558c39568c38588c38598c375a8c375b8d365c8d365d8d355e8d355f8d34608d34618d33628d33638d32648e32658e31668e31678e31688e30698e306a8e2f6b8e2f6c8e2e6d8e2e6e8e2e6f8e2d708e2d718e2c718e2c728e2c738e2b748e2b758e2a768e2a778e2a788e29798e297a8e297b8e287c8e287d8e277e8e277f8e27808e26818e26828e26828e25838e25848e25858e24868e24878e23888e23898e238a8d228b8d228c8d228d8d218e8d218f8d21908d21918c20928c20928c20938c1f948c1f958b1f968b1f978b1f988b1f998a1f9a8a1e9b8a1e9c891e9d891f9e891f9f881fa0881fa1881fa1871fa28720a38620a48621a58521a68522a78522a88423a98324aa8325ab8225ac8226ad8127ad8128ae8029af7f2ab07f2cb17e2db27d2eb37c2fb47c31b57b32b67a34b67935b77937b87838b9773aba763bbb753dbc743fbc7340bd7242be7144bf7046c06f48c16e4ac16d4cc26c4ec36b50c46a52c56954c56856c66758c7655ac8645cc8635ec96260ca6063cb5f65cb5e67cc5c69cd5b6ccd5a6ece5870cf5773d05675d05477d1537ad1517cd2507fd34e81d34d84d44b86d54989d5488bd6468ed64590d74393d74195d84098d83e9bd93c9dd93ba0da39a2da37a5db36a8db34aadc32addc30b0dd2fb2dd2db5de2bb8de29bade28bddf26c0df25c2df23c5e021c8e020cae11fcde11dd0e11cd2e21bd5e21ad8e219dae319dde318dfe318e2e418e5e419e7e419eae51aece51befe51cf1e51df4e61ef6e620f8e621fbe723fde725"));var a$=Bu(ue("00000401000501010601010802010902020b02020d03030f03031204041405041606051806051a07061c08071e0907200a08220b09240c09260d0a290e0b2b100b2d110c2f120d31130d34140e36150e38160f3b180f3d19103f1a10421c10441d11471e114920114b21114e22115024125325125527125829115a2a115c2c115f2d11612f116331116533106734106936106b38106c390f6e3b0f703d0f713f0f72400f74420f75440f764510774710784910784a10794c117a4e117b4f127b51127c52137c54137d56147d57157e59157e5a167e5c167f5d177f5f187f601880621980641a80651a80671b80681c816a1c816b1d816d1d816e1e81701f81721f817320817521817621817822817922827b23827c23827e24828025828125818326818426818627818827818928818b29818c29818e2a81902a81912b81932b80942c80962c80982d80992d809b2e7f9c2e7f9e2f7fa02f7fa1307ea3307ea5317ea6317da8327daa337dab337cad347cae347bb0357bb2357bb3367ab5367ab73779b83779ba3878bc3978bd3977bf3a77c03a76c23b75c43c75c53c74c73d73c83e73ca3e72cc3f71cd4071cf4070d0416fd2426fd3436ed5446dd6456cd8456cd9466bdb476adc4869de4968df4a68e04c67e24d66e34e65e44f64e55064e75263e85362e95462ea5661eb5760ec5860ed5a5fee5b5eef5d5ef05f5ef1605df2625df2645cf3655cf4675cf4695cf56b5cf66c5cf66e5cf7705cf7725cf8745cf8765cf9785df9795df97b5dfa7d5efa7f5efa815ffb835ffb8560fb8761fc8961fc8a62fc8c63fc8e64fc9065fd9266fd9467fd9668fd9869fd9a6afd9b6bfe9d6cfe9f6dfea16efea36ffea571fea772fea973feaa74feac76feae77feb078feb27afeb47bfeb67cfeb77efeb97ffebb81febd82febf84fec185fec287fec488fec68afec88cfeca8dfecc8ffecd90fecf92fed194fed395fed597fed799fed89afdda9cfddc9efddea0fde0a1fde2a3fde3a5fde5a7fde7a9fde9aafdebacfcecaefceeb0fcf0b2fcf2b4fcf4b6fcf6b8fcf7b9fcf9bbfcfbbdfcfdbf")),c$=Bu(ue("00000401000501010601010802010a02020c02020e03021004031204031405041706041907051b08051d09061f0a07220b07240c08260d08290e092b10092d110a30120a32140b34150b37160b39180c3c190c3e1b0c411c0c431e0c451f0c48210c4a230c4c240c4f260c51280b53290b552b0b572d0b592f0a5b310a5c320a5e340a5f3609613809623909633b09643d09653e0966400a67420a68440a68450a69470b6a490b6a4a0c6b4c0c6b4d0d6c4f0d6c510e6c520e6d540f6d550f6d57106e59106e5a116e5c126e5d126e5f136e61136e62146e64156e65156e67166e69166e6a176e6c186e6d186e6f196e71196e721a6e741a6e751b6e771c6d781c6d7a1d6d7c1d6d7d1e6d7f1e6c801f6c82206c84206b85216b87216b88226a8a226a8c23698d23698f24699025689225689326679526679727669827669a28659b29649d29649f2a63a02a63a22b62a32c61a52c60a62d60a82e5fa92e5eab2f5ead305dae305cb0315bb1325ab3325ab43359b63458b73557b93556ba3655bc3754bd3853bf3952c03a51c13a50c33b4fc43c4ec63d4dc73e4cc83f4bca404acb4149cc4248ce4347cf4446d04545d24644d34743d44842d54a41d74b3fd84c3ed94d3dda4e3cdb503bdd513ade5238df5337e05536e15635e25734e35933e45a31e55c30e65d2fe75e2ee8602de9612bea632aeb6429eb6628ec6726ed6925ee6a24ef6c23ef6e21f06f20f1711ff1731df2741cf3761bf37819f47918f57b17f57d15f67e14f68013f78212f78410f8850ff8870ef8890cf98b0bf98c0af98e09fa9008fa9207fa9407fb9606fb9706fb9906fb9b06fb9d07fc9f07fca108fca309fca50afca60cfca80dfcaa0ffcac11fcae12fcb014fcb216fcb418fbb61afbb81dfbba1ffbbc21fbbe23fac026fac228fac42afac62df9c72ff9c932f9cb35f8cd37f8cf3af7d13df7d340f6d543f6d746f5d949f5db4cf4dd4ff4df53f4e156f3e35af3e55df2e661f2e865f2ea69f1ec6df1ed71f1ef75f1f179f2f27df2f482f3f586f3f68af4f88ef5f992f6fa96f8fb9af9fc9dfafda1fcffa4")),u$=Bu(ue("0d088710078813078916078a19068c1b068d1d068e20068f2206902406912605912805922a05932c05942e05952f059631059733059735049837049938049a3a049a3c049b3e049c3f049c41049d43039e44039e46039f48039f4903a04b03a14c02a14e02a25002a25102a35302a35502a45601a45801a45901a55b01a55c01a65e01a66001a66100a76300a76400a76600a76700a86900a86a00a86c00a86e00a86f00a87100a87201a87401a87501a87701a87801a87a02a87b02a87d03a87e03a88004a88104a78305a78405a78606a68707a68808a68a09a58b0aa58d0ba58e0ca48f0da4910ea3920fa39410a29511a19613a19814a099159f9a169f9c179e9d189d9e199da01a9ca11b9ba21d9aa31e9aa51f99a62098a72197a82296aa2395ab2494ac2694ad2793ae2892b02991b12a90b22b8fb32c8eb42e8db52f8cb6308bb7318ab83289ba3388bb3488bc3587bd3786be3885bf3984c03a83c13b82c23c81c33d80c43e7fc5407ec6417dc7427cc8437bc9447aca457acb4679cc4778cc4977cd4a76ce4b75cf4c74d04d73d14e72d24f71d35171d45270d5536fd5546ed6556dd7566cd8576bd9586ada5a6ada5b69db5c68dc5d67dd5e66de5f65de6164df6263e06363e16462e26561e26660e3685fe4695ee56a5de56b5de66c5ce76e5be76f5ae87059e97158e97257ea7457eb7556eb7655ec7754ed7953ed7a52ee7b51ef7c51ef7e50f07f4ff0804ef1814df1834cf2844bf3854bf3874af48849f48948f58b47f58c46f68d45f68f44f79044f79143f79342f89441f89540f9973ff9983ef99a3efa9b3dfa9c3cfa9e3bfb9f3afba139fba238fca338fca537fca636fca835fca934fdab33fdac33fdae32fdaf31fdb130fdb22ffdb42ffdb52efeb72dfeb82cfeba2cfebb2bfebd2afebe2afec029fdc229fdc328fdc527fdc627fdc827fdca26fdcb26fccd25fcce25fcd025fcd225fbd324fbd524fbd724fad824fada24f9dc24f9dd25f8df25f8e125f7e225f7e425f6e626f6e826f5e926f5eb27f4ed27f3ee27f3f027f2f227f1f426f1f525f0f724f0f921"));const pa=t=>()=>t;function l$(t,{sourceEvent:e,target:n,transform:r,dispatch:i}){Object.defineProperties(this,{type:{value:t,enumerable:!0,configurable:!0},sourceEvent:{value:e,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:i}})}function pn(t,e,n){this.k=t,this.x=e,this.y=n}pn.prototype={constructor:pn,scale:function(t){return t===1?this:new pn(this.k*t,this.x,this.y)},translate:function(t,e){return t===0&e===0?this:new pn(this.k,this.x+this.k*t,this.y+this.k*e)},apply:function(t){return[t[0]*this.k+this.x,t[1]*this.k+this.y]},applyX:function(t){return t*this.k+this.x},applyY:function(t){return t*this.k+this.y},invert:function(t){return[(t[0]-this.x)/this.k,(t[1]-this.y)/this.k]},invertX:function(t){return(t-this.x)/this.k},invertY:function(t){return(t-this.y)/this.k},rescaleX:function(t){return t.copy().domain(t.range().map(this.invertX,this).map(t.invert,t))},rescaleY:function(t){return t.copy().domain(t.range().map(this.invertY,this).map(t.invert,t))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};var Wu=new pn(1,0,0);uT.prototype=pn.prototype;function uT(t){for(;!t.__zoom;)if(!(t=t.parentNode))return Wu;return t.__zoom}function pf(t){t.stopImmediatePropagation()}function bs(t){t.preventDefault(),t.stopImmediatePropagation()}function h$(t){return(!t.ctrlKey||t.type==="wheel")&&!t.button}function f$(){var t=this;return t instanceof SVGElement?(t=t.ownerSVGElement||t,t.hasAttribute("viewBox")?(t=t.viewBox.baseVal,[[t.x,t.y],[t.x+t.width,t.y+t.height]]):[[0,0],[t.width.baseVal.value,t.height.baseVal.value]]):[[0,0],[t.clientWidth,t.clientHeight]]}function cy(){return this.__zoom||Wu}function d$(t){return-t.deltaY*(t.deltaMode===1?.05:t.deltaMode?1:.002)*(t.ctrlKey?10:1)}function p$(){return navigator.maxTouchPoints||"ontouchstart"in this}function m$(t,e,n){var r=t.invertX(e[0][0])-n[0][0],i=t.invertX(e[1][0])-n[1][0],s=t.invertY(e[0][1])-n[0][1],o=t.invertY(e[1][1])-n[1][1];return t.translate(i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i),o>s?(s+o)/2:Math.min(0,s)||Math.max(0,o))}function g$(){var t=h$,e=f$,n=m$,r=d$,i=p$,s=[0,1/0],o=[[-1/0,-1/0],[1/0,1/0]],a=250,c=ib,u=ti("start","zoom","end"),l,h,f,d=500,p=150,g=0,m=10;function _(M){M.property("__zoom",cy).on("wheel.zoom",S,{passive:!1}).on("mousedown.zoom",A).on("dblclick.zoom",N).filter(i).on("touchstart.zoom",T).on("touchmove.zoom",k).on("touchend.zoom touchcancel.zoom",I).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}_.transform=function(M,E,R,O){var q=M.selection?M.selection():M;q.property("__zoom",cy),M!==q?w(M,E,R,O):q.interrupt().each(function(){x(this,arguments).event(O).start().zoom(null,typeof E=="function"?E.apply(this,arguments):E).end()})},_.scaleBy=function(M,E,R,O){_.scaleTo(M,function(){var q=this.__zoom.k,D=typeof E=="function"?E.apply(this,arguments):E;return q*D},R,O)},_.scaleTo=function(M,E,R,O){_.transform(M,function(){var q=e.apply(this,arguments),D=this.__zoom,$=R==null?y(q):typeof R=="function"?R.apply(this,arguments):R,F=D.invert($),L=typeof E=="function"?E.apply(this,arguments):E;return n(v(b(D,L),$,F),q,o)},R,O)},_.translateBy=function(M,E,R,O){_.transform(M,function(){return n(this.__zoom.translate(typeof E=="function"?E.apply(this,arguments):E,typeof R=="function"?R.apply(this,arguments):R),e.apply(this,arguments),o)},null,O)},_.translateTo=function(M,E,R,O,q){_.transform(M,function(){var D=e.apply(this,arguments),$=this.__zoom,F=O==null?y(D):typeof O=="function"?O.apply(this,arguments):O;return n(Wu.translate(F[0],F[1]).scale($.k).translate(typeof E=="function"?-E.apply(this,arguments):-E,typeof R=="function"?-R.apply(this,arguments):-R),D,o)},O,q)};function b(M,E){return E=Math.max(s[0],Math.min(s[1],E)),E===M.k?M:new pn(E,M.x,M.y)}function v(M,E,R){var O=E[0]-R[0]*M.k,q=E[1]-R[1]*M.k;return O===M.x&&q===M.y?M:new pn(M.k,O,q)}function y(M){return[(+M[0][0]+ +M[1][0])/2,(+M[0][1]+ +M[1][1])/2]}function w(M,E,R,O){M.on("start.zoom",function(){x(this,arguments).event(O).start()}).on("interrupt.zoom end.zoom",function(){x(this,arguments).event(O).end()}).tween("zoom",function(){var q=this,D=arguments,$=x(q,D).event(O),F=e.apply(q,D),L=R==null?y(F):typeof R=="function"?R.apply(q,D):R,te=Math.max(F[1][0]-F[0][0],F[1][1]-F[0][1]),Z=q.__zoom,W=typeof E=="function"?E.apply(q,D):E,ne=c(Z.invert(L).concat(te/Z.k),W.invert(L).concat(te/W.k));return function(J){if(J===1)J=W;else{var B=ne(J),z=te/B[2];J=new pn(z,L[0]-B[0]*z,L[1]-B[1]*z)}$.zoom(null,J)}})}function x(M,E,R){return!R&&M.__zooming||new C(M,E)}function C(M,E){this.that=M,this.args=E,this.active=0,this.sourceEvent=null,this.extent=e.apply(M,E),this.taps=0}C.prototype={event:function(M){return M&&(this.sourceEvent=M),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(M,E){return this.mouse&&M!=="mouse"&&(this.mouse[1]=E.invert(this.mouse[0])),this.touch0&&M!=="touch"&&(this.touch0[1]=E.invert(this.touch0[0])),this.touch1&&M!=="touch"&&(this.touch1[1]=E.invert(this.touch1[0])),this.that.__zoom=E,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(M){var E=ot(this.that).datum();u.call(M,this.that,new l$(M,{sourceEvent:this.sourceEvent,target:_,transform:this.that.__zoom,dispatch:u}),E)}};function S(M,...E){if(!t.apply(this,arguments))return;var R=x(this,E).event(M),O=this.__zoom,q=Math.max(s[0],Math.min(s[1],O.k*Math.pow(2,r.apply(this,arguments)))),D=Dt(M);if(R.wheel)(R.mouse[0][0]!==D[0]||R.mouse[0][1]!==D[1])&&(R.mouse[1]=O.invert(R.mouse[0]=D)),clearTimeout(R.wheel);else{if(O.k===q)return;R.mouse=[D,O.invert(D)],Pr(this),R.start()}bs(M),R.wheel=setTimeout($,p),R.zoom("mouse",n(v(b(O,q),R.mouse[0],R.mouse[1]),R.extent,o));function $(){R.wheel=null,R.end()}}function A(M,...E){if(f||!t.apply(this,arguments))return;var R=M.currentTarget,O=x(this,E,!0).event(M),q=ot(M.view).on("mousemove.zoom",L,!0).on("mouseup.zoom",te,!0),D=Dt(M,R),$=M.clientX,F=M.clientY;Iu(M.view),pf(M),O.mouse=[D,this.__zoom.invert(D)],Pr(this),O.start();function L(Z){if(bs(Z),!O.moved){var W=Z.clientX-$,ne=Z.clientY-F;O.moved=W*W+ne*ne>g}O.event(Z).zoom("mouse",n(v(O.that.__zoom,O.mouse[0]=Dt(Z,R),O.mouse[1]),O.extent,o))}function te(Z){q.on("mousemove.zoom mouseup.zoom",null),Ou(Z.view,O.moved),bs(Z),O.event(Z).end()}}function N(M,...E){if(t.apply(this,arguments)){var R=this.__zoom,O=Dt(M.changedTouches?M.changedTouches[0]:M,this),q=R.invert(O),D=R.k*(M.shiftKey?.5:2),$=n(v(b(R,D),O,q),e.apply(this,E),o);bs(M),a>0?ot(this).transition().duration(a).call(w,$,O,M):ot(this).call(_.transform,$,O,M)}}function T(M,...E){if(t.apply(this,arguments)){var R=M.touches,O=R.length,q=x(this,E,M.changedTouches.length===O).event(M),D,$,F,L;for(pf(M),$=0;$<O;++$)F=R[$],L=Dt(F,this),L=[L,this.__zoom.invert(L),F.identifier],q.touch0?!q.touch1&&q.touch0[2]!==L[2]&&(q.touch1=L,q.taps=0):(q.touch0=L,D=!0,q.taps=1+!!l);l&&(l=clearTimeout(l)),D&&(q.taps<2&&(h=L[0],l=setTimeout(function(){l=null},d)),Pr(this),q.start())}}function k(M,...E){if(this.__zooming){var R=x(this,E).event(M),O=M.changedTouches,q=O.length,D,$,F,L;for(bs(M),D=0;D<q;++D)$=O[D],F=Dt($,this),R.touch0&&R.touch0[2]===$.identifier?R.touch0[0]=F:R.touch1&&R.touch1[2]===$.identifier&&(R.touch1[0]=F);if($=R.that.__zoom,R.touch1){var te=R.touch0[0],Z=R.touch0[1],W=R.touch1[0],ne=R.touch1[1],J=(J=W[0]-te[0])*J+(J=W[1]-te[1])*J,B=(B=ne[0]-Z[0])*B+(B=ne[1]-Z[1])*B;$=b($,Math.sqrt(J/B)),F=[(te[0]+W[0])/2,(te[1]+W[1])/2],L=[(Z[0]+ne[0])/2,(Z[1]+ne[1])/2]}else if(R.touch0)F=R.touch0[0],L=R.touch0[1];else return;R.zoom("touch",n(v($,F,L),R.extent,o))}}function I(M,...E){if(this.__zooming){var R=x(this,E).event(M),O=M.changedTouches,q=O.length,D,$;for(pf(M),f&&clearTimeout(f),f=setTimeout(function(){f=null},d),D=0;D<q;++D)$=O[D],R.touch0&&R.touch0[2]===$.identifier?delete R.touch0:R.touch1&&R.touch1[2]===$.identifier&&delete R.touch1;if(R.touch1&&!R.touch0&&(R.touch0=R.touch1,delete R.touch1),R.touch0)R.touch0[1]=this.__zoom.invert(R.touch0[0]);else if(R.end(),R.taps===2&&($=Dt($,this),Math.hypot(h[0]-$[0],h[1]-$[1])<m)){var F=ot(this).on("dblclick.zoom");F&&F.apply(this,arguments)}}}return _.wheelDelta=function(M){return arguments.length?(r=typeof M=="function"?M:pa(+M),_):r},_.filter=function(M){return arguments.length?(t=typeof M=="function"?M:pa(!!M),_):t},_.touchable=function(M){return arguments.length?(i=typeof M=="function"?M:pa(!!M),_):i},_.extent=function(M){return arguments.length?(e=typeof M=="function"?M:pa([[+M[0][0],+M[0][1]],[+M[1][0],+M[1][1]]]),_):e},_.scaleExtent=function(M){return arguments.length?(s[0]=+M[0],s[1]=+M[1],_):[s[0],s[1]]},_.translateExtent=function(M){return arguments.length?(o[0][0]=+M[0][0],o[1][0]=+M[1][0],o[0][1]=+M[0][1],o[1][1]=+M[1][1],_):[[o[0][0],o[0][1]],[o[1][0],o[1][1]]]},_.constrain=function(M){return arguments.length?(n=M,_):n},_.duration=function(M){return arguments.length?(a=+M,_):a},_.interpolate=function(M){return arguments.length?(c=M,_):c},_.on=function(){var M=u.on.apply(u,arguments);return M===u?_:M},_.clickDistance=function(M){return arguments.length?(g=(M=+M)*M,_):Math.sqrt(g)},_.tapDistance=function(M){return arguments.length?(m=+M,_):m},_}const _$=Object.freeze(Object.defineProperty({__proto__:null,Adder:We,Delaunay:u0,FormatSpecifier:Qc,InternMap:Gs,InternSet:qr,Node:Xr,Path:po,Voronoi:Rw,ZoomTransform:pn,active:gI,arc:sS,area:My,areaRadial:Em,ascending:Oe,autoType:FO,axisBottom:L7,axisLeft:j7,axisRight:V7,axisTop:$7,bin:Eg,bisect:cr,bisectCenter:HC,bisectLeft:GC,bisectRight:cr,bisector:Bc,blob:LO,blur:YC,blur2:lv,blurImage:XC,brush:kI,brushSelection:MI,brushX:AI,brushY:NI,buffer:zO,chord:RI,chordDirected:OI,chordTranspose:II,cluster:JP,color:ur,contourDensity:nO,contours:Qf,count:Wc,create:xR,creator:Eu,cross:nM,csv:UO,csvFormat:MO,csvFormatBody:AO,csvFormatRow:kO,csvFormatRows:NO,csvFormatValue:EO,csvParse:Ow,csvParseRows:CO,cubehelix:rn,cumsum:rM,curveBasis:MS,curveBasisClosed:AS,curveBasisOpen:NS,curveBumpX:Ey,curveBumpY:Ry,curveBundle:kS,curveCardinal:ES,curveCardinalClosed:RS,curveCardinalOpen:IS,curveCatmullRom:OS,curveCatmullRomClosed:DS,curveCatmullRomOpen:PS,curveLinear:$c,curveLinearClosed:qS,curveMonotoneX:FS,curveMonotoneY:$S,curveNatural:VS,curveStep:LS,curveStepAfter:zS,curveStepBefore:jS,descending:cv,deviation:dv,difference:VM,disjoint:LM,dispatch:ti,drag:RR,dragDisable:Iu,dragEnable:Ou,dsv:WO,dsvFormat:Fu,easeBack:e_,easeBackIn:cI,easeBackInOut:e_,easeBackOut:uI,easeBounce:oo,easeBounceIn:oI,easeBounceInOut:aI,easeBounceOut:oo,easeCircle:J1,easeCircleIn:Z9,easeCircleInOut:J1,easeCircleOut:K9,easeCubic:Xf,easeCubicIn:z9,easeCubicInOut:Xf,easeCubicOut:B9,easeElastic:t_,easeElasticIn:lI,easeElasticInOut:hI,easeElasticOut:t_,easeExp:Q1,easeExpIn:Y9,easeExpInOut:Q1,easeExpOut:X9,easeLinear:V9,easePoly:Z1,easePolyIn:W9,easePolyInOut:Z1,easePolyOut:U9,easeQuad:X1,easeQuadIn:L9,easeQuadInOut:X1,easeQuadOut:j9,easeSin:K1,easeSinIn:G9,easeSinInOut:K1,easeSinOut:H9,every:OM,extent:Fs,fcumsum:sM,filter:PM,flatGroup:oM,flatRollup:aM,forceCenter:JO,forceCollide:yD,forceLink:bD,forceManyBody:kD,forceRadial:ED,forceSimulation:ND,forceX:RD,forceY:ID,get format(){return Jc},formatDefaultLocale:hb,formatLocale:lb,get formatPrefix(){return tp},formatSpecifier:qi,fsum:iM,geoAlbers:_x,geoAlbersUsa:RP,geoArea:qD,geoAzimuthalEqualArea:IP,geoAzimuthalEqualAreaRaw:w0,geoAzimuthalEquidistant:OP,geoAzimuthalEquidistantRaw:x0,geoBounds:LD,geoCentroid:GD,geoCircle:HD,geoClipAntimeridian:hd,geoClipCircle:tx,geoClipExtent:eP,geoClipRectangle:Lu,geoConicConformal:PP,geoConicConformalRaw:bx,geoConicEqualArea:kc,geoConicEqualAreaRaw:gx,geoConicEquidistant:FP,geoConicEquidistantRaw:wx,geoContains:aP,geoDistance:wc,geoEqualEarth:VP,geoEqualEarthRaw:T0,geoEquirectangular:qP,geoEquirectangularRaw:fo,geoGnomonic:LP,geoGnomonicRaw:S0,geoGraticule:ix,geoGraticule10:cP,geoIdentity:jP,geoInterpolate:uP,geoLength:nx,geoMercator:DP,geoMercatorRaw:Fo,geoNaturalEarth1:zP,geoNaturalEarth1Raw:C0,geoOrthographic:BP,geoOrthographicRaw:M0,geoPath:wP,geoProjection:Cn,geoProjectionMutator:v0,geoRotation:Xw,geoStereographic:WP,geoStereographicRaw:A0,geoStream:Jt,geoTransform:xP,geoTransverseMercator:UP,geoTransverseMercatorRaw:N0,gray:rA,greatest:Sv,greatestIndex:AM,group:_v,groupSort:lM,groups:yv,hcl:za,hierarchy:k0,histogram:Eg,hsl:Va,html:KO,image:HO,index:cM,indexes:uM,interpolate:gr,interpolateArray:uA,interpolateBasis:Uv,interpolateBasisClosed:Gv,interpolateBlues:UF,interpolateBrBG:SF,interpolateBuGn:OF,interpolateBuPu:DF,interpolateCividis:KF,interpolateCool:e$,interpolateCubehelix:SA,interpolateCubehelixDefault:QF,interpolateCubehelixLong:Zc,interpolateDate:Qv,interpolateDiscrete:fA,interpolateGnBu:PF,interpolateGreens:GF,interpolateGreys:HF,interpolateHcl:xA,interpolateHclLong:TA,interpolateHsl:vA,interpolateHslLong:bA,interpolateHue:dA,interpolateInferno:c$,interpolateLab:wA,interpolateMagma:a$,interpolateNumber:zt,interpolateNumberArray:Qd,interpolateObject:Jv,interpolateOrRd:qF,interpolateOranges:ZF,interpolatePRGn:CF,interpolatePiYG:MF,interpolatePlasma:u$,interpolatePuBu:$F,interpolatePuBuGn:FF,interpolatePuOr:AF,interpolatePuRd:VF,interpolatePurples:YF,interpolateRainbow:t$,interpolateRdBu:NF,interpolateRdGy:kF,interpolateRdPu:LF,interpolateRdYlBu:EF,interpolateRdYlGn:RF,interpolateReds:XF,interpolateRgb:Ks,interpolateRgbBasis:Xv,interpolateRgbBasisClosed:cA,interpolateRound:Xc,interpolateSinebow:i$,interpolateSpectral:IF,interpolateString:Jd,interpolateTransformCss:nb,interpolateTransformSvg:rb,interpolateTurbo:s$,interpolateViridis:o$,interpolateWarm:JF,interpolateYlGn:zF,interpolateYlGnBu:jF,interpolateYlOrBr:BF,interpolateYlOrRd:WF,interpolateZoom:ib,interrupt:Pr,intersection:jM,interval:PR,isoFormat:p3,isoParse:g3,json:XO,lab:ja,lch:iA,least:MM,leastIndex:Av,line:Dd,lineRadial:km,link:Vc,linkHorizontal:pS,linkRadial:gS,linkVertical:mS,local:gw,map:qM,matcher:Kp,max:Hs,maxIndex:Wd,mean:yM,median:vM,medianIndex:bM,merge:Gd,min:Fa,minIndex:Ud,mode:xM,namespace:Ro,namespaces:jf,nice:zd,now:Io,pack:kq,packEnclose:Tq,packSiblings:Aq,pairs:TM,partition:Eq,path:Rd,pathRound:QT,permute:Tv,pie:uS,piecewise:cb,pointRadial:Ts,pointer:Dt,pointers:SR,polygonArea:Gq,polygonCentroid:Hq,polygonContains:Kq,polygonHull:Zq,polygonLength:Qq,precisionFixed:fb,precisionPrefix:db,precisionRound:pb,quadtree:Vu,quantile:Ys,quantileIndex:Mv,quantileSorted:Cv,quantize:CA,quickselect:Uc,radialArea:Em,radialLine:km,randomBates:nF,randomBernoulli:sF,randomBeta:Dx,randomBinomial:Px,randomCauchy:aF,randomExponential:rF,randomGamma:I0,randomGeometric:Ox,randomInt:eF,randomIrwinHall:Ix,randomLcg:fF,randomLogNormal:tF,randomLogistic:cF,randomNormal:R0,randomPareto:iF,randomPoisson:uF,randomUniform:Jq,randomWeibull:oF,range:nr,rank:CM,reduce:FM,reverse:$M,rgb:Di,ribbon:jI,ribbonArrow:zI,rollup:bv,rollups:wv,scaleBand:Yd,scaleDiverging:Zb,scaleDivergingLog:Kb,scaleDivergingPow:fp,scaleDivergingSqrt:x3,scaleDivergingSymlog:Qb,scaleIdentity:_b,scaleImplicit:Tf,scaleLinear:gb,scaleLog:vb,scaleOrdinal:Hd,scalePoint:UM,scalePow:sp,scaleQuantile:xb,scaleQuantize:Tb,scaleRadial:wb,scaleSequential:Gb,scaleSequentialLog:Hb,scaleSequentialPow:hp,scaleSequentialQuantile:Xb,scaleSequentialSqrt:w3,scaleSequentialSymlog:Yb,scaleSqrt:BA,scaleSymlog:bb,scaleThreshold:Sb,scaleTime:v3,scaleUtc:b3,scan:NM,schemeAccent:pF,schemeBlues:rT,schemeBrBG:qx,schemeBuGn:Ux,schemeBuPu:Gx,schemeCategory10:dF,schemeDark2:mF,schemeGnBu:Hx,schemeGreens:iT,schemeGreys:sT,schemeObservable10:gF,schemeOrRd:Yx,schemeOranges:cT,schemePRGn:Fx,schemePaired:_F,schemePastel1:yF,schemePastel2:vF,schemePiYG:$x,schemePuBu:Zx,schemePuBuGn:Xx,schemePuOr:Vx,schemePuRd:Kx,schemePurples:oT,schemeRdBu:Lx,schemeRdGy:jx,schemeRdPu:Qx,schemeRdYlBu:zx,schemeRdYlGn:Bx,schemeReds:aT,schemeSet1:bF,schemeSet2:wF,schemeSet3:xF,schemeSpectral:Wx,schemeTableau10:TF,schemeYlGn:eT,schemeYlGnBu:Jx,schemeYlOrBr:tT,schemeYlOrRd:nT,select:ot,selectAll:CR,selection:ni,selector:Ru,selectorAll:Zp,shuffle:kM,shuffler:Nv,some:DM,sort:xf,stack:US,stackOffsetDiverging:HS,stackOffsetExpand:GS,stackOffsetNone:ki,stackOffsetSilhouette:YS,stackOffsetWiggle:XS,stackOrderAppearance:tv,stackOrderAscending:nv,stackOrderDescending:KS,stackOrderInsideOut:QS,stackOrderNone:Ei,stackOrderReverse:JS,stratify:Dq,style:Ur,subset:BM,sum:EM,superset:Ev,svg:QO,symbol:CS,symbolAsterisk:Iy,symbolCircle:Lc,symbolCross:Oy,symbolDiamond:Py,symbolDiamond2:qy,symbolPlus:Fy,symbolSquare:$y,symbolSquare2:Vy,symbolStar:jy,symbolTimes:bf,symbolTriangle:zy,symbolTriangle2:By,symbolWye:Wy,symbolX:bf,symbols:Rm,symbolsFill:Rm,symbolsStroke:SS,text:$u,thresholdFreedmanDiaconis:gM,thresholdScott:_M,thresholdSturges:Bd,tickFormat:mb,tickIncrement:$r,tickStep:qa,ticks:Fr,timeDay:ts,timeDays:XA,get timeFormat(){return cp},timeFormatDefaultLocale:Wb,timeFormatLocale:$b,timeFriday:Ab,timeFridays:n5,timeHour:nu,timeHours:HA,timeInterval:ze,timeMillisecond:Fi,timeMilliseconds:i1,timeMinute:eu,timeMinutes:UA,timeMonday:Qs,timeMondays:QA,timeMonth:iu,timeMonths:l5,get timeParse(){return Bb},timeSaturday:Nb,timeSaturdays:r5,timeSecond:qn,timeSeconds:o1,timeSunday:$i,timeSundays:a1,timeThursday:Lr,timeThursdays:t5,timeTickInterval:Fb,timeTicks:qb,timeTuesday:Cb,timeTuesdays:JA,timeWednesday:Mb,timeWednesdays:e5,timeWeek:$i,timeWeeks:a1,timeYear:gn,timeYears:f5,timeout:Uf,timer:Pu,timerFlush:bw,transition:Sw,transpose:kv,tree:jq,treemap:zq,treemapBinary:Bq,treemapDice:$o,treemapResquarify:Uq,treemapSlice:zu,treemapSliceDice:Wq,treemapSquarify:Rx,tsv:GO,tsvFormat:IO,tsvFormatBody:OO,tsvFormatRow:PO,tsvFormatRows:DO,tsvFormatValue:qO,tsvParse:Dw,tsvParseRows:RO,union:WM,unixDay:ap,unixDays:KA,utcDay:yo,utcDays:ZA,get utcFormat(){return ou},utcFriday:Rb,utcFridays:c5,utcHour:ru,utcHours:YA,utcMillisecond:Fi,utcMilliseconds:i1,utcMinute:tu,utcMinutes:GA,utcMonday:Js,utcMondays:i5,utcMonth:su,utcMonths:h5,get utcParse(){return up},utcSaturday:Ib,utcSaturdays:u5,utcSecond:qn,utcSeconds:o1,utcSunday:Vi,utcSundays:c1,utcThursday:jr,utcThursdays:a5,utcTickInterval:Pb,utcTicks:Db,utcTuesday:kb,utcTuesdays:s5,utcWednesday:Eb,utcWednesdays:o5,utcWeek:Vi,utcWeeks:c1,utcYear:_n,utcYears:d5,variance:fv,window:Qp,xml:ZO,zip:IM,zoom:g$,zoomIdentity:Wu,zoomTransform:uT},Symbol.toStringTag,{value:"Module"})),y$=lT(_$);var ws={},uy;function v$(){if(uy)return ws;uy=1,Object.defineProperty(ws,"__esModule",{value:!0}),ws.default=void 0;var t=n(T3()),e=dy();function n(a){return a&&a.__esModule?a:{default:a}}var r=function(c,u){return(0,t.default)(c,u)},i=function(c){var u=(0,e.useRef)(null);return r(c,u.current)&&(u.current=c),u.current},s=function(c,u){(0,e.useEffect)(c,[i(u),c])},o=s;return ws.default=o,ws}var ly;function b$(){if(ly)return gs;ly=1,Object.defineProperty(gs,"__esModule",{value:!0}),gs.default=void 0;var t=o(dy()),e=y$,n=i(M3()),r=i(v$());function i(S){return S&&S.__esModule?S:{default:S}}function s(){if(typeof WeakMap!="function")return null;var S=new WeakMap;return s=function(){return S},S}function o(S){if(S&&S.__esModule)return S;if(S===null||typeof S!="object"&&typeof S!="function")return{default:S};var A=s();if(A&&A.has(S))return A.get(S);var N={},T=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var k in S)if(Object.prototype.hasOwnProperty.call(S,k)){var I=T?Object.getOwnPropertyDescriptor(S,k):null;I&&(I.get||I.set)?Object.defineProperty(N,k,I):N[k]=S[k]}return N.default=S,A&&A.set(S,N),N}var a=-Math.PI/2,c=Math.PI/2,u={width:"100%"},l=["marginInPercent","arcPadding","percent","nrOfLevels","animDelay"],h=function(A){var N=(0,t.useRef)({}),T=(0,t.useRef)({}),k=(0,t.useRef)({}),I=(0,t.useRef)({}),M=(0,t.useRef)({}),E=(0,t.useRef)({}),R=(0,t.useRef)({}),O=(0,t.useRef)({}),q=(0,t.useRef)({}),D=(0,t.useRef)(0),$=(0,t.useRef)([]),F=(0,t.useRef)((0,e.arc)()),L=(0,t.useRef)([]),te=(0,t.useRef)((0,e.pie)()),Z=(0,t.useRef)(A),W=(0,t.useRef)({}),ne=(0,t.useCallback)(function(Y){var K=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,V=arguments.length>2?arguments[2]:void 0;if(Y){p(K,V,k,O,I,R,T,M,F,E,te,N,A,q,L);return}q.current.select("svg").remove(),N.current=q.current.append("svg"),T.current=N.current.append("g"),M.current=T.current.append("g").attr("class","doughnut"),te.current.value(function(ve){return ve.value}).startAngle(a).endAngle(c).sort(null),E.current=T.current.append("g").attr("class","needle"),p(K,V,k,O,I,R,T,M,F,E,te,N,A,q,L)},[A]);(0,t.useLayoutEffect)(function(){d(A,D,$,L),q.current=(0,e.select)(W),ne()},[A,ne]),(0,r.default)(function(){(A.nrOfLevels||Z.current.arcsLength.every(function(K){return A.arcsLength.includes(K)})||Z.current.colors.every(function(K){return A.colors.includes(K)}))&&d(A,D,$,L);var Y=!l.some(function(K){return Z.current[K]!==A[K]});ne(!0,Y,Z.current),Z.current=A},[A.nrOfLevels,A.arcsLength,A.colors,A.percent,A.needleColor,A.needleBaseColor]),(0,t.useEffect)(function(){var Y=function(){var V=!0;p(V,Z,k,O,I,R,T,M,F,E,te,N,A,q,L)};return window.addEventListener("resize",Y),function(){window.removeEventListener("resize",Y)}},[A]);var J=A.id,B=A.style,z=A.className;return t.default.createElement("div",{id:J,className:z,style:B,ref:function(K){return W=K}})},f=h;gs.default=f,h.defaultProps={style:u,marginInPercent:.05,cornerRadius:6,nrOfLevels:3,percent:.4,arcPadding:.05,arcWidth:.2,colors:["#00FF00","#FF0000"],textColor:"#fff",needleColor:"#464A4F",needleBaseColor:"#464A4F",hideText:!1,animate:!0,animDelay:500,formatTextValue:null,fontSize:null,animateDuration:3e3},h.propTypes={id:n.default.string,className:n.default.string,style:n.default.object,marginInPercent:n.default.number,cornerRadius:n.default.number,nrOfLevels:n.default.number,percent:n.default.number,arcPadding:n.default.number,arcWidth:n.default.number,arcsLength:n.default.array,colors:n.default.array,textColor:n.default.string,needleColor:n.default.string,needleBaseColor:n.default.string,hideText:n.default.bool,animate:n.default.bool,formatTextValue:n.default.func,fontSize:n.default.string,animateDuration:n.default.number,animDelay:n.default.number};var d=function(A,N,T,k){N.current=A.arcsLength?A.arcsLength.length:A.nrOfLevels,N.current===A.colors.length?T.current=A.colors:T.current=g(A,N),k.current=[];for(var I=0;I<N.current;I++){var M={value:A.arcsLength&&A.arcsLength.length>I?A.arcsLength[I]:1,color:T.current[I]};k.current.push(M)}},p=function(A,N,T,k,I,M,E,R,O,q,D,$,F,L,te){C(F,L,k,T,I),$.current.attr("width",T.current+k.current.left+k.current.right).attr("height",I.current+k.current.top+k.current.bottom),E.current.attr("transform","translate("+k.current.left+", "+k.current.top+")"),w(T,I,M,k,E),R.current.attr("transform","translate("+M.current+", "+M.current+")"),O.current.outerRadius(M.current).innerRadius(M.current*(1-F.arcWidth)).cornerRadius(F.cornerRadius).padAngle(F.arcPadding),R.current.selectAll(".arc").remove(),q.current.selectAll("*").remove(),E.current.selectAll(".text-group").remove();var Z=R.current.selectAll(".arc").data(D.current(te.current)).enter().append("g").attr("class","arc");Z.append("path").attr("d",O.current).style("fill",function(W){return W.data.color}),m(A,N,F,T,q,L,M,E),q.current.attr("transform","translate("+M.current+", "+M.current+")")},g=function(A,N){for(var T=A.colors,k=(0,e.scaleLinear)().domain([1,N.current]).range([T[0],T[T.length-1]]).interpolate(e.interpolateHsl),I=[],M=1;M<=N.current;M++)I.push(k(M));return I},m=function(A,N,T,k,I,M,E,R){var O=T.percent,q=T.needleColor,D=T.needleBaseColor,$=T.hideText,F=T.animate,L=15*(k.current/500),te=[0,-L/2],Z=N?N.percent:0,W=_(Z||O,E,k);I.current.append("path").attr("d",W).attr("fill",q),I.current.append("circle").attr("cx",te[0]).attr("cy",te[1]).attr("r",L).attr("fill",D),$||v(O,T,E,k,R),!A&&F?I.current.transition().delay(T.animDelay).ease(e.easeElastic).duration(T.animateDuration).tween("progress",function(){var ne=(0,e.interpolateNumber)(Z,O);return function(J){var B=ne(J);return M.current.select(".needle path").attr("d",_(B,E,k))}}):M.current.select(".needle path").attr("d",_(O,E,k))},_=function(A,N,T){var k=N.current*.55,I=15*(T.current/500),M=b(A),E=[0,-I/2],R=[E[0]-k*Math.cos(M),E[1]-k*Math.sin(M)],O=[E[0]-I*Math.cos(M-Math.PI/2),E[1]-I*Math.sin(M-Math.PI/2)],q=[E[0]-I*Math.cos(M+Math.PI/2),E[1]-I*Math.sin(M+Math.PI/2)],D="M ".concat(O[0]," ").concat(O[1]," L ").concat(R[0]," ").concat(R[1]," L ").concat(q[0]," ").concat(q[1]);return D},b=function(A){return A*Math.PI},v=function(A,N,T,k,I){var M=N.formatTextValue,E=N.fontSize,R=20,O=M?M(y(A)):y(A)+"%";I.current.append("g").attr("class","text-group").attr("transform","translate(".concat(T.current,", ").concat(T.current/2+R,")")).append("text").text(O).style("font-size",function(){return E||"".concat(k.current/11/(O.length>10?O.length/10:1),"px")}).style("fill",N.textColor).style("text-anchor","middle")},y=function(A){var N=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return Math.round(A*100*Math.pow(10,N))/Math.pow(10,N)},w=function(A,N,T,k,I){A.current<2*N.current?T.current=(A.current-k.current.left-k.current.right)/2:T.current=N.current-k.current.top-k.current.bottom,x(A,I,T,k)},x=function(A,N,T,k){k.current.left=A.current/2-T.current+k.current.right,N.current.attr("transform","translate("+k.current.left+", "+k.current.top+")")},C=function(A,N,T,k,I){var M=A.marginInPercent,E=N.current.node().getBoundingClientRect(),R=E.width,O=E.height;T.current.left=R*M,T.current.right=R*M,k.current=R-T.current.left-T.current.right,T.current.top=O*M,T.current.bottom=O*M,I.current=k.current/2-T.current.top-T.current.bottom};return gs}var hy;function w$(){if(hy)return ms;hy=1,Object.defineProperty(ms,"__esModule",{value:!0}),ms.default=void 0;var t=e(b$());function e(r){return r&&r.__esModule?r:{default:r}}var n=t.default;return ms.default=n,ms}var x$=w$();const T$=hT(x$);var S$=t=>(Math.max(-50,Math.min(50,t))+50)/100,C$=(t,e,n=.3)=>t+(e-t)*n,M$="#ef4444",A$="#10b981",N$="#f59e0b",k$=[...Array(10).fill(M$),...Array(10).fill(A$),...Array(10).fill(N$)],E$=({note:t,cents:e,className:n="",clarity:r,inTuneThreshold:i=5,smoothingFactor:s=.7})=>{const[o,a]=G.useState(e),c=G.useRef(null);G.useEffect(()=>{let d=!0;const p=()=>{d&&(a(g=>{const m=.05+(1-s)*.75,_=Math.abs(e-g),b=_>10?1.5:_>5?1:.6,v=Math.min(1,m*b),y=C$(g,e,v);return Math.abs(y-e)<.5?e:y}),d&&(c.current=requestAnimationFrame(p)))};return c.current=requestAnimationFrame(p),()=>{d=!1,c.current!==null&&cancelAnimationFrame(c.current)}},[e,s]);const u=G.useMemo(()=>S$(o),[o]),l=G.useMemo(()=>Math.round(o),[o]),h=G.useMemo(()=>l<-i?"":l>i?"":"",[l,i]),f=Math.abs(l)<=i;return P.jsxs("div",{className:`flex flex-col items-center p-4 ${n}`,children:[P.jsxs("div",{className:"relative w-56 h-56 mb-2",children:[P.jsx(T$,{id:"pitch-gauge",nrOfLevels:30,colors:k$,arcWidth:.2,percent:u,needleColor:"#374151",needleBaseColor:"#374151",textColor:"transparent",hideText:!0,animate:!1,animDelay:0}),P.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center pointer-events-none",style:{marginTop:"20px"},children:[P.jsx("span",{className:`text-4xl font-bold drop-shadow-md transition-colors duration-200 ${f?"text-green-600 dark:text-green-400":"text-gray-800 dark:text-gray-200"}`,children:t}),r!==void 0&&P.jsxs("span",{className:"text-xs text-muted-foreground mt-1",children:["clarity: ",Math.round(r*100),"%"]})]})]}),P.jsxs("div",{className:"text-center mt-2",children:[P.jsx("div",{className:"flex items-center justify-center gap-2",children:P.jsxs("span",{className:`text-2xl font-mono font-semibold transition-colors duration-200 ${Math.abs(l)<=i?"text-green-600 dark:text-green-400":l<0?"text-red-500 dark:text-red-400":"text-amber-500 dark:text-amber-400"}`,children:[h&&P.jsx("span",{className:"mr-1",children:h}),Math.abs(l),""]})}),P.jsx("div",{className:"text-sm text-muted-foreground mt-1",children:f?"In tune! ":l<0?"Too flat":"Too sharp"})]})]})},R$=Us.memo(E$,(t,e)=>t.note===e.note&&Math.abs(t.cents-e.cents)<.5&&t.clarity===e.clarity&&t.className===e.className&&t.inTuneThreshold===e.inTuneThreshold&&t.smoothingFactor===e.smoothingFactor);function I$({instrument:t,tabDisplayMode:e,isMicrophoneInstrument:n,staffContainerRef:r,tabContainerRef:i,detectedPitch:s,pitchSensitivity:o,pitchSmoothing:a,feedback:c,lastDetectedNote:u}){return P.jsx(Md,{className:"border-2 shadow-2xl bg-card/95 backdrop-blur overflow-hidden",children:P.jsxs(Ad,{className:"p-0",children:[P.jsxs("div",{className:`flex ${n?"flex-row":"flex-col"} items-center justify-center`,children:[P.jsxs("div",{className:`flex-1 p-8 flex items-center justify-center ${t==="guitar"&&e==="both"?"min-h-[400px]":"min-h-[300px]"}`,children:[P.jsx("div",{id:"staff-display",ref:r,className:t==="guitar"&&e!=="staff"?"hidden":"block"}),P.jsx("div",{id:"tab-display",ref:i,className:t==="guitar"&&(e==="tab"||e==="both")?"block":"hidden"})]}),n&&P.jsx("div",{className:"flex-shrink-0 p-6 border-l border-border bg-gradient-to-br from-blue-50/50 to-purple-50/50 dark:from-blue-950/30 dark:to-purple-950/30",children:s?P.jsx(R$,{note:s.note,cents:s.cents,clarity:s.clarity,inTuneThreshold:o,smoothingFactor:a}):P.jsx("div",{className:"w-56 h-56 flex items-center justify-center",children:P.jsxs("div",{className:"text-center text-muted-foreground",children:[P.jsx(L0,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),P.jsx("p",{className:"text-sm",children:"Waiting for audio..."})]})})})]}),P.jsx(Cd,{mode:"wait",children:c&&P.jsx(Bt.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:`px-6 py-3 text-center text-sm font-medium ${c.includes("")?"bg-emerald-500/10 text-emerald-600 dark:text-emerald-400":c.includes("")||c.includes("Try again")?"bg-red-500/10 text-red-600 dark:text-red-400":"bg-muted/50 text-muted-foreground"}`,children:c},c)}),(t==="piano"||t==="piano-virtual")&&u&&P.jsxs("div",{className:"px-6 py-3 flex items-center justify-center gap-4 bg-blue-50/50 dark:bg-blue-950/30 border-t border-border",children:[P.jsx(L0,{className:"h-4 w-4 text-blue-600 dark:text-blue-400"}),P.jsxs("span",{className:"text-sm font-medium text-blue-900 dark:text-blue-100",children:["Detected: ",u.noteName]}),u.centsOff!==void 0&&P.jsxs(Ni,{variant:Math.abs(u.centsOff)<10?"default":"secondary",children:[u.centsOff>0?"+":"",u.centsOff.toFixed(0),""]})]})]})})}var mf,fy;function O$(){if(fy)return mf;fy=1;var t={linear:function(e,n,r,i){var s=r-n;return s*e/i+n},easeInQuad:function(e,n,r,i){var s=r-n;return s*(e/=i)*e+n},easeOutQuad:function(e,n,r,i){var s=r-n;return-s*(e/=i)*(e-2)+n},easeInOutQuad:function(e,n,r,i){var s=r-n;return(e/=i/2)<1?s/2*e*e+n:-s/2*(--e*(e-2)-1)+n},easeInCubic:function(e,n,r,i){var s=r-n;return s*(e/=i)*e*e+n},easeOutCubic:function(e,n,r,i){var s=r-n;return s*((e=e/i-1)*e*e+1)+n},easeInOutCubic:function(e,n,r,i){var s=r-n;return(e/=i/2)<1?s/2*e*e*e+n:s/2*((e-=2)*e*e+2)+n},easeInQuart:function(e,n,r,i){var s=r-n;return s*(e/=i)*e*e*e+n},easeOutQuart:function(e,n,r,i){var s=r-n;return-s*((e=e/i-1)*e*e*e-1)+n},easeInOutQuart:function(e,n,r,i){var s=r-n;return(e/=i/2)<1?s/2*e*e*e*e+n:-s/2*((e-=2)*e*e*e-2)+n},easeInQuint:function(e,n,r,i){var s=r-n;return s*(e/=i)*e*e*e*e+n},easeOutQuint:function(e,n,r,i){var s=r-n;return s*((e=e/i-1)*e*e*e*e+1)+n},easeInOutQuint:function(e,n,r,i){var s=r-n;return(e/=i/2)<1?s/2*e*e*e*e*e+n:s/2*((e-=2)*e*e*e*e+2)+n},easeInSine:function(e,n,r,i){var s=r-n;return-s*Math.cos(e/i*(Math.PI/2))+s+n},easeOutSine:function(e,n,r,i){var s=r-n;return s*Math.sin(e/i*(Math.PI/2))+n},easeInOutSine:function(e,n,r,i){var s=r-n;return-s/2*(Math.cos(Math.PI*e/i)-1)+n},easeInExpo:function(e,n,r,i){var s=r-n;return e==0?n:s*Math.pow(2,10*(e/i-1))+n},easeOutExpo:function(e,n,r,i){var s=r-n;return e==i?n+s:s*(-Math.pow(2,-10*e/i)+1)+n},easeInOutExpo:function(e,n,r,i){var s=r-n;return e===0?n:e===i?n+s:(e/=i/2)<1?s/2*Math.pow(2,10*(e-1))+n:s/2*(-Math.pow(2,-10*--e)+2)+n},easeInCirc:function(e,n,r,i){var s=r-n;return-s*(Math.sqrt(1-(e/=i)*e)-1)+n},easeOutCirc:function(e,n,r,i){var s=r-n;return s*Math.sqrt(1-(e=e/i-1)*e)+n},easeInOutCirc:function(e,n,r,i){var s=r-n;return(e/=i/2)<1?-s/2*(Math.sqrt(1-e*e)-1)+n:s/2*(Math.sqrt(1-(e-=2)*e)+1)+n},easeInElastic:function(e,n,r,i){var s=r-n,o,a,c;return c=1.70158,a=0,o=s,e===0?n:(e/=i)===1?n+s:(a||(a=i*.3),o<Math.abs(s)?(o=s,c=a/4):c=a/(2*Math.PI)*Math.asin(s/o),-(o*Math.pow(2,10*(e-=1))*Math.sin((e*i-c)*(2*Math.PI)/a))+n)},easeOutElastic:function(e,n,r,i){var s=r-n,o,a,c;return c=1.70158,a=0,o=s,e===0?n:(e/=i)===1?n+s:(a||(a=i*.3),o<Math.abs(s)?(o=s,c=a/4):c=a/(2*Math.PI)*Math.asin(s/o),o*Math.pow(2,-10*e)*Math.sin((e*i-c)*(2*Math.PI)/a)+s+n)},easeInOutElastic:function(e,n,r,i){var s=r-n,o,a,c;return c=1.70158,a=0,o=s,e===0?n:(e/=i/2)===2?n+s:(a||(a=i*(.3*1.5)),o<Math.abs(s)?(o=s,c=a/4):c=a/(2*Math.PI)*Math.asin(s/o),e<1?-.5*(o*Math.pow(2,10*(e-=1))*Math.sin((e*i-c)*(2*Math.PI)/a))+n:o*Math.pow(2,-10*(e-=1))*Math.sin((e*i-c)*(2*Math.PI)/a)*.5+s+n)},easeInBack:function(e,n,r,i,s){var o=r-n;return s===void 0&&(s=1.70158),o*(e/=i)*e*((s+1)*e-s)+n},easeOutBack:function(e,n,r,i,s){var o=r-n;return s===void 0&&(s=1.70158),o*((e=e/i-1)*e*((s+1)*e+s)+1)+n},easeInOutBack:function(e,n,r,i,s){var o=r-n;return s===void 0&&(s=1.70158),(e/=i/2)<1?o/2*(e*e*(((s*=1.525)+1)*e-s))+n:o/2*((e-=2)*e*(((s*=1.525)+1)*e+s)+2)+n},easeInBounce:function(e,n,r,i){var s=r-n,o;return o=t.easeOutBounce(i-e,0,s,i),s-o+n},easeOutBounce:function(e,n,r,i){var s=r-n;return(e/=i)<1/2.75?s*(7.5625*e*e)+n:e<2/2.75?s*(7.5625*(e-=1.5/2.75)*e+.75)+n:e<2.5/2.75?s*(7.5625*(e-=2.25/2.75)*e+.9375)+n:s*(7.5625*(e-=2.625/2.75)*e+.984375)+n},easeInOutBounce:function(e,n,r,i){var s=r-n,o;return e<i/2?(o=t.easeInBounce(e*2,0,s,i),o*.5+n):(o=t.easeOutBounce(e*2-i,0,s,i),o*.5+s*.5+n)}};return mf=t,mf}var D$=O$();function P$(t){return t*Math.PI/180}function It(t,e){return t+Math.random()*(e-t)}function q$(t,e){return Math.floor(t+Math.random()*(e-t+1))}var Ws;(function(t){t[t.Circle=0]="Circle",t[t.Square=1]="Square",t[t.Strip=2]="Strip"})(Ws||(Ws={}));var tr;(function(t){t[t.Positive=1]="Positive",t[t.Negative=-1]="Negative"})(tr||(tr={}));const F$=1e3/60;class $${constructor(e,n,r,i){this.getOptions=n;const{colors:s,initialVelocityX:o,initialVelocityY:a}=this.getOptions();this.context=e,this.x=r,this.y=i,this.w=It(5,20),this.h=It(5,20),this.radius=It(5,10),this.vx=typeof o=="number"?It(-o,o):It(o.min,o.max),this.vy=typeof a=="number"?It(-a,0):It(a.min,a.max),this.shape=q$(0,2),this.angle=P$(It(0,360)),this.angularSpin=It(-.2,.2),this.color=s[Math.floor(Math.random()*s.length)],this.rotateY=It(0,1),this.rotationDirection=It(0,1)?tr.Positive:tr.Negative}update(e){const{gravity:n,wind:r,friction:i,opacity:s,drawShape:o}=this.getOptions(),a=e/F$;this.x+=this.vx*a,this.y+=this.vy*a,this.vy+=n*a,this.vx+=r*a,this.vx*=i**a,this.vy*=i**a,this.rotateY>=1&&this.rotationDirection===tr.Positive?this.rotationDirection=tr.Negative:this.rotateY<=-1&&this.rotationDirection===tr.Negative&&(this.rotationDirection=tr.Positive);const c=.1*this.rotationDirection*a;if(this.rotateY+=c,this.angle+=this.angularSpin,this.context.save(),this.context.translate(this.x,this.y),this.context.rotate(this.angle),this.context.scale(1,this.rotateY),this.context.rotate(this.angle),this.context.beginPath(),this.context.fillStyle=this.color,this.context.strokeStyle=this.color,this.context.globalAlpha=s,this.context.lineCap="round",this.context.lineWidth=2,o&&typeof o=="function")o.call(this,this.context);else switch(this.shape){case Ws.Circle:{this.context.beginPath(),this.context.arc(0,0,this.radius,0,2*Math.PI),this.context.fill();break}case Ws.Square:{this.context.fillRect(-this.w/2,-this.h/2,this.w,this.h);break}case Ws.Strip:{this.context.fillRect(-this.w/6,-this.h/2,this.w/3,this.h);break}}this.context.closePath(),this.context.restore()}}class V${constructor(e,n){this.x=0,this.y=0,this.w=0,this.h=0,this.lastNumberOfPieces=0,this.tweenProgress=0,this.tweenFrom=0,this.particles=[],this.particlesGenerated=0,this.removeParticleAt=i=>{this.particles.splice(i,1)},this.getParticle=()=>{const i=It(this.x,this.w+this.x),s=It(this.y,this.h+this.y);return new $$(this.context,this.getOptions,i,s)},this.animate=i=>{const{canvas:s,context:o,particlesGenerated:a,lastNumberOfPieces:c}=this,{run:u,recycle:l,numberOfPieces:h,debug:f,tweenFunction:d,tweenDuration:p}=this.getOptions();if(!u)return!1;const g=this.particles.length,m=l?g:a;if(m<h){c!==h&&(this.tweenProgress=0,this.tweenFrom=m,this.lastNumberOfPieces=h),this.tweenProgress=Math.min(p,Math.max(0,this.tweenProgress+i));const _=d(this.tweenProgress,this.tweenFrom,h,p),b=Math.round(_-m);for(let v=0;v<b;v++)this.particles.push(this.getParticle());this.particlesGenerated+=b}f&&(o.font="12px sans-serif",o.fillStyle="#333",o.textAlign="right",o.fillText(`Particles: ${g}`,s.width-10,s.height-20));for(let _=this.particles.length-1;_>=0;_--){const b=this.particles[_];b.update(i),(b.y>s.height||b.y<-100||b.x>s.width+100||b.x<-100)&&(l&&m<=h?this.particles[_]=this.getParticle():this.removeParticleAt(_))}return g>0||m<h},this.canvas=e;const r=this.canvas.getContext("2d");if(!r)throw new Error("Could not get canvas context");this.context=r,this.getOptions=n}}const O0={width:typeof window<"u"?window.innerWidth:300,height:typeof window<"u"?window.innerHeight:200,numberOfPieces:200,friction:.99,wind:0,gravity:.1,initialVelocityX:4,initialVelocityY:10,colors:["#f44336","#e91e63","#9c27b0","#673ab7","#3f51b5","#2196f3","#03a9f4","#00bcd4","#009688","#4CAF50","#8BC34A","#CDDC39","#FFEB3B","#FFC107","#FF9800","#FF5722","#795548"],opacity:1,debug:!1,tweenFunction:D$.easeInOutQuad,tweenDuration:5e3,recycle:!0,run:!0};class L${constructor(e,n){this.lastFrameTime=0,this.setOptionsWithDefaults=i=>{const s={confettiSource:{x:0,y:0,w:this.canvas.width,h:0}};this._options={...s,...O0,...i},Object.assign(this,i.confettiSource)},this.update=(i=0)=>{const{options:{run:s,onConfettiComplete:o,frameRate:a},canvas:c,context:u}=this,l=Math.min(i-this.lastFrameTime,50);if(a&&l<1e3/a){this.rafId=requestAnimationFrame(this.update);return}this.lastFrameTime=i-(a?l%a:0),s&&(u.fillStyle="white",u.clearRect(0,0,c.width,c.height)),this.generator.animate(l)?this.rafId=requestAnimationFrame(this.update):(o&&typeof o=="function"&&this.generator.particlesGenerated>0&&o.call(this,this),this._options.run=!1)},this.reset=()=>{this.generator&&this.generator.particlesGenerated>0&&(this.generator.particlesGenerated=0,this.generator.particles=[],this.generator.lastNumberOfPieces=0)},this.stop=()=>{this.options={run:!1},this.rafId&&(cancelAnimationFrame(this.rafId),this.rafId=void 0)},this.canvas=e;const r=this.canvas.getContext("2d");if(!r)throw new Error("Could not get canvas context");this.context=r,this.generator=new V$(this.canvas,()=>this.options),this.options=n,this.update()}get options(){return this._options}set options(e){var i,s;const n=(i=this._options)==null?void 0:i.run,r=(s=this._options)==null?void 0:s.recycle;this.setOptionsWithDefaults(e),this.generator&&(Object.assign(this.generator,this.options.confettiSource),typeof e.recycle=="boolean"&&e.recycle&&r===!1&&(this.generator.lastNumberOfPieces=this.generator.particles.length)),typeof e.run=="boolean"&&e.run&&n===!1&&this.update()}}const j$=Us.createRef();class D0 extends Us.Component{constructor(e){super(e),this.canvas=Us.createRef(),this.canvas=e.canvasRef||j$}componentDidMount(){if(this.canvas.current){const e=gf(this.props)[0];this.confetti=new L$(this.canvas.current,e)}}componentDidUpdate(){const e=gf(this.props)[0];this.confetti&&(this.confetti.options=e)}componentWillUnmount(){this.confetti&&this.confetti.stop(),this.confetti=void 0}render(){const[e,n]=gf(this.props),r={zIndex:2,position:"absolute",pointerEvents:"none",top:0,left:0,bottom:0,right:0,...n.style};return P.jsx("canvas",{width:e.width,height:e.height,ref:this.canvas,...n,style:r})}}D0.defaultProps={...O0};D0.displayName="ReactConfetti";function gf(t){const e={},n={},r={},i=[...Object.keys(O0),"confettiSource","drawShape","onConfettiComplete","frameRate"],s=["canvasRef"];for(const o in t){const a=t[o];i.includes(o)?e[o]=a:s.includes(o)?s[o]=a:r[o]=a}return[e,r,n]}const z$=Us.forwardRef((t,e)=>P.jsx(D0,{canvasRef:e,...t}));function B$({scoreResult:t,correctCount:e,totalNotes:n,isSuccessful:r,onContinue:i,onRetry:s,showConfetti:o=!0,className:a=""}){const[c,u]=G.useState(!1),[l,h]=G.useState({width:0,height:0});G.useEffect(()=>{const p=()=>{h({width:window.innerWidth,height:window.innerHeight})};return p(),window.addEventListener("resize",p),()=>window.removeEventListener("resize",p)},[]),G.useEffect(()=>{if(r&&o){u(!0);const p=setTimeout(()=>u(!1),5e3);return()=>clearTimeout(p)}},[r,o]);const f=Ms[t.rank],d=n>0?e/n*100:0;return P.jsxs(P.Fragment,{children:[c&&P.jsx(z$,{width:l.width,height:l.height,recycle:!1,numberOfPieces:200,gravity:.2,colors:["#3B82F6","#10B981","#F59E0B","#8B5CF6","#EC4899"]}),P.jsx(Bt.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:300,damping:20},className:a,children:P.jsxs(Md,{className:"border-2",children:[P.jsxs(py,{className:"text-center",children:[P.jsx(Bt.div,{initial:{rotate:-180,scale:0},animate:{rotate:0,scale:1},transition:{type:"spring",stiffness:200,damping:15,delay:.2},className:"flex justify-center mb-4",children:P.jsx(_y,{className:`h-16 w-16 ${f.color}`})}),P.jsx(my,{className:"text-3xl font-bold",children:r?"Round Complete!":"Round Failed"}),P.jsx(vT,{className:"text-lg mt-2",children:P.jsxs(Ni,{variant:"outline",className:`text-2xl font-bold px-4 py-2 ${f.color} border-current`,children:["Rank ",t.rank]})})]}),P.jsxs(Ad,{className:"space-y-6",children:[P.jsxs("div",{className:"space-y-4",children:[P.jsxs("div",{className:"flex items-center justify-between p-4 bg-muted rounded-lg",children:[P.jsxs("div",{className:"flex items-center gap-3",children:[P.jsx(gy,{className:"h-6 w-6 text-blue-500"}),P.jsxs("div",{children:[P.jsx("p",{className:"text-sm text-muted-foreground",children:"Accuracy"}),P.jsxs("p",{className:"text-2xl font-bold",children:[d.toFixed(0),"%"]})]})]}),P.jsxs("div",{className:"text-right",children:[P.jsx("p",{className:"text-sm text-muted-foreground",children:"Notes"}),P.jsxs("p",{className:"text-xl font-semibold",children:[e,"/",n]})]})]}),t.speedBonus>0&&P.jsx(Bt.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.3},className:"flex items-center justify-between p-4 bg-yellow-500/10 rounded-lg border border-yellow-500/20",children:P.jsxs("div",{className:"flex items-center gap-3",children:[P.jsx(bT,{className:"h-6 w-6 text-yellow-500"}),P.jsxs("div",{children:[P.jsx("p",{className:"text-sm text-muted-foreground",children:"Speed Bonus"}),P.jsxs("p",{className:"text-xl font-bold text-yellow-500",children:["+",t.speedBonus,"%"]})]})]})}),t.streakMultiplier>1&&P.jsx(Bt.div,{initial:{x:-20,opacity:0},animate:{x:0,opacity:1},transition:{delay:.4},className:"flex items-center justify-between p-4 bg-orange-500/10 rounded-lg border border-orange-500/20",children:P.jsxs("div",{className:"flex items-center gap-3",children:[P.jsx(TT,{className:"h-6 w-6 text-orange-500"}),P.jsxs("div",{children:[P.jsx("p",{className:"text-sm text-muted-foreground",children:"Streak Multiplier"}),P.jsxs("p",{className:"text-xl font-bold text-orange-500",children:["",t.streakMultiplier.toFixed(1)]})]})]})}),P.jsxs(Bt.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{delay:.5,type:"spring"},className:"p-6 bg-gradient-to-r from-blue-500/10 to-purple-500/10 rounded-lg border-2 border-blue-500/20",children:[P.jsx("p",{className:"text-sm text-muted-foreground text-center mb-2",children:"Total Score"}),P.jsx("p",{className:"text-5xl font-bold text-center text-blue-500",children:t.finalScore}),P.jsx("p",{className:"text-center text-lg font-medium mt-2 text-muted-foreground",children:f.label})]})]}),P.jsxs("div",{className:"flex gap-3 pt-4",children:[s&&!r&&P.jsx(ka,{onClick:s,variant:"outline",className:"flex-1",children:"Try Again"}),P.jsx(ka,{onClick:i,className:"flex-1",children:r?"Next Round":"Continue"})]})]})]})})]})}function W$({isOpen:t,scoreResult:e,correctCount:n,totalNotes:r,isSuccessful:i,onContinue:s,onRetry:o}){return P.jsx(Cd,{children:t&&e&&P.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4 backdrop-blur-sm",children:P.jsx(B$,{scoreResult:e,correctCount:n,totalNotes:r,isSuccessful:i,onContinue:s,onRetry:o,showConfetti:i})})})}function SV(){const t=fT(),e=dT.useSearch(),n=e.instrument||"piano",r=e.clef||"treble",i=e.difficulty||"beginner",s=e.gameMode||"practice",o=e.tabDisplayMode||"both",a=e.pitchSensitivity||10,c=e.pitchSmoothing||.7,u=e.selectedAudioDevice||"",[l,h]=G.useState(!1),[f,d]=G.useState(!1),[p,g]=G.useState(!1),[m,_]=G.useState({correct:0,incorrect:0,streak:0,avgTime:"-"}),[b,v]=G.useState(""),[,y]=G.useState(null),[w,x]=G.useState(null),[C,S]=G.useState(!1),[A,N]=G.useState(null),T=G.useRef(!1),k=G.useRef(null),I=G.useRef(n),M=G.useRef(r),E=G.useRef(s),R=G.useRef(null),O=G.useRef(null),q=G.useRef(null),D=G.useRef(null),$=G.useRef(null),F=G.useRef(null),L=G.useRef(null),te=G.useRef(null),Z=G.useRef(null),W=G.useRef(0),ne=G.useRef(!1),J=G.useRef(!1),B=G.useRef(0),z=G.useRef(0),Y=G.useCallback(()=>S1(n,i),[i,n]),K=G.useCallback(ee=>{var Ae,et;S(!0);const ye=S1(n,i);F0.saveSession({module:"sightReading",correct:ee.correctCount,incorrect:ee.incorrectCount,bestStreak:ee.streak,gameMode:s,roundScore:(Ae=ee.currentScore)==null?void 0:Ae.finalScore,timeLeft:ee.timeLeft,livesRemaining:ee.lives,instrument:n,clef:r,range:ye}),ls.success("Round Complete! ",{description:`Score: ${((et=ee.currentScore)==null?void 0:et.finalScore)||0} points`})},[s,n,r,i]),V=G.useCallback(ee=>{var ye;S(!0),ls.error("Round Failed",{description:`You scored ${((ye=ee.currentScore)==null?void 0:ye.finalScore)||0} points. Try again!`})},[]),ve=G.useCallback(ee=>{ee===1&&ls.warning("Last Life! ",{description:"Be careful on the next note!",duration:2e3})},[]),ge=G.useCallback(ee=>{const ye=I3(ee);ye&&ls.success(ye,{duration:2500})},[]),[j,H]=O3({difficulty:i,gameMode:s,onRoundComplete:K,onRoundFail:V,onLifeLost:ve,onStreakMilestone:ge}),U=G.useCallback(()=>{J.current=!1,B.current=0,z.current=0;const ee=Lo(Y(),r);ee&&(y(ee.midiNote),k.current=ee.midiNote,Yo({instrument:n,tabDisplayMode:o,clef:r,midiNote:ee.midiNote,staffRenderer:F.current,tabRenderer:L.current}))},[r,n,Y,o]),se=G.useCallback(ee=>{if(q.current){const ye=q.current.getInputDevices();h(ye.length>0)}},[]),le=G.useCallback(ee=>{var Ae,et,Xn,Zn;N({note:ee.noteName,cents:ee.cents,clarity:ee.clarity});let ye;if(k.current!==null){const Mn=jo(I.current);ye=zo(ee.midi,k.current,{allowOctaveError:Mn.validation.octaveFlexible}).centsOff}if(x({note:ee.midi,noteName:ee.noteName,centsOff:ye}),T.current&&k.current!==null){const Mn=jo(I.current);if(zo(ee.midi,k.current,{allowOctaveError:Mn.validation.octaveFlexible}).isCorrect)B.current+=1,z.current=Date.now(),B.current>=4&&!J.current&&(J.current=!0,E.current==="timed"&&((Ae=O.current)!=null&&Ae.isActive)&&((et=R.current)==null||et.noteCorrect()),_(Zt=>{var P0;return{correct:Zt.correct+1,incorrect:Zt.incorrect,streak:E.current==="timed"?((P0=O.current)==null?void 0:P0.streak)||0:Zt.streak+1,avgTime:Zt.avgTime}}),v("Correct! "),F.current&&F.current.showFeedback(!0));else{B.current=0,z.current=Date.now();const lt=Date.now();lt-W.current>1e3&&!J.current&&(E.current==="timed"&&((Xn=O.current)!=null&&Xn.isActive)&&((Zn=R.current)==null||Zn.noteIncorrect()),_(Zt=>({correct:Zt.correct,incorrect:Zt.incorrect+1,streak:0,avgTime:Zt.avgTime})),v(`Try again - you played ${ee.noteName}`),F.current&&F.current.showFeedback(!1),W.current=lt)}}},[]),me=G.useRef(U);G.useEffect(()=>{me.current=U},[U]);const ut=G.useCallback(ee=>{var Ae,et,Xn,Zn;$.current&&$.current.playNote(ee.note);let ye;if(k.current!==null){const Mn=jo(I.current);ye=zo(ee.note,k.current,{allowOctaveError:Mn.validation.octaveFlexible}).centsOff}if(x({note:ee.note,noteName:ee.noteName,centsOff:ye}),T.current&&k.current!==null){const Mn=jo(I.current);zo(ee.note,k.current,{allowOctaveError:Mn.validation.octaveFlexible}).isCorrect?(E.current==="timed"&&((Ae=O.current)!=null&&Ae.isActive)&&((et=R.current)==null||et.noteCorrect()),_(lt=>{var Zt;return{correct:lt.correct+1,incorrect:lt.incorrect,streak:E.current==="timed"?((Zt=O.current)==null?void 0:Zt.streak)||0:lt.streak+1,avgTime:lt.avgTime}}),v("Correct! "),F.current&&F.current.showFeedback(!0),setTimeout(()=>{var lt;(lt=O.current)!=null&&lt.isComplete||me.current()},500)):(E.current==="timed"&&((Xn=O.current)!=null&&Xn.isActive)&&((Zn=R.current)==null||Zn.noteIncorrect()),_(lt=>({correct:lt.correct,incorrect:lt.incorrect+1,streak:0,avgTime:lt.avgTime})),v("Try again "),F.current&&F.current.showFeedback(!1))}},[]);G.useEffect(()=>((async()=>{if($.current=new A3,yT(n)){q.current=new Jb;const ye=await q.current.init();h(ye),ye&&(q.current.on("noteOn",ut),q.current.on("deviceChange",se))}setTimeout(()=>{te.current&&!F.current&&(F.current=new e2("staff-display")),Z.current&&!L.current&&(L.current=new Af("tab-display",I.current))},200)})(),()=>{var ye,Ae,et;(ye=q.current)==null||ye.disconnectDevice(),(Ae=D.current)==null||Ae.disconnect(),(et=$.current)==null||et.cleanup()}),[]),G.useEffect(()=>{I.current=n,L.current&&Z.current&&(L.current=new Af("tab-display",n))},[n]),G.useEffect(()=>{M.current=r},[r]),G.useEffect(()=>{E.current=s},[s]),R.current=H,O.current=j,G.useEffect(()=>{if(!p)return;const ee=800,ye=setInterval(()=>{var et;const Ae=Date.now()-z.current;J.current&&Ae>ee&&(J.current=!1,B.current=0,z.current=0,(et=O.current)!=null&&et.isComplete||me.current())},100);return()=>clearInterval(ye)},[p]),G.useEffect(()=>{const ee=n==="violin"||n==="guitar";ee&&!ne.current?(async()=>{var Zn;ne.current=!0;const Ae=await $0.getAudioInputDevices(),et=u||((Zn=Ae[0])==null?void 0:Zn.deviceId);D.current=new $0;const Xn=await D.current.init(et);d(Xn),Xn?(D.current.on("pitchDetected",le),D.current.on("statusChange",Mn=>d(Mn.microphoneActive)),D.current.startListening()):ls.error("Microphone Access Required",{description:"Click the camera/microphone icon in your browser's address bar to allow microphone access.",duration:1e4})})():!ee&&D.current&&(D.current.disconnect(),D.current=null,d(!1),ne.current=!1)},[n,u]),G.useEffect(()=>{const ye=setTimeout(()=>{s==="timed"&&H.startRound();const Ae=Lo(Y(),r);Ae&&(y(Ae.midiNote),k.current=Ae.midiNote,setTimeout(()=>{Yo({instrument:n,tabDisplayMode:o,clef:r,midiNote:Ae.midiNote,staffRenderer:F.current,tabRenderer:L.current})},100),g(!0),T.current=!0,v("Play the note!"),_({correct:0,incorrect:0,streak:0,avgTime:"-"}))},600);return()=>clearTimeout(ye)},[]);const ln=()=>{s==="timed"&&j.isActive&&H.endRound(),g(!1),T.current=!1,s!=="timed"&&(m.correct>0||m.incorrect>0)&&F0.saveSession({module:"sightReading",instrument:n,clef:r,range:Y(),...m,timestamp:Date.now()}),t({to:"/"})},Yn=n==="violin"||n==="guitar";return P.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-background via-background to-muted/20 flex flex-col",children:[P.jsx("div",{className:"fixed top-6 right-6 z-30",children:P.jsx(ka,{variant:"ghost",size:"icon",onClick:ln,className:"h-12 w-12 rounded-full bg-card/80 backdrop-blur hover:bg-destructive hover:text-destructive-foreground transition-all shadow-lg",children:P.jsx(ST,{className:"h-5 w-5"})})}),P.jsxs("div",{className:"fixed top-6 left-6 z-30 flex gap-2",children:[l&&P.jsx(Ni,{variant:"default",className:"bg-emerald-600",children:"MIDI Connected"}),f&&Yn&&P.jsx(Ni,{variant:"default",className:"bg-emerald-600",children:" Mic Active"})]}),P.jsx("div",{className:"flex-1 flex items-center justify-center p-8",children:P.jsxs("div",{className:"w-full max-w-4xl space-y-8",children:[P.jsxs(Bt.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"flex items-center justify-between px-4",children:[P.jsx(R7,{gameMode:s,roundState:j,stats:m}),s==="timed"&&j.isActive&&P.jsx(k7,{timeLeft:j.timeLeft,maxTime:j.maxTime})]}),P.jsx(Bt.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:.1},children:P.jsx(I$,{instrument:n,tabDisplayMode:o,isMicrophoneInstrument:Yn,staffContainerRef:te,tabContainerRef:Z,detectedPitch:A,pitchSensitivity:a,pitchSmoothing:c,feedback:b,lastDetectedNote:w})}),s==="practice"&&P.jsx(Bt.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"flex justify-center",children:P.jsxs(ka,{variant:"ghost",onClick:U,className:"gap-2",children:[P.jsx(xT,{className:"h-4 w-4"}),"Skip Note"]})})]})}),n==="piano-virtual"&&P.jsx("div",{className:"pb-8 px-8",children:P.jsx(N7,{onNotePlay:(ee,ye)=>{const Ae=440*Math.pow(2,(ee-69)/12);ut({note:ee,noteName:ye,velocity:100,frequency:Ae,timestamp:Date.now()})},enabled:!0,startOctave:3,octaveCount:3})}),P.jsx(W$,{isOpen:C,scoreResult:j.currentScore,correctCount:j.correctCount,totalNotes:j.notesRequired,isSuccessful:j.isSuccessful||!1,onContinue:()=>{S(!1),H.startRound();const ee=Lo(Y(),r);ee&&(y(ee.midiNote),k.current=ee.midiNote,g(!0),T.current=!0,setTimeout(()=>{Yo({instrument:n,tabDisplayMode:o,clef:r,midiNote:ee.midiNote,staffRenderer:F.current,tabRenderer:L.current})},100))},onRetry:j.isSuccessful?void 0:()=>{S(!1),H.resetRound();const ee=Lo(Y(),r);ee&&(y(ee.midiNote),k.current=ee.midiNote,g(!0),T.current=!0,setTimeout(()=>{Yo({instrument:n,tabDisplayMode:o,clef:r,midiNote:ee.midiNote,staffRenderer:F.current,tabRenderer:L.current})},100))}})]})}export{SV as component};
//# sourceMappingURL=play-f4Z1CC15.js.map
